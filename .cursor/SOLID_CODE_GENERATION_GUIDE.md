# üéØ SOLID Code Generation Guide

## üìã –ü—Ä–æ–±–ª–µ–º–∞

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
- `oapi-codegen` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç **–æ–¥–∏–Ω –±–æ–ª—å—à–æ–π —Ñ–∞–π–ª** `api.gen.go` (2000-3000 —Å—Ç—Ä–æ–∫)
- **–ù–∞—Ä—É—à–µ–Ω–∏–µ SOLID –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤** (Single Responsibility)
- **–ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ —Ñ–∞–π–ª–æ–≤** (500 —Å—Ç—Ä–æ–∫ max)
- **–ù–∏–∑–∫–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å** –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞

**–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:**

| –°–µ—Ä–≤–∏—Å | api.gen.go | –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|--------|------------|------------|--------|
| `voice-chat-service-go` | **2926** —Å—Ç—Ä–æ–∫ | üî¥ **5.9x** | –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ |
| `housing-service-go` | **1869** —Å—Ç—Ä–æ–∫ | üî¥ **3.7x** | –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ |
| `clan-war-service-go` | **1724** —Å—Ç—Ä–æ–∫–∏ | üî¥ **3.4x** | –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ |
| `companion-service-go` | **1329** —Å—Ç—Ä–æ–∫ | üî¥ **2.6x** | –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ |
| `cosmetic-service-go` | **1191** —Å—Ç—Ä–æ–∫–∞ | üî¥ **2.4x** | –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ |

---

## OK –†–µ—à–µ–Ω–∏–µ: –†–∞–∑–¥–µ–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è

**–ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥:**
- ‚ùå **–°—Ç–∞—Ä—ã–π:** 1 —Ñ–∞–π–ª `api.gen.go` (2000-3000 —Å—Ç—Ä–æ–∫)
- OK **–ù–æ–≤—ã–π:** 3 —Ñ–∞–π–ª–∞ `types.gen.go`, `server.gen.go`, `spec.gen.go` (–∫–∞–∂–¥—ã–π <500 —Å—Ç—Ä–æ–∫)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- OK –°–æ–±–ª—é–¥–µ–Ω–∏–µ SOLID –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤
- OK –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª <500 —Å—Ç—Ä–æ–∫
- OK –õ—É—á—à–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å
- OK –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (—Ç–∏–ø—ã, —Å–µ—Ä–≤–µ—Ä, —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è)

---

## üìö –î–ª—è API Designer –∞–≥–µ–Ω—Ç–∞

### –ü—Ä–∞–≤–∏–ª–æ: –†–∞–∑–±–∏–≤–∞–π –±–æ–ª—å—à–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–ï—Å–ª–∏ OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è >500 —Å—Ç—Ä–æ–∫:**

1. **–°–æ–∑–¥–∞–π –º–æ–¥—É–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:**

```
proto/openapi/
‚îú‚îÄ‚îÄ {service-name}/
‚îÇ   ‚îú‚îÄ‚îÄ main.yaml                    # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª
‚îÇ   ‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ {domain1}.yaml           # –°—Ö–µ–º—ã –¥–æ–º–µ–Ω–∞ 1 (<500 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ {domain2}.yaml           # –°—Ö–µ–º—ã –¥–æ–º–µ–Ω–∞ 2 (<500 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ {domain3}.yaml           # –°—Ö–µ–º—ã –¥–æ–º–µ–Ω–∞ 3 (<500 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îî‚îÄ‚îÄ paths/
‚îÇ       ‚îú‚îÄ‚îÄ {domain1}.yaml           # Endpoints –¥–æ–º–µ–Ω–∞ 1 (<500 —Å—Ç—Ä–æ–∫)
‚îÇ       ‚îú‚îÄ‚îÄ {domain2}.yaml           # Endpoints –¥–æ–º–µ–Ω–∞ 2 (<500 —Å—Ç—Ä–æ–∫)
‚îÇ       ‚îî‚îÄ‚îÄ {domain3}.yaml           # Endpoints –¥–æ–º–µ–Ω–∞ 3 (<500 —Å—Ç—Ä–æ–∫)
‚îî‚îÄ‚îÄ {service-name}.yaml              # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª —Å $ref —Å—Å—ã–ª–∫–∞–º–∏
```

2. **–ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –∏—Å–ø–æ–ª—å–∑—É–µ—Ç $ref:**

```yaml
# Issue: #123
openapi: 3.0.0
info:
  title: Voice Chat Service API
  version: 1.0.0

paths:
  /api/v1/channels:
    $ref: 'voice-chat-service/paths/channels.yaml#/paths/~1api~1v1~1channels'

components:
  schemas:
    Channel:
      $ref: 'voice-chat-service/schemas/channels.yaml#/components/schemas/Channel'
  
  # ALWAYS use common.yaml
  securitySchemes:
    $ref: 'common.yaml#/components/securitySchemes'
```

3. **–í–∞–ª–∏–¥–∞—Ü–∏—è:**

```bash
redocly lint proto/openapi/{service-name}.yaml
redocly bundle proto/openapi/{service-name}.yaml -o /tmp/bundled.yaml
```

**–ü–æ–¥—Ä–æ–±–Ω–µ–µ:** `.cursor/rules/agent-api-designer.mdc` (—Å–µ–∫—Ü–∏—è "Splitting Large Specs")

---

## üõ†Ô∏è –î–ª—è Backend Developer –∞–≥–µ–Ω—Ç–∞

### –ü—Ä–∞–≤–∏–ª–æ: –ò—Å–ø–æ–ª—å–∑—É–π —Ä–∞–∑–¥–µ–ª—å–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**

```
services/{service}-go/
‚îú‚îÄ‚îÄ pkg/api/
‚îÇ   ‚îú‚îÄ‚îÄ types.gen.go              # <500 —Å—Ç—Ä–æ–∫ (–º–æ–¥–µ–ª–∏, —Å—Ö–µ–º—ã)
‚îÇ   ‚îú‚îÄ‚îÄ server.gen.go             # <500 —Å—Ç—Ä–æ–∫ (ServerInterface, —Ä–æ—É—Ç–µ—Ä)
‚îÇ   ‚îî‚îÄ‚îÄ spec.gen.go               # <500 —Å—Ç—Ä–æ–∫ (embedded OpenAPI spec)
‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îú‚îÄ‚îÄ http_server.go            # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ middleware.go             # Middleware
‚îÇ   ‚îú‚îÄ‚îÄ handlers.go               # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è api.ServerInterface
‚îÇ   ‚îú‚îÄ‚îÄ service.go                # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ repository.go             # –ë–î
‚îú‚îÄ‚îÄ Makefile                      # –° —Ä–∞–∑–¥–µ–ª—å–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
‚îî‚îÄ‚îÄ .gitignore                    # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç *.gen.go
```

### Makefile –∫–æ–º–∞–Ω–¥—ã:

```bash
make generate-api      # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Å–µ—Ö 3 —Ñ–∞–π–ª–æ–≤
make generate-types    # –¢–æ–ª—å–∫–æ types.gen.go
make generate-server   # –¢–æ–ª—å–∫–æ server.gen.go
make generate-spec     # –¢–æ–ª—å–∫–æ spec.gen.go
make check-file-sizes  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ 500 —Å—Ç—Ä–æ–∫
make verify-api        # –í–∞–ª–∏–¥–∞—Ü–∏—è OpenAPI spec
make clean             # –£–¥–∞–ª–µ–Ω–∏–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
```

### –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:

**Windows (PowerShell):**
```powershell
# –û–¥–∏–Ω —Å–µ—Ä–≤–∏—Å
.\scripts\migrate-to-split-generation.ps1 -ServiceName voice-chat-service

# –í—Å–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
.\scripts\migrate-to-split-generation.ps1
```

**Linux/macOS:**
```bash
# –û–¥–∏–Ω —Å–µ—Ä–≤–∏—Å
./scripts/migrate-to-split-generation.sh voice-chat-service

# –í—Å–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
./scripts/migrate-to-split-generation.sh
```

**–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
1. –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π `Makefile` —Å —Ä–∞–∑–¥–µ–ª—å–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
2. –û–±–Ω–æ–≤–ª—è–µ—Ç `.gitignore`
3. –£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–π `oapi-codegen.yaml` (–Ω–µ –Ω—É–∂–µ–Ω)
4. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥ –≤ 3 —Ñ–∞–π–ª–∞
5. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤

### –ß–µ–∫-–ª–∏—Å—Ç –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

- [ ] 3 —Ñ–∞–π–ª–∞ —Å–æ–∑–¥–∞–Ω—ã: `types.gen.go`, `server.gen.go`, `spec.gen.go`
- [ ] –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª <500 —Å—Ç—Ä–æ–∫ (`make check-file-sizes`)
- [ ] –°—Ç–∞—Ä—ã–π `api.gen.go` —É–¥–∞–ª–µ–Ω
- [ ] `.gitignore` –æ–±–Ω–æ–≤–ª–µ–Ω
- [ ] –ö–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è: `go build ./...`
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç: `go test ./...`
- [ ] Docker –æ–±—Ä–∞–∑ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è

**–ü–æ–¥—Ä–æ–±–Ω–µ–µ:** `.cursor/rules/agent-backend.mdc` (—Å–µ–∫—Ü–∏—è "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –∏–∑ OpenAPI")

---

## üîß –®–∞–±–ª–æ–Ω—ã –∏ –ø—Ä–∏–º–µ—Ä—ã

### –ü–æ–ª–Ω—ã–π —à–∞–±–ª–æ–Ω Makefile:

–°–º. `.cursor/CODE_GENERATION_TEMPLATE.md` - –ø–æ–ª–Ω—ã–π —à–∞–±–ª–æ–Ω —Å:
- –†–∞–∑–¥–µ–ª—å–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –í–∞–ª–∏–¥–∞—Ü–∏–µ–π —Ä–∞–∑–º–µ—Ä–æ–≤ —Ñ–∞–π–ª–æ–≤
- –ü—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä handlers.go:

```go
// Issue: #123
package server

import (
    "net/http"
    "github.com/your-org/necpgame/services/{service}-go/pkg/api"
)

type Handlers struct {
    service Service
}

func NewHandlers(service Service) *Handlers {
    return &Handlers{service: service}
}

// –†–µ–∞–ª–∏–∑–∞—Ü–∏—è api.ServerInterface (–∏–∑ server.gen.go)
func (h *Handlers) ListChannels(w http.ResponseWriter, r *http.Request, params api.ListChannelsParams) {
    // –ò—Å–ø–æ–ª—å–∑—É–π —Ç–∏–ø—ã –∏–∑ types.gen.go
    channels, err := h.service.ListChannels(r.Context(), params)
    if err != nil {
        respondError(w, http.StatusInternalServerError, err.Error())
        return
    }
    
    // Response —Ç–∏–ø—ã –∏–∑ types.gen.go
    response := api.ListChannelsResponse{
        Channels: channels,
    }
    
    respondJSON(w, http.StatusOK, response)
}
```

**–í–∞–∂–Ω–æ:** –ò–º–ø–æ—Ä—Ç –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è! –í—Å–µ —Ç–∏–ø—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ –ø–∞–∫–µ—Ç–µ `api`.

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

### üî¥ –ö–†–ò–¢–ò–ß–ù–´–ï (–º–∏–≥—Ä–∞—Ü–∏—è –°–†–û–ß–ù–û):

1. **voice-chat-service-go** (2926 —Å—Ç—Ä–æ–∫) - —Ä–∞–∑–±–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é + —Ä–∞–∑–¥–µ–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
2. **housing-service-go** (1869 —Å—Ç—Ä–æ–∫) - —Ä–∞–∑–¥–µ–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
3. **clan-war-service-go** (1724 —Å—Ç—Ä–æ–∫–∏) - —Ä–∞–∑–¥–µ–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è

### üü° –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢:

4. **companion-service-go** (1329 —Å—Ç—Ä–æ–∫)
5. **cosmetic-service-go** (1191 —Å—Ç—Ä–æ–∫–∞)
6. **referral-service-go** (1168 —Å—Ç—Ä–æ–∫)
7. **world-service-go** (1142 —Å—Ç—Ä–æ–∫–∏)

### üü¢ –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢:

8. **maintenance-service-go** (1000 —Å—Ç—Ä–æ–∫)
9. –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã —Å api.gen.go >500 —Å—Ç—Ä–æ–∫

---

## üéì –û–±—É—á–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:

1. **API Designer:**
   - OK –†–∞–∑–±–∏–≤–∞–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ >500 —Å—Ç—Ä–æ–∫ –Ω–∞ –º–æ–¥—É–ª–∏
   - OK –ò—Å–ø–æ–ª—å–∑—É–π `$ref` –¥–ª—è —Å–≤—è–∑–∏ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏
   - OK –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π `common.yaml` –¥–ª—è –æ–±—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - ‚ùå –ù–ï —Å–æ–∑–¥–∞–≤–∞–π –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ >500 —Å—Ç—Ä–æ–∫

2. **Backend Developer:**
   - OK –ò—Å–ø–æ–ª—å–∑—É–π —Ä–∞–∑–¥–µ–ª—å–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é (3 —Ñ–∞–π–ª–∞)
   - OK –ò—Å–ø–æ–ª—å–∑—É–π Chi —Ä–æ—É—Ç–µ—Ä –¥–ª—è –í–°–ï–• —Å–µ—Ä–≤–∏—Å–æ–≤ (`chi-server`)
   - OK –ú–∏–≥—Ä–∏—Ä—É–π Gorilla —Å–µ—Ä–≤–∏—Å—ã –Ω–∞ Chi (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)
   - OK –ü—Ä–æ–≤–µ—Ä—è–π —Ä–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤: `make check-file-sizes`
   - OK –£–¥–∞–ª—è–π —Å—Ç–∞—Ä—ã–π `api.gen.go` –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏
   - ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π —Å—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥ (1 —Ñ–∞–π–ª)
   - ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π Gorilla (–ó–ê–ü–†–ï–©–ï–ù!)

3. **–û–±–∞ –∞–≥–µ–Ω—Ç–∞:**
   - OK –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª –º–∞–∫—Å–∏–º—É–º 500 —Å—Ç—Ä–æ–∫
   - OK –°–æ–±–ª—é–¥–∞–π SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ã
   - OK –ò—Å–ø–æ–ª—å–∑—É–π —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
   - ‚ùå –ù–ï –∏–≥–Ω–æ—Ä–∏—Ä—É–π –ª–∏–º–∏—Ç —Ñ–∞–π–ª–æ–≤

---

## üìÅ –§–∞–π–ª—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è

### –®–∞–±–ª–æ–Ω—ã:
- `.cursor/CODE_GENERATION_TEMPLATE.md` - –ø–æ–ª–Ω—ã–π —à–∞–±–ª–æ–Ω —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏

### –ü—Ä–∞–≤–∏–ª–∞ –∞–≥–µ–Ω—Ç–æ–≤:
- `.cursor/rules/agent-api-designer.mdc` - –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è API Designer
- `.cursor/rules/agent-backend.mdc` - –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è Backend Developer

### –°–∫—Ä–∏–ø—Ç—ã:
- `scripts/migrate-to-split-generation.sh` - Linux/macOS
- `scripts/migrate-to-split-generation.ps1` - Windows
- `scripts/add-codegen-deps.sh` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- `scripts/validate-codegen.sh` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

---

## OK –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤

### API Designer:

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏:
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —Ä–∞–∑–º–µ—Ä —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
- [ ] –ï—Å–ª–∏ >500 —Å—Ç—Ä–æ–∫ ‚Üí —Ä–∞–∑–±–∏–ª –Ω–∞ –º–æ–¥—É–ª–∏
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `$ref` –¥–ª—è —Å–≤—è–∑–∏ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `common.yaml` –¥–ª—è –æ–±—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- [ ] –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞–ª: `redocly lint {service-name}.yaml`

### Backend Developer:

–ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞:
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ä–∞–∑–¥–µ–ª—å–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é (3 —Ñ–∞–π–ª–∞)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —Ä–∞–∑–º–µ—Ä—ã: `make check-file-sizes`
- [ ] –í—Å–µ —Ñ–∞–π–ª—ã <500 —Å—Ç—Ä–æ–∫
- [ ] –£–¥–∞–ª–∏–ª —Å—Ç–∞—Ä—ã–π `api.gen.go`
- [ ] –û–±–Ω–æ–≤–∏–ª `.gitignore`
- [ ] –ö–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –∏ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –î–ª—è –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:

1. **API Designer:** –°–æ–∑–¥–∞–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é (<500 —Å—Ç—Ä–æ–∫ –∏–ª–∏ —Ä–∞–∑–±–µ–π –Ω–∞ –º–æ–¥—É–ª–∏)
2. **Backend Developer:** –ò—Å–ø–æ–ª—å–∑—É–π —à–∞–±–ª–æ–Ω –∏–∑ `.cursor/CODE_GENERATION_TEMPLATE.md`
3. **Backend Developer:** `make generate-api` ‚Üí –ø—Ä–æ–≤–µ—Ä—å —Ä–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤
4. **Backend Developer:** –†–µ–∞–ª–∏–∑—É–π handlers

### –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:

1. **Backend Developer:** `.\scripts\migrate-to-split-generation.ps1 -ServiceName {service}`
2. **Backend Developer:** –ü—Ä–æ–≤–µ—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç: `make check-file-sizes`
3. **Backend Developer:** –£–¥–∞–ª–∏ —Å—Ç–∞—Ä—ã–π `api.gen.go`
4. **Backend Developer:** –ö–æ–º–º–∏—Ç —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `[backend]`

---

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ –≤—Å–µ—Ö api.gen.go
Get-ChildItem -Recurse -Filter "api.gen.go" | ForEach-Object { [PSCustomObject]@{File=$_.FullName; Lines=(Get-Content $_.FullName).Count} } | Sort-Object Lines -Descending

# –ú–∏–≥—Ä–∞—Ü–∏—è –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
.\scripts\migrate-to-split-generation.ps1 -ServiceName voice-chat-service

# –ú–∏–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
.\scripts\migrate-to-split-generation.ps1

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
cd services\{service-name}-go
make check-file-sizes

# –í–∞–ª–∏–¥–∞—Ü–∏—è OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
make verify-api
```

---

## üìû –ü–æ–º–æ—â—å

**–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:**

1. **–ü—Ä–æ–≤–µ—Ä—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   ```bash
   oapi-codegen version
   node --version
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É:**
   ```bash
   ls -la services/{service-name}-go/pkg/api/
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**
   ```bash
   make generate-api 2>&1 | tee generation.log
   ```

4. **–ò–∑—É—á–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:**
   - `.cursor/CODE_GENERATION_TEMPLATE.md`
   - `.cursor/rules/agent-backend.mdc`
   - `.cursor/rules/agent-api-designer.mdc`

---

## üéØ –ò—Ç–æ–≥

**–¶–µ–ª—å:** –°–æ–±–ª—é–¥–µ–Ω–∏–µ SOLID –∏ –ª–∏–º–∏—Ç–∞ 500 —Å—Ç—Ä–æ–∫ —á–µ—Ä–µ–∑ —Ä–∞–∑–¥–µ–ª—å–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–æ–¥–∞.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–∞–∂–¥—ã–π —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª <500 —Å—Ç—Ä–æ–∫, –ª—É—á—à–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞.

**–î–ª—è –∞–≥–µ–Ω—Ç–æ–≤:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ —Å —Ä–∞–∑–¥–µ–ª—å–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π!

