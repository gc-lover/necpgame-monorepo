# Руководство по коммитам для агентов

## Общие правила

### Формат коммитов

Каждый агент должен использовать префикс своего имени в каждом коммите:

```
[agent-name] краткое описание изменений
```

### Префиксы агентов

- `[idea-writer]` - Idea Writer агент
- `[architect]` - Architect агент
- `[api-designer]` - API Designer агент
- `[backend]` - Backend Developer агент
- `[network]` - Network Engineer агент
- `[devops]` - DevOps агент
- `[performance]` - Performance Engineer агент
- `[ue5]` - UE5 Developer агент
- `[content-writer]` - Content Writer агент
- `[qa]` - QA/Testing агент
- `[release]` - Release агент

### Типы коммитов

Используй стандартные типы коммитов:

- `feat:` - новая функциональность
- `fix:` - исправление бага
- `docs:` - документация
- `style:` - форматирование кода
- `refactor:` - рефакторинг
- `test:` - тесты
- `chore:` - рутинные задачи

### Формат полного коммита

```
[agent-name] type: краткое описание

Детальное описание изменений (опционально)

- Что было сделано
- Почему это важно
- Связанные Issue: #123
```

### Примеры коммитов

#### Idea Writer
```
[idea-writer] feat: добавить концепцию системы уведомлений

Создана детальная концепция системы уведомлений для игры:
- Визуальный дизайн уведомлений
- Типы уведомлений (квесты, сообщения, достижения)
- Система приоритетов
- Лор для системы в мире игры

Связанные Issue: #9
```

#### Backend Developer
```
[backend] feat: реализовать API для системы уведомлений

- Добавлен endpoint POST /api/v1/notifications
- Реализована бизнес-логика отправки уведомлений
- Добавлены тесты для всех endpoints
- Обновлена документация API

Связанные Issue: #9
```

#### UE5 Developer
```
[ue5] feat: добавить UI компонент для уведомлений

- Создан виджет UNotificationWidget
- Реализована анимация появления/исчезновения
- Добавлена поддержка разных типов уведомлений
- Интегрирован с системой приоритетов

Связанные Issue: #9
```

## Обязательные действия при коммите

### 1. Проверка перед коммитом

Перед коммитом убедись:
- [ ] Все файлы сохранены
- [ ] Код компилируется без ошибок
- [ ] Тесты проходят (если есть)
- [ ] Префикс агента указан правильно
- [ ] Описание коммита понятное

### 2. Добавление файлов

```bash
# Добавить все измененные файлы
git add .

# Или добавить конкретные файлы
git add path/to/file1 path/to/file2
```

### 3. Создание коммита

```bash
git commit -m "[agent-name] type: описание"
```

### 4. Отправка в remote

```bash
git push origin feature/issue-{number}-{description}
```

## Работа с Issue

### Связь коммита с Issue

Всегда указывай номер Issue в коммите или используй ключевые слова:

```
[backend] feat: реализовать API для уведомлений

Closes #9
```

Или:

```
[backend] feat: реализовать API для уведомлений

Связанные Issue: #9
```

### Автоматическое закрытие Issue

Используй ключевые слова для автоматического закрытия:
- `Closes #123` - закрывает Issue при мерже PR
- `Fixes #123` - закрывает Issue при мерже PR
- `Resolves #123` - закрывает Issue при мерже PR

## Частота коммитов

### Маленькие, логичные коммиты

Делай коммиты часто:
- После завершения логической части работы
- После исправления бага
- После добавления теста
- После обновления документации

### Не делай большие коммиты

Избегай:
- Коммитов с множеством несвязанных изменений
- Коммитов "все изменения за день"
- Коммитов без описания

## Работа в команде

### Синхронизация с remote

Перед началом работы:
```bash
git pull origin feature/issue-{number}-{description}
```

После коммита:
```bash
git push origin feature/issue-{number}-{description}
```

### Конфликты

Если возникли конфликты:
1. Не паникуй
2. Прочитай сообщение об ошибке
3. Разреши конфликты вручную
4. Закоммить разрешение конфликта:
   ```
   [agent-name] fix: разрешить конфликты с develop
   ```

## Специфичные правила по агентам

### Idea Writer
- Коммити файлы в `knowledge/` после создания концепций
- Обновляй Issue после каждого коммита
- Используй `docs:` для документации

### Architect
- Коммити архитектурные диаграммы и схемы
- Обновляй документацию в `knowledge/implementation/`
- Используй `docs:` для документации

### API Designer
- Коммити OpenAPI спецификации
- Обновляй файлы в `knowledge/implementation/api-specs/`
- Используй `docs:` для спецификаций

### Backend Developer
- Коммити Go код в `services/`
- Коммити тесты вместе с кодом
- Используй `feat:` для новой функциональности, `fix:` для багов

### Network Engineer
- Коммити конфигурации Envoy в `infrastructure/envoy/`
- Обновляй Protocol Buffers в `proto/`
- Используй `feat:` для новых протоколов, `fix:` для исправлений

### DevOps
- Коммити Dockerfile, Kubernetes манифесты
- Обновляй файлы в `infrastructure/` и `k8s/`
- Используй `chore:` для инфраструктурных изменений

### Performance Engineer
- Коммити результаты профилирования
- Обновляй документацию по оптимизации
- Используй `perf:` для оптимизаций

### UE5 Developer
- Коммити C++ код в `client/UE5/`
- Коммити Blueprint изменения (если нужно)
- Используй `feat:` для новой функциональности

### Content Writer
- Коммити YAML файлы квестов в `knowledge/canon/lore/timeline-author/quests/`
- Коммити лор и диалоги
- Используй `feat:` для новых квестов, `fix:` для исправлений, `docs:` для документации

### QA
- Коммити тестовые сценарии
- Обновляй баг-репорты
- Используй `test:` для тестов

### Release
- Коммити release notes
- Обновляй версии
- Используй `chore:` для релизных задач

## Автоматическая проверка

GitHub Actions автоматически проверяет:
- Наличие префикса агента в коммитах
- Формат коммитов
- Связь с Issues

Если коммит не соответствует правилам, CI может заблокировать PR.

## Примеры плохих коммитов

❌ `update files` - нет префикса, нет типа
❌ `[backend] fix` - нет описания
❌ `[backend] feat: много изменений` - слишком общее описание
❌ `fix bug` - нет префикса агента

## Примеры хороших коммитов

✅ `[backend] feat: добавить endpoint для создания уведомлений`
✅ `[ue5] fix: исправить утечку памяти в UNotificationWidget`
✅ `[idea-writer] docs: добавить концепцию системы уведомлений`
✅ `[qa] test: добавить тесты для системы уведомлений`

