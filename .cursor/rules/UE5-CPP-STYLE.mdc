---
description: "Стиль кода для UE5/C++ - соглашения и лучшие практики"
alwaysApply: true
globs: ["**/*.cpp", "**/*.h"]
priority: 2
tags: ["ue5", "cpp", "style", "coding-standards"]
---

# UE5/C++ Стиль кода

## Общие правила

### Именование
- Классы: `U` префикс для UObject, `A` для Actor, `I` для интерфейсов
- Функции: PascalCase для публичных, camelCase для приватных
- Переменные: camelCase
- Константы: UPPER_SNAKE_CASE

### Размер классов
- Максимум 300-400 строк на класс
- Если больше - разделить на несколько классов

### Комментарии
- Не использовать комментарии в коде (кроме критических мест)
- Не использовать TODO в коде
- Код должен быть самодокументируемым

### Зависимости
- Зависить от интерфейсов, а не от конкретных классов
- Использовать dependency injection через UPROPERTY

## Структура файлов

### Header файлы
- `#pragma once` в начале
- Includes в порядке: CoreMinimal, Engine, Project
- GENERATED_BODY() для UCLASS

### Implementation файлы
- Includes в порядке: Header, Engine, Project
- Реализация методов в логическом порядке

## UE5 специфичные правила

### UObject/UCLASS
- Всегда использовать `GENERATED_BODY()`
- UPROPERTY для переменных, которые должны реплицироваться или быть видимыми в Blueprint
- UFUNCTION для функций, доступных из Blueprint

### Потокобезопасность
- Использовать `FCriticalSection` для защиты данных
- Копировать данные перед обработкой вне блокировки

### Память
- Использовать `NewObject<>()` для создания UObject
- Не использовать `new` для UObject
- Использовать умные указатели для не-UObject

## Примеры

### Хорошо
```cpp
UCLASS()
class LYRAGAME_API UPlayerIdResolver : public UObject
{
    GENERATED_BODY()

public:
    FString GetPlayerIdFromController(APlayerController* Controller) const;
};
```

### Плохо
```cpp
class PlayerIdResolver {
    // Нет префикса U
    // Нет GENERATED_BODY()
    string getPlayerId(PlayerController* controller); // Неправильное именование
};
```
