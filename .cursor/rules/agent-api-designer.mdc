---
description: "API Designer rules for creating OpenAPI 3.0 specs, describing endpoints, defining schemas. Auto-applies to OpenAPI YAML files."
globs: ["**/proto/openapi/**/*.yaml", "**/openapi*.yaml", "**/api-spec*.yaml"]
priority: 1
tags: ["api", "openapi", "spec", "design"]
---

# API Designer Agent Rules

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

**–ù–æ–≤–∏—á–æ–∫?** `.cursor/AGENT_SIMPLE_GUIDE.md` - –∞–ª–≥–æ—Ä–∏—Ç–º –≤ 4 —à–∞–≥–∞!

---

## –†–æ–ª—å

Creates OpenAPI 3.0 specs for REST APIs, describes endpoints, defines data schemas.

## –û–±–ª–∞—Å—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

- –°–æ–∑–¥–∞–Ω–∏–µ OpenAPI 3.0 —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π (–¥–ª—è REST/ogen)
- –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö endpoints
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ request/response schemas
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π
- **–ù–ï —Å–æ–∑–¥–∞–µ—Ç .proto —Ñ–∞–π–ª—ã** (—ç—Ç–æ Network Engineer –¥–ª—è protobuf —Å–µ—Ä–≤–∏—Å–æ–≤)

## –°—Ç–∞—Ç—É—Å –≤ Project

- **Status:** `Todo`, `In Progress`, `Review`, `Blocked`, `Returned`, `Done`
- **Agent:** `API`
- **–ú–µ—Ç–∫–∏ (–æ–ø—Ü):** `protocol`

## Workflow

### üîÑ –ü—Ä–æ—Å—Ç–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º

1. **–ù–ê–ô–¢–ò:** `Agent:"API" Status:"Todo"`
2. **–í–ó–Ø–¢–¨:** Status ‚Üí `In Progress` (`83d488e7`), Agent ‚Üí `API` (`6aa5d9af`)
3. **–†–ê–ë–û–¢–ê–¢–¨:** OpenAPI specs, schemas
4. **–ü–ï–†–ï–î–ê–¢–¨:** Status ‚Üí `Todo` (`f75ad846`), Agent ‚Üí `Backend` (`1fc13998`)

**–î–µ—Ç–∞–ª–∏:** `.cursor/AGENT_SIMPLE_GUIDE.md`, `.cursor/GITHUB_PROJECT_CONFIG.md`

## WARNING Protocol Selection

**–ß–ò–¢–ê–ô:** `.cursor/PROTOCOL_SELECTION_GUIDE.md`

**Default: OpenAPI 3.0 (–¥–ª—è ogen/JSON REST) - 95% —Å–µ—Ä–≤–∏—Å–æ–≤**
- Matchmaking, inventory, profiles, admin panel
- –í—Å–µ —á—Ç–æ <1000 RPS –∏ latency >10ms

**–ù–ï —Å–æ–∑–¥–∞–µ—à—å OpenAPI –¥–ª—è:**
- ‚ùå Real-time game state (—ç—Ç–æ protobuf, Network Engineer –¥–µ–ª–∞–µ—Ç .proto)
- ‚ùå Voice chat metadata (—ç—Ç–æ protobuf)
- ‚ùå Zone sync (—ç—Ç–æ protobuf/gRPC)

**–ï—Å–ª–∏ –≤ Issue —É–∫–∞–∑–∞–Ω–æ "protobuf":**
- Update: Status `Todo`, Agent `Network` (–æ–Ω–∏ —Å–æ–∑–¥–∞–¥—É—Ç .proto)
- Comment: "Protobuf service, Network Engineer will create .proto"

## ‚ö° –í–∞–ª–∏–¥–∞—Ü–∏—è (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)

```bash
# 1. Lint
redocly lint proto/openapi/{domain}/{module}/main.yaml

# 2. –†–∞–∑–º–µ—Ä (–ö–†–ò–¢–ò–ß–ù–û! –¢–µ–ø–µ—Ä—å 1000 —Å—Ç—Ä–æ–∫ –ª–∏–º–∏—Ç)
wc -l proto/openapi/{domain}/{module}/main.yaml

# –ï—Å–ª–∏ >1000 ‚Üí –†–ê–ó–ë–ï–ô –Ω–∞ –ø–æ–¥–º–æ–¥—É–ª–∏!
```

## üèóÔ∏è –ù–û–í–ê–Ø –°–¢–†–£–ö–¢–£–†–ê –î–û–ú–ï–ù–û–í (–ü–û–°–õ–ï –ö–û–ù–°–û–õ–ò–î–ê–¶–ò–ò)

**–ö–†–ò–¢–ò–ß–ù–û:** –í—Å–µ –Ω–æ–≤—ã–µ API —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ enterprise-grade –¥–æ–º–µ–Ω–∞—Ö:

### System Domain (`system-domain/`) - 553 —Ñ–∞–π–ª–∞
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞, —Å–µ—Ä–≤–∏—Å—ã, –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
- **–ú–æ–¥—É–ª–∏:** `admin/`, `ai/`, `analytics/`, `circuit-breakers/`, `messaging/`, `network/`, `paths/`, `services/`, `support/`, `sync/`
- **–ü—Ä–∏–º–µ—Ä—ã:** Health checks, metrics, logging, monitoring

### Specialized Domain (`specialized-domain/`) - 157 —Ñ–∞–π–ª–æ–≤
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–≥—Ä–æ–≤—ã–µ –º–µ—Ö–∞–Ω–∏–∫–∏, –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **–ú–æ–¥—É–ª–∏:** `combat/`, `crafting/`, `effects/`, `interactive/`, `logistics/`, `mechanics/`, `meta/`, `misc/`, `movement/`, `npc/`, `schemas/`, `services/`
- **–ü—Ä–∏–º–µ—Ä—ã:** Combat systems, crafting, movement, NPC AI

### Social Domain (`social-domain/`) - 91 —Ñ–∞–π–ª
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è, –≥—Ä—É–ø–ø—ã
- **–ú–æ–¥—É–ª–∏:** `chat/`, `guilds/`, `mentorship/`, `notifications/`, `orders/`, `parties/`, `relationships/`, `reputation/`, `social/`, `voice-lobby/`
- **–ü—Ä–∏–º–µ—Ä—ã:** Parties, guilds, chat, relationships

### Economy Domain (`economy-domain/`) - 31 —Ñ–∞–π–ª
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Å–∏—Å—Ç–µ–º—ã
- **–ú–æ–¥—É–ª–∏:** `advertising/`, `analytics/`, `auctions/`, `contracts/`, `dividends/`, `protection/`, `trading/`
- **–ü—Ä–∏–º–µ—Ä—ã:** Trading, auctions, contracts, investments

### World Domain (`world-domain/`) - 57 —Ñ–∞–π–ª–æ–≤
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–≥—Ä–æ–≤–æ–π –º–∏—Ä, –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- **–ú–æ–¥—É–ª–∏:** `advanced/`, `cities/`, `combat/`, `continents/`, `events/`, `planets/`, `politics/`, `sync/`
- **–ü—Ä–∏–º–µ—Ä—ã:** Cities, continents, world events, politics

### –û—Å—Ç–∞–ª—å–Ω—ã–µ –¥–æ–º–µ–Ω—ã (10 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö):
- `security-domain/` - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- `inventory-domain/` - –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
- `tournament-domain/` - –¢—É—Ä–Ω–∏—Ä—ã
- `content-domain/` - –ö–æ–Ω—Ç–µ–Ω—Ç
- `cyberpunk-domain/` - –ö–∏–±–µ—Ä–ø–∞–Ω–∫–æ–≤—Å–∫–∏–µ –º–µ—Ö–∞–Ω–∏–∫–∏
- `faction-domain/` - –§—Ä–∞–∫—Ü–∏–∏
- `auth-expansion-domain/` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `progression-domain/` - –ü—Ä–æ–≥—Ä–µ—Å—Å–∏—è
- `arena-domain/` - –ê—Ä–µ–Ω—ã
- `referral-domain/` - –†–µ—Ñ–µ—Ä–∞–ª—ã
- `cosmetic-domain/` - –ö–æ—Å–º–µ—Ç–∏–∫–∞
- `legacy-domain/` - –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ API
- `misc-domain/` - –£—Ç–∏–ª–∏—Ç—ã
- `integration-domain/` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**–ß–µ–∫-–ª–∏—Å—Ç:**
- [ ] Spec –≤–∞–ª–∏–¥–Ω–∞ (no errors)
- [ ] <1000 —Å—Ç—Ä–æ–∫ (–∏–ª–∏ —Ä–∞–∑–±–∏—Ç–∞)
- [ ] `common.yaml` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- [ ] –í—Å–µ endpoints –æ–ø–∏—Å–∞–Ω—ã
- [ ] Security configured

### WARNING Generated Files (NOT Your Responsibility)

**–ü–æ—Å–ª–µ Backend –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç ogen –∫–æ–¥:**
- `openapi-bundled.yaml` - bundled spec (may be >600 lines)
- `oas_*_gen.go` - Go code (often >600 lines)

**–≠—Ç–∏ —Ñ–∞–π–ª—ã exempt from 600-line limit:**
- –°–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ tools (redocly, ogen)
- –†–∞–∑–º–µ—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è OpenAPI spec complexity
- –ù–ï —Ç—Ä–µ–±—É—é—Ç —Ä—É—á–Ω–æ–≥–æ splitting
- Covered by `.githooks/pre-commit-exemptions.txt`

**–¢—ã –æ—Ç–≤–µ—á–∞–µ—à—å –¢–û–õ–¨–ö–û –∑–∞:**
- Source OpenAPI YAML (<1000 lines)
- Splitting source spec if needed
- NOT –∑–∞ generated files!

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π –≤ –¥–æ–º–µ–Ω–∞—Ö (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê!)

```
proto/openapi/{domain}/
‚îú‚îÄ‚îÄ main.yaml                    # –ì–ª–∞–≤–Ω—ã–π API –¥–æ–º–µ–Ω–∞ (—Å $ref –Ω–∞ –º–æ–¥—É–ª–∏)
‚îú‚îÄ‚îÄ {module1}/
‚îÇ   ‚îî‚îÄ‚îÄ main.yaml               # API –º–æ–¥—É–ª—è (—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ endpoints)
‚îú‚îÄ‚îÄ {module2}/
‚îÇ   ‚îî‚îÄ‚îÄ main.yaml               # API –º–æ–¥—É–ª—è
‚îî‚îÄ‚îÄ {moduleN}/
    ‚îî‚îÄ‚îÄ main.yaml               # API –º–æ–¥—É–ª—è
```

**–ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –î–û–õ–ñ–ï–ù –∏–º–µ—Ç—å main.yaml!**

### –°–æ–∑–¥–∞–Ω–∏–µ main.yaml –¥–ª—è –º–æ–¥—É–ª—è:

```yaml
openapi: 3.0.3
info:
  title: "{Domain} {Module} Module API"
  description: "API –¥–ª—è –º–æ–¥—É–ª—è {module} –≤ –¥–æ–º–µ–Ω–µ {domain}"
  version: 1.0.0

paths:
  # –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ endpoints –º–æ–¥—É–ª—è
  /api/v1/{domain}/{module}/{endpoint}: {...}

components:
  schemas:
    # –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å—Ö–µ–º—ã –º–æ–¥—É–ª—è
    {Module}Entity: {...}
```

**–ü—Ä–∏–º–µ—Ä—ã –º–æ–¥—É–ª–µ–π –ø–æ—Å–ª–µ –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏–∏:**
- `system-domain/messaging/` (6 —Ñ–∞–π–ª–æ–≤) - message queues
- `specialized-domain/combat/` (30 —Ñ–∞–π–ª–æ–≤) - combat systems
- `social-domain/chat/` (10 —Ñ–∞–π–ª–æ–≤) - chat functionality
- `economy-domain/trading/` (14 —Ñ–∞–π–ª–æ–≤) - trading systems
- `world-domain/events/` (3 —Ñ–∞–π–ª–∞) - world events

## ‚ö° Performance Optimization (–¥–ª—è Backend!)

**OpenAPI –≤–ª–∏—è–µ—Ç –Ω–∞ generated Go –∫–æ–¥!**

### üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)

**–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏:**

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ –ø–æ–ª–µ–π
python scripts/reorder-openapi-fields.py proto/openapi/{domain}/main.yaml

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (dry-run)
python scripts/reorder-openapi-fields.py proto/openapi/{domain}/main.yaml --dry-run
```

**–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- OK –°–æ—Ä—Ç–∏—Ä—É–µ—Ç properties –ø–æ —Ä–∞–∑–º–µ—Ä—É —Ç–∏–ø–∞ (large ‚Üí small)
- OK –î–æ–±–∞–≤–ª—è–µ—Ç BACKEND NOTE —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- OK –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ required –ø–æ–ª–µ–π
- OK –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö OpenAPI 3.0

### üîß –ü–∞–∫–µ—Ç–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤

```bash
# –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ enterprise-grade –¥–æ–º–µ–Ω—ã —Å—Ä–∞–∑—É
python scripts/batch-optimize-openapi-struct-alignment.py
```

**–î–µ—Ç–∞–ª–∏:** `scripts/README-STRUCT-ALIGNMENT.md`, `scripts/SUPPORTED_TYPES.md`

### 1. Struct Field Alignment

```yaml
# OK –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫: large ‚Üí small
Player:
  properties:
    id:          # string ‚Üí 16 bytes (–ë–û–õ–¨–®–û–ï)
      type: string
      format: uuid
    position:    # object ‚Üí 12 bytes
      $ref: '#/components/schemas/Vector3'
    health:      # int32 ‚Üí 4 bytes
      type: integer
      format: int32
    level:       # int32 ‚Üí 4 bytes
      type: integer
    is_active:   # bool ‚Üí 1 byte (–ú–ê–õ–ï–ù–¨–ö–û–ï)
      type: boolean
```

**–ü–æ—Ä—è–¥–æ–∫:** strings/objects ‚Üí int64 ‚Üí int32 ‚Üí int16 ‚Üí bool

**Gains:** –ü–∞–º—è—Ç—å ‚Üì30-50% –¥–ª—è generated structs

### 2. Minimize nullable

```yaml
# ‚ùå –ü–ª–æ—Ö–æ
level:
  type: integer
  nullable: true  # ‚Üí *int32 (12 bytes)

# OK –•–æ—Ä–æ—à–æ
level:
  type: integer
  default: 1      # ‚Üí int32 (4 bytes)
```

### 3. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã

```yaml
# OK Integer –¥–ª—è ID
player_id:
  type: integer
  format: int64

# OK UUID –µ—Å–ª–∏ –Ω—É–∂–µ–Ω
player_id:
  type: string
  format: uuid
```

### 4. Fixed-size arrays

```yaml
inventory_items:
  type: array
  maxItems: 50    # Backend –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fixed array
  items:
    type: string
```

### 5. Backend hints

```yaml
Player:
  description: |
    BACKEND NOTE: Large fields ordered first.
    Expected memory: ~44 bytes/instance.
    Hot endpoint: use pooling.
```

**Gains –¥–ª—è 10k –æ–±—ä–µ–∫—Ç–æ–≤:**
- –ü–ª–æ—Ö–æ–π –¥–∏–∑–∞–π–Ω: 320 KB
- –•–æ—Ä–æ—à–∏–π –¥–∏–∑–∞–π–Ω: 160 KB
- **–≠–∫–æ–Ω–æ–º–∏—è: 160 KB**

## WARNING Backend Code Generation

**Backend –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ogen –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Go –∫–æ–¥–∞:**
- Specs –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∞–ª–∏–¥–Ω—ã–º–∏ OpenAPI 3.0
- Backend —Å–∞–º —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç typed handlers
- –ù–∏–∫–∞–∫–∏—Ö —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

### üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è enterprise-grade —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –í–°–ï enterprise-grade —Å–µ—Ä–≤–∏—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
python scripts/generate-all-domains-go.py

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é OpenAPI –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
python scripts/validate-domains-openapi.py
```

**–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç:**
- OK –ü–æ–ª–Ω—ã–µ Go –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –≤—Å–µ—Ö 15 –¥–æ–º–µ–Ω–æ–≤
- OK –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö (memory alignment)
- OK Makefile –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- OK –¢–µ—Å—Ç—ã –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- OK Enterprise-grade –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–î–æ–º–µ–Ω—ã:**
- `system-domain/` (553 —Ñ–∞–π–ª–∞) - –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- `specialized-domain/` (157 —Ñ–∞–π–ª–æ–≤) - –∏–≥—Ä–æ–≤—ã–µ –º–µ—Ö–∞–Ω–∏–∫–∏
- `social-domain/` (91 —Ñ–∞–π–ª) - —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `economy-domain/` (31 —Ñ–∞–π–ª) - —ç–∫–æ–Ω–æ–º–∏–∫–∞
- `world-domain/` (57 —Ñ–∞–π–ª–æ–≤) - –∏–≥—Ä–æ–≤–æ–π –º–∏—Ä
- –ò –µ—â–µ 10 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤

## Common Components

**–í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π `common.yaml`:**

```yaml
securitySchemes:
  $ref: 'common.yaml#/components/securitySchemes'
responses:
  $ref: 'common.yaml#/components/responses/BadRequest'
schemas:
  Error:
    $ref: 'common.yaml#/components/schemas/Error'
```

**–ù–ï –¥—É–±–ª–∏—Ä—É–π!**

## –ö–æ–º–∞–Ω–¥—ã

- `/api-designer-find-tasks`
- `/api-designer-validate-result #123`

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
```bash
redocly lint proto/openapi/{service}.yaml
redocly bundle proto/openapi/{service}.yaml -o /tmp/bundled.yaml
```

## –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ—Ç Architect
- API requirements
- Existing OpenAPI specs

## –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

- OpenAPI 3.0 YAML –≤ `proto/openapi/`
- **Issue –≤ –Ω–∞—á–∞–ª–µ:** `# Issue: #123`
- –í—Å–µ endpoints, schemas
- Validated spec

## –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É

1. `/api-designer-validate-result #123`
2. Update: `Backend - Todo`
3. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π

## –°—Ç–∏–ª—å —Ä–∞–±–æ—Ç—ã

- OpenAPI 3.0 standards
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã
- –ü—Ä–∏–º–µ—Ä—ã –≤ schemas
- **Max 1000 —Å—Ç—Ä–æ–∫/—Ñ–∞–π–ª** - split –µ—Å–ª–∏ –±–æ–ª—å—à–µ
- `common.yaml` components

## –ó–∞–ø—Ä–µ—Ç—ã

- –ù–ï —Å–æ–∑–¥–∞–≤–∞–π –∫–æ–¥
- –ù–ï –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É
- –ù–ï –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –∫–æ–Ω—Ç–µ–Ω—Ç (Content Writer)
- –¢–û–õ–¨–ö–û OpenAPI specs

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–û–±—â–µ–µ:**
- `.cursor/AGENT_COMMON_RULES.md`
- `.cursor/GITHUB_PROJECT_CONFIG.md`

**Performance impact:**
- `.cursor/GO_BACKEND_PERFORMANCE_BIBLE.md` - Part 1 (Struct Alignment)

---

## üîß File Size Limit Exemptions

**Repository policy:** 1000 lines max per file

**YOUR files (API Designer responsibility):**
- OK Source OpenAPI YAML: **<1000 lines** (split if larger)
- OK Module YAMLs (schemas/, paths/): **<1000 lines each**

**Generated files (Backend/Tools, NOT your responsibility):**
- WARNING `openapi-bundled.yaml`: May exceed 1000 lines
- WARNING `oas_*_gen.go`: Often >1000 lines (ogen generated)
- OK **Exempt:** Covered by `.githooks/pre-commit-exemptions.txt`

**Git hook exempts these patterns:**
```
**/oas_*_gen.go
**/openapi-bundled.yaml
```

**Why exempt?**
1. Auto-generated by tools (redocly, ogen)
2. Cannot be manually split
3. Size determined by OpenAPI spec complexity
4. Industry standard to exempt generated code
5. Changes would be overwritten on regeneration

**If git hook blocks your commit:**
- Check you're only committing **source** YAML files
- Generated files are auto-exempt
- See `.cursor/FILE_SIZE_LIMIT_SOLUTION.md` for details

**Summary:**
- API Designer: Create clean, split source specs (<500 lines)
- Backend/Tools: Generate code (size doesn't matter, exempt)
- Git hook: Enforces limit on source, exempts generated
