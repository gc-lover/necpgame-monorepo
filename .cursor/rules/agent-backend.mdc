---
alwaysApply: true
---

# Backend Developer Agent Rules

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

**–ù–æ–≤–∏—á–æ–∫?** –ß–∏—Ç–∞–π `.cursor/AGENT_SIMPLE_GUIDE.md` - —Ç–∞–º –ø—Ä–æ—Å—Ç–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã –≤ 4 —à–∞–≥–∞!

---

## ‚ö° –ë—ã—Å—Ç—Ä–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –∏ –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

### –ü–ï–†–ï–î –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
redocly lint proto/openapi/{service-name}.yaml

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–ö–†–ò–¢–ò–ß–ù–û!)
wc -l proto/openapi/{service-name}.yaml

# –ï—Å–ª–∏ >500 —Å—Ç—Ä–æ–∫ –∏ –ù–ï —Ä–∞–∑–±–∏—Ç–∞ –Ω–∞ –º–æ–¥—É–ª–∏ - –°–¢–û–ü!
# –í–µ—Ä–Ω–∏ –∑–∞–¥–∞—á—É API Designer: Update Status to 'API Designer - Returned'
```

**–ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º:**
- [ ] OpenAPI spec —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –≤–∞–ª–∏–¥–µ–Ω
- [ ] –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è <500 —Å—Ç—Ä–æ–∫ (–∏–ª–∏ —Ä–∞–∑–±–∏—Ç–∞ –Ω–∞ –º–æ–¥—É–ª–∏)
- [ ] –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞ (–µ—Å–ª–∏ —Å–∏—Å—Ç–µ–º–Ω–∞—è –∑–∞–¥–∞—á–∞)

**–ï—Å–ª–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è >500 —Å—Ç—Ä–æ–∫:** –í–µ—Ä–Ω–∏ –∑–∞–¥–∞—á—É API Designer!

### –ü–û–°–õ–ï –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞:

```bash
cd services/{service-name}-go

# –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –†–∞–∑–º–µ—Ä—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
make check-file-sizes

# –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:
# OK pkg/api/types.gen.go: 350 lines (OK)
# OK pkg/api/server.gen.go: 280 lines (OK)
# OK pkg/api/spec.gen.go: 120 lines (OK)

# –ï—Å–ª–∏ WARNING WARNING - —Ñ–∞–π–ª >500 —Å—Ç—Ä–æ–∫!
# –î–µ–π—Å—Ç–≤–∏–µ: –í–µ—Ä–Ω–∏ –∑–∞–¥–∞—á—É API Designer –¥–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
```

**–ß–µ–∫-–ª–∏—Å—Ç –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**
- [ ] 3 —Ñ–∞–π–ª–∞ —Å–æ–∑–¥–∞–Ω—ã (types.gen.go, server.gen.go, spec.gen.go)
- [ ] –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª <500 —Å—Ç—Ä–æ–∫
- [ ] –ö–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è: `go build ./...`
- [ ] –°—Ç–∞—Ä—ã–π api.gen.go —É–¥–∞–ª–µ–Ω (–µ—Å–ª–∏ –±—ã–ª)

**–ï—Å–ª–∏ —Ñ–∞–π–ª—ã >500 —Å—Ç—Ä–æ–∫:** –í–µ—Ä–Ω–∏ –∑–∞–¥–∞—á—É API Designer!

---

## –†–æ–ª—å –∞–≥–µ–Ω—Ç–∞

Backend Developer —Ä–µ–∞–ª–∏–∑—É–µ—Ç –±–µ–∫–µ–Ω–¥ –Ω–∞ Go –ø–æ OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Å–æ–∑–¥–∞–µ—Ç –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É.

## WARNING –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Chi —Ä–æ—É—Ç–µ—Ä

**Chi - –ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô —Ä–æ—É—Ç–µ—Ä –¥–ª—è –í–°–ï–• —Å–µ—Ä–≤–∏—Å–æ–≤!**

### OK –î–ª—è –ù–û–í–´–• —Å–µ—Ä–≤–∏—Å–æ–≤:
- `ROUTER_TYPE := chi-server` –≤ Makefile
- `github.com/go-chi/chi/v5` –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
- Chi - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π, –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π, –±—ã—Å—Ç—Ä—ã–π —Ä–æ—É—Ç–µ—Ä

### üîÑ –î–ª—è –°–£–©–ï–°–¢–í–£–Æ–©–ò–• —Å–µ—Ä–≤–∏—Å–æ–≤ —Å Gorilla:
- **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –º–∏–≥—Ä–∏—Ä—É–π –Ω–∞ Chi!**
- Gorilla ‚Üí Chi –º–∏–≥—Ä–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –°–ª–µ–¥—É–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ (—Å–º. —Å–µ–∫—Ü–∏—é "–ú–∏–≥—Ä–∞—Ü–∏—è —Å Gorilla –Ω–∞ Chi" –Ω–∏–∂–µ)
- –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —É–¥–∞–ª–∏ –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã `github.com/gorilla/mux`

### ‚ùå Gorilla –ó–ê–ü–†–ï–©–ï–ù:
- Gorilla deprecated –∏ –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ
- –í—Å–µ –Ω–æ–≤—ã–µ –∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã –î–û–õ–ñ–ù–´ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Chi
- –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ Gorilla ‚Üí –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Chi

## –û–±–ª–∞—Å—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –∏–∑ OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π —á–µ—Ä–µ–∑ oapi-codegen
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Go —Å–µ—Ä–≤–∏—Å–æ–≤ –ø–æ OpenAPI
- –°–æ–∑–¥–∞–Ω–∏–µ handlers –¥–ª—è endpoints (—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- –ù–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

## –°—Ç–∞—Ç—É—Å –≤ Project

- **–°—Ç–∞—Ç—É—Å—ã:** `Backend - Todo`, `Backend - In Progress`, `Backend - Blocked`, `Backend - Review`, `Backend - Returned`
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –º–µ—Ç–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):** `backend`, `protocol`, `infrastructure`

## Workflow with Issues

### üìã –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

**`Backend - Todo`** = –ó–∞–¥–∞—á–∞ –î–õ–Ø –¢–ï–ë–Ø (Backend –∞–≥–µ–Ω—Ç–∞). –¢—ã –¥–æ–ª–∂–µ–Ω –µ—ë –≤–∑—è—Ç—å!

### üîÑ –ü—Ä–æ—Å—Ç–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º

1. **–ù–ê–ô–¢–ò –∑–∞–¥–∞—á—É:** `Status:"Backend - Todo"` (—ç—Ç–æ –∑–∞–¥–∞—á–∏ –¥–ª—è —Ç–µ–±—è)
2. **–í–ó–Ø–¢–¨ –∑–∞–¥–∞—á—É:** –°–†–ê–ó–£ –æ–±–Ω–æ–≤–∏ —Å—Ç–∞—Ç—É—Å –Ω–∞ `Backend - In Progress`
3. **–†–ê–ë–û–¢–ê–¢–¨:** –°–æ–∑–¥–∞–≤–∞–π –∫–æ–¥, —Ç–µ—Å—Ç—ã, –∫–æ–º–º–∏—Ç—ã
4. **–ü–ï–†–ï–î–ê–¢–¨:** –û–±–Ω–æ–≤–∏ —Å—Ç–∞—Ç—É—Å –Ω–∞ `Network - Todo` (—Å–∏—Å—Ç–µ–º–Ω—ã–µ) –∏–ª–∏ `QA - Todo` (–∫–æ–Ω—Ç–µ–Ω—Ç-–∫–≤–µ—Å—Ç—ã)

### üìç ID —Å—Ç–∞—Ç—É—Å–æ–≤

**–í—Å–µ ID –≤ `.cursor/GITHUB_PROJECT_CONFIG.md`:**
- `Backend - In Progress`: `7bc9d20f`
- `Network - Todo`: `944246f3`
- `QA - Todo`: `86ca422e`
- `API Designer - Returned`: `d0352ed3`

**–ü—Ä–∏–º–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞:** –°–º. `.cursor/AGENT_SIMPLE_GUIDE.md`

## –û–±—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞

–°–º. `.cursor/AGENT_COMMON_RULES.md` –¥–ª—è:
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è GitHub API
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∫–∞–º–∏
- Git –∫–æ–º–º–∏—Ç—ã
- –®–∞–±–ª–æ–Ω—ã –≤–æ–∑–≤—Ä–∞—Ç–∞ –∑–∞–¥–∞—á
- –õ–∏–º–∏—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤ (max 500 —Å—Ç—Ä–æ–∫)

## –ö–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–µ –∫–≤–µ—Å—Ç—ã

**–ï—Å–ª–∏ Issue –∏–º–µ–µ—Ç –º–µ—Ç–∫–∏ `canon`, `lore`, `quest`:**

**–ò–º–ø–æ—Ä—Ç –≤ –ë–î (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û):**
1. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π YAML —á–µ—Ä–µ–∑ `POST /api/v1/gameplay/quests/content/reload` –≤ `quest_definitions`
2. –ü—Ä–æ–≤–µ—Ä—å –∏–º–ø–æ—Ä—Ç (–∑–∞–≥—Ä—É–∂–µ–Ω, –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã, –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ API)
3. –ü–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ Update Status to `QA - Todo`

**–í–∞–∂–Ω–æ:** –ë–µ–∑ –∏–º–ø–æ—Ä—Ç–∞ –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –ø–æ–ø–∞–¥–µ—Ç –≤ –∏–≥—Ä—É

## –ö–æ–º–∞–Ω–¥—ã Cursor

**–ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–∞–Ω–¥—ã –≤–º–µ—Å—Ç–æ —Ä—É—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:**
- `/backend-find-tasks` - –Ω–∞–π—Ç–∏ –∑–∞–¥–∞—á–∏
- `/backend-return-task #123` - –≤–µ—Ä–Ω—É—Ç—å –∑–∞–¥–∞—á—É
- `/backend-validate-result #123` - –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- `/backend-validate-optimizations #123` - **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π!**
- `/backend-check-openapi #123` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å OpenAPI
- `/backend-check-architecture #123` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
- `/backend-import-quest-to-db #123` - –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–≤–µ—Å—Ç –≤ –ë–î

**–î–µ—Ç–∞–ª–∏:** `.cursor/commands/backend-*.md`

**WARNING –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:** –ó–∞–ø—É—Å–∫–∞–π `/backend-validate-optimizations #123` –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π –∑–∞–¥–∞—á–∏ Network/QA!

### üîÑ –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–ü—Ä–æ–≤–µ—Ä–∫–∞ OpenAPI –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º:**
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–∞–Ω–¥—É
/backend-check-openapi #123

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
redocly lint proto/openapi/{service-name}.yaml
wc -l proto/openapi/{service-name}.yaml  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å <500 –∏–ª–∏ —Ä–∞–∑–±–∏—Ç–æ
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–∞–Ω–¥—É
/backend-validate-result #123

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
cd services/{service-name}-go
make check-file-sizes  # –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!
go build ./...
go test ./...
```

**–í–æ–∑–≤—Ä–∞—Ç –∑–∞–¥–∞—á–∏ –µ—Å–ª–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è >500 —Å—Ç—Ä–æ–∫:**
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–∞–Ω–¥—É
/backend-return-task #123

# –ü—Ä–∏—á–∏–Ω–∞: "OpenAPI spec too large (XXX lines, not split into modules)"
# Update Status to: API Designer - Returned
```

## –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

- OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Ç API Designer (`proto/openapi/`)
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ—Ç Architect
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ Go —Å–µ—Ä–≤–∏—Å—ã
- oapi-codegen —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

## WARNING –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û: –ü—Ä–æ–≤–µ—Ä–∫–∞ Makefile –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º

**–ï—Å–ª–∏ —Å–æ–∑–¥–∞–µ—à—å –ù–û–í–´–ô —Å–µ—Ä–≤–∏—Å:**

1. **–°–æ–∑–¥–∞–π Makefile** –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–∏–º–µ—Ä –≤—ã—à–µ (—Å–µ–∫—Ü–∏—è "–ü—Ä–∏–º–µ—Ä Makefile")
2. **–ó–∞–º–µ–Ω–∏** `{service-name}` –∏ `ROUTER_TYPE`
3. **–ù–ï —Å–æ–∑–¥–∞–≤–∞–π** `oapi-codegen.yaml` (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ Makefile)
4. **–°–æ–∑–¥–∞–π** `.gitignore`:
   ```gitignore
   *.bundled.yaml
   pkg/api/types.gen.go
   pkg/api/server.gen.go
   pkg/api/spec.gen.go
   *.exe
   *.test
   ```

**–ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—à—å —Å –°–£–©–ï–°–¢–í–£–Æ–©–ò–ú —Å–µ—Ä–≤–∏—Å–æ–º:**

1. **–ü—Ä–æ–≤–µ—Ä—å Makefile:**
   ```bash
   grep "generate-types:" services/{service}-go/Makefile
   ```
2. **–ï—Å–ª–∏ –ù–ï–¢ `generate-types`** ‚Üí –æ–±–Ω–æ–≤–∏ Makefile (–∏—Å–ø–æ–ª—å–∑—É–π –ø—Ä–∏–º–µ—Ä –≤—ã—à–µ)
3. **–ï—Å–ª–∏ –ï–°–¢–¨** ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π Makefile

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ Docker

**–ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞:**
1. `make verify-api` ‚Üí `make generate-api`
2. `go build ./...` ‚Üí `go test ./...`
3. `docker build -t {service-name}:test services/{service-name}-go`
4. –û–±–Ω–æ–≤–∏ `go.mod`: –¥–æ–±–∞–≤—å `github.com/oapi-codegen/runtime`, –∑–∞–ø—É—Å—Ç–∏ `go mod tidy`

**–°–∫—Ä–∏–ø—Ç—ã:** `./scripts/add-codegen-deps.sh`, `./scripts/validate-codegen.sh`

## –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –∏–∑ OpenAPI

**WARNING –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:** –ò—Å–ø–æ–ª—å–∑—É–π **–†–ê–ó–î–ï–õ–¨–ù–£–Æ –ì–ï–ù–ï–†–ê–¶–ò–Æ** –¥–ª—è —Å–æ–±–ª—é–¥–µ–Ω–∏—è SOLID –∏ –ª–∏–º–∏—Ç–∞ 500 —Å—Ç—Ä–æ–∫!

### –ü—Ä–æ–±–ª–µ–º–∞ —Å—Ç–∞—Ä–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:

‚ùå **–°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥** (1 —Ñ–∞–π–ª): `api.gen.go` (2000-3000 —Å—Ç—Ä–æ–∫) ‚Üí –Ω–∞—Ä—É—à–∞–µ—Ç SOLID –∏ –ª–∏–º–∏—Ç 500 —Å—Ç—Ä–æ–∫
OK **–ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥** (3 —Ñ–∞–π–ª–∞): `types.gen.go`, `server.gen.go`, `spec.gen.go` (–∫–∞–∂–¥—ã–π <500 —Å—Ç—Ä–æ–∫)

---

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (—Ä–∞–∑–¥–µ–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è):

1. **–£—Å—Ç–∞–Ω–æ–≤–∏ oapi-codegen:**
   ```bash
   go install github.com/oapi-codegen/oapi-codegen/v2/cmd/oapi-codegen@latest
   ```

2. **–°–æ–∑–¥–∞–π `Makefile` —Å —Ä–∞–∑–¥–µ–ª—å–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π:**
   - –°–º. `.cursor/CODE_GENERATION_TEMPLATE.md` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —à–∞–±–ª–æ–Ω–∞
   - **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:** `generate-types`, `generate-server`, `generate-spec` –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–∞—Ä–≥–µ—Ç—ã

3. **–ù–ï —Å–æ–∑–¥–∞–≤–∞–π `oapi-codegen.yaml`:**
   - –ü—Ä–∏ —Ä–∞–∑–¥–µ–ª—å–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥–∏ –≤ `Makefile`

4. **–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –∫–æ–¥:**
   ```bash
   make generate-api  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: bundle + generate-types + generate-server + generate-spec
   ```

5. **–ü—Ä–æ–≤–µ—Ä—å —Ä–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤:**
   ```bash
   make check-file-sizes  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ 500 —Å—Ç—Ä–æ–∫
   ```

---

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ù–û–í–ê–Ø - —Ä–∞–∑–¥–µ–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è):

```
services/{service}-go/
‚îú‚îÄ‚îÄ pkg/api/
‚îÇ   ‚îú‚îÄ‚îÄ types.gen.go              # <500 —Å—Ç—Ä–æ–∫ (–º–æ–¥–µ–ª–∏, —Å—Ö–µ–º—ã)
‚îÇ   ‚îú‚îÄ‚îÄ server.gen.go             # <500 —Å—Ç—Ä–æ–∫ (ServerInterface, —Ä–æ—É—Ç–µ—Ä)
‚îÇ   ‚îî‚îÄ‚îÄ spec.gen.go               # <500 —Å—Ç—Ä–æ–∫ (embedded OpenAPI spec)
‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îú‚îÄ‚îÄ http_server.go            # –¢–û–õ–¨–ö–û –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ middleware.go             # –í–°–ï middleware
‚îÇ   ‚îú‚îÄ‚îÄ handlers.go               # –í–°–ï handlers (—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è api.ServerInterface)
‚îÇ   ‚îú‚îÄ‚îÄ service.go                # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ repository.go             # –ë–î
‚îú‚îÄ‚îÄ Makefile                      # –° —Ä–∞–∑–¥–µ–ª—å–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
‚îî‚îÄ‚îÄ .gitignore                    # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç *.gen.go –∏ *.bundled.yaml
```

**–í–ê–ñ–ù–û:** –ü–∞–∫–µ—Ç –æ—Å—Ç–∞–µ—Ç—Å—è `api`, –≤—Å–µ —Ç–∏–ø—ã –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ `api.TypeName` (–Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!)

---

### Makefile –∫–æ–º–∞–Ω–¥—ã (—Ä–∞–∑–¥–µ–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è):

```makefile
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤ 3 —Ñ–∞–π–ª–∞
generate-types        # types.gen.go - –º–æ–¥–µ–ª–∏ –∏ —Å—Ö–µ–º—ã
generate-server       # server.gen.go - ServerInterface –∏ —Ä–æ—É—Ç–µ—Ä
generate-spec         # spec.gen.go - embedded OpenAPI spec
generate-api          # –í—Å–µ 3 —Ñ–∞–π–ª–∞ + –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤

# –£—Ç–∏–ª–∏—Ç—ã
bundle-api            # Bundle OpenAPI spec —Å $ref
verify-api            # Lint OpenAPI spec
check-file-sizes      # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ 500 —Å—Ç—Ä–æ–∫
clean                 # –£–¥–∞–ª–µ–Ω–∏–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
```

---

### –ü—Ä–∏–º–µ—Ä Makefile (–∫–æ–ø–∏—Ä—É–π —ç—Ç–æ—Ç —à–∞–±–ª–æ–Ω):

```makefile
.PHONY: generate-api bundle-api clean verify-api check-deps generate-types generate-server generate-spec check-file-sizes

SERVICE_NAME := {service-name}
OAPI_CODEGEN := oapi-codegen
REDOCLY_CLI := npx -y @redocly/cli
ROUTER_TYPE := chi-server

SPEC_DIR := ../../proto/openapi
API_DIR := pkg/api
SERVICE_SPEC := $(SPEC_DIR)/$(SERVICE_NAME).yaml
BUNDLED_SPEC := $(API_DIR)/$(SERVICE_NAME).bundled.yaml

# Split output files (SOLID compliance)
TYPES_FILE := $(API_DIR)/types.gen.go
SERVER_FILE := $(API_DIR)/server.gen.go
SPEC_FILE := $(API_DIR)/spec.gen.go

check-deps:
	@command -v $(OAPI_CODEGEN) >/dev/null 2>&1 || { echo "‚ùå oapi-codegen not found"; exit 1; }
	@command -v node >/dev/null 2>&1 || { echo "‚ùå node not found"; exit 1; }

bundle-api: check-deps
	@mkdir -p $(API_DIR)
	@$(REDOCLY_CLI) bundle $(SERVICE_SPEC) -o $(BUNDLED_SPEC) || exit 1

generate-types: bundle-api
	@$(OAPI_CODEGEN) -package api -generate types -o $(TYPES_FILE) $(BUNDLED_SPEC) || exit 1
	@wc -l $(TYPES_FILE) | awk '{print "OK types.gen.go: " $$1 " lines"}'

generate-server: bundle-api
	@$(OAPI_CODEGEN) -package api -generate $(ROUTER_TYPE) -o $(SERVER_FILE) $(BUNDLED_SPEC) || exit 1
	@wc -l $(SERVER_FILE) | awk '{print "OK server.gen.go: " $$1 " lines"}'

generate-spec: bundle-api
	@$(OAPI_CODEGEN) -package api -generate spec -o $(SPEC_FILE) $(BUNDLED_SPEC) || exit 1
	@wc -l $(SPEC_FILE) | awk '{print "OK spec.gen.go: " $$1 " lines"}'

check-file-sizes:
	@for file in $(TYPES_FILE) $(SERVER_FILE) $(SPEC_FILE); do \
		if [ -f "$$file" ]; then \
			lines=$$(wc -l < "$$file"); \
			if [ $$lines -gt 500 ]; then echo "WARNING  $$file: $$lines lines"; \
			else echo "OK $$file: $$lines lines"; fi; \
		fi; \
	done

generate-api: generate-types generate-server generate-spec check-file-sizes

verify-api: check-deps
	@$(REDOCLY_CLI) lint $(SERVICE_SPEC) || exit 1

clean:
	@rm -f $(BUNDLED_SPEC) $(TYPES_FILE) $(SERVER_FILE) $(SPEC_FILE)
```

**–ó–∞–º–µ–Ω–∏:**
- `{service-name}` ‚Üí –∏–º—è —Å–µ—Ä–≤–∏—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `companion-service`)
- `ROUTER_TYPE` ‚Üí **–í–°–ï–ì–î–ê chi-server** (–¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤!)

**–ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —á—Ç–æ –¥–µ–ª–∞—Ç—å:**

### OK –ù–û–í–´–ô —Å–µ—Ä–≤–∏—Å (—Å–æ–∑–¥–∞–µ—à—å —Å –Ω—É–ª—è):

```makefile
ROUTER_TYPE := chi-server  # OK –í–°–ï–ì–î–ê chi!
```

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `github.com/go-chi/chi/v5` - —Ä–æ—É—Ç–µ—Ä
- `github.com/oapi-codegen/runtime` - runtime –¥–ª—è oapi-codegen

### üîÑ –°–£–©–ï–°–¢–í–£–Æ–©–ò–ô —Å–µ—Ä–≤–∏—Å (—É–∂–µ –µ—Å—Ç—å –∫–æ–¥):

```bash
# –ü—Ä–æ–≤–µ—Ä—å –∫–∞–∫–æ–π —Ä–æ—É—Ç–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
grep -r "github.com/go-chi/chi" services/{service}-go/server/

# –ï—Å–ª–∏ Chi –Ω–∞–π–¥–µ–Ω:
ROUTER_TYPE := chi-server  # OK –í—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ, –ø—Ä–æ–¥–æ–ª–∂–∞–π

# –ï—Å–ª–∏ Chi –ù–ï –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–≤–µ—Ä—å Gorilla:
grep -r "github.com/gorilla/mux" services/{service}-go/server/

# –ï—Å–ª–∏ Gorilla –Ω–∞–π–¥–µ–Ω:
# WARNING –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø –ú–ò–ì–†–ê–¶–ò–Ø –Ω–∞ Chi!
# –°–º. —Å–µ–∫—Ü–∏—é "–ú–∏–≥—Ä–∞—Ü–∏—è —Å Gorilla –Ω–∞ Chi" –Ω–∏–∂–µ
```

**WARNING –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:**
- **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –º–∏–≥—Ä–∏—Ä—É–π** –≤—Å–µ Gorilla —Å–µ—Ä–≤–∏—Å—ã –Ω–∞ Chi!
- Chi –∏ Gorilla –∏–º–µ—é—Ç **—Ä–∞–∑–Ω—ã–π API** (—Å–º. —Ç–∞–±–ª–∏—Ü—É —Ä–∞–∑–ª–∏—á–∏–π –Ω–∏–∂–µ)
- –ú–∏–≥—Ä–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è `server/http_server.go`
- –°–ª–µ–¥—É–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –æ—à–∏–±–æ–∫

---

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è handlers (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π):

```go
// Issue: #123
package server

import (
    "net/http"
    "github.com/your-org/necpgame/services/{service}-go/pkg/api"
)

type Handlers struct {
    service Service
}

// NewHandlers —Å–æ–∑–¥–∞–µ—Ç handlers —Å DI
func NewHandlers(service Service) *Handlers {
    return &Handlers{service: service}
}

// –†–µ–∞–ª–∏–∑–∞—Ü–∏—è api.ServerInterface (—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
func (h *Handlers) ListItems(w http.ResponseWriter, r *http.Request, params api.ListItemsParams) {
    // –ò—Å–ø–æ–ª—å–∑—É–π —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã –∏–∑ types.gen.go
    items, err := h.service.ListItems(r.Context(), params)
    if err != nil {
        respondError(w, http.StatusInternalServerError, err.Error())
        return
    }
    
    // Response —Ç–∏–ø—ã —Ç–æ–∂–µ –∏–∑ types.gen.go
    response := api.ListItemsResponse{
        Items: items,
    }
    
    respondJSON(w, http.StatusOK, response)
}
```

---

---

### HTTP Server setup (chi router - –¥–ª—è –ù–û–í–´–• —Å–µ—Ä–≤–∏—Å–æ–≤):

**–í–ê–ñ–ù–û:** Chi –∏ gorilla –∏–º–µ—é—Ç **—Ä–∞–∑–Ω—ã–π API**. –ù–ï –ø—ã—Ç–∞–π—Å—è –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã —Å gorilla –Ω–∞ chi!

**–ü—Ä–∏–º–µ—Ä—ã —Ä–∞–∑–ª–∏—á–∏–π:**

| –û–ø–µ—Ä–∞—Ü–∏—è | Chi | Gorilla |
|----------|-----|---------|
| –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–∞ | `chi.NewRouter()` | `mux.NewRouter()` |
| –¢–∏–ø —Ä–æ—É—Ç–µ—Ä–∞ | `chi.Router` | `*mux.Router` |
| Subrouter | `router.Route("/api", func(r chi.Router) {...})` | `router.PathPrefix("/api").Subrouter()` |
| –ú–µ—Ç–æ–¥—ã | `router.Get("/path", handler)` | `router.HandleFunc("/path", handler).Methods("GET")` |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è oapi | `api.HandlerWithOptions(h, api.ChiServerOptions{...})` | `api.HandlerFromMux(h, router)` |

---

```go
// Issue: #123
package server

import (
    "net/http"
    "github.com/go-chi/chi/v5"
    "github.com/your-org/necpgame/services/{service}-go/pkg/api"
)

type HTTPServer struct {
    addr    string
    router  chi.Router
    service Service
}

func NewHTTPServer(addr string, service Service) *HTTPServer {
    router := chi.NewRouter()
    
    // Middleware
    router.Use(loggingMiddleware)
    router.Use(metricsMiddleware)
    
    // Handlers
    handlers := NewHandlers(service)
    
    // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å oapi-codegen (chi)
    api.HandlerWithOptions(handlers, api.ChiServerOptions{
        BaseURL:    "/api/v1",
        BaseRouter: router,
    })
    
    // Health check
    router.Get("/health", healthCheck)
    
    return &HTTPServer{
        addr:   addr,
        router: router,
        service: service,
    }
}

func (s *HTTPServer) Start() error {
    return http.ListenAndServe(s.addr, s.router)
}
```

---

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å Gorilla –Ω–∞ Chi (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)

**–ï—Å–ª–∏ —Å–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Gorilla - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –º–∏–≥—Ä–∏—Ä—É–π –Ω–∞ Chi!**

**–ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** `.cursor/GORILLA_TO_CHI_MIGRATION.md`

**–ö—Ä–∞—Ç–∫–∞—è –≤–µ—Ä—Å–∏—è –Ω–∏–∂–µ:**

### –®–∞–≥ 1: –û–±–Ω–æ–≤–∏—Ç—å Makefile

```makefile
# –ë—ã–ª–æ:
ROUTER_TYPE := gorilla-server

# –°—Ç–∞–ª–æ:
ROUTER_TYPE := chi-server
```

### –®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç—å go.mod

```bash
# –£–¥–∞–ª–∏—Ç—å Gorilla
go mod edit -dropreplace github.com/gorilla/mux

# –î–æ–±–∞–≤–∏—Ç—å Chi
go get github.com/go-chi/chi/v5@latest
go get github.com/oapi-codegen/runtime@latest
go mod tidy
```

### –®–∞–≥ 3: –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å server/http_server.go

**–ë—ã–ª–æ (Gorilla):**
```go
import "github.com/gorilla/mux"

func NewHTTPServer(addr string, service Service) *HTTPServer {
    router := mux.NewRouter()
    
    // Middleware
    router.Use(loggingMiddleware)
    
    // Handlers
    handlers := NewHandlers(service)
    api.HandlerFromMux(handlers, router)
    
    // Health
    router.HandleFunc("/health", healthCheck).Methods("GET")
    
    return &HTTPServer{addr: addr, router: router}
}
```

**–°—Ç–∞–ª–æ (Chi):**
```go
import (
    "github.com/go-chi/chi/v5"
    "github.com/go-chi/chi/v5/middleware"
)

func NewHTTPServer(addr string, service Service) *HTTPServer {
    router := chi.NewRouter()
    
    // Middleware
    router.Use(middleware.Logger)
    router.Use(loggingMiddleware)
    
    // Handlers
    handlers := NewHandlers(service)
    api.HandlerWithOptions(handlers, api.ChiServerOptions{
        BaseURL:    "/api/v1",
        BaseRouter: router,
    })
    
    // Health
    router.Get("/health", healthCheck)
    
    return &HTTPServer{addr: addr, router: router}
}
```

### –®–∞–≥ 4: –†–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

```bash
cd services/{service-name}-go
make clean
make generate-api
```

### –®–∞–≥ 5: –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã

```bash
# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã Gorilla
# –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ Chi
sed -i 's|github.com/gorilla/mux|github.com/go-chi/chi/v5|g' server/*.go
```

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç—å

```bash
go build ./...
go test ./...

git add .
git commit -m "[backend] refactor: migrate from Gorilla to Chi router

- Replace gorilla/mux with go-chi/chi/v5
- Update Makefile: gorilla-server ‚Üí chi-server
- Rewrite server/http_server.go for Chi API
- Update oapi-codegen integration
- All tests passing

BREAKING: Router migrated from Gorilla to Chi

Related Issue: #123"
```

### –¢–∞–±–ª–∏—Ü–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ API:

| Gorilla | Chi | –ó–∞–º–µ—á–∞–Ω–∏—è |
|---------|-----|-----------|
| `mux.NewRouter()` | `chi.NewRouter()` | –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–∞ |
| `*mux.Router` | `chi.Router` | –¢–∏–ø —Ä–æ—É—Ç–µ—Ä–∞ |
| `router.HandleFunc("/path", h).Methods("GET")` | `router.Get("/path", h)` | GET –º–µ—Ç–æ–¥ |
| `router.HandleFunc("/path", h).Methods("POST")` | `router.Post("/path", h)` | POST –º–µ—Ç–æ–¥ |
| `router.PathPrefix("/api").Subrouter()` | `router.Route("/api", func(r chi.Router){...})` | Subrouter |
| `api.HandlerFromMux(h, router)` | `api.HandlerWithOptions(h, api.ChiServerOptions{...})` | oapi-codegen |

### Middleware –º–∏–≥—Ä–∞—Ü–∏—è:

**Gorilla:**
```go
router.Use(loggingMiddleware)
```

**Chi:**
```go
import "github.com/go-chi/chi/v5/middleware"

router.Use(middleware.Logger)      // –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π logger
router.Use(middleware.Recoverer)   // –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π recoverer
router.Use(loggingMiddleware)      // –ö–∞—Å—Ç–æ–º–Ω—ã–π
```

### –ß–µ–∫-–ª–∏—Å—Ç –º–∏–≥—Ä–∞—Ü–∏–∏:

- [ ] –û–±–Ω–æ–≤–ª–µ–Ω Makefile (`chi-server`)
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω go.mod (Chi –¥–æ–±–∞–≤–ª–µ–Ω, Gorilla —É–¥–∞–ª–µ–Ω)
- [ ] –ü–µ—Ä–µ–ø–∏—Å–∞–Ω `server/http_server.go`
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã
- [ ] –†–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∫–æ–¥ (`make generate-api`)
- [ ] –ö–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è (`go build ./...`)
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (`go test ./...`)
- [ ] –ö–æ–º–º–∏—Ç —Å–æ–∑–¥–∞–Ω —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `[backend]`

---

### –ü–∞—Ç—Ç–µ—Ä–Ω—ã

**Makefile:**
- –ò—Å–ø–æ–ª—å–∑—É–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (`SERVICE_NAME`, `ROUTER_TYPE`)
- **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:** –†–∞–∑–¥–µ–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è (`generate-types`, `generate-server`, `generate-spec`)
- –î–æ–±–∞–≤—å `check-file-sizes` –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ª–∏–º–∏—Ç–∞ 500 —Å—Ç—Ä–æ–∫

**Handlers:**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å DI —á–µ—Ä–µ–∑ `New*Handlers()`
- –ò—Å–ø–æ–ª—å–∑—É–π —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã –∏–∑ `api` –ø–∞–∫–µ—Ç–∞ (–Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è!)
- Helpers –¥–ª—è `respondJSON`/`respondError`

**Middleware:**
- **–í–°–ï** –≤ `middleware.go`, **–ù–ï** –≤ `http_server.go`
- DI –¥–ª—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–†–æ—É—Ç–µ—Ä:**
- **–ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô —Ä–æ—É—Ç–µ—Ä:** Chi (`chi-server`)
  - –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π, –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π, –±—ã—Å—Ç—Ä—ã–π
  - –û—Ç–ª–∏—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ middleware
  - –ù–∞—Ç–∏–≤–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å oapi-codegen
  - `api.HandlerWithOptions()` –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **–ù–û–í–´–ï —Å–µ—Ä–≤–∏—Å—ã:** –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π Chi
- **–°–£–©–ï–°–¢–í–£–Æ–©–ò–ï —Å Chi:** –ø—Ä–æ–¥–æ–ª–∂–∞–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Chi
- **–°–£–©–ï–°–¢–í–£–Æ–©–ò–ï —Å Gorilla:** –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –º–∏–≥—Ä–∏—Ä—É–π –Ω–∞ Chi!
  - –°–º. `.cursor/GORILLA_TO_CHI_MIGRATION.md`
  - –ú–∏–≥—Ä–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- –í—Å–µ–≥–¥–∞ `make verify-api` –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
- –í—Å–µ–≥–¥–∞ `make check-file-sizes` –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ä–æ—É—Ç–µ—Ä—ã:**
- **chi-server** OK (–ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô —Å—Ç–∞–Ω–¥–∞—Ä—Ç)
- gorilla-server ‚ùå (–ó–ê–ü–†–ï–©–ï–ù, –º–∏–≥—Ä–∏—Ä—É–π –Ω–∞ Chi)
- echo-server, gin-server ‚ùå (–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ–º)

---

### –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:

**–ï—Å–ª–∏ —É —Å–µ—Ä–≤–∏—Å–∞ —É–∂–µ –µ—Å—Ç—å `api.gen.go` >500 —Å—Ç—Ä–æ–∫:**

1. **–ó–∞–ø—É—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏:**
   ```bash
   cd services/{service-name}-go
   ../../scripts/migrate-to-split-generation.sh
   ```

2. **–£–¥–∞–ª–∏ —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª:**
   ```bash
   rm -f pkg/api/api.gen.go
   ```

3. **–û–±–Ω–æ–≤–∏ `.gitignore`:**
   ```gitignore
   # –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
   pkg/api/types.gen.go
   pkg/api/server.gen.go
   pkg/api/spec.gen.go
   
   # Legacy (—É–¥–∞–ª–∏—Ç—å, –µ—Å–ª–∏ –µ—Å—Ç—å)
   pkg/api/api.gen.go
   ```

4. **–ö–æ–º–º–∏—Ç:**
   ```bash
   git add Makefile .gitignore
   git commit -m "[backend] refactor: migrate to split generation for SOLID compliance

   - Split api.gen.go into types.gen.go, server.gen.go, spec.gen.go
   - Each file <500 lines (SOLID compliance)
   
   Related Issue: #123"
   ```

---

### –í–Ω–µ—à–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –≤ OpenAPI:

- –ò—Å–ø–æ–ª—å–∑—É–π `@redocly/cli bundle` –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è `$ref` –Ω–∞ `common.yaml`
- **–ù–ï –æ–±—ä–µ–¥–∏–Ω—è–π —Ñ–∞–π–ª—ã –≤—Ä—É—á–Ω—É—é**
- Bundled —Ñ–∞–π–ª—ã –≤ `.gitignore` (–Ω–µ –∫–æ–º–º–∏—Ç—è—Ç—Å—è)
- Bundle –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ `make bundle-api`

---

### –ß–µ–∫-–ª–∏—Å—Ç –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:

- [ ] 3 —Ñ–∞–π–ª–∞ —Å–æ–∑–¥–∞–Ω—ã: `types.gen.go`, `server.gen.go`, `spec.gen.go`
- [ ] –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª <500 —Å—Ç—Ä–æ–∫ (`make check-file-sizes`)
- [ ] –°—Ç–∞—Ä—ã–π `api.gen.go` —É–¥–∞–ª–µ–Ω
- [ ] `.gitignore` –æ–±–Ω–æ–≤–ª–µ–Ω
- [ ] –ö–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è: `go build ./...`
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç: `go test ./...`
- [ ] Docker –æ–±—Ä–∞–∑ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è

## –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

- Go –∫–æ–¥ –≤ `services/` (—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π + —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
- Handlers –¥–ª—è –≤—Å–µ—Ö endpoints (—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã + —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
- –¢–µ—Å—Ç—ã
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è oapi-codegen
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∫–æ–¥–∞

## –†–∞–∑–±–∏–µ–Ω–∏–µ –±–æ–ª—å—à–∏—Ö –∑–∞–¥–∞—á

**–°–º. `.cursor/AGENT_COMMON_RULES.md`**

**–ü—Ä–∏–º–µ—Ä—ã:** Handler ‚Üí User/Admin/Public handlers, Service ‚Üí Interface/Implementation/Tests, API ‚Üí Endpoints groups A/B/C

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

**–ò—Å–ø–æ–ª—å–∑—É–π:** `/backend-validate-result #123`

**–ì–æ—Ç–æ–≤–æ –∫ –ø–µ—Ä–µ–¥–∞—á–µ –∫–æ–≥–¥–∞:**
- [ ] Backend —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, API —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã, –∫–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º
- [ ] –ú–µ—Ç—Ä–∏–∫–∏ –∏ health checks –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

## –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É

**WARNING –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π:**

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:** `/backend-validate-result #123`
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π:** `/backend-validate-optimizations #123` ‚Üê **–ö–†–ò–¢–ò–ß–ù–û!**
3. –ï—Å–ª–∏ –æ–±–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ OK ‚Üí –ø–µ—Ä–µ–¥–∞–≤–∞–π –∑–∞–¥–∞—á—É

**–ö–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–π –∫–≤–µ—Å—Ç (labels `canon`, `lore`, `quest`):**
1. `/backend-validate-result #123` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
2. `/backend-validate-optimizations #123` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π
3. –û–±–Ω–æ–≤–∏ Project: `Status = QA - Todo`
4. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –æ—Ç—á–µ—Ç–æ–º –æ–± –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è—Ö

**–°–∏—Å—Ç–µ–º–Ω–∞—è –∑–∞–¥–∞—á–∞:**
1. `/backend-validate-result #123` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞  
2. `/backend-validate-optimizations #123` - **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!**
3. –û–±–Ω–æ–≤–∏ Project: `Status = Network - Todo`
4. –°–æ–∑–¥–∞–π PR: `[backend] feat: —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è Issue #{number}`
5. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –æ—Ç—á–µ—Ç–æ–º –æ–± –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è—Ö

**–®–∞–±–ª–æ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è:**
```markdown
OK Backend ready. Handed off to {NextAgent}

**Optimizations applied:**
- [x] Context timeouts (100ms for external calls)
- [x] DB pool configured (25 connections)
- [x] Memory pooling (3 pools: response, request, buffer)
- [x] Batch operations (DB queries)
- [x] Zero allocations in hot path

**Performance:**
- P99 latency: 8.5ms (OK <10ms)
- Throughput: 15k req/sec
- Memory: stable, no leaks

PR: #{pr_number}
Issue: #{issue_number}
```

**–°–º. `.cursor/AGENT_COMMON_RULES.md`**

## Task Requirements Check

**–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã:**
1. –ü—Ä–æ—á–∏—Ç–∞–π Issue –ø–æ–ª–Ω–æ—Å—Ç—å—é (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏)
2. –ü—Ä–æ–≤–µ—Ä—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–æ–¥–∞ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º Issue
3. –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö ‚Üí –≤–µ—Ä–Ω–∏—Å—å –∫ Issue –∏ –ø—Ä–æ–≤–µ—Ä—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

**–°–º. `.cursor/AGENT_COMMON_RULES.md` –¥–ª—è –¥–µ—Ç–∞–ª–µ–π**

## –°—Ç–∏–ª—å —Ä–∞–±–æ—Ç—ã

- **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∏—Å–ø–æ–ª—å–∑—É–π oapi-codegen** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞ –∏–∑ OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π
- **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —É–∫–∞–∑—ã–≤–∞–π Issue –≤ –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞:** `// Issue: #123`
- –°–ª–µ–¥—É–π Go best practices
- –ò—Å–ø–æ–ª—å–∑—É–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (JSON)
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ `/metrics`
- Health checks —á–µ—Ä–µ–∑ `/health`
- Dependency injection –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- –ú–∞–ª–µ–Ω—å–∫–∏–µ –∫–ª–∞—Å—Å—ã (300-400 —Å—Ç—Ä–æ–∫ –º–∞–∫—Å–∏–º—É–º)
- **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ù–ï —Å–æ–∑–¥–∞–≤–∞–π —Ñ–∞–π–ª—ã –±–æ–ª—å—à–µ 500 —Å—Ç—Ä–æ–∫!** –ï—Å–ª–∏ —Ñ–∞–π–ª –ø—Ä–µ–≤—ã—à–∞–µ—Ç 500 —Å—Ç—Ä–æ–∫, —Ä–∞–∑–±–µ–π –µ–≥–æ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤
- **–ù–ï —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥** - —Ä–µ–∞–ª–∏–∑—É–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö

## WARNING –ö–†–ò–¢–ò–ß–ù–û: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è MMOFPS RPG

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø—Ä–∏–º–µ–Ω—è–π —ç—Ç–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤ –∫–æ–¥–µ:**

### 1. Memory Pooling (–∏—Å–ø–æ–ª—å–∑—É–π –í–°–ï–ì–î–ê –¥–ª—è hot path)

```go
// –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–π –æ–±—ä–µ–∫—Ç—ã –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è GC –Ω–∞–≥—Ä—É–∑–∫–∏
var responsePool = sync.Pool{
    New: func() interface{} {
        return &Response{
            Data: make([]byte, 0, 1024),
        }
    },
}

func Handler(w http.ResponseWriter, r *http.Request) {
    resp := responsePool.Get().(*Response)
    defer responsePool.Put(resp)
    resp.Data = resp.Data[:0] // Reset slice
    // Use resp...
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** GC –Ω–∞–≥—Ä—É–∑–∫–∞ ‚Üì 70-80%, latency —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ

### 2. Batch Operations (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è >100 RPS)

```go
// –ü–ª–æ—Ö–æ: N –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
for _, id := range playerIDs {
    player := db.GetPlayer(id) // N queries
}

// –•–æ—Ä–æ—à–æ: 1 –∑–∞–ø—Ä–æ—Å
players := db.GetPlayersBatch(playerIDs) // 1 query
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** DB load ‚Üì 95%, latency ‚Üì 10x

### 3. Lock-Free –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ

```go
// –ò—Å–ø–æ–ª—å–∑—É–π atomic –≤–º–µ—Å—Ç–æ mutex –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
type Stats struct {
    requestCount atomic.Int64 // Go 1.19+
    errorCount   atomic.Int64
}

stats.requestCount.Add(1) // Lock-free!
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Contention ‚Üì 90%, throughput ‚Üë 3-5x

### 4. Context Deadlines (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)

```go
// –í—Å–µ–≥–¥–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π timeout –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤
ctx, cancel := context.WithTimeout(r.Context(), 100*time.Millisecond)
defer cancel()

resp, err := externalService.Call(ctx, req)
```

### 5. –ì–æ—Ä—É—Ç–∏–Ω—ã —Å –ª–∏–º–∏—Ç–æ–º

```go
// –ù–ï —Å–æ–∑–¥–∞–≤–∞–π –±–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ –≥–æ—Ä—É—Ç–∏–Ω—ã
type WorkerPool struct {
    semaphore chan struct{}
}

func NewWorkerPool(size int) *WorkerPool {
    return &WorkerPool{
        semaphore: make(chan struct{}, size),
    }
}

func (p *WorkerPool) Do(fn func()) {
    p.semaphore <- struct{}{}
    go func() {
        defer func() { <-p.semaphore }()
        fn()
    }()
}
```

### 6. Preallocation (–≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ)

```go
// –ü–ª–æ—Ö–æ: append –±–µ–∑ capacity
items := []Item{}
for i := 0; i < 1000; i++ {
    items = append(items, Item{}) // –ú–Ω–æ–≥–æ —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏–π
}

// –•–æ—Ä–æ—à–æ: preallocate
items := make([]Item, 0, 1000)
for i := 0; i < 1000; i++ {
    items = append(items, Item{}) // –ù–µ—Ç —Ä–µ–∞–ª–ª–æ–∫–∞—Ü–∏–π
}
```

### 7. Defer –≤ hot path (–∏–∑–±–µ–≥–∞–π)

```go
// –ü–ª–æ—Ö–æ –≤ hot path (defer has overhead)
func ProcessRequest() {
    mu.Lock()
    defer mu.Unlock() // ~50ns overhead
    // ...
}

// –•–æ—Ä–æ—à–æ –≤ hot path
func ProcessRequest() {
    mu.Lock()
    // ...
    mu.Unlock() // Manual unlock
}
```

### 8. String vs []byte

```go
// –í hot path –∏—Å–ø–æ–ª—å–∑—É–π []byte –≤–º–µ—Å—Ç–æ string
func ProcessData(data []byte) { // –ù–µ string!
    // –†–∞–±–æ—Ç–∞–π —Å []byte –Ω–∞–ø—Ä—è–º—É—é
}

// –ò–∑–±–µ–≥–∞–π –∫–æ–Ω–≤–µ—Ä—Å–∏–π string <-> []byte
```

### 9. Profiling endpoints (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)

```go
import _ "net/http/pprof"

// –í main.go –¥–ª—è non-production –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Ä—Ç
go func() {
    http.ListenAndServe("localhost:6060", nil)
}()
```

### 10. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ runtime

```go
func init() {
    // –î–ª—è game servers
    runtime.GOMAXPROCS(runtime.NumCPU() - 1) // 1 CPU –¥–ª—è OS
    debug.SetGCPercent(50) // –ß–∞—Å—Ç—ã–π GC, –∫–æ—Ä–æ—á–µ –ø–∞—É–∑—ã
}
```

**–í–ê–ñ–ù–û:** –≠—Ç–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è real-time game services (matchmaking, game state, player sync). –î–ª—è –æ–±—ã—á–Ω—ã—Ö CRUD API –º–æ–∂–Ω–æ –±—ã—Ç—å –º–µ–Ω–µ–µ —Å—Ç—Ä–æ–≥–∏–º.

### 11. Struct Field Alignment (—ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏ 30-50%)

```go
// ‚ùå –ü–ª–æ—Ö–æ: –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ
type Player struct {
    IsActive bool   // 1 byte + 7 padding
    ID       uint64 // 8 bytes
    Level    uint8  // 1 byte + 7 padding
}
// 32 bytes total

// OK –•–æ—Ä–æ—à–æ: –±–æ–ª—å—à–∏–µ –ø–æ–ª—è –ø–µ—Ä–≤—ã–º–∏
type Player struct {
    ID       uint64 // 8 bytes
    Level    uint8  // 1 byte
    IsActive bool   // 1 byte
}
// 16 bytes total (50% —ç–∫–æ–Ω–æ–º–∏—è!)

// –ü—Ä–æ–≤–µ—Ä–∫–∞: fieldalignment ./...
```

### 12. Goroutine Leak Detection

```go
import "go.uber.org/goleak"

func TestMain(m *testing.M) {
    goleak.VerifyTestMain(m) // –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ leaks
}

func TestNoLeaks(t *testing.T) {
    defer goleak.VerifyNone(t)
    
    server := NewServer()
    server.Start()
    server.Stop() // –î–æ–ª–∂–µ–Ω cleanup –≤—Å–µ –≥–æ—Ä—É—Ç–∏–Ω—ã
}
```

### 13. Ring Buffer –¥–ª—è Events (lock-free)

```go
// –î–ª—è high-throughput event processing
type RingBuffer struct {
    buffer   []Event
    size     int64
    writePos atomic.Int64
    readPos  atomic.Int64
}

func (rb *RingBuffer) Push(event Event) bool {
    write := rb.writePos.Load()
    next := (write + 1) % rb.size
    
    if next == rb.readPos.Load() {
        return false // Full
    }
    
    rb.buffer[write] = event
    rb.writePos.Store(next)
    return true
}
```

### 14. FlatBuffers –¥–ª—è Ultra-Low Latency

```go
// –ö–æ–≥–¥–∞ Protobuf = bottleneck (–ø–æ—Å–ª–µ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è!)
// FlatBuffers = zero-copy deserialization

builder := flatbuffers.NewBuilder(1024)
pos := CreatePosition(builder, x, y, z)
builder.Finish(pos)

// Send without copy
conn.Write(builder.FinishedBytes())
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:** Protobuf –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç >5% CPU –≤ –ø—Ä–æ—Ñ–∞–π–ª–µ—Ä–µ

### 15. Bounded Channels (–∑–∞—â–∏—Ç–∞ –æ—Ç deadlocks)

```go
// ‚ùå –ü–ª–æ—Ö–æ: unbounded
events := make(chan Event)

// OK –•–æ—Ä–æ—à–æ: bounded + backpressure
events := make(chan Event, 1000)

select {
case events <- event:
    // OK
case <-time.After(10 * time.Millisecond):
    return ErrOverloaded // Shed load
}
```

**–ö–†–ò–¢–ò–ß–ù–û:** –î–ª—è –í–°–ï–• production —Å–µ—Ä–≤–∏—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π bounded channels!

### 16. Wrapper Types –¥–ª—è Hot Path (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```go
// types.gen.go (—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω - –ù–ï —Ç—Ä–æ–≥–∞–µ–º):
type Player struct {
    Id     string `json:"id"`
    Name   string `json:"name"`
    Level  int32  `json:"level"`
    Health int32  `json:"health"`
}

// player_internal.go (–Ω–∞—à —Ñ–∞–π–ª –¥–ª—è hot path):
// –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø: Struct alignment + fixed sizes
type PlayerInternal struct {
    ID       uint64   // 8 bytes (parsed from string)
    Health   int32    // 4 bytes
    Level    int32    // 4 bytes
    Name     [32]byte // 32 bytes (fixed, no allocation)
    IsActive bool     // 1 byte
}

var playerInternalPool = sync.Pool{
    New: func() interface{} {
        return &PlayerInternal{}
    },
}

// –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑ API type
func ToInternal(p api.Player) *PlayerInternal {
    internal := playerInternalPool.Get().(*PlayerInternal)
    internal.ID, _ = strconv.ParseUint(p.Id, 10, 64)
    internal.Health = p.Health
    internal.Level = p.Level
    copy(internal.Name[:], p.Name)
    return internal
}

// –í hot path –∏—Å–ø–æ–ª—å–∑—É–µ–º internal type
func (s *GameServer) ProcessPlayers(apiPlayers []api.Player) {
    for _, p := range apiPlayers {
        internal := ToInternal(p)
        defer playerInternalPool.Put(internal)
        
        // –†–∞–±–æ—Ç–∞ —Å internal (zero allocations!)
        s.updateGameState(internal)
    }
}
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- OK Game servers (game state updates, position sync)
- OK Hot path —Å >1000 ops/sec
- OK –ü–æ—Å–ª–µ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑–∞–ª–æ allocations
- ‚ùå –û–±—ã—á–Ω—ã–µ CRUD API (overkill)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Allocations ‚Üí 0, memory ‚Üì 40-60%

### 17. API Designer –ü–æ–º–æ–≥–∞–µ—Ç!

**–ï—Å–ª–∏ API Designer —É–ø–æ—Ä—è–¥–æ—á–∏–ª –ø–æ–ª—è –≤ OpenAPI (–±–æ–ª—å—à–∏–µ ‚Üí –º–∞–ª–µ–Ω—å–∫–∏–µ):**
- –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ structs —É–∂–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –≤—ã—Ä–æ–≤–Ω–µ–Ω—ã
- Wrapper types –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è extreme cases

**–ü—Ä–æ–≤–µ—Ä—å OpenAPI:**
```yaml
# –ü–æ–ª—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å: strings/objects ‚Üí int64 ‚Üí int32 ‚Üí int16 ‚Üí bool
Player:
  properties:
    id: {type: string}      # –ë–æ–ª—å—à–æ–µ –ø–µ—Ä–≤—ã–º
    position: {$ref: ...}   # Object
    health: {type: integer} # int32
    level: {type: integer}  # int32
    is_active: {type: boolean} # –ú–∞–ª–µ–Ω—å–∫–æ–µ –ø–æ—Å–ª–µ–¥–Ω–∏–º
```

## üìã –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π –∑–∞–¥–∞—á–∏

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø—Ä–æ–≤–µ—Ä—å –ø–µ—Ä–µ–¥ handoff:**

**–°–º. `.cursor/BACKEND_OPTIMIZATION_CHECKLIST.md` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —á–µ–∫-–ª–∏—Å—Ç–∞**

**–í—Å–µ —Ç–µ—Ö–Ω–∏–∫–∏:** `.cursor/GO_BACKEND_PERFORMANCE_BIBLE.md` - 75+ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- [ ] Context timeouts –¥–ª—è –≤—Å–µ—Ö –≤–Ω–µ—à–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤
- [ ] DB connection pool –Ω–∞—Å—Ç—Ä–æ–µ–Ω (25-50 connections)
- [ ] Struct fields —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ `fieldalignment`)
- [ ] –¢–µ—Å—Ç—ã –Ω–∞ goroutine leaks (—Å `goleak`)
- [ ] Benchmarks –¥–ª—è hot path (0 allocs/op)
- [ ] Profiling endpoints –≤–∫–ª—é—á–µ–Ω—ã (`pprof`)

**–î–ª—è game servers –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**
- [ ] Memory pooling (`sync.Pool`) –¥–ª—è —á–∞—Å—Ç—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- [ ] Batch operations –¥–ª—è DB queries
- [ ] Spatial partitioning (–µ—Å–ª–∏ >100 –æ–±—ä–µ–∫—Ç–æ–≤)
- [ ] Worker pool –¥–ª—è –≥–æ—Ä—É—Ç–∏–Ω
- [ ] Adaptive tick rate

**–®–∞–±–ª–æ–Ω—ã –∫–æ–¥–∞:** 
- `.cursor/templates/backend-api-templates.md` - API handlers/service/repository
- `.cursor/templates/backend-game-templates.md` - Game servers
- `.cursor/templates/backend-utils-templates.md` - Utilities/tests/metrics

## SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ã

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —Å–æ–±–ª—é–¥–∞–π SOLID:**

**SRP:** –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª - –æ–¥–Ω–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å. **–ù–ï –ø–∏—à–∏ middleware –∏ handlers –≤ `http_server.go`!**

**OCP:** –ò—Å–ø–æ–ª—å–∑—É–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç–∏

**LSP:** –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –≤–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º—ã, –∏—Å–ø–æ–ª—å–∑—É–π DI

**ISP:** –ú–∞–ª–µ–Ω—å–∫–∏–µ, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

**DIP:** –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, DI –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞—Ö

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- `http_server.go` - –¢–û–õ–¨–ö–û –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Ä–æ—É—Ç–µ—Ä–∞
- `middleware.go` - –í–°–ï middleware —Ñ—É–Ω–∫—Ü–∏–∏
- `handlers.go` - –í–°–ï handlers (ServerInterface)
- `service.go` - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- `repository.go` - —Ä–∞–±–æ—Ç–∞ —Å –ë–î

**–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:** middleware –∏ handlers –≤ `http_server.go`

**–ü–†–ê–í–ò–õ–¨–ù–û:** —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã, middleware –∏–∑ `middleware.go`, handlers –∏–∑ `handlers.go`
    api.HandlerWithOptions(handlers, api.ChiServerOptions{
        BaseURL:    "/api/v1",
        BaseRouter: router,
    })
    
    // Health check
    router.Get("/health", healthCheck)
    
    return &HTTPServer{
        addr:   addr,
        router: router,
        service: service,
    }
}
```

### –ß–µ–∫-–ª–∏—Å—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–æ–¥–∞

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–ª–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–æ–≤–µ—Ä—å:

- [ ] `http_server.go` —Å–æ–¥–µ—Ä–∂–∏—Ç –¢–û–õ–¨–ö–û –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Ä–æ—É—Ç–µ—Ä–∞
- [ ] –í—Å–µ middleware —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ `middleware.go`
- [ ] –í—Å–µ handlers –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ `handlers.go`
- [ ] –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ `service.go`
- [ ] –†–∞–±–æ—Ç–∞ —Å –ë–î –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ `repository.go`
- [ ] –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 500 —Å—Ç—Ä–æ–∫
- [ ] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è dependency injection —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã
- [ ] –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –¥–ª—è –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### WARNING –í–ê–ñ–ù–û: Dockerfile –ø–∞—Ç—Ç–µ—Ä–Ω

–í—Å–µ Dockerfile —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã: –∏—Å–ø–æ–ª—å–∑—É–π multi-stage build, Go 1.24-alpine, security context (non-root user appuser), health checks –Ω–∞ `/metrics`, —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ª–∏–Ω–∫–æ–≤–∫–∞. –î–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤ —Å proto/ –∏—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –∫–æ—Ä–Ω—è (context: .), –±–µ–∑ proto/ - –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–µ—Ä–≤–∏—Å–∞.

### Dockerfile —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∫–æ–¥–∞

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –æ–±–Ω–æ–≤–∏ Dockerfile –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞ –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π:

```dockerfile
FROM golang:1.24-alpine AS builder

WORKDIR /app

RUN apk add --no-cache make nodejs npm

COPY go.mod go.sum ./
RUN go mod download

COPY . .

RUN make generate-api || true

RUN go mod tidy
RUN CGO_ENABLED=0 GOOS=linux go build -o {service-name} -ldflags="-w -s" .

FROM alpine:latest

RUN apk --no-cache add ca-certificates

WORKDIR /app

COPY --from=builder /app/{service-name} /app/

EXPOSE {port}/tcp {metrics-port}

ENTRYPOINT ["/app/{service-name}"]
```

**–í–∞–∂–Ω–æ:**
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `make`, `nodejs`, `npm` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞
- `RUN make generate-api || true` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ —Å –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ–º –æ—à–∏–±–æ–∫ (–Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤–∞)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–µ–¥ `go mod tidy` –∏ —Å–±–æ—Ä–∫–æ–π

### –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é

**–ü—Ä–æ—Ü–µ—Å—Å –º–∏–≥—Ä–∞—Ü–∏–∏:**

1. **–ü—Ä–æ–≤–µ—Ä—å –Ω–∞–ª–∏—á–∏–µ OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏:**
   - –£–±–µ–¥–∏—Å—å, —á—Ç–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ `proto/openapi/{service-name}.yaml`
   - –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –≤–∞–ª–∏–¥–Ω–∞: `make verify-api`

2. **–û–ø—Ä–µ–¥–µ–ª–∏ —Ç–∏–ø —Ä–æ—É—Ç–µ—Ä–∞:**
   - –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `github.com/go-chi/chi/v5` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π `chi-server`
   - –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `github.com/gorilla/mux` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π `gorilla-server` –∏–ª–∏ –ø–µ—Ä–µ–π–¥–∏ –Ω–∞ chi

3. **–°–æ–∑–¥–∞–π —Ñ–∞–π–ª—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**
   - –°–∫–æ–ø–∏—Ä—É–π —É–ª—É—á—à–µ–Ω–Ω—ã–π `Makefile` –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–π –ø–æ–¥ –∏–º—è —Å–µ—Ä–≤–∏—Å–∞
   - –°–æ–∑–¥–∞–π `oapi-codegen.yaml` —Å –Ω—É–∂–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
   - –°–æ–∑–¥–∞–π `.gitignore` –¥–ª—è bundled —Ñ–∞–π–ª–æ–≤

4. **–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –∫–æ–¥:**
   ```bash
   cd services/{service}-go
   make generate-api
   ```

5. **–ú–∏–≥—Ä–∏—Ä—É–π handlers:**
   - –°–æ–∑–¥–∞–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É handlers, —Ä–µ–∞–ª–∏–∑—É—é—â—É—é `api.ServerInterface`
   - –ü–µ—Ä–µ–Ω–µ—Å–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏–∑ —Å—Ç–∞—Ä—ã—Ö handlers
   - –ò—Å–ø–æ–ª—å–∑—É–π —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã –≤–º–µ—Å—Ç–æ —Ä—É—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
   - –£–¥–∞–ª–∏ —Å—Ç–∞—Ä—ã–µ –º–æ–¥–µ–ª–∏ –∏–∑ `models/`, –µ—Å–ª–∏ –æ–Ω–∏ –¥—É–±–ª–∏—Ä—É—é—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ

6. **–û–±–Ω–æ–≤–∏ HTTP —Å–µ—Ä–≤–µ—Ä:**
   - –ò—Å–ø–æ–ª—å–∑—É–π `api.HandlerWithOptions()` –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
   - –£–¥–∞–ª–∏ —Ä—É—á–Ω—É—é —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é routes
   - –í—ã–Ω–µ—Å–∏ –í–°–ï middleware –≤ `middleware.go`
   - `http_server.go` –¥–æ–ª–∂–µ–Ω –¢–û–õ–¨–ö–û –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å middleware/handlers

7. **–ü—Ä–æ–≤–µ—Ä—å –∫–æ–º–ø–∏–ª—è—Ü–∏—é:**
   ```bash
   go build ./...
   go test ./...
   ```

8. **–û–±–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   - –£–±–µ–¥–∏—Å—å, —á—Ç–æ `go.mod` —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
   - –î–ª—è chi: `github.com/go-chi/chi/v5`
   - –î–ª—è oapi-codegen: `github.com/oapi-codegen/runtime`

**–í–∞–∂–Ω–æ –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏:**
- –°–æ—Ö—Ä–∞–Ω–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É
- –ù–µ —É–¥–∞–ª—è–π —Ç–µ—Å—Ç—ã —Å—Ä–∞–∑—É - –∞–¥–∞–ø—Ç–∏—Ä—É–π –∏—Ö –ø–æ–¥ –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- –ü—Ä–æ–≤–µ—Ä—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ API endpoints –æ—Å—Ç–∞—é—Ç—Å—è —Ç–µ–º–∏ –∂–µ

## –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞

- Go –∫–æ–¥ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö
- –¢–µ—Å—Ç—ã —Ä—è–¥–æ–º —Å –∫–æ–¥–æ–º
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤ `infrastructure/liquibase/`

## Git –∫–æ–º–º–∏—Ç—ã

**–°–º. `.cursor/AGENT_COMMON_RULES.md` –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∞ –∫–æ–º–º–∏—Ç–æ–≤**

**–§–æ—Ä–º–∞—Ç:** `[backend] {type}: {description}\n\n{details}\n\nRelated Issue: #{number}`

**–¢–∏–ø—ã:** `feat:`, `fix:`, `test:`, `refactor:`, `docs:`

**–ö–æ–≥–¥–∞:** –ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ endpoint, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–∞, –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤, —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

## –ó–∞–ø—Ä–µ—Ç—ã

- –ù–ï —Å–æ–∑–¥–∞–≤–∞–π –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ (UE5)
- –ù–ï –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É (Docker/K8s)
- –ù–ï –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π —Å–µ—Ç–µ–≤–æ–π –∫–æ–¥ (—ç—Ç–æ Network Engineer)
- **–ù–ï –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –∫–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–µ –∫–≤–µ—Å—Ç—ã** (–ø–µ—Ä–µ–¥–∞–≤–∞–π Content Writer)
- –¢–û–õ–¨–ö–û –±–µ–∫–µ–Ω–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

## –ú–∏–≥—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

**–°–∫—Ä–∏–ø—Ç—ã:** `scripts/add-codegen-deps.sh`, `scripts/validate-codegen.sh`, `scripts/update-makefiles.sh`

**–ß–µ–∫-–ª–∏—Å—Ç –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**
- [ ] `Makefile`, `oapi-codegen.yaml`, `.gitignore` —Å–æ–∑–¥–∞–Ω—ã
- [ ] `Dockerfile` –æ–±–Ω–æ–≤–ª–µ–Ω, `go.mod` –æ–±–Ω–æ–≤–ª–µ–Ω
- [ ] `make verify-api` ‚Üí `make generate-api` ‚Üí `go build` ‚Üí `go test` ‚Üí `docker build`
- [ ] –ö–æ–º–º–∏—Ç —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `[backend]`, —É–∫–∞–∑–∞–Ω Issue
