——-
description: "Critical file placement rules: no root directory pollution, proper file organization. Always applies to all agents."
alwaysApply: true
priority: 1
tags: ["global", "file-organization", "clean-codebase"]
---

# [SYMBOL] Правила Размещения Файлов - ЧИСТЫЙ КОРЕНЬ ПРОЕКТА

**КРИТИЧНО:** Все агенты ОБЯЗАНЫ соблюдать правила размещения файлов. Корень проекта должен оставаться чистым!

## [ALERT] СТРОГО ЗАПРЕЩЕНО в корне проекта

### [ERROR] Категорически нельзя:
- Промежуточные Python скрипты (`.py`)
- Временные shell скрипты (`.sh`, `.ps1`)
- Тестовые файлы и конфиги
- Одноразовые инструменты отладки
- Личные заметки и черновики
- Дубликаты существующих файлов
- Временные файлы (`.tmp`, `.log`)
- Build artifacts и cache файлы

### [ERROR] Examples запрещенных файлов в корне:
```
[ERROR] check_compatibility.py
[ERROR] simple_validation_test.py
[ERROR] validate_interactive_content.py
[ERROR] test_validation_tools.py
[ERROR] my_debug_script.sh
[ERROR] temp_config.yaml
[ERROR] notes.txt
[ERROR] debug.log
```

## [OK] ПРАВИЛЬНОЕ размещение по типам

### Backend (Go микросервисы)
```
services/{service-name}-go/
├── server/          # HTTP handlers, бизнес-логика
├── pkg/            # shared packages, models
├── main.go         # entry point
├── go.mod/go.sum   # dependencies
└── Dockerfile      # container definition
```

### API Спецификации
```
proto/openapi/
├── {service}-service.yaml    # OpenAPI 3.0 specs
├── schemas/                 # reusable schemas ($ref)
└── examples/               # request/response examples
```

### Контент (квесты, NPC, лор)
```
knowledge/
├── analysis/                # Аналитика и исследования
│   ├── optimization/       # Оптимизации производительности
│   ├── references/         # Ссылки и глоссарии
│   └── research/           # Исследования
├── canon/                  # Канонический лор (YAML файлы)
│   ├── lore/               # Лор и история мира
│   │   ├── characters/     # Персонажи
│   │   ├── culture/        # Культура и общество
│   │   ├── events/         # Исторические события
│   │   ├── factions/       # Фракции и организации
│   │   ├── locations/      # Локации и регионы
│   │   ├── technology/     # Технологии и наука
│   │   └── timeline/       # Хронология событий
│   ├── narrative/          # Нарратив и сюжеты
│   │   ├── cutscenes/      # Кат-сцены
│   │   ├── dialogues/      # Диалоги
│   │   ├── events/         # Сюжетные события
│   │   ├── lore/           # Нарративный лор
│   │   ├── main-story/     # Основной сюжет
│   │   ├── npc-lore/       # Лор NPC
│   │   ├── scenarios/      # Сценарии
│   │   ├── sid-endings/    # Альтернативные концовки
│   │   └── stories/        # Истории и рассказы
│   └── vision/             # Видение проекта
├── content/                # Игровые ассеты
│   ├── enemies/           # Враги и противники
│   ├── interactives/      # Интерактивные объекты
│   ├── quests/            # Квесты и задания
│   ├── raid/              # Рейды и боссы
│   ├── romantic/          # Романтические квесты
│   └── systems/           # Игровые системы
├── design/                 # Дизайн-документы
│   └── ui/                # UI/UX дизайн
├── implementation/         # Техническая реализация
│   ├── ai-systems/        # AI и нейронные сети
│   ├── algorithms/        # Алгоритмы
│   ├── analytics/         # Аналитика
│   ├── api-requirements/  # Требования к API
│   ├── api-specs/         # Спецификации API
│   ├── api-structures/    # Структуры API
│   ├── api-tech-docs/     # Техдокументация API
│   ├── architecture/      # Архитектура систем
│   ├── backend/           # Backend компоненты
│   ├── content-generation/# Генерация контента
│   ├── database/          # База данных
│   ├── frontend-backend-integration/ # Интеграция frontend-backend
│   ├── global-state/      # Глобальное состояние
│   ├── infrastructure/    # Инфраструктура
│   ├── mvp/               # MVP компоненты
│   ├── mvp-content/       # MVP контент
│   ├── mvp-data-json/     # MVP тестовые данные
│   ├── networking/        # Сетевое взаимодействие
│   ├── romance-system/    # Система романтики
│   ├── start-content/     # Стартовый контент
│   └── ui/                # UI компоненты
└── mechanics/             # Игровые механики
    ├── analytics/         # Аналитика механик
    ├── combat/            # Боевые механики
    ├── economy/           # Экономические механики
    ├── gear/              # Экипировка
    ├── items/             # Предметы
    ├── meta/              # Мета-механики
    ├── movement/          # Движение и перемещение
    ├── progression/       # Прогрессия
    ├── quests/            # Квестовые механики
    ├── skills/            # Навыки
    ├── social/            # Социальные механики
    └── weapons/           # Оружие
```

### Скрипты и автоматизация
```
scripts/
├── validate-*.sh/py        # валидация кода/архитектуры
├── import-*.sh/py         # импорт данных в БД
├── generate-*.sh/py       # генерация кода/миграций
├── deploy-*.sh/py         # развертывание
└── ci-*.sh/py            # CI/CD helpers
```

### Database миграции
```
infrastructure/liquibase/migrations/
├── V*__create_tables.sql          # DDL - структура таблиц
├── V*__add_indexes.sql            # индексы и оптимизации
└── data/
    ├── quests/V*__data_quest_*.sql    # данные квестов
    ├── npcs/V*__data_npc_*.sql        # данные NPC
    └── dialogues/V*__data_dialogue_*.sql  # данные диалогов
```

### Клиент (Unreal Engine 5)
```
client/UE5/
├── Source/{GameModule}/          # C++ классы
│   ├── Core/                    # базовые системы
│   ├── AI/                      # AI компоненты
│   ├── UI/                      # UI компоненты
│   └── Network/                 # сетевые компоненты
├── Content/                     # ассеты
└── {GameModule}.uproject        # проект UE5
```

### Конфигурация и инфраструктура
```
k8s/                            # Kubernetes манифесты
├── {service}-deployment.yaml
├── configmap-*.yaml
└── ingress.yaml

infrastructure/                 # инфраструктура
├── docker/                    # Dockerfiles
└── monitoring/               # Prometheus, Grafana

.github/workflows/             # CI/CD пайплайны
├── ci-backend.yml
├── cd-deploy.yml
└── quality-gates.yml
```

### Документация
```
.cursor/                        # правила агентов и гайды
├── rules/                     # специфичные правила
├── commands/                  # команды агентов
└── *.md                       # документация

docs/                          # проектная документация (опционально)
├── architecture/             # архитектура
└── api/                      # API документация
```

## [SYMBOL] Разрешенные файлы в корне

### [OK] Только эти типы файлов:
- `README.md` - основная документация проекта
- `CHANGELOG*.md` - история изменений и релизов
- `RELEASE_NOTES.md` - заметки о релизах
- `prompt.md` - промпт для агентов
- Основные конфигурационные файлы:
  - `.gitignore`
  - `.gitattributes`
  - `go.work` (Go workspace)
  - `docker-compose.yml` (главный compose)

### [ERROR] Запрещенные в корне:
- Любые `.py`, `.sh`, `.ps1` скрипты
- Любые YAML файлы кроме основных конфигов
- Любые временные или тестовые файлы
- Любые логи или артефакты сборки

## [SEARCH] Проверка размещения файлов

### Перед коммитом ОБЯЗАТЕЛЬНО проверить:
```bash
# Проверь нет ли запрещенных файлов в корне
find . -maxdepth 1 -name "*.py" -o -name "*.sh" -o -name "*.tmp" | head -10

# Если нашелся - ПЕРЕМЕСТИ в правильную папку!
```

### Если нашел запрещенный файл:
1. **НЕ коммить** его в корень
2. **Переместить** в правильную папку
3. **Удалить** из корня
4. **Только потом** коммитить

## [TARGET] Принцип: "Все по местам"

- **Backend код** → `services/`
- **Контент** → `knowledge/canon/`
- **Скрипты** → `scripts/`
- **Миграции** → `infrastructure/liquibase/`
- **Документация** → `.cursor/` или `docs/`
- **Корень** → только README, CHANGELOG, основные конфиги

**Корень проекта = визитная карточка. Держи его чистым и профессиональным!**

## [ALERT] КРИТИЧНЫЕ ПРАВИЛА РАБОТЫ С /knowledge

### [OK] ЧТО МОЖНО в knowledge/:

**1. `knowledge/analysis/` - Только для анализа и исследований:**
- `optimization/` - результаты оптимизации производительности
- `references/` - глоссарии, словари, ссылки
- `research/` - исследовательские материалы

**2. `knowledge/canon/` - Канонический лор (YAML файлы):**
- `lore/` - фундаментальный лор мира, персонажей, истории
- `narrative/` - нарративные элементы, диалоги, сюжеты
- `vision/` - видение проекта, философия

**3. `knowledge/content/` - Игровые ассеты:**
- `enemies/` - спецификации врагов
- `interactives/` - интерактивные объекты мира
- `quests/` - квесты и задания

**4. `knowledge/design/` - Дизайн-документы:**
- `ui/` - UI/UX дизайн интерфейсов

**5. `knowledge/implementation/` - Техническая реализация:**
- Архитектурные решения, API спецификации, технические детали

**6. `knowledge/mechanics/` - Игровые механики:**
- Спецификации всех игровых систем

### [ERROR] ЧТО ЗАПРЕЩЕНО:

**1. НИКОГДА не создавать файлы напрямую в `knowledge/`:**
```
[ERROR] knowledge/my-file.yaml          # ЗАПРЕЩЕНО!
[ERROR] knowledge/temp-analysis.md      # ЗАПРЕЩЕНО!
[ERROR] knowledge/debug-script.py       # ЗАПРЕЩЕНО!
```

**2. НИКОГДА не создавать новые корневые директории в knowledge/:**
```
[ERROR] knowledge/my-custom-folder/      # ЗАПРЕЩЕНО!
[ERROR] knowledge/backup/               # ЗАПРЕЩЕНО!
[ERROR] knowledge/archive/              # ЗАПРЕЩЕНО!
```

**3. НИКОГДА не перемещать существующие файлы без причины:**
- Файлы в knowledge/ имеют четкую структуру и назначение
- Любые перемещения должны быть обоснованы и согласованы

### [SYMBOL] Правила для агентов:

**Content Writer:**
- Работает ТОЛЬКО в `knowledge/canon/`
- Создает YAML файлы квестов, NPC, лора
- Пример: `knowledge/canon/lore/characters/jackie-welles.yaml`

**Architect:**
- Работает ТОЛЬКО в `knowledge/implementation/architecture/`
- Создает архитектурные документы
- Пример: `knowledge/implementation/architecture/quest-system-architecture.yaml`

**API Designer:**
- Работает ТОЛЬКО в `knowledge/implementation/api-specs/`
- Создает спецификации API
- Пример: `knowledge/implementation/api-specs/gameplay-api.yaml`

**UI/UX Designer:**
- Работает ТОЛЬКО в `knowledge/design/ui/`
- Создает дизайн-документы интерфейсов
- Пример: `knowledge/design/ui/hud-design.yaml`

### [SEARCH] Валидация размещения файлов:

**ПЕРЕД каждым коммитом ОБЯЗАТЕЛЬНО проверить:**
```bash
# Проверить структуру knowledge/
find knowledge/ -maxdepth 1 -type f | head -10

# Если есть файлы в корне knowledge/ - ПЕРЕМЕСТИТЬ!
# Правильные места:
# - Анализ → knowledge/analysis/
# - Лор → knowledge/canon/lore/
# - Квесты → knowledge/canon/lore/quests/
# - Дизайн → knowledge/design/
# - Реализация → knowledge/implementation/
# - Механики → knowledge/mechanics/
```

**Нарушение:** Файл в корне knowledge/ → автоматический возврат задачи!

**Правило:** Структура knowledge/ = фундамент проекта. Нарушения недопустимы!

---

**Нарушение:** Создание файла в корне → автоматический возврат задачи на исправление.

**Правило:** Чистый корень = профессиональный проект.