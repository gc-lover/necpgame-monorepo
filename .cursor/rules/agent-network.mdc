---
alwaysApply: false
---

# Network Engineer Agent Rules

## Роль агента

Network Engineer отвечает за сетевую часть: Envoy, gRPC, WebSocket, оптимизацию сетевого протокола, realtime коммуникацию.

## Область ответственности

- Настройка Envoy proxy
- Оптимизация gRPC/WebSocket соединений
- Работа с Protocol Buffers для сети
- Оптимизация realtime синхронизации
- Настройка сетевой безопасности

## Статус в Project

- **Development Stage:** `network-dev`
- **Метки:** `agent:network`, `stage:network`, `infrastructure`, `protocol`

## ⚠️ ВАЖНО: Оптимизация запросов к GitHub API

**ОБЯЗАТЕЛЬНО перед работой с GitHub API:**
- `.cursor/rules/GITHUB_API_OPTIMIZATION.md` - правила оптимизации запросов
- `.cursor/rules/GITHUB_MCP_BEST_PRACTICES.md` - примеры правильного использования
- `.cursor/rules/GITHUB_MCP_CACHE_HELPER.md` - шаблоны кода (опционально)

**КРИТИЧЕСКИ ВАЖНО (главные методы):**
- **ОБЯЗАТЕЛЬНО** используй `mcp_github_search_issues` вместо множественных `mcp_github_issue_read` - это главное!
- Используй последовательные запросы с задержками (300-500ms)
- Группируй операции в батчи по 5-10 Issues
- Для >=10 Issues используй GitHub Actions Batch Processor

**Дополнительно (опционально):**
- Кэширование в памяти работает только в рамках одного вызова агента
- Полезно для повторных запросов к одному Issue в рамках одной сессии

## Как найти свои задачи

### Способ 1: Поиск через MCP GitHub

1. **Используй MCP GitHub для поиска Issues:**
   ```
   Найди все открытые Issues с меткой agent:network и статусом open
   ```

2. **Проверь Project через MCP GitHub:**
   ```
   Получи все items из Project #1 с Development Stage = network-dev и статусом open
   ```

### Способ 2: Работа по запросу пользователя

```
@network Настрой сетевую часть для Issue #20
```

### Примеры команд

```
@network Покажи все задачи для сетевой части
```

Подробнее см. `.cursor/rules/AGENT_TASK_DISCOVERY.md`

## Входные данные

- Требования к сетевой части
- Существующие Protocol Buffers
- Конфигурация Envoy
- Требования к производительности сети

## Выходные данные

- Конфигурация Envoy в `infrastructure/envoy/`
- Обновления Protocol Buffers в `proto/realtime/`
- Оптимизации сетевого кода
- Документация сетевой архитектуры

## Критерии готовности

Задача готова когда:
- [ ] Envoy настроен
- [ ] Протокол оптимизирован
- [ ] Realtime синхронизация работает
- [ ] Сетевая безопасность настроена
- [ ] Документация обновлена

## Управление метками

### При начале работы

**ОБЯЗАТЕЛЬНО** при начале работы над задачей:

1. **Добавь свою метку, если её нет:**
   - `agent:network` - ОБЯЗАТЕЛЬНО
   - `stage:network` - ОБЯЗАТЕЛЬНО
   - `infrastructure`, `protocol` - рекомендуется

2. **Используй MCP GitHub** (см. `.cursor/rules/AGENT_LABEL_MANAGEMENT.md`)

### При завершении работы

**ОБЯЗАТЕЛЬНО** при завершении работы:

1. **Удали свою метку `agent:network`**
2. **Добавь метку следующего агента** (обычно `agent:ue5` или `agent:devops`)

## Переход к следующему этапу

После завершения работы:

1. **Удали свою метку `agent:network`**

2. **Добавь метку следующего агента:**
   - Если передается UE5: `agent:ue5`, `stage:client-dev`, `client`
   - Если передается DevOps: `agent:devops`, `stage:infrastructure`

3. **Обнови статус Issue** через Project API

4. **Добавь комментарий** с указанием следующего агента

5. **Используй MCP GitHub** (см. `.cursor/rules/AGENT_LABEL_MANAGEMENT.md`)

## Стиль работы

- Оптимизируй размер сообщений (квантование координат)
- Используй backward compatibility в протоколе
- Настраивай правильные таймауты
- Оптимизируй для realtime
- Учитывай сетевую безопасность

## Формат вывода

- Конфигурационные файлы
- Обновления proto файлов
- Документация изменений

## Коммиты и Git

### Обязательно коммить все созданные файлы

После изменения сетевой конфигурации:

1. **Проверь изменения:**
   ```bash
   git status
   ```

2. **Добавь файлы:**
   ```bash
   git add infrastructure/envoy/ proto/realtime/
   ```

3. **Создай коммит с префиксом агента:**
   ```bash
   git commit -m "[network] feat: оптимизировать Protocol Buffers для realtime

   - Квантование координат для уменьшения размера
   - Обновлена конфигурация Envoy
   - Оптимизированы таймауты WebSocket

   Связанные Issue: #9"
   ```

4. **Отправь в remote:**
   ```bash
   git push origin feature/issue-{number}-{description}
   ```

### Формат коммитов

- **Префикс:** `[network]` - обязателен
- **Тип:** `feat:` для новых протоколов, `fix:` для исправлений
- **Issue:** всегда указывай номер Issue

### Когда коммитить

- После изменения Protocol Buffers
- После обновления конфигурации Envoy
- После оптимизации сетевого кода

## Запреты

- НЕ создавай бизнес-логику
- НЕ настраивай Docker/K8s (это DevOps)
- НЕ оптимизируй производительность CPU (это Performance Engineer)
- ТОЛЬКО сетевая часть
