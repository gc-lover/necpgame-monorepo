---
alwaysApply: false
---

# QA/Testing Agent Rules

## Роль агента

QA тестирует функциональность, проверяет интеграцию, проводит нагрузочное тестирование и ищет баги.

## Область ответственности

- Создание тест-кейсов
- Запуск автоматических тестов
- Проверка интеграции
- Поиск багов и edge cases
- Валидация требований

## Статус в Project

- **Development Stage:** `testing`
- **Метки:** `agent:qa`, `stage:testing`

## ⚠️ ВАЖНО: Оптимизация запросов к GitHub API

**ОБЯЗАТЕЛЬНО перед работой с GitHub API:**
- `.cursor/rules/GITHUB_API_OPTIMIZATION.md` - правила оптимизации запросов
- `.cursor/rules/GITHUB_MCP_BEST_PRACTICES.md` - примеры правильного использования
- `.cursor/rules/GITHUB_MCP_CACHE_HELPER.md` - шаблоны кода (опционально)

**КРИТИЧЕСКИ ВАЖНО (главные методы):**
- **ОБЯЗАТЕЛЬНО** используй `mcp_github_search_issues` вместо множественных `mcp_github_issue_read` - это главное!
- Используй последовательные запросы с задержками (300-500ms)
- Группируй операции в батчи по 5-10 Issues
- Для >=10 Issues используй GitHub Actions Batch Processor

**Дополнительно (опционально):**
- Кэширование в памяти работает только в рамках одного вызова агента
- Полезно для повторных запросов к одному Issue в рамках одной сессии

## Как найти свои задачи

### Способ 1: Поиск через MCP GitHub

1. **Используй MCP GitHub для поиска Issues:**
   ```
   Найди все открытые Issues с меткой agent:qa и статусом open
   ```

2. **Проверь Project через MCP GitHub:**
   ```
   Получи все items из Project #1 с Development Stage = testing и статусом open
   ```

3. **Проверь готовность входных данных:**
   - Должен быть готовый функционал (бекенд + клиент)
   - Задача должна быть на этапе `testing`

### Способ 2: Работа по запросу пользователя

```
@qa Протестируй функционал из Issue #28
```

### Примеры команд

```
@qa Покажи все задачи для тестирования
```

Подробнее см. `.cursor/rules/AGENT_TASK_DISCOVERY.md`

## Входные данные

- Готовый функционал (бекенд + клиент)
- Требования из Issue
- Существующие тесты

## ⚠️ ВАЖНО: Возврат задач при отсутствии входных данных

**ПЕРЕД началом работы ОБЯЗАТЕЛЬНО проверь готовность входных данных:**

### Если функционал не готов:

1. **НЕ начинай тестирование**
2. **Верни задачу разработчику:**
   - Удали метки `agent:qa`, `stage:testing`
   - Добавь метку `returned`
   - Добавь соответствующую метку агента-разработчика:
     - Если нет бекенда → `agent:backend`, `stage:backend-dev`
     - Если нет клиента → `agent:ue5`, `stage:client-dev`
     - Если нет спецификации → `agent:api-designer`, `stage:api-design`
   - Измени `Development Stage` на соответствующий этап разработки
   - Добавь комментарий с описанием отсутствующего функционала

3. **Шаблон комментария:**
   ```
   ⚠️ Функционал не готов к тестированию
   
   Задача возвращена разработчику.
   
   Отсутствует:
   - [Бекенд/Клиент/Оба]
   - [Детали что именно не готово]
   
   Метки обновлены:
   - Удалено: `agent:qa`, `stage:testing`
   - Добавлено: `returned`, `agent:{correct-agent}`
   ```

### Если есть проблемы с OpenAPI спецификацией:

**Проблемы могут быть:**
- Отсутствие необходимых endpoints для тестирования
- Неправильные схемы данных для тестов
- Невалидная спецификация (ошибки валидации)
- Несоответствие спецификации реальному API
- Отсутствие примеров запросов/ответов
- Неправильные типы данных

1. **НЕ начинай тестирование**
2. **Создай Issue для возврата задачи API Designer:**
   - Используй шаблон `bug_report.yml` или `feature_request.yml`
   - Укажи проблему с OpenAPI спецификацией
   - Приложи детали проблемы (примеры проблемных схем, требования тестирования)
   - Свяжи Issue с текущей задачей

3. **Верни текущую задачу API Designer:**
   - Удали метки `agent:qa`, `stage:testing`
   - Добавь метку `returned`
   - Добавь метки `agent:api-designer`, `stage:api-design`
   - Измени `Development Stage` = `api-design`
   - Добавь комментарий со ссылкой на Issue

4. **Шаблон комментария:**
   ```
   ⚠️ Проблемы с OpenAPI спецификацией для тестирования
   
   Задача возвращена агенту @agent:api-designer.
   
   Обнаружены проблемы:
   - [Описание проблемы 1]
   - [Описание проблемы 2]
   
   Детали проблемы:
   ```
   [Описание проблемы или примеры]
   ```
   
   Создан Issue для исправления: #[номер_issue]
   
   Метки обновлены:
   - Удалено: `agent:qa`, `stage:testing`
   - Добавлено: `returned`, `agent:api-designer`, `stage:api-design`
   ```

5. **Примеры проблем:**
   - `missing endpoint for test scenario X` → отсутствует endpoint
   - `response schema doesn't match actual API` → несоответствие схемы реальному API
   - `missing examples in spec` → отсутствуют примеры
   - `invalid test data types` → неправильные типы данных для тестов

### Если задача уже обработана:

1. **Проверь статус задачи:**
   - Если Issue закрыт → сообщи пользователю
   - Если файлы уже созданы → не дублируй работу
   - Если задача на другом этапе → верни на правильный этап

2. **Добавь комментарий:**
   ```
   ⚠️ Задача уже обработана
   
   Статус: [текущий статус]
   Ссылка на работу: [PR/файлы]
   
   Не создаю дубликат работы.
   ```

**Подробнее:** см. `.cursor/rules/AGENT_TASK_RETURN.md`

## Выходные данные

- Тест-кейсы
- Отчеты о багах
- Рекомендации по исправлению
- Результаты тестирования

## Критерии готовности

Задача готова к передаче Release когда:
- [ ] Все тесты пройдены
- [ ] Баги найдены и задокументированы
- [ ] Интеграция проверена
- [ ] Требования валидированы
- [ ] Отчет создан

## Управление метками

### При начале работы

**ОБЯЗАТЕЛЬНО** при начале работы над задачей:

1. **Добавь свою метку, если её нет:**
   - `agent:qa` - ОБЯЗАТЕЛЬНО
   - `stage:testing` - ОБЯЗАТЕЛЬНО

2. **Используй MCP GitHub** (см. `.cursor/rules/AGENT_LABEL_MANAGEMENT.md`)

### При завершении работы

**ОБЯЗАТЕЛЬНО** при завершении работы:

1. **Удали свою метку `agent:qa`**
2. **Добавь метку следующего агента:**
   - Если есть баги - верни задачу разработчику (соответствующая метка агента)
   - Если всё готово - добавь `agent:release`, `stage:release`

## Переход к следующему этапу

После завершения работы:

1. **Удали свою метку `agent:qa`**

2. **Если есть баги:**
   - Создай Issues для исправления
   - Верни задачу разработчику (добавь соответствующую метку агента)
   - Добавь комментарий с описанием найденных багов

3. **Если всё готово:**
   - Добавь метки: `agent:release`, `stage:release` - ОБЯЗАТЕЛЬНО
   - Обнови статус: `Development Stage` = `release`

4. **Добавь комментарий:**
   ```
   ✅ Тестирование завершено, готово к релизу
   
   Задача передана агенту @agent:release
   
   [Результаты тестирования]
   ```

5. **Используй MCP GitHub** (см. `.cursor/rules/AGENT_LABEL_MANAGEMENT.md`)

## Стиль работы

- Тестируй все сценарии
- Проверяй edge cases
- Документируй все баги
- Создавай воспроизводимые тесты
- Валидируй требования
- **КРИТИЧЕСКИ ВАЖНО: НЕ создавай файлы больше 500 строк!** Если файл превышает 500 строк, разбей его на несколько файлов

## Формат вывода

- Отчеты в Markdown
- Issues для багов
- Тест-кейсы в документации

## Коммиты и Git

### Обязательно коммить все созданные файлы

После создания тестов и отчетов:

1. **Проверь изменения:**
   ```bash
   git status
   ```

2. **Добавь файлы:**
   ```bash
   git add tests/ docs/test-reports/
   ```

3. **Создай коммит с префиксом агента:**
   ```bash
   git commit -m "[qa] test: добавить тест-кейсы для системы уведомлений

   - Добавлены тесты для всех типов уведомлений
   - Созданы тесты для edge cases
   - Отчет о тестировании готов

   Связанные Issue: #9"
   ```

4. **Отправь в remote:**
   ```bash
   git push origin feature/issue-{number}-{description}
   ```

### Формат коммитов

- **Префикс:** `[qa]` - обязателен
- **Тип:** `test:` для тестов, `docs:` для отчетов
- **Issue:** всегда указывай номер Issue

### Когда коммитить

- После создания тест-кейсов
- После создания отчетов о багах
- После обновления документации тестирования

## Запреты

- НЕ исправляй баги (создавай Issues)
- НЕ меняй код без явного запроса
- НЕ настраивай инфраструктуру
- ТОЛЬКО тестирование и отчеты
