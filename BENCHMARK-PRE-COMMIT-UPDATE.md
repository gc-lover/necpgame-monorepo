# üîÑ Pre-commit Hook Update - Benchmark Results Collection

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** Pre-commit hook —Ç–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±–µ–Ω—á–º–∞—Ä–∫–æ–≤ –≤ `.benchmarks/results/`

---

## OK –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –î–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
- ‚ùå Pre-commit hook –∑–∞–ø—É—Å–∫–∞–ª —Ç–æ–ª—å–∫–æ `bench-quick` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚ùå –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å
- ‚ùå –ù–µ –±—ã–ª–æ –∏—Å—Ç–æ—Ä–∏–∏ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤

### –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
- OK Pre-commit hook –∑–∞–ø—É—Å–∫–∞–µ—Ç `bench-quick` —Å JSON output
- OK –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ `.benchmarks/results/pre-commit_TIMESTAMP.json`
- OK –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –¥–∞—à–±–æ—Ä–¥–µ
- OK –ò—Å—Ç–æ—Ä–∏—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

---

## üìã –§–æ—Ä–º–∞—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```json
{
  "timestamp": "20251204_143022",
  "source": "pre-commit",
  "services": [
    {
      "service": "loot-service-go",
      "benchmarks": [
        {
          "name": "server/BenchmarkGetPlayerLootHistory",
          "ns_per_op": 200.2,
          "allocs_per_op": 5,
          "bytes_per_op": 320
        }
      ]
    }
  ]
}
```

**–û—Ç–ª–∏—á–∏—è –æ—Ç –ø–æ–ª–Ω—ã—Ö –±–µ–Ω—á–º–∞—Ä–∫–æ–≤:**
- `source: "pre-commit"` - –º–µ—Ç–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- `benchtime=100ms` - –±—ã—Å—Ç—Ä—ã–µ –±–µ–Ω—á–º–∞—Ä–∫–∏ (–º–µ–Ω—å—à–µ —Ç–æ—á–Ω–æ—Å—Ç—å)
- –¢–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
```bash
# –ü—Ä–∏ –∫–æ–º–º–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
git add services/loot-service-go/server/handlers.go
git commit -m "feat: update handler"
# ‚Üí –°–æ–∑–¥–∞–µ—Ç—Å—è .benchmarks/results/pre-commit_YYYYMMDD_HHMMSS.json
```

### –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:
```bash
SKIP_BENCHMARKS=1 git commit -m "message"
```

---

## üìä –ü—Ä–æ—Å–º–æ—Ç—Ä –≤ –¥–∞—à–±–æ—Ä–¥–µ

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã pre-commit –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –¥–∞—à–±–æ—Ä–¥–µ:
- –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:8080`
- –§–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ —Å–µ—Ä–≤–∏—Å–∞–º
- –°–º–æ—Ç—Ä–∏—Ç–µ —Ç—Ä–µ–Ω–¥—ã (–≤–∫–ª—é—á–∞—è pre-commit —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)

---

## WARNING –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- `jq` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON
- –ï—Å–ª–∏ `jq` –Ω–µ –Ω–∞–π–¥–µ–Ω, hook –≤—Å–µ —Ä–∞–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç JSON

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ jq:**
```bash
# Ubuntu/Debian
sudo apt-get install jq

# macOS
brew install jq

# Windows (PowerShell)
choco install jq
```

---

## üîç –û—Ç–ª–∏—á–∏—è –æ—Ç –ø–æ–ª–Ω—ã—Ö –±–µ–Ω—á–º–∞—Ä–∫–æ–≤

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | Pre-commit | –ü–æ–ª–Ω—ã–µ (CI) |
|----------------|------------|-------------|
| –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | 100ms | –ü–æ–ª–Ω–∞—è |
| –¢–æ—á–Ω–æ—Å—Ç—å | –ù–∏–∂–µ | –í—ã—Å–æ–∫–∞—è |
| –°–µ—Ä–≤–∏—Å—ã | –¢–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ | –í—Å–µ |
| –ò—Å—Ç–æ—á–Ω–∏–∫ | `pre-commit` | `benchmarks.yml` |
| –§–∞–π–ª | `pre-commit_*.json` | `benchmarks_*.json` |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ pre-commit –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏, –ø–æ–ª–Ω—ã–µ –±–µ–Ω—á–º–∞—Ä–∫–∏ - –¥–ª—è —Ç–æ—á–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π.

---

**–°–º. —Ç–∞–∫–∂–µ:**
- `AUTOMATIC-BENCHMARKS-GUIDE.md` - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- `.githooks/pre-commit` - –∫–æ–¥ hook'–∞

