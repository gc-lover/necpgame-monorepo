--liquibase formatted sql

--changeset kiev-part1-quests:canon-quest-kiev-sophia-cathedral runOnChange:true

INSERT INTO gameplay.quests (
    id,
    metadata_id,
    title,
    english_title,
    type,
    location,
    time_period,
    difficulty,
    estimated_duration,
    player_level_min,
    player_level_max,
    status,
    version,
    quest_definition,
    narrative_context,
    gameplay_mechanics,
    additional_npcs,
    environmental_challenges,
    visual_design,
    cultural_elements,
    metadata_hash,
    content_hash,
    created_at,
    updated_at,
    source_file
) VALUES (
    '3beeba16-2806-468a-a657-e8d8c51e8445',
    'canon-quest-kiev-sophia-cathedral',
    'Киев 2020-2029 — «Софийский собор»',
    'Киев 2020-2029 — «Софийский собор»',
    'side',
    'Kiev',
    '2020-2029',
    'easy',
    '30-60 минут',
    1,
    NULL,
    'active',
    '1.0.0',
    '{
  "quest_type": "side",
  "level_min": 1,
  "level_max": null
}',
    '[
  {
    "id": "overview",
    "title": "Обзор: Киев 2020-2029 — «Софийский собор»",
    "body": "Этот side квест \"Киев 2020-2029 — «Софийский собор»\" предлагает увлекательное исследование и взаимодействие с миром игры.",
    "mechanics_links": [],
    "assets": []
  },
  {
    "id": "stages",
    "title": "Этапы выполнения",
    "body": "Этапы квеста:\n",
    "mechanics_links": [],
    "assets": []
  },
  {
    "id": "introduction",
    "title": "Знакомство с собором",
    "body": "Квест начинается у входа в Софийский собор. Игрок получает информационное сообщение о культурном значении места.\n\n**Сценарий старта:**\nИгрок подходит к собору и видит информационную табличку ЮНЕСКО. Система предлагает квест \"Паломничество в Софию\".\n\n**Диалог с виртуальным гидом:**\n\"Добро пожаловать в Софийский собор - жемчужину украинской культуры, построенную Ярославом Мудрым в XI веке. Готовы ли вы прикоснуться к тысячелетней истории?\"\n\n**Выборы:**\n- \"Да, я хочу узнать больше\" → квест принят\n- \"Просто осмотр\" → доступ к базовому исследованию без квеста\n- \"Не сейчас\" → отказ, квест доступен позже\n\n**Исторический контекст:**\nСобор основан в 1037 году князем Ярославом Мудрым. Внесен в список Всемирного наследия ЮНЕСКО. Сохранились уникальные мозаики и фрески XI века.\n",
    "mechanics_links": [
      "dialogue-system",
      "quest-acceptance"
    ],
    "assets": [
      "location-sofia-cathedral-exterior",
      "npc-virtual-guide"
    ]
  },
  {
    "id": "exterior_exploration",
    "title": "Внешний осмотр собора",
    "body": "Игрок исследует внешнюю архитектуру собора, изучая его исторические особенности.\n\n**Уровень 1: Базовое исследование**\n- Осмотр золотых куполов (13 куполов символизируют Христа и 12 апостолов)\n- Изучение древних стен и фундамента\n- Знакомство с архитектурными стилями (византийское влияние)\n\n**Интерактивные элементы:**\n- Информационные таблички с историческими фактами\n- Мини-игры на распознавание архитектурных элементов\n- Фотографирование для коллекции достижений\n\n**Проверка культуры:** Culture DC 12 → дополнительные исторические факты\n**Награда за уровень:** +5 XP, +1 к культуре, разблокировка следующего уровня\n",
    "mechanics_links": [
      "culture-skill-checks",
      "exploration-mechanics",
      "mini-games"
    ],
    "assets": [
      "cathedral-exterior-details",
      "info-panels"
    ]
  },
  {
    "id": "interior_discovery",
    "title": "Интерьер собора",
    "body": "Игрок входит внутрь собора и изучает его внутреннее убранство.\n\n**Уровень 2: Внутреннее пространство**\n- Центральный неф с колоннами\n- Алтарная часть с древними мозаиками\n- Бело-золотая цветовая гамма\n\n**Ключевые артефакты:**\n- Мозаика \"Оранта\" (Богоматерь с распростертыми руками)\n- Фрески с изображениями святых\n- Древние иконы и резьба по камню\n\n**Интерактивные открытия:**\n- Подробное изучение мозаик с увеличением\n- Прослушивание исторических аудиогидов\n- Виртуальные реконструкции первоначального вида\n\n**Проверка культуры:** Culture DC 15 → глубокий анализ символики\n**Награда за уровень:** +10 XP, +2 к культуре, доступ к мозаикам\n",
    "mechanics_links": [
      "artifact-examination",
      "audio-visual-systems",
      "culture-progression"
    ],
    "assets": [
      "cathedral-interior-3d",
      "mosaic-details",
      "historical-reconstructions"
    ]
  },
  {
    "id": "mosaics_frescoes",
    "title": "Мозаики и фрески XI века",
    "body": "Глубокое исследование уникальных произведений искусства собора.\n\n**Уровень 3: Искусство и символика**\n- Анализ техники мозаичного искусства (золотые и разноцветные смальты)\n- Изучение фресковой живописи (портреты князей и святых)\n- Расшифровка религиозных символов\n\n**Уникальные открытия:**\n- Скрытые символы в мозаиках (геометрические узоры)\n- Исторические надписи на древнерусском языке\n- Восстановленные фрагменты утраченных росписей\n\n**Духовный аспект:**\n- Медитация у мозаики Оранты для духовного бонуса\n- Осознание культурного наследия Украины\n\n**Проверка культуры:** Culture DC 18 → экспертный анализ\n**Награда за уровень:** +15 XP, +3 к культуре, духовный бафф\n",
    "mechanics_links": [
      "spiritual-mechanics",
      "expert-analysis",
      "cultural-insights"
    ],
    "assets": [
      "high-res-mosaic-scans",
      "fresco-details",
      "symbolic-analysis-tools"
    ]
  },
  {
    "id": "bell_tower_ascent",
    "title": "Подъем на колокольню",
    "body": "Кульминация квеста - подъем на колокольню высотой 76 метров.\n\n**Уровень 4: Небесный подъем**\n- Винтовая лестница с 200 ступенями\n- Исторические колокола (XV-XVIII века)\n- Панорамный вид на Киев\n\n**Символическое значение:**\n- Подъем как метафора духовного роста\n- Звон колоколов как очищение души\n- Вид на город как связь прошлого и настоящего\n\n**Интерактивные элементы:**\n- Ручной звон в колокол (ограниченное время)\n- Осмотр колоколов с аудиогидом\n- Фотографирование панорамы для коллекции\n\n**Духовный пик:**\n- Временный бафф \"Благословение Софии\" (+10% к духовным действиям)\n- Воспоминания о культурном наследии\n\n**Проверка культуры:** Culture DC 20 → максимальные награды\n**Награда за уровень:** +20 XP, +4 к культуре, достижение \"Паломник Софии\"\n",
    "mechanics_links": [
      "elevation-mechanics",
      "spiritual-buffs",
      "achievement-system"
    ],
    "assets": [
      "bell-tower-interior",
      "panoramic-views",
      "bell-sound-samples"
    ]
  },
  {
    "id": "reflection_meditation",
    "title": "Размышления и завершение",
    "body": "Финальная фаза квеста - духовные размышления и подведение итогов.\n\n**Уровень 5: Духовное осмысление**\n- Медитация в тихом уголке собора\n- Осознание культурного значения места\n- Связь с тысячелетней историей Украины\n\n**Личные открытия:**\n- Внутренние монологи о значении культуры\n- Понимание роли наследия в современном мире\n- Мотивация к дальнейшим культурным исследованиям\n\n**Духовные награды:**\n- Постоянный бонус к культуре\n- Доступ к специальным культурным квестам\n- Укрепление связи с украинской культурой\n\n**Финальное достижение:** \"Хранитель Софии\"\n",
    "mechanics_links": [
      "meditation-system",
      "character-development",
      "cultural-progression"
    ],
    "assets": [
      "meditation-scenes",
      "reflection-dialogues"
    ]
  },
  {
    "id": "rewards_completion",
    "title": "Награды и последствия",
    "body": "В зависимости от глубины исследования игрок получает соответствующие награды.\n\n**Базовые награды (все уровни):**\n- 1000 XP\n- +10 к параметру \"Культура\"\n- Достижение \"Посетитель Софии\"\n\n**Расширенные награды (3+ уровня):**\n- Дополнительные 500 XP\n- +5 к параметру \"Духовность\"\n- Доступ к коллекции \"Украинское наследие\"\n\n**Полные награды (все уровни):**\n- Дополнительные 1000 XP\n- +10 к обоим параметрам\n- Достижение \"Паломник Софии\"\n- Временный бафф \"Благословение Софии\" (24 часа)\n\n**Долгосрочные эффекты:**\n- Повышенная репутация в культурных кругах Киева\n- Доступ к специальным культурным событиям\n- Бонусы к взаимодействию с украинскими NPC\n- Возможность стать \"Культурным послом\" города\n\n**Экономический аспект:**\n- Возможность сделать пожертвование (-20 едди за дополнительные благословения)\n- Продажа фотографий и впечатлений (+50 едди)\n",
    "mechanics_links": [
      "reward-system",
      "reputation-system",
      "achievement-system",
      "economic-system"
    ],
    "assets": [
      "reward-screens",
      "achievement-icons",
      "cultural-collection-items"
    ]
  },
  {
    "id": "technical_details",
    "title": "Технические детали реализации",
    "body": "**Система прогресса:**\n- Quest progress: 0-100% с чекпоинтами на каждом уровне\n- Culture skill progression: базовый/продвинутый/эксперт\n- Discovery counter: уникальные открытия и артефакты\n\n**Интеграция с системами:**\n- Culture system: навык исследования и понимания искусства\n- Spirituality system: духовные баффы и медитация\n- Achievement system: коллекция культурных достижений\n\n**Баланс и тестирование:**\n- DC проверки откалиброваны для среднего уровня 20-40\n- Время прохождения: 1-2 часа\n- Риск провала: минимальный (информативные подсказки)\n",
    "mechanics_links": [
      "quest-progression",
      "balance-system",
      "integration-points"
    ],
    "assets": [
      "quest-tracker-ui",
      "culture-skill-tree",
      "balance-spreadsheets"
    ]
  }
]',
    '{}',
    '[]',
    '[]',
    '{}',
    '{}',
    'd0332c71b6341d618a8e6ab791fa3b0ddb9e2df860831c2e37eea782a9eee8f8',
    '30b6ef117de8ccfc3a6efc93066aba3c6b3a1b9ab4e38ab5ebe825e3296220eb',
    CURRENT_TIMESTAMP,
    CURRENT_TIMESTAMP,
    'knowledge\canon\lore\timeline-author\quests\cis\kiev\2020-2029\quest-007-sophia-cathedral.yaml'
);

--rollback DELETE FROM gameplay.quests WHERE metadata_id = 'canon-quest-kiev-sophia-cathedral';

