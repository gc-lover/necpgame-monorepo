databaseChangeLog:
- changeSet:
    id: documentation-announcement-data-flows-b69aeefd
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '6504765259954062'
        - column:
            name: doc_id
            value: announcement-data-flows
        - column:
            name: title
            value: Архитектура системы объявлений - Потоки данных и синхронизация
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.1.0
        - column:
            name: last_updated
            value: 2025-11-30 20:30:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[]'
        - column:
            name: tags
            value: []
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value: []
        - column:
            name: related_documents
            value: '[{"id": "announcement-core", "relation": "extends"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: ''
        - column:
            name: audience
            value: []
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "announcement-data-flows", "title": "Архитектура
              системы объявлений - Потоки данных и синхронизация", "document_type":
              "architecture", "category": "systems", "status": "draft", "version":
              "1.1.0", "last_updated": "2025-11-30T20:30:00+00:00", "github_issue":
              323, "related_documents": [{"id": "announcement-core", "relation": "extends"}]},
              "data_flows": {"publication_flow": "1. Администратор создает объявление
              через Admin API\n2. Announcement Publisher сохраняет объявление в БД\n3.
              Announcement Targeting Manager настраивает таргетинг\n4. Announcement
              Scheduler планирует публикацию (если запланировано)\n5. Announcement
              Publisher публикует объявление\n6. Announcement Delivery Manager определяет
              целевую аудиторию\n7. Announcement Delivery Manager доставляет объявление
              через каналы\n8. Announcement Service публикует событие announcement.published\n9.
              Notification Service отправляет уведомления\n10. Realtime Gateway отправляет
              обновление клиентам\n", "delivery_flow": "1. Объявление опубликовано
              или запланировано\n2. Announcement Delivery Manager получает список
              целевой аудитории\n3. Announcement Targeting Manager фильтрует аудиторию
              по критериям\n4. Announcement Delivery Manager выбирает каналы доставки\n5.
              Announcement Delivery Manager доставляет через in-game канал\n6. Notification
              Service доставляет через push/email каналы\n7. Announcement Read Tracker
              отслеживает доставку\n8. Announcement Service публикует событие announcement.delivered\n9.
              Realtime Gateway отправляет обновление клиентам\n", "read_tracking_flow":
              "1. Игрок видит объявление в клиенте\n2. Клиент отправляет событие displayed\n3.
              Announcement Read Tracker фиксирует отображение\n4. Игрок читает объявление\n5.
              Клиент отправляет событие read\n6. Announcement Read Tracker фиксирует
              прочтение\n7. Announcement Service публикует событие announcement.read\n8.
              Analytics Service собирает метрики\n"}, "data_consistency": {"strategy":
              "Strong Consistency (ACID транзакции) для критичных операций (создание,
              публикация объявлений)", "mechanisms": ["ACID транзакции для создания
              объявлений, публикации и планирования", "Оптимистичные блокировки (versioning)
              для предотвращения конфликтов при обновлении объявлений", "Валидация
              перед публикацией объявлений", "Синхронизация с другими сервисами через
              Event Bus", "Outbox Pattern для гарантированной доставки событий", "Saga
              Pattern для распределенных операций (публикация объявлений, доставка,
              отслеживание прочтений)"]}, "data_synchronization": {"event_sourcing":
              "Все изменения состояния объявлений (создание, обновление, публикация,
              доставка, прочтение)\nзаписываются как события в Event Store.\nЭто обеспечивает
              полный аудит, возможность восстановления состояния и \"time travel\"
              для отладки.\nПримеры событий: AnnouncementCreatedEvent, AnnouncementPublishedEvent,
              AnnouncementDeliveredEvent, AnnouncementReadEvent.\n", "cqrs_pattern":
              "Разделение команд (создание объявлений, публикация, планирование) и
              запросов\n(получение списка объявлений, получение новостной ленты, получение
              статистики) для оптимизации производительности\nи масштабируемости.
              Read-модели могут быть кэшированы в Redis для быстрых запросов.\n",
              "saga_pattern": "Для распределенных транзакций, таких как публикация
              объявления (публикация, определение целевой аудитории,\nдоставка через
              каналы, уведомление игроков) или доставка объявления (фильтрация аудитории,
              выбор каналов,\nдоставка через in-game/push/email, отслеживание доставки),
              используется Saga Pattern\nдля обеспечения атомарности операций между
              Announcement Service, Notification Service, Character Service и Realtime
              Gateway.\n", "outbox_pattern": "Для гарантированной доставки событий
              в Event Bus используется Outbox Pattern,\nкоторый записывает события
              в транзакционную таблицу перед публикацией.\n"}, "tickrate_specification":
              {"announcement_operations": {"tickrate": "Event-based (on-demand)",
              "network_load": "- Создание объявления: event-based, ~0.001-0.01 events/sec
              (административные операции)\n- Получение списка объявлений: event-based,
              ~0.01-0.05 requests/sec на игрока\n- Получение новостной ленты: event-based,
              ~0.01-0.05 requests/sec на игрока\n- Общий трафик: ~0.1-0.3 KB/sec на
              игрока для операций объявлений\n", "latency_requirements": "< 100-200ms
              для создания объявления, < 30-100ms для получения списка", "sync_strategy":
              "Strong Consistency (ACID транзакции) для создания объявлений, Eventual
              Consistency для получения списка"}, "publication_operations": {"tickrate":
              "Event-based (on-demand при публикации) + cron-triggered для запланированных
              объявлений", "network_load": "- Публикация объявления: event-based,
              ~0.001-0.01 events/sec\n- Планирование публикации: event-based, ~0.001-0.01
              events/sec\n- Запланированные публикации: cron-triggered, ~0.001-0.01
              events/sec\n- Общий трафик: ~0.1-0.3 KB/sec для операций публикации\n",
              "latency_requirements": "< 200-300ms для публикации объявления, < 100-200ms
              для планирования", "sync_strategy": "Strong Consistency (ACID транзакции)
              для публикации объявлений"}, "delivery_operations": {"tickrate": "Event-based
              (on-demand при публикации) + 1-5 Hz для обновления статуса доставки",
              "network_load": "- Доставка объявления: event-based, ~0.01-0.1 events/sec\n-
              Обновление статуса доставки: 1-5 Hz, ~0.01-0.05 events/sec\n- Общий
              трафик: ~0.2-0.5 KB/sec для операций доставки\n", "latency_requirements":
              "< 200-500ms для доставки объявления, < 50-100ms для обновления статуса",
              "sync_strategy": "Eventual Consistency для доставки объявлений (через
              Notification Service)"}, "targeting_operations": {"tickrate": "Event-based
              (on-demand при публикации)", "network_load": "- Определение целевой
              аудитории: event-based, ~0.001-0.01 events/sec\n- Фильтрация по критериям:
              event-based, ~0.001-0.01 events/sec\n- Общий трафик: ~0.1-0.3 KB/sec
              для операций таргетинга\n", "latency_requirements": "< 100-300ms для
              определения целевой аудитории", "sync_strategy": "Eventual Consistency
              для таргетинга (кэширование результатов)"}, "read_tracking_operations":
              {"tickrate": "Event-based (on-demand при взаимодействии) + 1-5 Hz для
              обновления статистики", "network_load": "- Отметка о прочтении: event-based,
              ~0.01-0.1 events/sec на игрока\n- Отслеживание взаимодействий: event-based,
              ~0.01-0.05 events/sec на игрока\n- Обновление статистики: 1-5 Hz, ~0.01-0.05
              events/sec\n- Общий трафик: ~0.2-0.5 KB/sec на игрока для операций отслеживания\n",
              "latency_requirements": "< 50-100ms для отметки о прочтении, < 30-100ms
              для обновления статистики", "sync_strategy": "Eventual Consistency для
              отслеживания прочтений (батчинг событий)"}, "feed_operations": {"tickrate":
              "Event-based (on-demand) + 1-5 Hz для обновления новостной ленты", "network_load":
              "- Получение новостной ленты: event-based, ~0.01-0.05 requests/sec на
              игрока\n- Обновление новостной ленты: 1-5 Hz, ~0.01-0.05 events/sec
              на игрока\n- Получение непрочитанных: event-based, ~0.01-0.02 requests/sec
              на игрока\n- Общий трафик: ~0.1-0.3 KB/sec на игрока для операций новостной
              ленты\n", "latency_requirements": "< 30-100ms для получения новостной
              ленты, < 50-100ms для обновления", "sync_strategy": "Eventual Consistency
              для новостной ленты (кэширование в Redis)"}, "patch_notes_operations":
              {"tickrate": "Event-based (on-demand)", "network_load": "- Получение
              списка патчноутов: event-based, ~0.001-0.01 requests/sec на игрока\n-
              Получение патчноута по версии: event-based, ~0.001-0.01 requests/sec
              на игрока\n- Создание патчноута: event-based, ~0.001-0.01 events/sec
              (административные операции)\n- Общий трафик: ~0.1-0.3 KB/sec для операций
              патчноутов\n", "latency_requirements": "< 30-100ms для получения патчноутов,
              < 100-200ms для создания", "sync_strategy": "Strong Consistency (ACID
              транзакции) для создания патчноутов, Eventual Consistency для получения"},
              "stats_operations": {"tickrate": "Event-based (on-demand при запросе)
              + 1-5 Hz для обновления статистики", "network_load": "- Получение статистики:
              event-based, ~0.001-0.01 requests/sec на игрока\n- Обновление статистики:
              1-5 Hz, ~0.01-0.05 events/sec\n- Общий трафик: ~0.1-0.3 KB/sec для операций
              статистики\n", "latency_requirements": "< 30-100ms для получения статистики,
              < 50-100ms для обновления", "sync_strategy": "Eventual Consistency для
              статистики (кэширование в Redis)"}, "event_handling": {"tickrate": "Event-based
              (on-demand)", "network_load": "- Публикация событий объявлений: event-based,
              ~0.1-0.5 events/sec\n- Подписка на события: event-based, ~0.05-0.2 events/sec\n-
              Общий трафик: ~0.2-0.7 KB/sec для событий\n", "latency_requirements":
              "< 100-300ms для публикации событий", "sync_strategy": "Eventual Consistency
              для событий (через Event Bus)"}}}'
        - column:
            name: metadata
            value: '{"id": "announcement-data-flows", "title": "Архитектура системы
              объявлений - Потоки данных и синхронизация", "document_type": "architecture",
              "category": "systems", "status": "draft", "version": "1.1.0", "last_updated":
              "2025-11-30T20:30:00+00:00", "github_issue": 323, "related_documents":
              [{"id": "announcement-core", "relation": "extends"}]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\announcement-data-flows.yaml
