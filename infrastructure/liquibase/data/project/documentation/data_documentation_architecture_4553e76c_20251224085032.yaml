databaseChangeLog:
- changeSet:
    id: documentation-architecture-4553e76c
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '-103095310924304'
        - column:
            name: doc_id
            value: narrative-coherence-event-matrix-architecture
        - column:
            name: title
            value: Архитектура графа событий
        - column:
            name: document_type
            value: canon
        - column:
            name: category
            value: narrative-coherence
        - column:
            name: status
            value: approved
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-13 00:00:00+00:00
        - column:
            name: concept_approved
            value: true
        - column:
            name: concept_reviewed_at
            value: 2025-11-06 23:29:00+00:00
        - column:
            name: owners
            value: '[{"role": "narrative_lead", "contact": "narrative@necp.game"}]'
        - column:
            name: tags
            value:
            - event-matrix
            - quest-graph
            - world-state
        - column:
            name: topics
            value:
            - dynamic-content
            - narrative-systems
        - column:
            name: related_systems
            value:
            - gameplay-service
            - narrative-service
        - column:
            name: related_documents
            value: '[{"id": "narrative-coherence-quest-dependencies-graph", "relation":
              "references"}, {"id": "narrative-coherence-world-state-graph", "relation":
              "references"}]'
        - column:
            name: source
            value: shared/docs/knowledge/canon/narrative/narrative-coherence/phase3-event-matrix/architecture.md
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - concept
            - narrative
            - backend
        - column:
            name: risk_level
            value: medium
        - column:
            name: content
            value: '{"metadata": {"id": "narrative-coherence-event-matrix-architecture",
              "title": "Архитектура графа событий", "document_type": "canon", "category":
              "narrative-coherence", "status": "approved", "version": "1.0.0", "last_updated":
              "2025-11-13T00:00:00+00:00", "concept_approved": true, "concept_reviewed_at":
              "2025-11-06T23:29:00+00:00", "owners": [{"role": "narrative_lead", "contact":
              "narrative@necp.game"}], "tags": ["event-matrix", "quest-graph", "world-state"],
              "topics": ["dynamic-content", "narrative-systems"], "related_systems":
              ["gameplay-service", "narrative-service"], "related_documents": [{"id":
              "narrative-coherence-quest-dependencies-graph", "relation": "references"},
              {"id": "narrative-coherence-world-state-graph", "relation": "references"}],
              "source": "shared/docs/knowledge/canon/narrative/narrative-coherence/phase3-event-matrix/architecture.md",
              "visibility": "internal", "audience": ["concept", "narrative", "backend"],
              "risk_level": "medium"}, "review": {"chain": [{"role": "concept_director",
              "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions":
              []}, "summary": {"problem": "Нужно описать архитектуру графа событий
              для динамической генерации контента.", "goal": "Определить типы узлов,
              связи, вероятностные модели и интеграцию с мировым состоянием.", "essence":
              "Граф событий объединяет квесты, выборы и состояние мира, поддерживая
              динамическое наполнение AAA MMORPG.", "key_points": ["Четыре типа узлов:
              квесты, выборы, состояние мира и события.", "Связи REQUIRES, UNLOCKS,
              BLOCKS и INFLUENCES управляют прогрессией.", "Вероятностная и весовая
              системы регулируют генерацию контента.", "Глобальное состояние мира
              запускает триггеры и обновляет события."]}, "content": {"sections":
              [{"id": "overview", "title": "Краткое описание", "body": "Архитектура
              определяет структуру графа событий, который управляет динамическими
              квестами и мирами. Модель поддерживает непредсказуемость контента и
              объединяет решения игроков и глобальные состояния.\n", "mechanics_links":
              [], "assets": []}, {"id": "node-types", "title": "Типы узлов графа",
              "body": "### Quest Node\n```\ntype: quest\nid: quest_id\nprerequisites:
              [quest_ids]\nunlocks: [quest_ids]\nblocks: [quest_ids]\nprobability:
              0.0-1.0\n```\n\n### Choice Node\n```\ntype: choice\nid: choice_id\noptions:
              [option_ids]\nconsequences: {option_id: [effects]}\n```\n\n### World
              State Node\n```\ntype: world_state\nid: state_id\nvalue: any\ntriggers:
              [event_ids]\n```\n\n### Event Node\n```\ntype: event\nid: event_id\nconditions:
              [conditions]\neffects: [effects]\nprobability: 0.0-1.0\n```\n", "mechanics_links":
              [], "assets": []}, {"id": "edge-types", "title": "Типы связей", "body":
              "• **REQUIRES** — доступ к узлу после выполнения зависимого узла.  \n•
              **UNLOCKS** — открывает новые ветви после завершения события.  \n• **BLOCKS**
              — блокирует узел навсегда или до выполнения условий.  \n• **INFLUENCES**
              — мягкое влияние на сложность, награды или диалоги.\n", "mechanics_links":
              [], "assets": []}, {"id": "dynamic-generation", "title": "Динамическая
              генерация", "body": "### Probability System\n```\nevent_pool:\n  - event_id:
              random_ambush\n    base_probability: 0.15\n    modifiers:\n      danger_zone:
              +0.10\n      night_time: +0.05\n      high_reputation_gangs: -0.10\n    final_probability:
              calculated\n```\n\n### Weight System\n```\nquest_selection:\n  - quest_id:
              SQ-2020-001\n    weight: 10\n    conditions:\n      level: 1-5\n      class:
              Solo\n    adjusted_weight: calculated\n```\n", "mechanics_links": [],
              "assets": []}, {"id": "world-state", "title": "Интеграция мирового состояния",
              "body": "```\nworld_state:\n  blackwall_integrity: 0-100\n  corporate_control:
              0-100\n  faction_wars_active: boolean\n  player_chaos_score: 0-100\n\ntriggers:\n  -
              condition: blackwall_integrity < 50\n    effect: unlock_blackwall_incident_quests\n  -
              condition: corporate_control > 80\n    effect: increase_revolution_quest_probability\n```\nГлобальные
              значения обновляются событиями и играми игроков, запускают триггеры
              и переопределяют вероятности графа.\n", "mechanics_links": [], "assets":
              []}]}, "appendix": {"glossary": [], "references": [], "decisions": []},
              "implementation": {"github_issue": 109, "needs_task": false, "queue_reference":
              [], "blockers": []}, "history": [{"version": "1.0.0", "date": "2025-11-13",
              "author": "concept_director", "changes": "Конвертация архитектуры графа
              событий из MD в YAML."}], "validation": {"checksum": "", "schema_version":
              "1.0"}}'
        - column:
            name: metadata
            value: '{"id": "narrative-coherence-event-matrix-architecture", "title":
              "Архитектура графа событий", "document_type": "canon", "category": "narrative-coherence",
              "status": "approved", "version": "1.0.0", "last_updated": "2025-11-13T00:00:00+00:00",
              "concept_approved": true, "concept_reviewed_at": "2025-11-06T23:29:00+00:00",
              "owners": [{"role": "narrative_lead", "contact": "narrative@necp.game"}],
              "tags": ["event-matrix", "quest-graph", "world-state"], "topics": ["dynamic-content",
              "narrative-systems"], "related_systems": ["gameplay-service", "narrative-service"],
              "related_documents": [{"id": "narrative-coherence-quest-dependencies-graph",
              "relation": "references"}, {"id": "narrative-coherence-world-state-graph",
              "relation": "references"}], "source": "shared/docs/knowledge/canon/narrative/narrative-coherence/phase3-event-matrix/architecture.md",
              "visibility": "internal", "audience": ["concept", "narrative", "backend"],
              "risk_level": "medium"}'
        - column:
            name: source_file
            value: knowledge\canon\narrative\narrative-coherence\phase3-event-matrix\architecture.yaml
