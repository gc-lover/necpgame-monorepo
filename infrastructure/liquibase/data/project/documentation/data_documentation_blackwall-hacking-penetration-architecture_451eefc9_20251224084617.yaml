databaseChangeLog:
- changeSet:
    id: documentation-blackwall-hacking-penetration-architecture-451eefc9
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '-329805232906225'
        - column:
            name: doc_id
            value: blackwall-hacking-penetration-architecture
        - column:
            name: title
            value: Архитектура взлома и проникновения через Blackwall
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-29 00:00:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[{"role": "architect", "contact": "architect@necp.game"}]'
        - column:
            name: tags
            value:
            - architecture
            - blackwall
            - hacking
            - penetration
            - high-risk
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value: []
        - column:
            name: related_documents
            value: '[{"id": "blackwall-systems-architecture", "relation": "extends"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - architect
            - backend
            - gameplay
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "blackwall-hacking-penetration-architecture",
              "title": "Архитектура взлома и проникновения через Blackwall", "document_type":
              "architecture", "category": "systems", "status": "draft", "version":
              "1.0.0", "last_updated": "2025-11-29T00:00:00+00:00", "owners": [{"role":
              "architect", "contact": "architect@necp.game"}], "tags": ["architecture",
              "blackwall", "hacking", "penetration", "high-risk"], "related_documents":
              [{"id": "blackwall-systems-architecture", "relation": "extends"}], "github_issues":
              [1471], "visibility": "internal", "audience": ["architect", "backend",
              "gameplay"]}, "summary": {"problem": "Требуется архитектура системы
              взлома и проникновения через многослойную защиту Blackwall.\nСистема
              должна создавать ощущение экстремального риска через серию мини-игр
              и проверок,\nгде каждая неудача приближает к смерти.\n", "goal": "Спроектировать
              систему взлома через 5 слоёв защиты:\n- Многослойная система с уникальными
              мини-играми\n- Накопительный стресс и временное давление\n- Интеграция
              с системой перегрева\n- Последствия провала на каждом слое\n- Психологическое
              давление через механику\n", "essence": "Система последовательного взлома
              слоёв защиты Blackwall, где каждое действие несёт риск,\nа неудача может
              привести к критическим последствиям или смерти.\n"}, "architecture":
              {"components": [{"name": "breach-session-manager", "location": "blackwall-service
              (blackwall-breach-engine)", "responsibility": "Управление сессией взлома:\n-
              Создание сессии взлома\n- Отслеживание прогресса по слоям\n- Управление
              состоянием\n- Обработка экстренного прерывания\n", "estimated_lines":
              300, "dependencies": ["character-service", "blackwall-risk-calculator"]},
              {"name": "layer-breaker", "location": "blackwall-service (blackwall-breach-engine)",
              "responsibility": "Взлом отдельных слоёв защиты:\n- Обработка мини-игр
              для каждого слоя\n- Проверка навыков\n- Обработка неудач\n- Прогресс
              по слоям\n", "estimated_lines": 400, "dependencies": ["hacking-service",
              "blackwall-atmosphere-engine"]}, {"name": "stress-accumulator", "location":
              "blackwall-service (blackwall-breach-engine)", "responsibility": "Накопительный
              стресс:\n- Отслеживание стресса от каждого слоя\n- Влияние стресса на
              эффективность\n- Генерация галлюцинаций при высоком стрессе\n- Интеграция
              с атмосферным движком\n", "estimated_lines": 250, "dependencies": ["blackwall-atmosphere-engine",
              "character-service"]}, {"name": "consequence-processor", "location":
              "blackwall-service (blackwall-breach-engine)", "responsibility": "Обработка
              последствий провала:\n- Расчёт последствий на основе слоя провала\n-
              Применение эффектов заражения\n- Интеграция с системой рисков\n- Управление
              откатом\n", "estimated_lines": 300, "dependencies": ["blackwall-risk-calculator",
              "character-service", "medical-service"]}], "layer_system": {"layer_1_signature_analysis":
              {"name": "Анализ сигнатур", "difficulty_dc": "18-24", "skill_checks":
              [{"skill": "INT + NETRUN", "weight": 100}], "minigame_type": "pattern_recognition",
              "time_limit": "120 seconds", "failure_consequences": [{"detection_risk":
              "+10%"}, {"stress": "+15%"}, {"can_retry": true}], "success_rewards":
              [{"next_layer_bonus": "-2 DC"}, {"experience": "200 XP"}], "visual_effects":
              ["grid_of_lines", "blinking_wrong_patterns", "pressure_indicators"]},
              "layer_2_behavior_analysis": {"name": "Анализ поведения", "difficulty_dc":
              "20-26", "skill_checks": [{"skill": "NETRUN + HACKING", "weight": 100}],
              "minigame_type": "adaptive_prediction", "time_limit": "150 seconds",
              "adaptive": true, "failure_consequences": [{"system_adaptation": true},
              {"other_layers_dc": 2}, {"stress": "+20%"}, {"can_retry": true}], "success_rewards":
              [{"next_layer_bonus": "-3 DC"}, {"experience": "300 XP"}], "visual_effects":
              ["moving_figures", "almost_human_but_wrong", "uncanny_valley"]}, "layer_3_decoy_traps":
              {"name": "Ловушки-приманки", "difficulty_dc": "18-24", "skill_checks":
              [{"skill": "PERCEPTION + INT", "weight": 100}], "minigame_type": "path_selection",
              "paths_count": "3-5", "correct_paths": 1, "failure_consequences": [{"trap_activation":
              true}, {"cyberpsychosis": "+10%"}, {"false_attack": true}, {"stress":
              "+25%"}, {"can_retry": false}], "success_rewards": [{"next_layer_bonus":
              "-2 DC"}, {"experience": "400 XP"}], "visual_effects": ["beautiful_doors",
              "become_horrible_on_approach", "uncanny_valley"]}, "layer_4_air_gap":
              {"name": "Физический воздушный разрыв", "difficulty_dc": "22-28", "skill_checks":
              [{"skill": "TECH + NETRUN", "weight": 100}], "minigame_type": "bridge_creation",
              "time_limit": "180 seconds", "stability_required": 70, "failure_consequences":
              [{"instability": true}, {"data_loss": "30-50%"}, {"deck_damage": "10-20%"},
              {"stress": "+30%"}, {"can_retry": true}], "success_rewards": [{"next_layer_bonus":
              "-3 DC"}, {"experience": "600 XP"}], "visual_effects": ["void_space",
              "something_moving_in_darkness", "fear_of_unknown"]}, "layer_5_quantum_encryption":
              {"name": "Квантовое шифрование", "difficulty_dc": "24-30", "skill_checks":
              [{"skill": "INT + NETRUN + SPECIAL", "weight": 100}], "minigame_type":
              "quantum_puzzle", "time_limit": "240 seconds", "time_pressure": "extreme",
              "failure_consequences": [{"full_rollback": true}, {"critical_damage":
              "20-40%"}, {"possible_death": "10-30%"}, {"stress": "+50%"}, {"can_retry":
              false}], "success_rewards": [{"breach_complete": true}, {"experience":
              "1000 XP"}, {"temporary_passage": "15-60 minutes"}], "visual_effects":
              ["abstract_forms", "almost_make_sense_but_slip", "uncanny_valley_peak"]}},
              "stress_system": {"accumulation": {"base_per_layer": 10, "time_pressure":
              "+1 per 10 seconds over limit", "failure_modifier": "x2", "detection_modifier":
              "+5"}, "effects": {"low_30": {"description": "Лёгкие искажения", "performance_modifier":
              "-5%", "visual_effects": "minor_glitches"}, "medium_60": {"description":
              "Серьёзные помехи", "performance_modifier": "-15%", "visual_effects":
              "major_distortions", "audio_effects": "whispers"}, "high_90": {"description":
              "Критическое состояние", "performance_modifier": "-30%", "visual_effects":
              "hallucinations", "audio_effects": "voices", "random_actions": true},
              "critical_100": {"description": "Потеря контроля", "performance_modifier":
              "-50%", "visual_effects": "complete_distortion", "audio_effects": "overwhelming_voices",
              "auto_abort": "possible"}}}, "time_pressure_system": {"base_timers":
              {"layer_1": "120 seconds", "layer_2": "150 seconds", "layer_3": "180
              seconds", "layer_4": "180 seconds", "layer_5": "240 seconds"}, "failure_penalty":
              ["Each failure reduces next layer timer by 20%", "Stacking effect: multiple
              failures compound"], "warnings": ["50% time remaining: visual warning",
              "25% time remaining: audio warning", "10% time remaining: critical warning",
              "5% time remaining: panic mode"]}, "api_endpoints": [{"path": "POST
              /api/v1/blackwall/breach/start", "description": "Начало взлома Blackwall",
              "request": {"character_id": "UUID", "location_id": "UUID", "map_id":
              "UUID (optional, for weak zone)", "equipment_ids": ["UUID"], "preparation_level":
              "enum [none, basic, good, excellent]"}, "response": {"breach_id": "UUID",
              "risk_assessment": "object", "estimated_mortality": "percentage", "warnings":
              ["string"], "recommended_abort": "boolean"}}, {"path": "POST /api/v1/blackwall/breach/{breachId}/layer/{layerNumber}/start",
              "description": "Начало прохождения слоя", "response": {"layer_info":
              "object", "minigame_config": "object", "time_limit": "seconds", "current_stress":
              "0-100"}}, {"path": "POST /api/v1/blackwall/breach/{breachId}/layer/{layerNumber}/attempt",
              "description": "Попытка прохождения слоя (мини-игра)", "request": {"action_data":
              "object (minigame specific)", "skill_check": "object"}, "response":
              {"success": "boolean", "progress": "0-100", "stress_change": "integer",
              "consequences": "object", "next_layer_available": "boolean"}}, {"path":
              "POST /api/v1/blackwall/breach/{breachId}/layer/{layerNumber}/complete",
              "description": "Успешное прохождение слоя", "response": {"layer_reward":
              "object", "next_layer_info": "object", "accumulated_stress": "0-100",
              "warnings": ["string"]}}, {"path": "POST /api/v1/blackwall/breach/{breachId}/layer/{layerNumber}/fail",
              "description": "Провал слоя", "response": {"consequences": "object",
              "can_retry": "boolean", "rollback_options": "object", "mortality_risk":
              "percentage"}}, {"path": "POST /api/v1/blackwall/breach/{breachId}/abort",
              "description": "Экстренное прерывание взлома", "response": {"rollback_layer":
              "integer", "partial_rewards": "object", "consequences": "object", "experience_partial":
              "integer"}}, {"path": "GET /api/v1/blackwall/breach/{breachId}/status",
              "description": "Статус активного взлома", "response": {"current_layer":
              "integer", "progress": "0-100", "stress_level": "0-100", "time_remaining":
              "seconds", "warnings": ["string"], "consequences_risk": "object"}},
              {"path": "POST /api/v1/blackwall/breach/{breachId}/complete", "description":
              "Успешное завершение всех слоёв", "response": {"breach_reward": "object",
              "temporary_passage": "object", "access_granted": "object", "experience":
              "integer", "reputation_changes": "object"}}], "database_schema": {"tables":
              [{"name": "blackwall_breach_sessions", "columns": [{"name": "id", "type":
              "UUID", "primary_key": true}, {"name": "character_id", "type": "UUID",
              "foreign_key": "characters.id"}, {"name": "location_id", "type": "UUID",
              "foreign_key": "locations.id"}, {"name": "map_id", "type": "UUID", "foreign_key":
              "blackwall_maps.id", "nullable": true}, {"name": "status", "type": "VARCHAR(20)",
              "values": ["active", "completed", "aborted", "failed", "dead"]}, {"name":
              "current_layer", "type": "INTEGER", "range": "0-5"}, {"name": "stress_level",
              "type": "INTEGER", "range": "0-100"}, {"name": "started_at", "type":
              "TIMESTAMP"}, {"name": "completed_at", "type": "TIMESTAMP", "nullable":
              true}]}, {"name": "blackwall_breach_layers", "columns": [{"name": "id",
              "type": "UUID", "primary_key": true}, {"name": "breach_id", "type":
              "UUID", "foreign_key": "blackwall_breach_sessions.id"}, {"name": "layer_number",
              "type": "INTEGER", "range": "1-5"}, {"name": "status", "type": "VARCHAR(20)",
              "values": ["pending", "in_progress", "completed", "failed", "skipped"]},
              {"name": "attempts_count", "type": "INTEGER"}, {"name": "completion_time",
              "type": "INTEGER", "nullable": true}, {"name": "stress_added", "type":
              "INTEGER"}, {"name": "started_at", "type": "TIMESTAMP"}, {"name": "completed_at",
              "type": "TIMESTAMP", "nullable": true}]}, {"name": "blackwall_breach_consequences",
              "columns": [{"name": "id", "type": "UUID", "primary_key": true}, {"name":
              "breach_id", "type": "UUID", "foreign_key": "blackwall_breach_sessions.id"},
              {"name": "layer_number", "type": "INTEGER"}, {"name": "consequence_type",
              "type": "VARCHAR(50)"}, {"name": "severity", "type": "INTEGER", "range":
              "0-100"}, {"name": "applied", "type": "BOOLEAN"}, {"name": "applied_at",
              "type": "TIMESTAMP", "nullable": true}]}]}, "class_modifiers": {"netrunner":
              {"layer_dc_modifier": -2, "stress_resistance": "+10%", "special_abilities":
              [{"layer_rollback": "One critical failure can be rolled back"}, {"adaptive_breach":
              "Can adapt to layer changes"}, {"deep_analysis": "See deeper layer info"}],
              "estimated_lines_component": 400}, "techie": {"layer_dc_modifier": 1,
              "stress_resistance": "+5%", "special_abilities": [{"equipment_boost":
              "Equipment gives +3 to checks"}, {"alternative_methods": "Can use tech
              solutions"}], "estimated_lines_component": 350}, "other_classes": {"layer_dc_modifier":
              3, "stress_resistance": "-10%", "special_abilities": [{"emergency_support":
              "Can call for help"}], "estimated_lines_component": 300}}, "reward_scaling":
              {"by_layers_completed": {"1_layer": {"experience": "200 XP", "risk":
              "Low", "rewards": "Minimal data"}, "2_layers": {"experience": "500 XP",
              "risk": "Medium", "rewards": "Partial data, coordinates"}, "3_layers":
              {"experience": "900 XP", "risk": "High", "rewards": "Good data, weak
              zone access"}, "4_layers": {"experience": "1500 XP", "risk": "Very High",
              "rewards": "Excellent data, corridor coords"}, "5_layers": {"experience":
              "3000 XP", "risk": "Extreme", "rewards": "Complete access, unique artifacts,
              legendary items"}}}, "failure_consequences": {"layer_1_failure": {"mortality":
              "2-5%", "consequences": ["Detection risk +10%", "Stress +15%"], "rollback":
              "Safe"}, "layer_2_failure": {"mortality": "5-10%", "consequences": ["System
              adaptation", "Other layers +2 DC", "Stress +20%"], "rollback": "Safe"},
              "layer_3_failure": {"mortality": "10-20%", "consequences": ["Trap activation",
              "Cyberpsychosis +10%", "Stress +25%"], "rollback": "Partial damage"},
              "layer_4_failure": {"mortality": "20-40%", "consequences": ["Data loss
              30-50%", "Deck damage 10-20%", "Stress +30%"], "rollback": "Significant
              damage"}, "layer_5_failure": {"mortality": "40-70%", "consequences":
              ["Full rollback", "Critical damage 20-40%", "Stress +50%", "Possible
              death"], "rollback": "Extreme risk"}}, "integration_points": {"hacking_service":
              ["POST /api/v1/hacking/blackwall/analyze-layer", "POST /api/v1/hacking/blackwall/breach-layer",
              "GET /api/v1/hacking/demons/blackwall-protection"], "character_service":
              ["GET /api/v1/characters/{id}/skills/breach-readiness", "POST /api/v1/characters/{id}/stress/add",
              "POST /api/v1/characters/{id}/consequences/apply"], "overheat_system":
              ["GET /api/v1/overheat/status/{characterId}", "POST /api/v1/overheat/increase",
              {"Integration": "High overheat → increased breach difficulty"}]}}}'
        - column:
            name: metadata
            value: '{"id": "blackwall-hacking-penetration-architecture", "title":
              "Архитектура взлома и проникновения через Blackwall", "document_type":
              "architecture", "category": "systems", "status": "draft", "version":
              "1.0.0", "last_updated": "2025-11-29T00:00:00+00:00", "owners": [{"role":
              "architect", "contact": "architect@necp.game"}], "tags": ["architecture",
              "blackwall", "hacking", "penetration", "high-risk"], "related_documents":
              [{"id": "blackwall-systems-architecture", "relation": "extends"}], "github_issues":
              [1471], "visibility": "internal", "audience": ["architect", "backend",
              "gameplay"]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\blackwall-hacking-penetration-architecture.yaml
