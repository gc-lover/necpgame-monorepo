databaseChangeLog:
- changeSet:
    id: documentation-blackwall-mapping-architecture-c2ecbb49
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '2799007516224825'
        - column:
            name: doc_id
            value: blackwall-mapping-architecture
        - column:
            name: title
            value: Архитектура системы картографии Blackwall
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-29 00:00:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[{"role": "architect", "contact": "architect@necp.game"}]'
        - column:
            name: tags
            value:
            - architecture
            - blackwall
            - mapping
            - exploration
            - high-risk
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value: []
        - column:
            name: related_documents
            value: '[{"id": "blackwall-systems-architecture", "relation": "extends"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - architect
            - backend
            - gameplay
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "blackwall-mapping-architecture", "title":
              "Архитектура системы картографии Blackwall", "document_type": "architecture",
              "category": "systems", "status": "draft", "version": "1.0.0", "last_updated":
              "2025-11-29T00:00:00+00:00", "owners": [{"role": "architect", "contact":
              "architect@necp.game"}], "tags": ["architecture", "blackwall", "mapping",
              "exploration", "high-risk"], "related_documents": [{"id": "blackwall-systems-architecture",
              "relation": "extends"}], "github_issues": [1470], "visibility": "internal",
              "audience": ["architect", "backend", "gameplay"]}, "summary": {"problem":
              "Требуется архитектура системы картографии слабых зон Blackwall для
              исследования и подготовки \nк проникновению. Система должна создавать
              ощущение опасного исследования с неопределённостью \nи психологическим
              давлением.\n", "goal": "Спроектировать систему картографии:\n- Активное
              сканирование барьера\n- Обнаружение аномалий и разломов\n- Генерация
              динамических карт с ложными данными\n- Атмосфера исследования с эффектом
              зловещей долины\n- Интеграция с классами и оборудованием\n", "essence":
              "Система исследования Blackwall, которая генерирует карты со зонами
              разной опасности, \nно сохраняет неопределённость через ложные сигналы
              и динамические изменения.\n"}, "architecture": {"components": [{"name":
              "blackwall-scanner", "location": "blackwall-service (blackwall-mapping-system)",
              "responsibility": "Основной механизм сканирования барьера:\n- Активация
              режима сканирования\n- Сбор сигнатур и аномалий\n- Обработка ложных
              сигналов\n- Интеграция с киберпространством\n", "estimated_lines": 350,
              "dependencies": ["cyberspace-service", "hacking-service", "character-service"]},
              {"name": "anomaly-detector", "location": "blackwall-service (blackwall-mapping-system)",
              "responsibility": "Обнаружение аномалий и разломов:\n- Анализ сигнатур\n-
              Классификация зон по опасности\n- Определение ложных сигналов\n- Оценка
              стабильности зон\n", "estimated_lines": 300, "dependencies": ["blackwall-scanner",
              "character-service (навыки анализа)"]}, {"name": "map-generator", "location":
              "blackwall-service (blackwall-mapping-system)", "responsibility": "Генерация
              динамических карт:\n- Создание визуального представления\n- Разметка
              зон по опасности\n- Включение ложных данных\n- Расчёт точности карты\n",
              "estimated_lines": 350, "dependencies": ["anomaly-detector", "character-service
              (навыки картографии)"]}, {"name": "false-signal-generator", "location":
              "blackwall-service (blackwall-mapping-system)", "responsibility": "Генерация
              ложных сигналов для давления:\n- Создание приманок от rogue AI\n- Эхо
              от старых данных\n- Ловушки NetWatch\n- Интеграция с атмосферным движком\n",
              "estimated_lines": 300, "dependencies": ["blackwall-atmosphere-engine",
              "world-service"]}, {"name": "map-validator", "location": "blackwall-service
              (blackwall-mapping-system)", "responsibility": "Валидация и обновление
              карт:\n- Проверка актуальности данных\n- Обновление устаревших зон\n-
              Удаление ложных данных при обнаружении\n- Сохранение истории изменений\n",
              "estimated_lines": 250, "dependencies": ["map-generator", "database"]}],
              "api_endpoints": [{"path": "POST /api/v1/blackwall/mapping/start", "description":
              "Начало сессии сканирования", "request": {"character_id": "UUID", "location_id":
              "UUID", "equipment_ids": ["UUID"], "scan_type": "enum [surface, deep,
              critical]"}, "response": {"session_id": "UUID", "estimated_duration":
              "seconds", "risk_level": "enum [low, medium, high, extreme]", "warnings":
              ["string"]}}, {"path": "GET /api/v1/blackwall/mapping/{sessionId}/status",
              "description": "Статус активного сканирования", "response": {"progress":
              "0-100", "anomalies_detected": "integer", "current_zone_type": "enum
              [safe, weak, anomaly, critical, unknown]", "false_signals_detected":
              "integer", "stress_level": "0-100", "warnings": ["string"]}}, {"path":
              "POST /api/v1/blackwall/mapping/{sessionId}/analyze-signal", "description":
              "Анализ обнаруженного сигнала (мини-игра)", "request": {"signal_id":
              "UUID", "analysis_method": "enum [basic, advanced, expert]", "skill_check":
              "object"}, "response": {"signal_type": "enum [real, false, trap]", "zone_info":
              "object", "confidence": "0-100"}}, {"path": "POST /api/v1/blackwall/mapping/{sessionId}/complete",
              "description": "Завершение сканирования", "request": {"session_id":
              "UUID"}, "response": {"map_id": "UUID", "accuracy": "0-100", "zones_detected":
              "integer", "false_zones": "integer", "map_item": "object", "experience_reward":
              "integer", "consequences": "object"}}, {"path": "POST /api/v1/blackwall/mapping/{sessionId}/abort",
              "description": "Прерывание сканирования (экстренный откат)", "response":
              {"partial_data": "object", "consequences": "object", "experience_partial":
              "integer"}}, {"path": "GET /api/v1/blackwall/maps/{mapId}", "description":
              "Получение сохранённой карты", "response": {"map_id": "UUID", "accuracy":
              "0-100", "zones": ["object"], "age": "seconds", "outdated": "boolean",
              "warnings": ["string"]}}], "database_schema": {"tables": [{"name": "blackwall_maps",
              "columns": [{"name": "id", "type": "UUID", "primary_key": true}, {"name":
              "character_id", "type": "UUID", "foreign_key": "characters.id"}, {"name":
              "location_id", "type": "UUID", "foreign_key": "locations.id"}, {"name":
              "accuracy", "type": "INTEGER", "range": "0-100"}, {"name": "created_at",
              "type": "TIMESTAMP"}, {"name": "last_updated", "type": "TIMESTAMP"},
              {"name": "outdated", "type": "BOOLEAN"}, {"name": "map_data", "type":
              "JSONB"}]}, {"name": "blackwall_scanning_sessions", "columns": [{"name":
              "id", "type": "UUID", "primary_key": true}, {"name": "character_id",
              "type": "UUID", "foreign_key": "characters.id"}, {"name": "location_id",
              "type": "UUID", "foreign_key": "locations.id"}, {"name": "scan_type",
              "type": "VARCHAR(20)"}, {"name": "status", "type": "VARCHAR(20)", "values":
              ["active", "completed", "aborted", "failed"]}, {"name": "progress",
              "type": "INTEGER", "range": "0-100"}, {"name": "stress_level", "type":
              "INTEGER", "range": "0-100"}, {"name": "started_at", "type": "TIMESTAMP"},
              {"name": "completed_at", "type": "TIMESTAMP", "nullable": true}]}, {"name":
              "blackwall_zones", "columns": [{"name": "id", "type": "UUID", "primary_key":
              true}, {"name": "map_id", "type": "UUID", "foreign_key": "blackwall_maps.id"},
              {"name": "zone_type", "type": "VARCHAR(20)", "values": ["safe", "weak",
              "anomaly", "critical", "unknown"]}, {"name": "coordinates", "type":
              "JSONB"}, {"name": "stability", "type": "INTEGER", "range": "0-100"},
              {"name": "risk_level", "type": "INTEGER", "range": "0-100"}, {"name":
              "is_false_signal", "type": "BOOLEAN"}, {"name": "discovered_at", "type":
              "TIMESTAMP"}]}, {"name": "blackwall_anomalies", "columns": [{"name":
              "id", "type": "UUID", "primary_key": true}, {"name": "zone_id", "type":
              "UUID", "foreign_key": "blackwall_zones.id"}, {"name": "anomaly_type",
              "type": "VARCHAR(50)"}, {"name": "severity", "type": "INTEGER", "range":
              "0-100"}, {"name": "data", "type": "JSONB"}, {"name": "detected_at",
              "type": "TIMESTAMP"}]}]}, "zone_types": {"safe": {"color": "green",
              "risk_level": "0-20", "stability": "80-100", "description": "Стабильные
              участки барьера", "usage": "Малоинтересны для проникновения"}, "weak":
              {"color": "yellow", "risk_level": "20-40", "stability": "60-80", "description":
              "Тонкие участки барьера", "usage": "Подходят для тёплых коридоров"},
              "anomaly": {"color": "orange", "risk_level": "40-70", "stability": "30-60",
              "description": "Нестабильные участки", "usage": "Возможность проникновения,
              но непредсказуемо"}, "critical": {"color": "red", "risk_level": "70-90",
              "stability": "0-30", "description": "Активные точки проникновения",
              "usage": "Возможно присутствие rogue AI"}, "unknown": {"color": "purple",
              "risk_level": "90-100", "stability": "0-50", "description": "Неизвестная
              природа", "usage": "Максимальный риск, непредсказуемые последствия"}},
              "false_signal_system": {"types": [{"name": "ai_decoy", "source": "rogue_ai",
              "probability": 0.15, "detection_difficulty": 25, "effect": "Ложная зона
              на карте, при использовании → атака AI"}, {"name": "old_data_echo",
              "source": "data_corruption", "probability": 0.2, "detection_difficulty":
              20, "effect": "Устаревшие данные, зона уже изменилась"}, {"name": "netwatch_trap",
              "source": "netwatch", "probability": 0.1, "detection_difficulty": 30,
              "effect": "Приманка для обнаружения, триггер преследования"}, {"name":
              "system_glitch", "source": "blackwall_instability", "probability": 0.25,
              "detection_difficulty": 15, "effect": "Случайный артефакт, не опасен,
              но вводит в заблуждение"}]}, "accuracy_calculation": {"base_accuracy":
              50, "skill_modifiers": {"netrun_skill": "+2% per level above 30", "hacking_skill":
              "+1% per level above 25", "int_attribute": "+1% per point above 15"},
              "equipment_modifiers": {"advanced_scanner": "+15%", "anomaly_detector":
              "+10%", "elite_cyberdeck": "+20%"}, "risk_modifiers": {"deep_scan":
              "+10% but +risk", "time_invested": "+5% per 10 minutes"}, "false_signal_penalty":
              "-accuracy for each undetected false signal"}, "class_access": {"netrunner":
              {"scan_types": ["surface", "deep", "critical"], "false_signal_detection":
              "+15%", "accuracy_bonus": "+20%", "risk_modifier": "-10%"}, "techie":
              {"scan_types": ["surface", "deep"], "false_signal_detection": "+5%",
              "accuracy_bonus": "+5%", "risk_modifier": "+5%", "requires_modifications":
              true}, "other_classes": {"scan_types": ["surface"], "false_signal_detection":
              "0%", "accuracy_bonus": "-20%", "risk_modifier": "+15%", "requires_help":
              true}}, "rewards": {"experience": {"surface": "500-1500 XP", "deep":
              "1500-3000 XP", "critical": "3000-5000 XP"}, "items": {"map_item": {"rarity":
              "common to legendary", "accuracy": "0-100", "zones_revealed": "integer",
              "false_zones": "integer"}}, "reputation": {"netwatch": "-20 to -50 (if
              detected)", "voodoo_boys": "+10 to +30", "data_jackals": "+10 to +25"},
              "data": {"anomaly_data": "Sellable to NetWatch or factions", "warm_corridor_coords":
              "For warm corridor creation"}}, "risks": {"detection": {"netwatch":
              "10-30% chance", "consequences": "Reputation -50, possible quest pursuit"},
              "ai_contact": {"rogue_ai": "5-20% chance", "consequences": "Cyberpsychosis
              +15%, neural damage"}, "false_data": {"probability": "15-40% of zones",
              "consequences": "Wrong map → death on use"}, "digital_infection": {"probability":
              "10-25% chance", "consequences": "Temporary debuffs on hacking skills"}},
              "integration_points": {"cyberspace_service": {"purpose": "Навигация
              в киберпространстве для сканирования", "endpoints": ["POST /api/v1/cyberspace/blackwall/enter-scanning",
              "GET /api/v1/cyberspace/blackwall/visual-signals"]}, "hacking_service":
              {"purpose": "Использование навыков хакерства для анализа", "endpoints":
              ["POST /api/v1/hacking/signal-analysis", "GET /api/v1/hacking/false-signal-detection"]},
              "character_service": {"purpose": "Проверка навыков и применение последствий",
              "endpoints": ["GET /api/v1/characters/{id}/skills/netrun", "POST /api/v1/characters/{id}/stress/add"]},
              "world_service": {"purpose": "Контекст локаций и события", "endpoints":
              ["GET /api/v1/world/locations/{id}/blackwall-proximity", "POST /api/v1/world/events/netwatch-patrol"]}},
              "technical_considerations": {"performance": ["Асинхронная обработка
              сканирования", "Процедурная генерация зон", "Кэширование активных сессий",
              "Оптимизация визуальных эффектов"], "scalability": ["Ограничение частоты
              сканирования (кулердауны)", "Пакетная обработка обновлений карт", "Очистка
              устаревших данных"], "consistency": ["Транзакционная обработка завершения
              сканирования", "Валидация данных карты перед сохранением", "Проверка
              актуальности при использовании"]}}}'
        - column:
            name: metadata
            value: '{"id": "blackwall-mapping-architecture", "title": "Архитектура
              системы картографии Blackwall", "document_type": "architecture", "category":
              "systems", "status": "draft", "version": "1.0.0", "last_updated": "2025-11-29T00:00:00+00:00",
              "owners": [{"role": "architect", "contact": "architect@necp.game"}],
              "tags": ["architecture", "blackwall", "mapping", "exploration", "high-risk"],
              "related_documents": [{"id": "blackwall-systems-architecture", "relation":
              "extends"}], "github_issues": [1470], "visibility": "internal", "audience":
              ["architect", "backend", "gameplay"]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\blackwall-mapping-architecture.yaml
