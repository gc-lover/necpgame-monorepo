databaseChangeLog:
- changeSet:
    id: documentation-blackwall-systems-architecture-5bf90a6a
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '-396936552198282'
        - column:
            name: doc_id
            value: blackwall-systems-architecture
        - column:
            name: title
            value: Архитектура систем Blackwall
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-29 00:00:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[{"role": "architect", "contact": "architect@necp.game"}]'
        - column:
            name: tags
            value:
            - architecture
            - blackwall
            - hacking
            - cyberspace
            - high-risk
            - gameplay
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value:
            - gameplay-service
            - hacking-service
            - cyberspace-service
            - character-service
            - world-service
        - column:
            name: related_documents
            value: '[{"id": "cyber-network-systems-architecture", "relation": "extends"},
              {"id": "blackwall-mapping-architecture", "relation": "references"},
              {"id": "blackwall-hacking-penetration-architecture", "relation": "references"},
              {"id": "blackwall-risk-mortality-architecture", "relation": "references"},
              {"id": "blackwall-ice-protection-architecture", "relation": "references"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - architect
            - backend
            - gameplay
            - api-designer
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "blackwall-systems-architecture", "title":
              "Архитектура систем Blackwall", "document_type": "architecture", "category":
              "systems", "status": "draft", "version": "1.0.0", "last_updated": "2025-11-29T00:00:00+00:00",
              "owners": [{"role": "architect", "contact": "architect@necp.game"}],
              "tags": ["architecture", "blackwall", "hacking", "cyberspace", "high-risk",
              "gameplay"], "related_systems": ["gameplay-service", "hacking-service",
              "cyberspace-service", "character-service", "world-service"], "related_documents":
              [{"id": "cyber-network-systems-architecture", "relation": "extends"},
              {"id": "blackwall-mapping-architecture", "relation": "references"},
              {"id": "blackwall-hacking-penetration-architecture", "relation": "references"},
              {"id": "blackwall-risk-mortality-architecture", "relation": "references"},
              {"id": "blackwall-ice-protection-architecture", "relation": "references"}],
              "github_issues": [1470, 1471, 1472, 1473, 1474], "visibility": "internal",
              "audience": ["architect", "backend", "gameplay", "api-designer"]}, "summary":
              {"problem": "Требуется архитектура систем Blackwall для реализации хардкорных
              и рискованных механик взаимодействия \nс цифровым барьером. Blackwall
              — это не просто защита, а живая адаптивная система с высоким риском
              \nсмертности (~70% для netrunner) и достойными наградами.\n", "goal":
              "Спроектировать архитектуру систем Blackwall:\n- Картография слабых
              зон и разломов\n- Взлом и проникновение через многослойную защиту\n-
              Blackwall ICE как адаптивная защита\n- Тёплые коридоры (временные проходы)\n-
              Система рисков и смертности\n- Интеграция с существующими системами
              взлома и киберпространства\n", "essence": "Комплексная система взаимодействия
              с Blackwall, создающая ощущение экстремального риска, \nпсихологического
              давления и загадочности. Каждое действие требует подготовки, навыков
              и \nнесёт реальные последствия вплоть до смерти персонажа.\n"}, "architecture":
              {"overview": "Системы Blackwall состоят из следующих компонентов:\n1.
              Blackwall Mapping System - исследование и картография барьера\n2. Blackwall
              Breach Engine - взлом и проникновение через слои защиты\n3. Blackwall
              ICE Manager - управление адаптивной защитой\n4. Warm Corridor Manager
              - создание и поддержание временных проходов\n5. Blackwall Risk Calculator
              - расчёт рисков и последствий\n6. Blackwall Atmosphere Engine - создание
              психологического давления\n7. Blackwall Reward System - управление наградами
              за успех\n8. Blackwall Event Publisher - публикация событий взаимодействия\n",
              "design_principles": [{"name": "High Risk, High Reward", "description":
              "Экстремальные риски (~70% смертность) компенсируются уникальными наградами"},
              {"name": "Psychological Pressure", "description": "Механика создаёт
              ощущение ужаса и неопределённости через визуальные и аудио эффекты"},
              {"name": "Adaptive Difficulty", "description": "Blackwall адаптируется
              к действиям игроков, повышая сложность"}, {"name": "Class Specialization",
              "description": "Разные классы имеют разный доступ и возможности взаимодействия"},
              {"name": "Preparation Matters", "description": "Правильная подготовка
              критически важна для выживания"}], "component_diagram": "```mermaid\ngraph
              TB\n    Client[UE5 Client] --> Gateway[API Gateway]\n\n    Gateway -->
              BlackwallService[Blackwall Service<br/>gameplay-service/blackwall]\n\n    BlackwallService
              --> Mapping[Blackwall Mapping System]\n    BlackwallService --> Breach[Blackwall
              Breach Engine]\n    BlackwallService --> ICEManager[Blackwall ICE Manager]\n    BlackwallService
              --> Corridor[Warm Corridor Manager]\n    BlackwallService --> RiskCalc[Risk
              Calculator]\n    BlackwallService --> Atmosphere[Atmosphere Engine]\n    BlackwallService
              --> Rewards[Reward System]\n\n    Mapping --> HackingService[Hacking
              Service]\n    Breach --> HackingService\n    ICEManager --> HackingService\n\n    BlackwallService
              --> CyberspaceService[Cyberspace Service]\n    BlackwallService -->
              CharacterService[Character Service]\n    BlackwallService --> WorldService[World
              Service]\n    BlackwallService --> InventoryService[Inventory Service]\n\n    BlackwallService
              --> EventBus[Event Bus]\n    BlackwallService --> DB[(Blackwall DB)]\n    BlackwallService
              --> Cache[(Redis Cache)]\n```\n", "microservices": [{"name": "blackwall-service",
              "location": "gameplay-service (модуль blackwall)", "responsibility":
              "Основной сервис для всех операций с Blackwall:\n- Картография и сканирование\n-
              Взлом и проникновение\n- Управление Blackwall ICE\n- Создание тёплых
              коридоров\n- Расчёт рисков и последствий\n- Управление наградами\n",
              "endpoints": ["POST /api/v1/blackwall/mapping/start - начало сканирования",
              "GET /api/v1/blackwall/mapping/{sessionId}/status - статус сканирования",
              "POST /api/v1/blackwall/mapping/{sessionId}/complete - завершение сканирования",
              "POST /api/v1/blackwall/breach/start - начало взлома", "POST /api/v1/blackwall/breach/{breachId}/layer/{layerId}
              - прохождение слоя", "GET /api/v1/blackwall/breach/{breachId}/status
              - статус взлома", "POST /api/v1/blackwall/breach/{breachId}/abort -
              экстренное прерывание", "POST /api/v1/blackwall/corridor/create - создание
              тёплого коридора", "GET /api/v1/blackwall/corridor/{corridorId}/status
              - статус коридора", "POST /api/v1/blackwall/corridor/{corridorId}/maintain
              - поддержание коридора", "POST /api/v1/blackwall/risk/calculate - расчёт
              рисков для действия"]}], "components": [{"name": "blackwall-mapping-system",
              "location": "blackwall-service", "responsibility": "Система картографии
              слабых зон Blackwall:\n- Активное сканирование барьера\n- Обнаружение
              аномалий и разломов\n- Генерация динамических карт\n- Обработка ложных
              сигналов\n- Создание атмосферы исследования\n", "dependencies": ["hacking-service
              (навыки хакерства)", "cyberspace-service (навигация)", "character-service
              (проверка навыков)", "inventory-service (оборудование)"], "estimated_lines":
              450}, {"name": "blackwall-breach-engine", "location": "blackwall-service",
              "responsibility": "Движок взлома через многослойную защиту:\n- Управление
              прохождением 5 слоёв защиты\n- Обработка мини-игр для каждого слоя\n-
              Накопительный стресс и давление\n- Интеграция с системой перегрева\n-
              Обработка последствий провала\n", "dependencies": ["hacking-service
              (навыки взлома)", "character-service (применение последствий)", "atmosphere-engine
              (психологическое давление)"], "estimated_lines": 500}, {"name": "blackwall-ice-manager",
              "location": "blackwall-service", "responsibility": "Управление Blackwall
              ICE как адаптивной защиты:\n- Адаптация к методам взлома\n- Координация
              с rogue AI\n- Генерация психологических эффектов\n- Интеграция с системой
              ICE\n", "dependencies": ["hacking-service (ICE система)", "atmosphere-engine
              (эффекты)"], "estimated_lines": 400}, {"name": "warm-corridor-manager",
              "location": "blackwall-service", "responsibility": "Управление тёплыми
              коридорами:\n- Создание временных проходов\n- Поддержание стабильности\n-
              Координация команды\n- Обработка угроз (AI, NetWatch)\n", "dependencies":
              ["blackwall-mapping-system (поиск слабых зон)", "social-service (координация
              команды)", "world-service (события NetWatch)"], "estimated_lines": 450},
              {"name": "blackwall-risk-calculator", "location": "blackwall-service",
              "responsibility": "Расчёт рисков и последствий:\n- Оценка смертности
              на основе действий\n- Генерация последствий (от лёгких до летальных)\n-
              Учёт подготовки и навыков\n- Интеграция с системой цифрового призрака\n",
              "dependencies": ["character-service (навыки, состояние)", "medical-service
              (лечение последствий)"], "estimated_lines": 400}, {"name": "blackwall-atmosphere-engine",
              "location": "blackwall-service", "responsibility": "Создание атмосферы
              ужаса и психологического давления:\n- Генерация визуальных эффектов
              (зловещая долина)\n- Звуковые эффекты и голоса\n- Неопределённость и
              ложные сигналы\n- Накопительный стресс\n", "dependencies": ["world-service
              (контекст)", "character-service (состояние персонажа)"], "estimated_lines":
              350}, {"name": "blackwall-reward-system", "location": "blackwall-service",
              "responsibility": "Управление наградами за успешные операции:\n- Редкие
              данные и артефакты\n- Уникальные предметы\n- Опыт и репутация\n- Доступ
              к локациям за Blackwall\n", "dependencies": ["inventory-service (выдача
              предметов)", "character-service (опыт, репутация)", "world-service (доступ
              к локациям)"], "estimated_lines": 300}], "integrations": [{"name": "hacking-service",
              "purpose": "Использование навыков хакерства, демонов взлома, системы
              ICE", "endpoints": ["POST /api/v1/hacking/blackwall/analyze - анализ
              структуры барьера", "POST /api/v1/hacking/blackwall/breach-layer - взлом
              слоя защиты", "GET /api/v1/hacking/blackwall/ice-status - статус Blackwall
              ICE"]}, {"name": "cyberspace-service", "purpose": "Навигация в киберпространстве
              для исследования и взлома", "endpoints": ["POST /api/v1/cyberspace/blackwall/enter
              - вход к барьеру", "GET /api/v1/cyberspace/blackwall/zones - зоны барьера"]},
              {"name": "character-service", "purpose": "Проверка навыков, применение
              последствий, управление состоянием", "endpoints": ["GET /api/v1/characters/{characterId}/skills/hacking
              - навыки хакерства", "POST /api/v1/characters/{characterId}/consequences
              - применение последствий", "POST /api/v1/characters/{characterId}/stress
              - увеличение стресса"]}, {"name": "inventory-service", "purpose": "Проверка
              и выдача оборудования, карт, артефактов", "endpoints": ["GET /api/v1/inventory/{characterId}/equipment/hacking
              - оборудование для взлома", "POST /api/v1/inventory/{characterId}/items/blackwall-map
              - выдача карты"]}, {"name": "world-service", "purpose": "Контекст локаций,
              события NetWatch, доступ к зонам за Blackwall", "endpoints": ["GET /api/v1/world/locations/{locationId}/blackwall-access
              - доступ к барьеру", "POST /api/v1/world/events/netwatch-detection -
              обнаружение NetWatch"]}, {"name": "medical-service", "purpose": "Лечение
              последствий взаимодействия с Blackwall", "endpoints": ["POST /api/v1/medical/digital-infection/treat
              - лечение заражения", "POST /api/v1/medical/cyberpsychosis/treat - лечение
              киберпсихоза"]}, {"name": "event-bus", "purpose": "Публикация событий
              взаимодействия с Blackwall", "events": ["blackwall.mapping.started",
              "blackwall.mapping.anomaly.detected", "blackwall.mapping.completed",
              "blackwall.breach.started", "blackwall.breach.layer.completed", "blackwall.breach.layer.failed",
              "blackwall.breach.completed", "blackwall.breach.failed", "blackwall.ice.encountered",
              "blackwall.ice.adaptive", "blackwall.corridor.created", "blackwall.corridor.stability.changed",
              "blackwall.corridor.closed", "blackwall.risk.calculated", "blackwall.consequence.applied",
              "blackwall.reward.granted"]}], "risk_reward_balance": {"mortality_rates":
              {"surface_operations": "2-5%", "barrier_interaction": "10-25%", "penetration":
              "40-60%", "deep_expedition": "70-90%"}, "rewards_tiers": {"surface_operations":
              {"experience": "500-2000 XP", "currency": "5000-20000 еддис", "items":
              "Обычные карты, базовые данные"}, "barrier_interaction": {"experience":
              "2000-5000 XP", "currency": "20000-50000 еддис", "items": "Улучшенные
              карты, координаты коридоров, данные об аномалиях", "reputation": "+10-30
              к Voodoo Boys, Data Jackals"}, "penetration": {"experience": "5000-15000
              XP", "currency": "50000-150000 еддис", "items": "Редкие артефакты, протоколы
              Soulkiller (фрагменты), связи с Alt Cunningham", "reputation": "+30-50
              к фракциям хакеров", "unlocks": "Доступ к локациям за Blackwall"}, "deep_expedition":
              {"experience": "15000-50000 XP", "currency": "150000-500000 еддис",
              "items": "Легендарные артефакты, полные протоколы, уникальные технологии",
              "reputation": "+50-100 к фракциям, репутация ''Blackwall Diver''", "unlocks":
              "Эксклюзивные локации, уникальные квесты"}}}, "class_access_levels":
              {"netrunner": {"mapping_access": "full", "breach_access": "full", "ice_resistance":
              "high", "risk_modifier": "-15%", "special_abilities": ["deep_scanning",
              "layer_rollback", "ice_analysis", "adaptive_breach"]}, "techie": {"mapping_access":
              "limited", "breach_access": "limited", "ice_resistance": "medium", "risk_modifier":
              "+5%", "special_abilities": ["equipment_modification", "alternative_breach_methods",
              "technical_countermeasures"]}, "other_classes": {"mapping_access": "minimal",
              "breach_access": "minimal", "ice_resistance": "low", "risk_modifier":
              "+20%", "special_abilities": ["basic_gadget_usage", "team_coordination",
              "emergency_support"]}}}, "implementation_notes": {"high_risk_design":
              "Система спроектирована как хардкорная механика:\n- Реальная смертность
              персонажей (пермадеат или цифровой призрак)\n- Последствия необратимы
              без дорогостоящего лечения\n- Ошибки критичны и смертельны\n- Подготовка
              обязательна для выживания\n", "psychological_pressure": "Механика создаёт
              психологическое давление:\n- Эффект зловещей долины через визуальные
              эффекты\n- Неопределённость и ложные сигналы\n- Накопительный стресс\n-
              Ощущение наблюдения и преследования\n- Звуковые эффекты и голоса\n",
              "preparation_importance": "Подготовка критически важна:\n- Правильное
              оборудование снижает риск на 10-20%\n- Высокие навыки снижают риск на
              15-25%\n- Команда поддержки снижает риск на 20-30%\n- Карты снижают
              риск на 10-15%\n- Без подготовки риск смертности близок к 90%\n", "reward_scaling":
              "Награды масштабируются с риском:\n- Чем выше риск, тем больше награда\n-
              Уникальные предметы только за высокий риск\n- Репутация растёт экспоненциально
              с риском\n- Эксклюзивный контент доступен только после успешных экспедиций\n"},
              "next_steps": ["Создать детальную архитектуру компонентов (отдельные
              файлы до 500 строк)", "Определить структуру БД для Blackwall систем",
              "Спроектировать API endpoints детально", "Разбить на технические задачи
              для Backend Developer"]}'
        - column:
            name: metadata
            value: '{"id": "blackwall-systems-architecture", "title": "Архитектура
              систем Blackwall", "document_type": "architecture", "category": "systems",
              "status": "draft", "version": "1.0.0", "last_updated": "2025-11-29T00:00:00+00:00",
              "owners": [{"role": "architect", "contact": "architect@necp.game"}],
              "tags": ["architecture", "blackwall", "hacking", "cyberspace", "high-risk",
              "gameplay"], "related_systems": ["gameplay-service", "hacking-service",
              "cyberspace-service", "character-service", "world-service"], "related_documents":
              [{"id": "cyber-network-systems-architecture", "relation": "extends"},
              {"id": "blackwall-mapping-architecture", "relation": "references"},
              {"id": "blackwall-hacking-penetration-architecture", "relation": "references"},
              {"id": "blackwall-risk-mortality-architecture", "relation": "references"},
              {"id": "blackwall-ice-protection-architecture", "relation": "references"}],
              "github_issues": [1470, 1471, 1472, 1473, 1474], "visibility": "internal",
              "audience": ["architect", "backend", "gameplay", "api-designer"]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\blackwall-systems-architecture.yaml
