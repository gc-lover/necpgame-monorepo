databaseChangeLog:
- changeSet:
    id: documentation-combat-acrobatics-combat-integration-architecture-c76c1492
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '-283924281722339'
        - column:
            name: doc_id
            value: combat-acrobatics-combat-integration-architecture
        - column:
            name: title
            value: Архитектура боевой акробатики
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-29 14:00:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[{"role": "architect", "contact": "architect@necp.game"}]'
        - column:
            name: tags
            value:
            - architecture
            - combat
            - movement
            - acrobatics
            - freerun
            - combos
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value:
            - gameplay-service
            - movement-service
            - character-service
        - column:
            name: related_documents
            value: '[{"id": "combat-freerun-architecture", "relation": "extends"},
              {"id": "combat-basic-acrobatics-architecture", "relation": "extends"},
              {"id": "combat-advanced-acrobatics-architecture", "relation": "extends"},
              {"id": "combat-combos-synergies-architecture", "relation": "integrates"},
              {"id": "combat-abilities-architecture", "relation": "integrates"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - architect
            - backend
            - client
            - gameplay
            - api-designer
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "combat-acrobatics-combat-integration-architecture",
              "title": "Архитектура боевой акробатики", "document_type": "architecture",
              "category": "systems", "status": "draft", "version": "1.0.0", "last_updated":
              "2025-11-29T14:00:00+00:00", "owners": [{"role": "architect", "contact":
              "architect@necp.game"}], "tags": ["architecture", "combat", "movement",
              "acrobatics", "freerun", "combos"], "related_systems": ["gameplay-service",
              "movement-service", "character-service"], "related_documents": [{"id":
              "combat-freerun-architecture", "relation": "extends"}, {"id": "combat-basic-acrobatics-architecture",
              "relation": "extends"}, {"id": "combat-advanced-acrobatics-architecture",
              "relation": "extends"}, {"id": "combat-combos-synergies-architecture",
              "relation": "integrates"}, {"id": "combat-abilities-architecture", "relation":
              "integrates"}], "github_issue": 1512, "visibility": "internal", "audience":
              ["architect", "backend", "client", "gameplay", "api-designer"]}, "summary":
              {"problem": "Требуется спроектировать архитектуру интеграции элементов
              акробатики с боевой системой:\n- Атаки в движении (Wall Run, Slide,
              Air, Vault)\n- Комбо из движения (цепочки движений с бонусами)\n- Мобильные
              способности (активация способностей во время движения)\nВсе элементы
              должны интегрироваться с боевой системой, комбо-системой и системой
              способностей.\n", "goal": "Создать архитектурную схему боевой акробатики
              с определением:\n- Компонентов для атак в движении\n- Системы комбо
              из движения\n- Интеграции мобильных способностей\n- API endpoints для
              управления\n- Структуры БД для отслеживания\n- Технического задания
              для реализации\n", "essence": "Детальная архитектура интеграции акробатики
              с боевой системой для создания\nдинамичного боевого геймплея с атаками
              в движении и комбо.\n"}, "architecture": {"overview": "Архитектура боевой
              акробатики состоит из следующих компонентов:\n1. Movement Combat Integrator
              - интеграция боя с движением\n2. Acrobatics Attack System - система
              атак в движении\n3. Movement Combo System - система комбо из движения\n4.
              Mobile Ability Integrator - интеграция мобильных способностей\n5. Combat
              Accuracy Modifier - модификаторы точности в движении\n6. Movement Attack
              Analytics - аналитика атак в движении\n", "microservices": [{"name":
              "gameplay-service", "port": 8083, "responsibility": "Обработка боевой
              акробатики:\n- Интеграция боя с элементами акробатики\n- Управление
              атаками в движении\n- Обработка комбо из движения\n- Интеграция мобильных
              способностей\n- Модификация точности в движении\n- Сбор аналитики\n",
              "components": [{"movement-combat-integrator": "интеграция боя с движением"},
              {"acrobatics-attack-system": "система атак в движении"}, {"movement-combo-system":
              "система комбо из движения"}, {"mobile-ability-integrator": "интеграция
              мобильных способностей"}, {"combat-accuracy-modifier": "модификаторы
              точности"}, {"movement-attack-analytics": "аналитика атак"}], "endpoints":
              ["POST /api/v1/gameplay/combat/acrobatics/attack/wall-run - атака во
              время Wall Run", "POST /api/v1/gameplay/combat/acrobatics/attack/slide
              - атака во время Slide", "POST /api/v1/gameplay/combat/acrobatics/attack/air
              - атака в воздухе", "POST /api/v1/gameplay/combat/acrobatics/attack/vault
              - атака во время Vault", "POST /api/v1/gameplay/combat/acrobatics/combo/movement
              - комбо из движения", "GET /api/v1/gameplay/combat/acrobatics/combo/available
              - доступные комбо", "POST /api/v1/gameplay/combat/acrobatics/mobile-ability
              - мобильная способность", "GET /api/v1/gameplay/combat/acrobatics/accuracy-modifiers
              - модификаторы точности", "GET /api/v1/gameplay/combat/acrobatics/analytics
              - аналитика атак"], "websocket_channels": ["wss://api.necp.game/v1/gameplay/combat/acrobatics/combat/{sessionId}
              - поток боевых событий"], "events_published": [{"combat.acrobatics.attack.wall-run":
              "атака во время Wall Run"}, {"combat.acrobatics.attack.slide": "атака
              во время Slide"}, {"combat.acrobatics.attack.air": "атака в воздухе"},
              {"combat.acrobatics.attack.vault": "атака во время Vault"}, {"combat.acrobatics.combo.movement":
              "комбо из движения"}, {"combat.acrobatics.mobile-ability": "мобильная
              способность"}], "events_subscribed": [{"combat.acrobatics.wall-run.started":
              "начало Wall Run"}, {"combat.acrobatics.slide.started": "начало Slide"},
              {"combat.acrobatics.air-dash": "выполнение Air Dash"}, {"combat.acrobatics.vault":
              "выполнение Vault"}, {"combat.ability.activated": "активация способности"},
              {"combat.weapon.fired": "выстрел из оружия"}]}], "movement_attacks":
              {"wall_run_attacks": {"description": "Атаки во время Wall Run (стрельба,
              удары, специальные атаки).\n", "mechanics": {"shooting": "- Возможность
              стрельбы во время Wall Run\n- Снижение точности (баланс)\n- Модификаторы
              точности зависят от навыков\n", "melee": "- Возможность ударов во время
              Wall Run\n- Специальные атаки при отталкивании от стены\n- Интеграция
              с Wall Kick для комбо\n", "special": "- Специальные атаки при отталкивании
              от стены\n- Увеличенный урон при wall kick → attack\n- Визуальные эффекты\n"},
              "accuracy_modifiers": "- Базовое снижение точности: -20%\n- Модификаторы
              от навыков: до +10%\n- Импланты могут улучшать точность\n"}, "slide_attacks":
              {"description": "Атаки во время Slide (стрельба, скользящие атаки, выход
              из Slide).\n", "mechanics": {"shooting": "- Возможность стрельбы во
              время Slide\n- Сохранение точности или небольшое снижение\n", "melee":
              "- Скользящие атаки (удары во время Slide)\n- Специальные атаки при
              выходе из Slide\n- Увеличение скорости атаки (баланс)\n", "special":
              "- Специальные атаки при выходе из Slide\n- Бонусы за комбо: Slide →
              Attack\n- Визуальные эффекты\n"}, "accuracy_modifiers": "- Базовое снижение
              точности: -10%\n- Модификаторы от навыков: до +15%\n- Бонус скорости
              атаки: +25%\n"}, "air_attacks": {"description": "Атаки в воздухе (стрельба,
              удары, атаки во время Air Dash).\n", "mechanics": {"shooting": "- Возможность
              стрельбы в воздухе\n- Снижение точности в зависимости от высоты\n- Интеграция
              с Air Dash\n", "melee": "- Возможность ударов в воздухе\n- Атаки во
              время Air Dash\n- Специальные атаки при приземлении\n", "special": "-
              Специальные атаки при приземлении\n- Бонусы за комбо: Air Dash → Attack\n-
              Визуальные эффекты\n"}, "accuracy_modifiers": "- Базовое снижение точности:
              -15%\n- Дополнительное снижение на высоте: -5% за 10м\n- Модификаторы
              от навыков: до +10%\n"}, "vault_attacks": {"description": "Атаки во
              время Vault (стрельба, удары, выход из Vault).\n", "mechanics": {"shooting":
              "- Возможность стрельбы во время Vault\n- Сохранение точности\n", "melee":
              "- Возможность ударов во время Vault\n- Атаки при выходе из Vault\n",
              "special": "- Специальные атаки при выходе из Vault\n- Бонусы за комбо:
              Vault → Attack\n- Визуальные эффекты\n"}, "accuracy_modifiers": "- Базовое
              снижение точности: -5%\n- Модификаторы от навыков: до +10%\n"}}, "movement_combos":
              {"description": "Комбо из движения с бонусами урона, скорости атаки
              и специальными эффектами.\n", "combo_chains": [{"chain": "Wall Run →
              Wall Kick → Air Dash → Attack", "description": "Вертикальная цепочка
              с бонусами", "bonuses": [{"damage_boost": "+30%"}, {"attack_speed":
              "+20%"}, {"special_effects": ["stun", "knockback"]}]}, {"chain": "Slide
              → Vault → Attack", "description": "Горизонтальная цепочка с бонусами",
              "bonuses": [{"damage_boost": "+25%"}, {"attack_speed": "+15%"}, {"special_effects":
              ["knockback"]}]}, {"chain": "Double Jump → Air Dash → Attack", "description":
              "Воздушная цепочка с бонусами", "bonuses": [{"damage_boost": "+20%"},
              {"attack_speed": "+10%"}, {"special_effects": ["stun"]}]}, {"chain":
              "Wall Run → Jump → Slide → Attack", "description": "Смешанная цепочка
              с бонусами", "bonuses": [{"damage_boost": "+35%"}, {"attack_speed":
              "+25%"}, {"special_effects": ["stun", "knockback"]}]}], "integration":
              {"combos_synergies_system": "- Интеграция с системой комбо и синергий\n-
              Бонусы за комбо из движения\n- Специальные эффекты (stun, knockback)\n-
              Визуальные эффекты\n", "freerun_combo_system": "- Интеграция с Freerun
              Combo System\n- Общие компоненты для комбо\n- Синхронизация состояний\n"}},
              "mobile_abilities": {"description": "Активация способностей во время
              движения (Wall Run, Slide, Air Dash).\n", "mechanics": {"activation":
              "- Возможность активировать способности во время движения\n- Модификация
              способностей для движения (мобильные версии)\n- Ограничения по типу
              способностей\n- Интеграция с Mobile Ability Integrator\n", "modifications":
              "- Мобильные версии способностей\n- Корректировка затрат способностей\n-
              Изменение эффектов для движения\n- Ограничения по типу способностей\n"},
              "integration": {"ability_system": "- Интеграция с системой способностей\n-
              Получение мобильных версий способностей\n- Корректировка затрат способностей\n",
              "mobile_ability_integrator": "- Использование Mobile Ability Integrator
              из freerun\n- Проверка совместимости способностей\n- Применение мобильных
              версий\n"}}, "data_flows": {"wall_run_attack_flow": "1. Игрок в Wall
              Run активирует атаку\n2. Movement Combat Integrator проверяет состояние
              Wall Run\n3. Combat Accuracy Modifier применяет модификаторы точности\n4.
              Acrobatics Attack System обрабатывает атаку\n5. Combat System выполняет
              атаку с модификаторами\n6. Movement Combo System проверяет комбо\n7.
              Публикация события и отправка обновления клиентам\n", "slide_attack_flow":
              "1. Игрок в Slide активирует атаку\n2. Movement Combat Integrator проверяет
              состояние Slide\n3. Combat Accuracy Modifier применяет модификаторы\n4.
              Acrobatics Attack System обрабатывает атаку\n5. Combat System выполняет
              атаку с бонусами скорости\n6. Movement Combo System проверяет комбо\n7.
              Публикация события и отправка обновления\n", "movement_combo_flow":
              "1. Игрок выполняет цепочку движений\n2. Movement Combo System отслеживает
              последовательность\n3. Проверка соответствия комбо-цепочке\n4. Применение
              бонусов (урон, скорость, эффекты)\n5. Интеграция с Combos Synergies
              System\n6. Публикация события и отправка обновления\n", "mobile_ability_flow":
              "1. Игрок активирует способность во время движения\n2. Mobile Ability
              Integrator проверяет совместимость\n3. Получение мобильной версии способности\n4.
              Корректировка затрат способности\n5. Активация мобильной способности\n6.
              Публикация события и отправка обновления\n"}, "database_structure":
              {"tables": [{"name": "acrobatics_combat_attacks", "description": "История
              атак в движении", "columns": [{"id": "UUID PRIMARY KEY"}, {"character_id":
              "UUID FOREIGN KEY"}, {"movement_type": "ENUM (wall_run, slide, air,
              vault)"}, {"attack_type": "ENUM (shooting, melee, special)"}, {"accuracy_modifier":
              "DECIMAL(5,2)"}, {"damage_dealt": "INTEGER"}, {"combo_triggered": "BOOLEAN"},
              {"timestamp": "TIMESTAMP"}]}, {"name": "acrobatics_movement_combos",
              "description": "История комбо из движения", "columns": [{"id": "UUID
              PRIMARY KEY"}, {"character_id": "UUID FOREIGN KEY"}, {"combo_chain":
              "JSONB"}, {"bonuses_applied": "JSONB"}, {"damage_boost": "DECIMAL(5,2)"},
              {"attack_speed_boost": "DECIMAL(5,2)"}, {"special_effects": "JSONB"},
              {"timestamp": "TIMESTAMP"}]}, {"name": "acrobatics_mobile_abilities",
              "description": "История мобильных способностей", "columns": [{"id":
              "UUID PRIMARY KEY"}, {"character_id": "UUID FOREIGN KEY"}, {"ability_id":
              "UUID"}, {"movement_type": "ENUM (wall_run, slide, air_dash)"}, {"mobile_version_applied":
              "BOOLEAN"}, {"cost_adjusted": "DECIMAL(5,2)"}, {"timestamp": "TIMESTAMP"}]}]},
              "integrations": {"basic_acrobatics": "- Интеграция с базовыми элементами
              акробатики\n- Атаки во время Wall Run, Slide\n- Комбо из базовых элементов\n",
              "advanced_acrobatics": "- Интеграция с продвинутыми элементами\n- Атаки
              во время Air Dash, Vault\n- Комбо из продвинутых элементов\n", "combat_system":
              "- Интеграция с боевой системой\n- Обработка атак с модификаторами\n-
              Применение бонусов урона и скорости\n", "combos_synergies_system": "-
              Интеграция с системой комбо и синергий\n- Бонусы за комбо из движения\n-
              Специальные эффекты\n", "abilities_system": "- Интеграция с системой
              способностей\n- Мобильные версии способностей\n- Корректировка затрат\n",
              "animation_system": "- Анимации атак в движении\n- Визуальные эффекты
              комбо\n- Плавные переходы между состояниями\n", "realtime_gateway":
              "- Отправка realtime обновлений боевых событий\n- Синхронизация атак
              и комбо\n- Уведомления о событиях\n"}}, "technical_specification": {"subtasks":
              [{"id": "movement-combat-integrator", "title": "Реализация интегратора
              боя с движением", "description": "Реализация Movement Combat Integrator
              с интеграцией боевой системы\nс элементами акробатики и обработкой состояний.\n",
              "dependencies": [], "estimated_effort": "5 days", "file_size_estimate":
              "350 lines"}, {"id": "acrobatics-attack-system", "title": "Реализация
              системы атак в движении", "description": "Реализация Acrobatics Attack
              System с обработкой атак во время\nWall Run, Slide, Air, Vault и применением
              модификаторов.\n", "dependencies": ["movement-combat-integrator"], "estimated_effort":
              "6 days", "file_size_estimate": "400 lines"}, {"id": "movement-combo-system",
              "title": "Реализация системы комбо из движения", "description": "Реализация
              Movement Combo System с отслеживанием цепочек движений,\nприменением
              бонусов и интеграцией с комбо-системой.\n", "dependencies": ["movement-combat-integrator"],
              "estimated_effort": "5 days", "file_size_estimate": "350 lines"}, {"id":
              "mobile-ability-integrator", "title": "Реализация интегратора мобильных
              способностей", "description": "Реализация Mobile Ability Integrator
              с проверкой совместимости,\nполучением мобильных версий и корректировкой
              затрат.\n", "dependencies": ["movement-combat-integrator"], "estimated_effort":
              "4 days", "file_size_estimate": "300 lines"}, {"id": "combat-accuracy-modifier",
              "title": "Реализация модификаторов точности", "description": "Реализация
              Combat Accuracy Modifier с расчетом модификаторов\nточности в зависимости
              от движения и навыков.\n", "dependencies": ["acrobatics-attack-system"],
              "estimated_effort": "3 days", "file_size_estimate": "250 lines"}, {"id":
              "movement-attack-analytics", "title": "Реализация аналитики атак в движении",
              "description": "Реализация Movement Attack Analytics с логированием
              атак,\nсбором метрик и интеграцией с Analytics Service.\n", "dependencies":
              ["acrobatics-attack-system"], "estimated_effort": "3 days", "file_size_estimate":
              "200 lines"}, {"id": "acrobatics-combat-api-endpoints", "title": "Реализация
              API endpoints для боевой акробатики", "description": "Реализация REST
              API endpoints для управления атаками в движении,\nкомбо и мобильными
              способностями.\n", "dependencies": ["acrobatics-attack-system", "movement-combo-system"],
              "estimated_effort": "2 days", "file_size_estimate": "180 lines"}, {"id":
              "acrobatics-combat-websocket", "title": "Реализация WebSocket каналов
              для боевой акробатики", "description": "Реализация WebSocket каналов
              для realtime обновлений боевых событий,\nсинхронизации атак и комбо.\n",
              "dependencies": ["movement-combat-integrator"], "estimated_effort":
              "2 days", "file_size_estimate": "150 lines"}, {"id": "acrobatics-combat-event-bus",
              "title": "Интеграция с Event Bus для боевой акробатики", "description":
              "Реализация публикации и подписки на события через Kafka\nдля всех компонентов
              боевой акробатики.\n", "dependencies": ["acrobatics-attack-system",
              "movement-combo-system"], "estimated_effort": "2 days", "file_size_estimate":
              "120 lines"}, {"id": "acrobatics-combat-database-schema", "title": "Создание
              схемы БД для боевой акробатики", "description": "Создание таблиц БД
              для атак в движении, комбо и мобильных способностей\nс миграциями Liquibase.\n",
              "dependencies": [], "estimated_effort": "2 days", "file_size_estimate":
              "100 lines"}]}, "diagrams": {"component_diagram": "```mermaid\ngraph
              TB\n    Client[UE5 Client] --> Gateway[API Gateway]\n\n    Gateway -->
              GameplayService[Gameplay Service<br/>8083]\n\n    GameplayService -->
              MCI[Movement Combat Integrator]\n    GameplayService --> AAS[Acrobatics
              Attack System]\n    GameplayService --> MCS[Movement Combo System]\n    GameplayService
              --> MAI[Mobile Ability Integrator]\n    GameplayService --> CAM[Combat
              Accuracy Modifier]\n    GameplayService --> MAA[Movement Attack Analytics]\n\n    AAS
              --> CS[Combat System]\n    MCS --> CSS[Combos Synergies System]\n    MAI
              --> AS[Abilities System]\n\n    MCI --> WRM[Wall Run Manager]\n    MCI
              --> SM[Slide Manager]\n    MCI --> ADM[Air Dash Manager]\n    MCI -->
              VM[Vault Manager]\n\n    GameplayService --> EventBus[Event Bus<br/>Kafka]\n    EventBus
              --> RealtimeGateway[Realtime Gateway]\n\n    GameplayService --> DB[(Gameplay
              DB)]\n\n    Client --> WSCombat[WebSocket<br/>Combat Acrobatics]\n    WSCombat
              --> GameplayService\n```\n", "movement_attack_flow_diagram": "```mermaid\nsequenceDiagram\n    participant
              C as Client\n    participant MCI as Movement Combat Integrator\n    participant
              AAS as Acrobatics Attack System\n    participant CAM as Accuracy Modifier\n    participant
              CS as Combat System\n    participant MCS as Movement Combo System\n    participant
              EB as Event Bus\n\n    C->>MCI: POST /attack/wall-run\n    MCI->>MCI:
              Check movement state\n    MCI->>CAM: Get accuracy modifiers\n    CAM-->>MCI:
              Modifiers\n    MCI->>AAS: Process attack\n    AAS->>CS: Execute attack
              with modifiers\n    CS-->>AAS: Attack result\n    AAS->>MCS: Check combo\n    MCS-->>AAS:
              Combo status\n    AAS->>EB: Publish attack event\n    AAS-->>C: Attack
              executed\n```\n"}}'
        - column:
            name: metadata
            value: '{"id": "combat-acrobatics-combat-integration-architecture", "title":
              "Архитектура боевой акробатики", "document_type": "architecture", "category":
              "systems", "status": "draft", "version": "1.0.0", "last_updated": "2025-11-29T14:00:00+00:00",
              "owners": [{"role": "architect", "contact": "architect@necp.game"}],
              "tags": ["architecture", "combat", "movement", "acrobatics", "freerun",
              "combos"], "related_systems": ["gameplay-service", "movement-service",
              "character-service"], "related_documents": [{"id": "combat-freerun-architecture",
              "relation": "extends"}, {"id": "combat-basic-acrobatics-architecture",
              "relation": "extends"}, {"id": "combat-advanced-acrobatics-architecture",
              "relation": "extends"}, {"id": "combat-combos-synergies-architecture",
              "relation": "integrates"}, {"id": "combat-abilities-architecture", "relation":
              "integrates"}], "github_issue": 1512, "visibility": "internal", "audience":
              ["architect", "backend", "client", "gameplay", "api-designer"]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\combat-acrobatics-combat-integration-architecture.yaml
