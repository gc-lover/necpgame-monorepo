databaseChangeLog:
- changeSet:
    id: documentation-combat-berserk-reverse-stim-ef593542
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '-729910418014747'
        - column:
            name: doc_id
            value: combat-berserk-reverse-stim
        - column:
            name: title
            value: 'Берсерк: «Реверсивный стим» (урон растёт при потере HP)'
        - column:
            name: document_type
            value: mechanics
        - column:
            name: category
            value: combat
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 0.1.0
        - column:
            name: last_updated
            value: 2025-12-12 00:00:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: ''
        - column:
            name: owners
            value: '[{"role": "game_balance", "contact": "balance@necp.game"}]'
        - column:
            name: tags
            value:
            - berserk
            - buff
            - stamina
            - risk_reward
        - column:
            name: topics
            value:
            - combat_effects
            - dps_modulation
        - column:
            name: related_systems
            value:
            - gameplay-service
            - combat-service
            - realtime-service
        - column:
            name: related_documents
            value: '[{"id": "combat-shooter-core", "relation": "interacts_with"},
              {"id": "combat-implants-mechanics", "relation": "references"}, {"id":
              "combat-ux-guidelines", "relation": "references"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - combat
            - gameplay
            - analytics
        - column:
            name: risk_level
            value: medium
        - column:
            name: content
            value: '{"metadata": {"id": "combat-berserk-reverse-stim", "title": "Берсерк:
              «Реверсивный стим» (урон растёт при потере HP)", "document_type": "mechanics",
              "category": "combat", "status": "draft", "version": "0.1.0", "last_updated":
              "2025-12-12T00:00:00+00:00", "concept_approved": false, "concept_reviewed_at":
              "", "owners": [{"role": "game_balance", "contact": "balance@necp.game"}],
              "tags": ["berserk", "buff", "stamina", "risk_reward"], "topics": ["combat_effects",
              "dps_modulation"], "related_systems": ["gameplay-service", "combat-service",
              "realtime-service"], "related_documents": [{"id": "combat-shooter-core",
              "relation": "interacts_with"}, {"id": "combat-implants-mechanics", "relation":
              "references"}, {"id": "combat-ux-guidelines", "relation": "references"}],
              "source": "", "visibility": "internal", "audience": ["combat", "gameplay",
              "analytics"], "risk_level": "medium"}, "review": {"chain": [{"role":
              "game_balance_lead", "reviewer": "", "reviewed_at": "", "status": "pending"}],
              "next_actions": []}, "summary": {"problem": "Нужен бафф урона, растущий
              при потере HP, с платой за лечение и риском смерти.", "goal": "Определить
              формулу урона vs %HP, длительность/кулдаун, штрафы к лечению, контрплей
              и метрики.", "essence": "Берсерк усиливает урон при снижении HP, но
              повышает стоимость и время лечения; есть анти-баффы и капы TTK.", "key_points":
              ["Скейл урона от %HP с капом.", "Штраф к лечению/регену во время баффа.",
              "Контрплей анти-берсерк эффектами."]}, "content": {"sections": [{"id":
              "damage_formula", "title": "Формула урона vs HP", "body": "Базовый множитель:
              `damage_mult = 1 + clamp(k_mass * (1 - hp_ratio), 0, cap)`.\nПараметры
              по массе (k_mass / cap):\n- Лёгкий: k=0.55, cap=0.35 → при 30% HP множитель
              ~1.39.\n- Средний: k=0.65, cap=0.42 → при 30% HP ~1.46.\n- Тяжёлый:
              k=0.75, cap=0.48 → при 30% HP ~1.53.\nhp_ratio = current_hp / max_hp,
              квантуется каждые 5%.\nЖёсткий кап TTK: бонус урона не увеличивает фактический
              TTK >15% относительно базовой модели оружия.\n"}, {"id": "uptime", "title":
              "Длительность и кулдаун", "body": "Длительность: 10 с. Кулдаун: 50 с
              (PvP), 42 с (PvE).\nАктивация требует стамину >40% и отсутствие тяжёлых
              ранений/оглушений.\nБафф снимается при лечении выше 60% HP или при получении
              анти-берсерк дебаффа.\n"}, {"id": "healing_penalty", "title": "Штрафы
              к лечению и регену", "body": "Во время баффа:\n- Стоимость лечения (медкит/стим)
              x1.25 (PvP) / x1.15 (PvE).\n- Время применения хил-предметов +20% (PvP)
              / +10% (PvE).\n- Реген стамины -20%; реген HP отключён.\nПосле баффа:
              «откат» 6 с: реген стамины -10%, HP-regen остаётся отключён ещё 3 с.\n"},
              {"id": "fail_states", "title": "Риски и смерть", "body": "При HP <15%
              игрок получает «опасный порог»: +10% входящего урона. Повторная активация
              запрещена 60 с после смерти.\nЕсли смерть наступила под баффом, следующий
              запуск даёт -10% к cap на 1 бой.\n"}, {"id": "counterplay", "title":
              "Контрплей", "body": "Анти-берсерк дебафф: снижает damage_mult на 50%
              и включает нормальные стоимости лечения на 8 с.\nШумовые гранаты и EMP:
              сбрасывают стаки квантования (hp_ratio округляется вверх до ближайших
              10%).\nВ PvP мед-дроны союзников могут временно игнорировать штрафы
              лечения (1 раз/бой, 3 с окно).\n"}, {"id": "telemetry", "title": "Метрики",
              "body": "Логировать:\n- `reverse_stim.activations`, `duration_avg`,
              `hp_ratio_avg_on_activation`.\n- `reverse_stim.deaths_under_buff`, `ttk_delta_ms`,
              `damage_mult_avg`.\n- `healing_cost_multiplier_avg`, `antiberserk_triggers`.\n-
              Экономика: средний расход медкитов/стимов под баффом.\n"}]}, "appendix":
              {"glossary": [{"term": "hp_ratio", "definition": "Доля текущего HP к
              максимуму, квантуется для расчёта баффа."}], "formulas": [{"name": "damage_mult",
              "expression": "damage_mult = 1 + clamp(k_mass * (1 - hp_ratio), 0, cap)",
              "notes": "k_mass и cap зависят от класса экипировки; hp_ratio квантуется
              каждые 5%."}]}, "implementation": {"needs_task": false, "github_issue":
              1675, "queue_reference": [], "blockers": []}, "history": [{"version":
              "0.1.0", "date": "2025-12-12", "author": "game_balance_team", "changes":
              "Базовая формула берсерка с штрафами к лечению и контрплеем."}], "validation":
              {"checksum": "", "schema_version": "1.0"}}'
        - column:
            name: metadata
            value: '{"id": "combat-berserk-reverse-stim", "title": "Берсерк: «Реверсивный
              стим» (урон растёт при потере HP)", "document_type": "mechanics", "category":
              "combat", "status": "draft", "version": "0.1.0", "last_updated": "2025-12-12T00:00:00+00:00",
              "concept_approved": false, "concept_reviewed_at": "", "owners": [{"role":
              "game_balance", "contact": "balance@necp.game"}], "tags": ["berserk",
              "buff", "stamina", "risk_reward"], "topics": ["combat_effects", "dps_modulation"],
              "related_systems": ["gameplay-service", "combat-service", "realtime-service"],
              "related_documents": [{"id": "combat-shooter-core", "relation": "interacts_with"},
              {"id": "combat-implants-mechanics", "relation": "references"}, {"id":
              "combat-ux-guidelines", "relation": "references"}], "source": "", "visibility":
              "internal", "audience": ["combat", "gameplay", "analytics"], "risk_level":
              "medium"}'
        - column:
            name: source_file
            value: knowledge\mechanics\combat\combat-berserk-reverse-stim.yaml
