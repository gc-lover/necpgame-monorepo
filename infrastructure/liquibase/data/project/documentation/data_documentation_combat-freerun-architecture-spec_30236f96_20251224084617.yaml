databaseChangeLog:
- changeSet:
    id: documentation-combat-freerun-architecture-spec-30236f96
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '1696473437474546'
        - column:
            name: doc_id
            value: combat-freerun-architecture-spec
        - column:
            name: title
            value: Техническое задание и диаграммы Freerun
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-30 15:20:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[{"role": "architect", "contact": "architect@necp.game"}]'
        - column:
            name: tags
            value:
            - architecture
            - combat
            - freerun
            - technical-specification
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value: []
        - column:
            name: related_documents
            value: '[{"id": "combat-freerun-architecture", "relation": "extends"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - architect
            - backend
            - database
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "combat-freerun-architecture-spec", "title":
              "Техническое задание и диаграммы Freerun", "document_type": "architecture",
              "category": "systems", "status": "draft", "version": "1.0.0", "last_updated":
              "2025-11-30T15:20:00+00:00", "owners": [{"role": "architect", "contact":
              "architect@necp.game"}], "tags": ["architecture", "combat", "freerun",
              "technical-specification"], "related_documents": [{"id": "combat-freerun-architecture",
              "relation": "extends"}], "github_issue": 1513, "visibility": "internal",
              "audience": ["architect", "backend", "database"]}, "technical_specification":
              {"subtasks": [{"id": "freerun-action-manager", "title": "Реализация
              менеджера действий паркура", "description": "Реализация Freerun Action
              Manager с обработкой всех типов действий паркура,\nвалидацией доступности
              и интеграцией с боевой сессией.\n", "dependencies": [], "estimated_effort":
              "5 days"}, {"id": "stamina-manager", "title": "Реализация менеджера
              выносливости", "description": "Реализация Stamina Manager с расчетом
              расхода, восстановления и модификаторов\nвыносливости на основе навыков
              и имплантов.\n", "dependencies": [], "estimated_effort": "4 days"},
              {"id": "freerun-combo-system", "title": "Реализация системы комбо паркура",
              "description": "Реализация Freerun Combo System с отслеживанием последовательностей
              действий,\nприменением бонусов и интеграцией с боевыми комбо.\n", "dependencies":
              ["freerun-action-manager"], "estimated_effort": "4 days"}, {"id": "route-manager",
              "title": "Реализация менеджера маршрутов", "description": "Реализация
              Route Manager с созданием, валидацией и управлением пользовательскими\nмаршрутами
              паркура.\n", "dependencies": ["freerun-action-manager"], "estimated_effort":
              "4 days"}, {"id": "mobile-ability-integrator", "title": "Реализация
              интегратора мобильных способностей", "description": "Реализация Mobile
              Ability Integrator с проверкой совместимости способностей\nс паркуром
              и применением мобильных версий.\n", "dependencies": ["freerun-action-manager"],
              "estimated_effort": "4 days"}, {"id": "freerun-telemetry-collector",
              "title": "Реализация сборщика телеметрии", "description": "Реализация
              Freerun Telemetry Collector с логированием действий, сбором метрик\nи
              интеграцией с Analytics Service.\n", "dependencies": ["freerun-action-manager"],
              "estimated_effort": "3 days"}, {"id": "anti-cheat-validator", "title":
              "Реализация валидатора античит", "description": "Реализация Anti-Cheat
              Validator с проверкой действий паркура на подозрительность,\nвалидацией
              физической возможности и детектом эксплойтов.\n", "dependencies": ["freerun-action-manager"],
              "estimated_effort": "5 days"}, {"id": "websocket-channels", "title":
              "Реализация WebSocket каналов", "description": "Реализация WebSocket
              каналов для realtime обновлений действий паркура,\nсостояния выносливости
              и телеметрии.\n", "dependencies": ["freerun-action-manager", "stamina-manager"],
              "estimated_effort": "3 days"}, {"id": "event-bus-integration", "title":
              "Интеграция с Event Bus", "description": "Реализация публикации и подписки
              на события через Kafka\nдля всех компонентов системы Freerun.\n", "dependencies":
              ["freerun-action-manager", "freerun-combo-system"], "estimated_effort":
              "2 days"}, {"id": "database-schema", "title": "Создание схемы БД", "description":
              "Создание таблиц БД для действий паркура, профилей, комбо, выносливости,
              маршрутов,\nтелеметрии и аудита с миграциями Liquibase.\n", "dependencies":
              [], "estimated_effort": "2 days"}]}, "diagrams": {"component_diagram":
              "```mermaid\ngraph TB\n    Client[UE5 Client] --> Gateway[API Gateway]\n\n    Gateway
              --> GameplayService[Gameplay Service<br/>8083]\n\n    GameplayService
              --> FAM[Freerun Action Manager]\n    GameplayService --> SM[Stamina
              Manager]\n    GameplayService --> FCS[Freerun Combo System]\n    GameplayService
              --> RM[Route Manager]\n    GameplayService --> MAI[Mobile Ability Integrator]\n    GameplayService
              --> FTC[Freerun Telemetry Collector]\n    GameplayService --> ACV[Anti-Cheat
              Validator]\n\n    FAM --> SM\n    FAM --> FCS\n    FAM --> ACV\n    FCS
              --> MAI\n\n    GameplayService --> CombatSession[Combat Session]\n    GameplayService
              --> AbilityService[Ability Service]\n    GameplayService --> ImplantService[Implant
              Service]\n    GameplayService --> ProgressionService[Progression Service]\n    GameplayService
              --> QuestService[Quest Service]\n    GameplayService --> AnalyticsService[Analytics
              Service]\n    GameplayService --> InventoryService[Inventory Service]\n\n    GameplayService
              --> EventBus[Event Bus<br/>Kafka]\n    EventBus --> RealtimeGateway[Realtime
              Gateway]\n\n    GameplayService --> DB[(Gameplay DB)]\n\n    Client
              --> WSFreerun[WebSocket<br/>Freerun]\n    WSFreerun --> GameplayService\n```\n",
              "freerun_action_flow_diagram": "```mermaid\nsequenceDiagram\n    participant
              C as Client\n    participant FAM as Freerun Action Manager\n    participant
              SM as Stamina Manager\n    participant ACV as Anti-Cheat Validator\n    participant
              FCS as Freerun Combo System\n    participant MAI as Mobile Ability Integrator\n    participant
              EB as Event Bus\n\n    C->>FAM: POST /freerun/actions\n    FAM->>FAM:
              Check action availability\n    FAM->>SM: Check stamina\n    SM-->>FAM:
              Stamina status\n    FAM->>ACV: Validate action\n    ACV-->>FAM: Validation
              result\n    FAM->>FAM: Execute action\n    FAM->>SM: Consume stamina\n    FAM->>FCS:
              Check combo\n    FCS-->>FAM: Combo status\n    FAM->>MAI: Check mobile
              abilities\n    MAI-->>FAM: Mobile ability status\n    FAM->>EB: Publish
              combat.freerun.action\n    FAM-->>C: Action result\n```\n", "stamina_recovery_diagram":
              "```mermaid\nsequenceDiagram\n    participant SM as Stamina Manager\n    participant
              PS as Progression Service\n    participant IS as Implant Service\n    participant
              ES as Economy Service\n    participant EB as Event Bus\n\n    Note over
              SM: Action performed, stamina consumed\n    SM->>SM: Calculate stamina
              consumption\n    SM->>PS: Get skill bonuses\n    PS-->>SM: Skill data\n    SM->>IS:
              Get implant bonuses\n    IS-->>SM: Implant data\n    SM->>SM: Apply
              modifiers\n    SM->>SM: Update stamina state\n\n    alt Stamina depleted\n        SM->>SM:
              Block actions\n        SM->>SM: Start recovery timer\n    end\n\n    SM->>SM:
              Natural recovery\n    SM->>EB: Publish combat.freerun.stamina\n```\n"}}'
        - column:
            name: metadata
            value: '{"id": "combat-freerun-architecture-spec", "title": "Техническое
              задание и диаграммы Freerun", "document_type": "architecture", "category":
              "systems", "status": "draft", "version": "1.0.0", "last_updated": "2025-11-30T15:20:00+00:00",
              "owners": [{"role": "architect", "contact": "architect@necp.game"}],
              "tags": ["architecture", "combat", "freerun", "technical-specification"],
              "related_documents": [{"id": "combat-freerun-architecture", "relation":
              "extends"}], "github_issue": 1513, "visibility": "internal", "audience":
              ["architect", "backend", "database"]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\combat-freerun-architecture-spec.yaml
