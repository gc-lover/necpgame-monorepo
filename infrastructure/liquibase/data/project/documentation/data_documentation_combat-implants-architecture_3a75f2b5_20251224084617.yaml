databaseChangeLog:
- changeSet:
    id: documentation-combat-implants-architecture-3a75f2b5
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '6206863127199870'
        - column:
            name: doc_id
            value: combat-implants-architecture
        - column:
            name: title
            value: Архитектура системы боевых имплантов
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-30 15:30:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[{"role": "architect", "contact": "architect@necp.game"}]'
        - column:
            name: tags
            value:
            - architecture
            - combat
            - implants
            - cyberware
            - progression
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value:
            - gameplay-service
            - character-service
            - progression-service
            - economy-service
            - inventory-service
        - column:
            name: related_documents
            value: '[{"id": "mechanics-combat-implants-overview", "relation": "implements"},
              {"id": "mechanics-combat-implants-types", "relation": "implements"},
              {"id": "mechanics-combat-implants-acquisition", "relation": "implements"},
              {"id": "mechanics-combat-implants-limits", "relation": "implements"},
              {"id": "mechanics-combat-implants-visuals", "relation": "implements"},
              {"id": "combat-abilities-architecture", "relation": "integrates"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - architect
            - backend
            - gameplay
            - api-designer
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "combat-implants-architecture", "title": "Архитектура
              системы боевых имплантов", "document_type": "architecture", "category":
              "systems", "status": "draft", "version": "1.0.0", "last_updated": "2025-11-30T15:30:00+00:00",
              "owners": [{"role": "architect", "contact": "architect@necp.game"}],
              "tags": ["architecture", "combat", "implants", "cyberware", "progression"],
              "related_systems": ["gameplay-service", "character-service", "progression-service",
              "economy-service", "inventory-service"], "related_documents": [{"id":
              "mechanics-combat-implants-overview", "relation": "implements"}, {"id":
              "mechanics-combat-implants-types", "relation": "implements"}, {"id":
              "mechanics-combat-implants-acquisition", "relation": "implements"},
              {"id": "mechanics-combat-implants-limits", "relation": "implements"},
              {"id": "mechanics-combat-implants-visuals", "relation": "implements"},
              {"id": "combat-abilities-architecture", "relation": "integrates"}],
              "github_issue": 80, "visibility": "internal", "audience": ["architect",
              "backend", "gameplay", "api-designer"]}, "summary": {"problem": "Требуется
              спроектировать архитектуру системы боевых имплантов, включающую:\n-
              Управление типами имплантов и их эффектами\n- Приобретение и улучшение
              имплантов\n- Лимиты имплантов (слоты, совместимость, энергия, человечность)\n-
              Визуализацию имплантов\n- Интеграцию с боевой системой, способностями
              и прогрессией\n- Управление киберпсихозом\n", "goal": "Создать архитектурную
              схему системы боевых имплантов с определением:\n- Компонентов для управления
              имплантами\n- REST, WebSocket и Event Bus контрактов\n- Интеграций с
              другими системами\n- Структуры БД\n- Технического задания для реализации\n",
              "essence": "Комплексная архитектура системы боевых имплантов с поддержкой
              типов, приобретения,\nлимитов, визуализации и интеграции с боевой системой
              и прогрессией.\n"}, "architecture": {"overview": "Архитектура системы
              боевых имплантов состоит из следующих компонентов:\n1. Implant Catalog
              Manager - управление каталогом имплантов\n2. Implant Acquisition Manager
              - управление приобретением и улучшением\n3. Implant Limits Manager -
              управление лимитами (слоты, совместимость, энергия)\n4. Implant Visuals
              Manager - управление визуализацией\n5. Cyberpsychosis Tracker - отслеживание
              киберпсихоза\n6. Implant Effects Calculator - расчет эффектов имплантов\n7.
              Implant Synergy System - система синергий имплантов\n", "microservices":
              [{"name": "gameplay-service", "port": 8083, "responsibility": "Обработка
              боевых имплантов:\n- Управление каталогом имплантов\n- Управление приобретением
              и улучшением\n- Управление лимитами имплантов\n- Управление визуализацией\n-
              Отслеживание киберпсихоза\n- Расчет эффектов имплантов\n- Обработка
              синергий\n", "components": [{"implant-catalog-manager": "управление
              каталогом имплантов"}, {"implant-acquisition-manager": "управление приобретением"},
              {"implant-limits-manager": "управление лимитами"}, {"implant-visuals-manager":
              "управление визуализацией"}, {"cyberpsychosis-tracker": "отслеживание
              киберпсихоза"}, {"implant-effects-calculator": "расчет эффектов"}, {"implant-synergy-system":
              "система синергий"}], "endpoints": ["GET /api/v1/gameplay/combat/implants/catalog
              - каталог имплантов", "GET /api/v1/gameplay/combat/implants/{implantId}
              - информация об импланте", "GET /api/v1/gameplay/combat/implants/character/{characterId}
              - импланты персонажа", "POST /api/v1/gameplay/combat/implants/acquire
              - приобретение импланта", "POST /api/v1/gameplay/combat/implants/install
              - установка импланта", "POST /api/v1/gameplay/combat/implants/uninstall
              - удаление импланта", "POST /api/v1/gameplay/combat/implants/upgrade
              - улучшение импланта", "GET /api/v1/gameplay/combat/implants/limits
              - проверка лимитов", "GET /api/v1/gameplay/combat/implants/cyberpsychosis
              - состояние киберпсихоза", "POST /api/v1/gameplay/combat/implants/visuals
              - обновление визуалов"], "websocket_channels": ["wss://api.necp.game/v1/gameplay/combat/implants/{sessionId}
              - live события имплантов"], "events_published": [{"combat.implant.acquired":
              "приобретение импланта"}, {"combat.implant.installed": "установка импланта"},
              {"combat.implant.uninstalled": "удаление импланта"}, {"combat.implant.upgraded":
              "улучшение импланта"}, {"combat.implant.limit.reached": "достижение
              лимита"}, {"combat.implant.cyberpsychosis.updated": "обновление киберпсихоза"},
              {"combat.implant.synergy.activated": "активация синергии"}], "events_subscribed":
              [{"character.created": "создание персонажа"}, {"progression.level-up":
              "повышение уровня"}, {"economy.transaction.completed": "завершение транзакции"},
              {"inventory.item.added": "добавление предмета"}, {"combat.ability.activated":
              "активация способности"}]}], "implant_types": [{"name": "combat", "description":
              "Боевые импланты", "categories": [{"offensive": "урон, крит, скорость
              атаки"}, {"defensive": "защита, сопротивление, регенерация"}, {"tactical":
              "стелс, хак, контроль"}]}, {"name": "movement", "description": "Двигательные
              импланты", "categories": [{"speed": "скорость движения"}, {"jump": "прыжки,
              двойной прыжок"}, {"parkour": "паркур, лазание"}]}, {"name": "os", "description":
              "Операционные системы", "categories": [{"cyberdeck": "хакерские способности"},
              {"sandevistan": "замедление времени"}, {"berserk": "берсерк режим"}]},
              {"name": "visual", "description": "Визуальные импланты", "categories":
              [{"eyes": "глаза, зрение"}, {"skin": "кожа, камуфляж"}, {"limbs": "конечности"}]}],
              "data_flows": {"implant_acquisition_flow": "1. Игрок приобретает имплант
              через POST /api/v1/gameplay/combat/implants/acquire\n2. Implant Acquisition
              Manager проверяет доступность импланта\n3. Economy Service проверяет
              наличие средств\n4. Economy Service списывает средства\n5. Inventory
              Service добавляет имплант в инвентарь\n6. Gameplay Service публикует
              событие combat.implant.acquired\n7. Realtime Gateway отправляет обновление
              клиентам\n", "implant_installation_flow": "1. Игрок устанавливает имплант
              через POST /api/v1/gameplay/combat/implants/install\n2. Implant Limits
              Manager проверяет лимиты (слоты, совместимость, энергия)\n3. Implant
              Effects Calculator рассчитывает эффекты импланта\n4. Cyberpsychosis
              Tracker обновляет уровень киберпсихоза\n5. Implant Synergy System проверяет
              синергии\n6. Character Service обновляет характеристики персонажа\n7.
              Gameplay Service публикует событие combat.implant.installed\n8. Realtime
              Gateway отправляет обновление клиентам\n", "implant_upgrade_flow": "1.
              Игрок улучшает имплант через POST /api/v1/gameplay/combat/implants/upgrade\n2.
              Implant Acquisition Manager проверяет возможность улучшения\n3. Economy
              Service проверяет наличие материалов/средств\n4. Implant Effects Calculator
              рассчитывает новые эффекты\n5. Character Service обновляет характеристики
              персонажа\n6. Gameplay Service публикует событие combat.implant.upgraded\n7.
              Realtime Gateway отправляет обновление клиентам\n", "cyberpsychosis_update_flow":
              "1. Игрок устанавливает/удаляет имплант\n2. Cyberpsychosis Tracker рассчитывает
              новый уровень киберпсихоза\n3. Cyberpsychosis Tracker проверяет пороги
              киберпсихоза\n4. При достижении порога → применение эффектов киберпсихоза\n5.
              Gameplay Service публикует событие combat.implant.cyberpsychosis.updated\n6.
              Realtime Gateway отправляет обновление клиентам\n"}, "database_structure":
              {"tables": [{"name": "implants_catalog", "description": "Каталог имплантов",
              "columns": [{"id": "UUID PRIMARY KEY"}, {"name": "VARCHAR(255) NOT NULL"},
              {"type": "ENUM (combat, movement, os, visual)"}, {"category": "VARCHAR(100)"},
              {"rarity": "ENUM (common, uncommon, rare, epic, legendary)"}, {"effects":
              "JSONB NOT NULL"}, {"energy_cost": "INTEGER"}, {"humanity_cost": "INTEGER"},
              {"slot_type": "VARCHAR(100)"}, {"compatibility": "JSONB"}, {"created_at":
              "TIMESTAMP NOT NULL DEFAULT NOW()"}]}, {"name": "character_implants",
              "description": "Импланты персонажей", "columns": [{"id": "UUID PRIMARY
              KEY"}, {"character_id": "UUID FOREIGN KEY"}, {"implant_id": "UUID FOREIGN
              KEY"}, {"installed_at": "TIMESTAMP"}, {"upgrade_level": "INTEGER DEFAULT
              1"}, {"slot": "VARCHAR(100)"}, {"is_active": "BOOLEAN DEFAULT true"},
              {"created_at": "TIMESTAMP NOT NULL DEFAULT NOW()"}]}, {"name": "implant_acquisitions",
              "description": "История приобретений имплантов", "columns": [{"id":
              "UUID PRIMARY KEY"}, {"character_id": "UUID FOREIGN KEY"}, {"implant_id":
              "UUID FOREIGN KEY"}, {"acquisition_type": "ENUM (purchase, loot, quest,
              crafting)"}, {"cost": "JSONB"}, {"acquired_at": "TIMESTAMP NOT NULL
              DEFAULT NOW()"}]}, {"name": "implant_limits_state", "description": "Состояние
              лимитов имплантов", "columns": [{"id": "UUID PRIMARY KEY"}, {"character_id":
              "UUID FOREIGN KEY"}, {"total_energy_used": "INTEGER"}, {"max_energy":
              "INTEGER"}, {"total_humanity_lost": "INTEGER"}, {"max_humanity": "INTEGER"},
              {"slots_used": "JSONB"}, {"last_update": "TIMESTAMP NOT NULL DEFAULT
              NOW()"}]}, {"name": "cyberpsychosis_state", "description": "Состояние
              киберпсихоза", "columns": [{"id": "UUID PRIMARY KEY"}, {"character_id":
              "UUID FOREIGN KEY"}, {"current_level": "INTEGER"}, {"threshold_level":
              "INTEGER"}, {"effects_active": "JSONB"}, {"last_update": "TIMESTAMP
              NOT NULL DEFAULT NOW()"}]}, {"name": "implant_synergies", "description":
              "Синергии имплантов", "columns": [{"id": "UUID PRIMARY KEY"}, {"character_id":
              "UUID FOREIGN KEY"}, {"synergy_id": "UUID"}, {"active_implants": "JSONB"},
              {"bonus_effects": "JSONB"}, {"activated_at": "TIMESTAMP NOT NULL DEFAULT
              NOW()"}]}]}, "integrations": {"character_service": "- Получение данных
              персонажа\n- Обновление характеристик при установке/удалении имплантов\n-
              Применение эффектов имплантов к персонажу\n", "progression_service":
              "- Получение данных о прокачке\n- Разблокировка имплантов по уровню\n-
              Обновление навыков на основе имплантов\n", "economy_service": "- Проверка
              средств для приобретения\n- Списание средств при покупке\n- Получение
              цен на импланты\n", "inventory_service": "- Добавление имплантов в инвентарь\n-
              Удаление имплантов из инвентаря\n- Проверка наличия материалов для улучшения\n",
              "ability_service": "- Получение способностей от имплантов\n- Интеграция
              имплантов с системой способностей\n- Проверка синергий имплантов и способностей\n",
              "combat_service": "- Применение эффектов имплантов в бою\n- Расчет бонусов
              от имплантов\n- Интеграция с боевой системой\n", "realtime_gateway":
              "- Отправка realtime обновлений имплантов\n- Синхронизация состояния
              киберпсихоза\n- Уведомления о лимитах и синергиях\n"}, "tickrate_and_network_requirements":
              {"implant_management": {"tickrate": "Event-based (on-demand)", "network_load":
              "- Приобретение импланта: event-based, ~0.1-0.5 events/sec\n- Установка/удаление:
              event-based, ~0.1-0.3 events/sec\n- Улучшение: event-based, ~0.05-0.1
              events/sec\n- Общий трафик: ~0.2-0.5 KB/sec на игрока\n", "sync_strategy":
              "Strong Consistency (ACID транзакции)"}, "implant_effects": {"tickrate":
              "60-128 Hz (в бою)", "network_load": "- Эффекты имплантов в бою: 60-128
              updates/sec\n- Бонусы от имплантов: event-based, ~5-10 events/sec\n-
              Общий трафик: ~1-2 KB/sec на игрока\n", "sync_strategy": "Strong Consistency
              для боевых эффектов"}, "cyberpsychosis": {"tickrate": "Event-based (on-demand)",
              "network_load": "- Обновление киберпсихоза: event-based, ~0.01-0.05
              events/sec\n- Эффекты киберпсихоза: event-based, ~0.1-0.2 events/sec\n-
              Общий трафик: ~0.1-0.2 KB/sec на игрока\n", "sync_strategy": "Strong
              Consistency"}, "implant_synergies": {"tickrate": "Event-based (on-demand)",
              "network_load": "- Активация синергий: event-based, ~0.1-0.3 events/sec\n-
              Обновление эффектов: event-based, ~0.1-0.2 events/sec\n- Общий трафик:
              ~0.1-0.3 KB/sec на игрока\n", "sync_strategy": "Strong Consistency"}}},
              "technical_specification": {"reference": "combat-implants-architecture-spec.yaml"},
              "diagrams": {"reference": "combat-implants-architecture-spec.yaml"}}'
        - column:
            name: metadata
            value: '{"id": "combat-implants-architecture", "title": "Архитектура системы
              боевых имплантов", "document_type": "architecture", "category": "systems",
              "status": "draft", "version": "1.0.0", "last_updated": "2025-11-30T15:30:00+00:00",
              "owners": [{"role": "architect", "contact": "architect@necp.game"}],
              "tags": ["architecture", "combat", "implants", "cyberware", "progression"],
              "related_systems": ["gameplay-service", "character-service", "progression-service",
              "economy-service", "inventory-service"], "related_documents": [{"id":
              "mechanics-combat-implants-overview", "relation": "implements"}, {"id":
              "mechanics-combat-implants-types", "relation": "implements"}, {"id":
              "mechanics-combat-implants-acquisition", "relation": "implements"},
              {"id": "mechanics-combat-implants-limits", "relation": "implements"},
              {"id": "mechanics-combat-implants-visuals", "relation": "implements"},
              {"id": "combat-abilities-architecture", "relation": "integrates"}],
              "github_issue": 80, "visibility": "internal", "audience": ["architect",
              "backend", "gameplay", "api-designer"]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\combat-implants-architecture.yaml
