databaseChangeLog:
- changeSet:
    id: documentation-database-architecture-9c8c5d89
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '-391112195465768'
        - column:
            name: doc_id
            value: infrastructure-database-architecture
        - column:
            name: title
            value: Database Architecture
        - column:
            name: document_type
            value: implementation
        - column:
            name: category
            value: infrastructure
        - column:
            name: status
            value: approved
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-07 00:18:00+00:00
        - column:
            name: concept_approved
            value: true
        - column:
            name: concept_reviewed_at
            value: 2025-11-07 00:00:00+00:00
        - column:
            name: owners
            value: '[{"role": "infrastructure_lead", "contact": "infrastructure@necp.game"}]'
        - column:
            name: tags
            value:
            - database
            - postgresql
            - infrastructure
        - column:
            name: topics
            value:
            - storage
            - data-architecture
        - column:
            name: related_systems
            value:
            - infrastructure-service
            - gameplay-service
        - column:
            name: related_documents
            value: '[{"id": "infrastructure-caching-strategy", "relation": "references"}]'
        - column:
            name: source
            value: shared/docs/knowledge/implementation/infrastructure/database-architecture.md
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - infrastructure
            - backend
            - devops
        - column:
            name: risk_level
            value: high
        - column:
            name: content
            value: '{"metadata": {"id": "infrastructure-database-architecture", "title":
              "Database Architecture", "document_type": "implementation", "category":
              "infrastructure", "status": "approved", "version": "1.0.0", "last_updated":
              "2025-11-07T00:18:00+00:00", "concept_approved": true, "concept_reviewed_at":
              "2025-11-07T00:00:00+00:00", "owners": [{"role": "infrastructure_lead",
              "contact": "infrastructure@necp.game"}], "tags": ["database", "postgresql",
              "infrastructure"], "topics": ["storage", "data-architecture"], "related_systems":
              ["infrastructure-service", "gameplay-service"], "related_documents":
              [{"id": "infrastructure-caching-strategy", "relation": "references"}],
              "source": "shared/docs/knowledge/implementation/infrastructure/database-architecture.md",
              "visibility": "internal", "audience": ["infrastructure", "backend",
              "devops"], "risk_level": "high"}, "review": {"chain": [{"role": "infrastructure_lead",
              "reviewer": "", "reviewed_at": "2025-11-07T00:00:00+00:00", "status":
              "approved"}], "next_actions": []}, "summary": {"problem": "Базовые данные
              обслуживают множество микросервисов и требуют плана изоляции, масштабирования
              и резервирования.", "goal": "Сформировать целевую архитектуру баз данных
              NECPGAME, включая текущую схему и roadmap на выделенные сервисные БД.",
              "essence": "Документ описывает этапы эволюции PostgreSQL-инфраструктуры,
              шардирование, репликацию, резервное копирование и partitioning.", "key_points":
              ["Фаза 1–3 использует shared PostgreSQL со схемами на сервис.", "Фаза
              4 переводит архитектуру на модель database-per-service с отдельными
              экземплярами.", "Реализуются шардирование по player_id/региону, master-replica,
              и автоматизированные бэкапы.", "Внедряется partitioning и стандарты
              для резервного копирования и восстановления."]}, "content": {"sections":
              [{"id": "architecture", "title": "Архитектура и roadmap", "body": "Текущая
              реализация (Фаза 1–3) использует один экземпляр PostgreSQL со схемами
              на сервис. Планируемая реализация\n(Фаза 4) подразумевает выделенную
              БД на каждый сервис и общий Redis-кэш. Roadmap описывает преимущества
              и риски\nобеих моделей.\n", "mechanics_links": []}, {"id": "core_database",
              "title": "Основной стек", "body": "Базовый выбор — PostgreSQL 15+. Причины:
              ACID, JSONB, материализованные представления, partitioning, репликация,\nполнотекстовый
              поиск. Расписан процесс шардирования по игрокам и регионам.\n", "mechanics_links":
              []}, {"id": "replication", "title": "Репликация", "body": "Используется
              master-replica топология: master обслуживает записи, реплики перераспределяют
              чтения. Рассматривается\nмасштабирование чтения через несколько реплик.\n",
              "mechanics_links": []}, {"id": "backup", "title": "Резервное копирование",
              "body": "Планы бэкапов включают ежедневные полные копии, инкрементальные
              каждые 6 часов и непрерывное WAL-архивирование.\nСхема хранения: 7 дневных,
              4 недельных, 12 месячных бэкапов.\n", "mechanics_links": []}, {"id":
              "partitioning", "title": "Partitioning и производительность", "body":
              "Для больших таблиц используется time-based partitioning. Приведён пример
              SQL для разбивки на месячные секции.\n", "mechanics_links": []}]}, "appendix":
              {"glossary": [], "references": [], "decisions": []}, "implementation":
              {"github_issue": 136, "needs_task": false, "queue_reference": ["shared/trackers/queues/concept/queued.yaml"],
              "blockers": []}, "history": [{"version": "1.0.0", "date": "2025-11-06",
              "author": "infrastructure_lead", "changes": "Определена архитектура
              PostgreSQL и стратегия эволюции базы данных."}], "validation": {"checksum":
              "", "schema_version": "1.0"}}'
        - column:
            name: metadata
            value: '{"id": "infrastructure-database-architecture", "title": "Database
              Architecture", "document_type": "implementation", "category": "infrastructure",
              "status": "approved", "version": "1.0.0", "last_updated": "2025-11-07T00:18:00+00:00",
              "concept_approved": true, "concept_reviewed_at": "2025-11-07T00:00:00+00:00",
              "owners": [{"role": "infrastructure_lead", "contact": "infrastructure@necp.game"}],
              "tags": ["database", "postgresql", "infrastructure"], "topics": ["storage",
              "data-architecture"], "related_systems": ["infrastructure-service",
              "gameplay-service"], "related_documents": [{"id": "infrastructure-caching-strategy",
              "relation": "references"}], "source": "shared/docs/knowledge/implementation/infrastructure/database-architecture.md",
              "visibility": "internal", "audience": ["infrastructure", "backend",
              "devops"], "risk_level": "high"}'
        - column:
            name: source_file
            value: knowledge\implementation\infrastructure\database-architecture.yaml
