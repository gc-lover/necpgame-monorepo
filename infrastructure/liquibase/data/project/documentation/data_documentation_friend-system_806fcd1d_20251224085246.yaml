databaseChangeLog:
- changeSet:
    id: documentation-friend-system-806fcd1d
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '9046926886739938'
        - column:
            name: doc_id
            value: friend-system
        - column:
            name: title
            value: Backend системы друзей
        - column:
            name: document_type
            value: implementation
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: approved
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-07 05:20:00+00:00
        - column:
            name: concept_approved
            value: true
        - column:
            name: concept_reviewed_at
            value: 2025-11-07 05:20:00+00:00
        - column:
            name: owners
            value: '[{"role": "concept_director", "contact": "concept@necp.game"}]'
        - column:
            name: tags
            value:
            - social
            - friends
            - backend
        - column:
            name: topics
            value:
            - friend-management
            - online-status
        - column:
            name: related_systems
            value:
            - social-service
            - session-service
            - notification-service
        - column:
            name: related_documents
            value: '[{"id": "relationships-system", "relation": "references"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - concept
            - social
            - backend
        - column:
            name: risk_level
            value: medium
        - column:
            name: content
            value: '{"metadata": {"id": "friend-system", "title": "Backend системы
              друзей", "document_type": "implementation", "category": "systems", "status":
              "approved", "version": "1.0.0", "last_updated": "2025-11-07T05:20:00+00:00",
              "concept_approved": true, "concept_reviewed_at": "2025-11-07T05:20:00+00:00",
              "owners": [{"role": "concept_director", "contact": "concept@necp.game"}],
              "tags": ["social", "friends", "backend"], "topics": ["friend-management",
              "online-status"], "related_systems": ["social-service", "session-service",
              "notification-service"], "related_documents": [{"id": "relationships-system",
              "relation": "references"}], "source": "", "visibility": "internal",
              "audience": ["concept", "social", "backend"], "risk_level": "medium"},
              "review": {"chain": [{"role": "concept_director", "reviewer": "", "reviewed_at":
              "2025-11-07T05:20:00+00:00", "status": "approved"}], "next_actions":
              []}, "summary": {"problem": "Игрокам требуется удобное управление друзьями
              и актуальный онлайн-статус.", "goal": "Описать backend-компонент, который
              обслуживает запросы на дружбу, блокировки и последние контакты.", "essence":
              "Social-service обрабатывает запросы, хранит связи и публикует события
              для уведомлений и статуса.", "key_points": ["Поддержка заявок, принятия,
              удаления и блокировок.", "Событийное обновление статуса онлайн/офлайн.",
              "Интеграция с уведомлениями и отображением прогресса друзей."]}, "content":
              {"sections": [{"id": "architecture", "title": "Архитектура сервиса",
              "body": "Сервис друзей доступен по маршруту `/api/v1/social/friends/*`
              внутри social-service\n(порт 8084). Он взаимодействует с character-service
              для получения профилей, session-service\nдля статуса онлайн и notification-service
              для уведомлений о заявках. Публикуемые события:\n`friend:request-sent`,
              `friend:request-accepted`, `friend:online`, `friend:offline`.\n", "mechanics_links":
              [], "assets": []}, {"id": "data-model", "title": "Модель данных", "body":
              "Таблица `friendships` хранит пары персонажей, статус (PENDING, ACCEPTED,
              BLOCKED),\nинициатора и временные метки. Индексы по каждому персонажу
              позволяют быстро искать\nдрузей и запросы. Проверка `character_a_id
              < character_b_id` предотвращает дубликаты.\n", "mechanics_links": [],
              "assets": []}, {"id": "flows", "title": "Основные сценарии", "body":
              "При отправке заявки сервис создаёт запись, уведомляет получателя и
              ждёт подтверждения.\nПринятие обновляет статус и публикует событие о
              добавлении в друзья. События сессий\n`session:created` и `session:ended`
              обновляют онлайн-статус друзей в реальном времени.\n", "mechanics_links":
              [], "assets": []}]}, "appendix": {"glossary": [], "references": [{"type":
              "repository", "path": "shared/code/backend/social/friend-service/"}],
              "decisions": [{"id": "adr-friend-service", "summary": "Утверждён сервис
              друзей с событийным обновлением статуса и блок-листом."}]}, "implementation":
              {"needs_task": false, "github_issue": 79, "queue_reference": ["shared/trackers/queues/concept/queued.yaml"],
              "blockers": []}, "history": [{"version": "1.0.0", "date": "2025-11-07",
              "author": "Concept Director", "changes": "Утверждена архитектура системы
              друзей."}], "validation": {"checksum": "", "schema_version": "1.0"}}'
        - column:
            name: metadata
            value: '{"id": "friend-system", "title": "Backend системы друзей", "document_type":
              "implementation", "category": "systems", "status": "approved", "version":
              "1.0.0", "last_updated": "2025-11-07T05:20:00+00:00", "concept_approved":
              true, "concept_reviewed_at": "2025-11-07T05:20:00+00:00", "owners":
              [{"role": "concept_director", "contact": "concept@necp.game"}], "tags":
              ["social", "friends", "backend"], "topics": ["friend-management", "online-status"],
              "related_systems": ["social-service", "session-service", "notification-service"],
              "related_documents": [{"id": "relationships-system", "relation": "references"}],
              "source": "", "visibility": "internal", "audience": ["concept", "social",
              "backend"], "risk_level": "medium"}'
        - column:
            name: source_file
            value: knowledge\implementation\backend\friend-system.yaml
