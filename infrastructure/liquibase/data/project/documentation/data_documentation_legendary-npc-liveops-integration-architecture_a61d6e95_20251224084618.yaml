databaseChangeLog:
- changeSet:
    id: documentation-legendary-npc-liveops-integration-architecture-a61d6e95
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '-759353769920091'
        - column:
            name: doc_id
            value: legendary-npc-liveops-integration-architecture
        - column:
            name: title
            value: Архитектура интеграции легендарных NPC с Live Ops и специальными
              механиками (на примере Дэвида Мартинеса)
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-23 14:00:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[{"role": "architect", "contact": "architect@necp.game"}]'
        - column:
            name: tags
            value:
            - architecture
            - npc
            - legendary
            - live-ops
            - sandevistan
            - edgerunners
            - integration
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value:
            - gameplay-service-go
            - world-service-go
            - quest-engine
            - live-ops-service
        - column:
            name: related_documents
            value: '[{"id": "npc-integration-system-architecture", "relation": "extends"},
              {"id": "npc-david-martinez", "relation": "extends"}, {"id": "combat-sandevistan-temporal-overdrive",
              "relation": "references"}, {"id": "live-events-system", "relation":
              "references"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - architect
            - backend
            - game-design
            - api-designer
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "legendary-npc-liveops-integration-architecture",
              "title": "Архитектура интеграции легендарных NPC с Live Ops и специальными
              механиками (на примере Дэвида Мартинеса)", "document_type": "architecture",
              "category": "systems", "status": "draft", "version": "1.0.0", "last_updated":
              "2025-11-23T14:00:00+00:00", "owners": [{"role": "architect", "contact":
              "architect@necp.game"}], "tags": ["architecture", "npc", "legendary",
              "live-ops", "sandevistan", "edgerunners", "integration"], "related_systems":
              ["gameplay-service-go", "world-service-go", "quest-engine", "live-ops-service"],
              "related_documents": [{"id": "npc-integration-system-architecture",
              "relation": "extends"}, {"id": "npc-david-martinez", "relation": "extends"},
              {"id": "combat-sandevistan-temporal-overdrive", "relation": "references"},
              {"id": "live-events-system", "relation": "references"}], "github_issue":
              27, "visibility": "internal", "audience": ["architect", "backend", "game-design",
              "api-designer"]}, "summary": {"problem": "Легендарные NPC (такие как
              Дэвид Мартинес) требуют специфической интеграции\nс системами Live Ops,
              специальными механиками (Sandevistan), сюжетами о киберпсихозе\nи Edgerunners
              командами, которые отличаются от обычных NPC интеграций.\n", "goal":
              "Создать архитектурную схему интеграции легендарных NPC с игровыми системами:\n-
              Интеграция с Live Ops событиями\n- Интеграция с механикой Sandevistan\n-
              Сюжеты о киберпсихозе\n- Edgerunners команды\n- Сезонные события\n-
              API endpoints (высокоуровнево)\n- Техническое задание для реализации\n",
              "essence": "Архитектура интеграции легендарных NPC с Live Ops системами
              и специальными механиками\nдля обеспечения динамического контента и
              сезонных событий.\n"}, "architecture": {"overview": "Система интеграции
              легендарных NPC расширяет общую архитектуру NPC интеграции\nследующими
              компонентами:\n1. Legendary NPC Event Manager - управление событиями
              легендарных NPC\n2. Sandevistan Integration System - интеграция с механикой
              Sandevistan\n3. Cyberpsychosis Story System - система сюжетов о киберпсихозе\n4.
              Edgerunners Team Manager - управление Edgerunners командами\n5. Seasonal
              Event Coordinator - координация сезонных событий\n6. Legendary NPC State
              Manager - управление состоянием легендарных NPC\n7. Live Ops Integration
              System - интеграция с Live Ops\n", "microservices": [{"name": "legendary-npc-event-manager",
              "location": "world-service-go (модуль legendary-npc-events)", "responsibility":
              "Управление событиями легендарных NPC:\n- Создание событий с участием
              легендарных NPC\n- Координация появления легендарных NPC\n- Управление
              наградами за события\n- Интеграция с Live Ops\n", "event_types": ["Legendary
              Encounters (легендарные встречи)", "Story Events (сюжетные события)",
              "Seasonal Events (сезонные события)", "Special Operations (специальные
              операции)"], "endpoints": ["GET /api/v1/legendary-npc/{npc_id}/events
              - события NPC", "GET /api/v1/legendary-npc/{npc_id}/events/{event_id}
              - информация о событии", "POST /api/v1/legendary-npc/{npc_id}/events/{event_id}/join
              - присоединение к событию", "POST /api/v1/legendary-npc/{npc_id}/events/{event_id}/complete
              - завершение события"]}, {"name": "sandevistan-integration-system",
              "location": "gameplay-service-go (модуль sandevistan-integration)",
              "responsibility": "Интеграция с механикой Sandevistan:\n- Управление
              Sandevistan способностями для NPC\n- Координация временного овердрайва\n-
              Интеграция с боевой системой\n- Управление рисками киберпсихоза\n",
              "sandevistan_features": ["Temporal Overdrive (временной овердрайв)",
              "Action Priority Budget (бюджет приоритетных действий)", "Perception
              Drag (задержка восприятия)", "Cyberpsychosis Risk (риск киберпсихоза)"],
              "endpoints": ["POST /api/v1/legendary-npc/{npc_id}/sandevistan/activate
              - активация Sandevistan", "GET /api/v1/legendary-npc/{npc_id}/sandevistan/status
              - статус Sandevistan", "POST /api/v1/legendary-npc/{npc_id}/sandevistan/cooling
              - охлаждение системы", "GET /api/v1/legendary-npc/{npc_id}/sandevistan/cyberpsychosis-risk
              - риск киберпсихоза"]}, {"name": "cyberpsychosis-story-system", "location":
              "gameplay-service-go (модуль cyberpsychosis-stories)", "responsibility":
              "Система сюжетов о киберпсихозе:\n- Управление сюжетами о киберпсихозе\n-
              Отслеживание прогресса киберпсихоза\n- Управление последствиями киберпсихоза\n-
              Интеграция с квестами\n", "cyberpsychosis_features": ["Psychosis progression
              (прогрессия киберпсихоза)", "Warning signs (предупреждающие знаки)",
              "Intervention events (события вмешательства)", "Recovery mechanics (механики
              восстановления)"], "endpoints": ["GET /api/v1/legendary-npc/{npc_id}/cyberpsychosis/status
              - статус киберпсихоза", "GET /api/v1/legendary-npc/{npc_id}/cyberpsychosis/stories
              - сюжеты о киберпсихозе", "POST /api/v1/legendary-npc/{npc_id}/cyberpsychosis/intervene
              - вмешательство", "GET /api/v1/legendary-npc/{npc_id}/cyberpsychosis/progression
              - прогрессия"]}, {"name": "edgerunners-team-manager", "location": "gameplay-service-go
              (модуль edgerunners-teams)", "responsibility": "Управление Edgerunners
              командами:\n- Создание Edgerunners команд\n- Управление участниками
              команд\n- Координация операций команд\n- Управление наградами команд\n",
              "team_features": ["Team formation (формирование команд)", "Team operations
              (операции команд)", "Team reputation (репутация команд)", "Team resources
              (ресурсы команд)"], "endpoints": ["GET /api/v1/edgerunners/teams - список
              команд", "POST /api/v1/edgerunners/teams - создание команды", "GET /api/v1/edgerunners/teams/{team_id}
              - информация о команде", "POST /api/v1/edgerunners/teams/{team_id}/join
              - присоединение к команде", "POST /api/v1/edgerunners/teams/{team_id}/operations/{op_id}/start
              - запуск операции"]}, {"name": "seasonal-event-coordinator", "location":
              "world-service-go (модуль seasonal-events)", "responsibility": "Координация
              сезонных событий:\n- Планирование сезонных событий\n- Координация участия
              легендарных NPC\n- Управление наградами за сезоны\n- Интеграция с Live
              Ops\n", "seasonal_features": ["Event scheduling (планирование событий)",
              "NPC participation (участие NPC)", "Seasonal rewards (сезонные награды)",
              "Event progression (прогрессия событий)"], "endpoints": ["GET /api/v1/seasonal/events
              - сезонные события", "GET /api/v1/seasonal/events/{event_id} - информация
              о событии", "GET /api/v1/seasonal/events/{event_id}/legendary-npcs -
              легендарные NPC в событии", "POST /api/v1/seasonal/events/{event_id}/join
              - присоединение к событию"]}, {"name": "legendary-npc-state-manager",
              "location": "world-service-go (модуль legendary-npc-state)", "responsibility":
              "Управление состоянием легендарных NPC:\n- Хранение состояния легендарных
              NPC\n- Синхронизация между сервисами\n- Управление жизненным циклом\n-
              Персистентность состояния\n", "state_features": ["Legendary status (легендарный
              статус)", "Story progression (прогрессия сюжета)", "Event participation
              (участие в событиях)", "Relationship tracking (отслеживание отношений)"],
              "endpoints": ["GET /api/v1/legendary-npc/{npc_id}/state - состояние
              NPC", "POST /api/v1/legendary-npc/{npc_id}/state/update - обновление
              состояния", "GET /api/v1/legendary-npc/{npc_id}/story/progression -
              прогрессия сюжета"]}, {"name": "live-ops-integration-system", "location":
              "world-service-go (модуль live-ops-integration)", "responsibility":
              "Интеграция с Live Ops:\n- Синхронизация с Live Ops событиями\n- Управление
              появлением легендарных NPC\n- Координация с сезонными кампаниями\n-
              Интеграция с аналитикой\n", "live_ops_features": ["Event synchronization
              (синхронизация событий)", "NPC spawning (появление NPC)", "Campaign
              coordination (координация кампаний)", "Analytics integration (интеграция
              с аналитикой)"], "endpoints": ["GET /api/v1/live-ops/events - активные
              Live Ops события", "GET /api/v1/live-ops/events/{event_id}/legendary-npcs
              - легендарные NPC в событии", "POST /api/v1/live-ops/events/{event_id}/trigger
              - триггер события", "GET /api/v1/live-ops/campaigns - активные кампании"]}],
              "data_flow": {"live_ops_event_flow": "1. Live Ops система планирует
              сезонное событие\n2. Seasonal Event Coordinator создаёт событие\n3.
              Legendary NPC Event Manager определяет участие Дэвида Мартинеса\n4.
              Игроки получают уведомление о событии\n5. Игроки присоединяются к событию\n6.
              Дэвид Мартинес появляется в событии\n7. Игроки взаимодействуют с Дэвидом\n8.
              Событие проходит с участием легендарного NPC\n9. При завершении события
              выдаются награды\n10. Legendary NPC State Manager обновляет состояние\n",
              "sandevistan_activation_flow": "1. Дэвид Мартинес активирует Sandevistan
              в бою\n2. Sandevistan Integration System обрабатывает активацию\n3.
              Сервер выделяет Action Priority Budget\n4. Клиент получает локальное
              слоумо\n5. Другие игроки получают Perception Drag\n6. Дэвид выполняет
              действия в ускоренном режиме\n7. Sandevistan Integration System отслеживает
              риск киберпсихоза\n8. При перегреве активируется Cyberpsychosis Story
              System\n9. Игроки могут вмешаться для помощи\n", "cyberpsychosis_story_flow":
              "1. Дэвид Мартинес использует Sandevistan слишком часто\n2. Cyberpsychosis
              Story System отслеживает прогрессию\n3. Система детектирует предупреждающие
              знаки\n4. Игроки получают уведомление о риске киберпсихоза\n5. Игроки
              могут вмешаться через квесты\n6. Cyberpsychosis Story System управляет
              сюжетом\n7. При успешном вмешательстве киберпсихоз предотвращается\n8.
              При провале активируется событие киберпсихоза\n9. Legendary NPC State
              Manager обновляет состояние\n", "edgerunners_team_flow": "1. Игроки
              формируют Edgerunners команду\n2. Edgerunners Team Manager создаёт команду\n3.
              Дэвид Мартинес может присоединиться к команде\n4. Команда получает доступ
              к специальным операциям\n5. Edgerunners Team Manager координирует операции\n6.
              Команда выполняет операции вместе с Дэвидом\n7. При успешном выполнении
              выдаются награды\n8. Edgerunners Team Manager обновляет репутацию команды\n"},
              "integrations": {"with_npc_integration_system": "- Использование NPC
              Quest Manager для квестов\n- Использование NPC Relationship Tracker
              для отношений\n- Использование NPC Dialogue System для диалогов\n- Использование
              NPC Event Trigger System для событий\n", "with_live_ops_system": "-
              Синхронизация с Live Ops событиями\n- Управление сезонными кампаниями\n-
              Интеграция с аналитикой\n- Координация появления NPC\n", "with_combat_system":
              "- Интеграция с механикой Sandevistan\n- Управление временным овердрайвом\n-
              Координация боевых действий\n- Управление рисками киберпсихоза\n", "with_quest_engine":
              "- Создание квестов с легендарными NPC\n- Интеграция с сюжетами о киберпсихозе\n-
              Управление наградами за квесты\n", "with_world_service": "- Управление
              состоянием легендарных NPC\n- Синхронизация событий\n- Интеграция с
              Live Ops\n"}, "database_schema": {"tables": [{"name": "legendary_npc_events",
              "description": "События с легендарными NPC", "fields": [{"id": "UUID
              (PK)"}, {"npc_id": "VARCHAR(50) (FK npcs)"}, {"event_type": "ENUM (legendary_encounter,
              story_event, seasonal_event, special_operation)"}, {"title": "VARCHAR(255)"},
              {"description": "TEXT"}, {"requirements": "JSONB (требования для участия)"},
              {"rewards": "JSONB (награды за событие)"}, {"status": "ENUM (pending,
              active, completed, cancelled)"}, {"participants": "UUID[] (array of
              player IDs)"}, {"created_at": "TIMESTAMP"}, {"updated_at": "TIMESTAMP"}],
              "indexes": ["npc_id, status", "event_type, status"]}, {"name": "legendary_npc_sandevistan_state",
              "description": "Состояние Sandevistan у легендарных NPC", "fields":
              [{"id": "UUID (PK)"}, {"npc_id": "VARCHAR(50) (FK npcs)"}, {"is_active":
              "BOOLEAN (активен ли Sandevistan)"}, {"activation_count": "INTEGER (количество
              активаций)"}, {"heat_level": "INTEGER (уровень перегрева, 0-100)"},
              {"cyberpsychosis_risk": "INTEGER (риск киберпсихоза, 0-100)"}, {"last_activation":
              "TIMESTAMP (nullable)"}, {"last_cooling": "TIMESTAMP (nullable)"}, {"created_at":
              "TIMESTAMP"}, {"updated_at": "TIMESTAMP"}], "indexes": ["npc_id, is_active",
              "cyberpsychosis_risk"]}, {"name": "cyberpsychosis_stories", "description":
              "Сюжеты о киберпсихозе", "fields": [{"id": "UUID (PK)"}, {"npc_id":
              "VARCHAR(50) (FK npcs)"}, {"story_type": "ENUM (warning, intervention,
              recovery, full_psychosis)"}, {"progression_level": "INTEGER (уровень
              прогрессии, 0-100)"}, {"warning_signs": "JSONB (предупреждающие знаки)"},
              {"intervention_events": "JSONB (события вмешательства)"}, {"status":
              "ENUM (pending, active, resolved, failed)"}, {"created_at": "TIMESTAMP"},
              {"updated_at": "TIMESTAMP"}], "indexes": ["npc_id, status", "progression_level"]},
              {"name": "edgerunners_teams", "description": "Edgerunners команды",
              "fields": [{"id": "UUID (PK)"}, {"team_name": "VARCHAR(255)"}, {"leader_id":
              "UUID (FK accounts)"}, {"members": "UUID[] (array of player IDs)"},
              {"legendary_npc_members": "VARCHAR(50)[] (array of NPC IDs)"}, {"reputation":
              "INTEGER (репутация команды)"}, {"operations_completed": "INTEGER (завершённых
              операций)"}, {"status": "ENUM (active, inactive, disbanded)"}, {"created_at":
              "TIMESTAMP"}, {"updated_at": "TIMESTAMP"}], "indexes": ["leader_id,
              status", "reputation"]}, {"name": "edgerunners_operations", "description":
              "Операции Edgerunners команд", "fields": [{"id": "UUID (PK)"}, {"team_id":
              "UUID (FK edgerunners_teams)"}, {"operation_type": "ENUM (heist, rescue,
              sabotage, protection)"}, {"title": "VARCHAR(255)"}, {"description":
              "TEXT"}, {"requirements": "JSONB (требования для операции)"}, {"rewards":
              "JSONB (награды за операцию)"}, {"status": "ENUM (pending, active, completed,
              failed)"}, {"participants": "UUID[] (array of player IDs)"}, {"legendary_npc_participants":
              "VARCHAR(50)[] (array of NPC IDs)"}, {"created_at": "TIMESTAMP"}, {"updated_at":
              "TIMESTAMP"}], "indexes": ["team_id, status", "operation_type, status"]},
              {"name": "seasonal_events", "description": "Сезонные события", "fields":
              [{"id": "UUID (PK)"}, {"event_name": "VARCHAR(255)"}, {"season": "VARCHAR(50)
              (сезон события)"}, {"start_date": "TIMESTAMP"}, {"end_date": "TIMESTAMP"},
              {"legendary_npc_participants": "VARCHAR(50)[] (array of NPC IDs)"},
              {"event_data": "JSONB (данные события)"}, {"status": "ENUM (scheduled,
              active, completed, cancelled)"}, {"created_at": "TIMESTAMP"}, {"updated_at":
              "TIMESTAMP"}], "indexes": ["season, status", "start_date, end_date"]},
              {"name": "legendary_npc_state", "description": "Состояние легендарных
              NPC", "fields": [{"id": "UUID (PK)"}, {"npc_id": "VARCHAR(50) (FK npcs)"},
              {"story_progression": "JSONB (прогрессия сюжета)"}, {"event_participation":
              "JSONB (участие в событиях)"}, {"relationship_data": "JSONB (данные
              отношений)"}, {"special_abilities": "JSONB (специальные способности)"},
              {"status": "ENUM (active, inactive, story_locked)"}, {"created_at":
              "TIMESTAMP"}, {"updated_at": "TIMESTAMP"}], "indexes": ["npc_id, status"]}]}}}'
        - column:
            name: metadata
            value: '{"id": "legendary-npc-liveops-integration-architecture", "title":
              "Архитектура интеграции легендарных NPC с Live Ops и специальными механиками
              (на примере Дэвида Мартинеса)", "document_type": "architecture", "category":
              "systems", "status": "draft", "version": "1.0.0", "last_updated": "2025-11-23T14:00:00+00:00",
              "owners": [{"role": "architect", "contact": "architect@necp.game"}],
              "tags": ["architecture", "npc", "legendary", "live-ops", "sandevistan",
              "edgerunners", "integration"], "related_systems": ["gameplay-service-go",
              "world-service-go", "quest-engine", "live-ops-service"], "related_documents":
              [{"id": "npc-integration-system-architecture", "relation": "extends"},
              {"id": "npc-david-martinez", "relation": "extends"}, {"id": "combat-sandevistan-temporal-overdrive",
              "relation": "references"}, {"id": "live-events-system", "relation":
              "references"}], "github_issue": 27, "visibility": "internal", "audience":
              ["architect", "backend", "game-design", "api-designer"]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\legendary-npc-liveops-integration-architecture.yaml
