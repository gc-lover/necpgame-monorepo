databaseChangeLog:
- changeSet:
    id: documentation-maintenance-mode-technical-c8095b61
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '-819941873336198'
        - column:
            name: doc_id
            value: maintenance-mode-technical
        - column:
            name: title
            value: Архитектура системы режима обслуживания - Техническое задание
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.1.0
        - column:
            name: last_updated
            value: 2025-11-30 20:55:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[]'
        - column:
            name: tags
            value: []
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value: []
        - column:
            name: related_documents
            value: '[{"id": "maintenance-mode-core", "relation": "extends"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: ''
        - column:
            name: audience
            value: []
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "maintenance-mode-technical", "title": "Архитектура
              системы режима обслуживания - Техническое задание", "document_type":
              "architecture", "category": "systems", "status": "draft", "version":
              "1.1.0", "last_updated": "2025-11-30T20:55:00+00:00", "github_issue":
              316, "related_documents": [{"id": "maintenance-mode-core", "relation":
              "extends"}]}, "technical_specification": {"subtasks": [{"id": "maintenance-manager",
              "title": "Реализация менеджера системы обслуживания", "description":
              "Реализация Maintenance Manager с управлением системой обслуживания\nи
              интеграцией с другими компонентами.\n", "dependencies": [], "estimated_effort":
              "4 days"}, {"id": "maintenance-window-manager", "title": "Реализация
              менеджера окон обслуживания", "description": "Реализация Maintenance
              Window Manager с управлением окнами обслуживания,\nсозданием, обновлением
              и удалением окон.\n", "dependencies": ["maintenance-manager"], "estimated_effort":
              "4 days"}, {"id": "maintenance-status-manager", "title": "Реализация
              менеджера статуса обслуживания", "description": "Реализация Maintenance
              Status Manager с управлением статусом обслуживания,\nобновлением статуса
              и проверкой режима обслуживания.\n", "dependencies": ["maintenance-manager"],
              "estimated_effort": "3 days"}, {"id": "scheduled-maintenance-manager",
              "title": "Реализация менеджера планового обслуживания", "description":
              "Реализация Scheduled Maintenance Manager с управлением плановым обслуживанием,\nпланированием
              окон и автоматическим запуском.\n", "dependencies": ["maintenance-window-manager"],
              "estimated_effort": "4 days"}, {"id": "emergency-maintenance-manager",
              "title": "Реализация менеджера экстренного обслуживания", "description":
              "Реализация Emergency Maintenance Manager с управлением экстренным обслуживанием,\nтриггерами
              и немедленным запуском.\n", "dependencies": ["maintenance-window-manager"],
              "estimated_effort": "4 days"}, {"id": "graceful-shutdown-manager", "title":
              "Реализация менеджера graceful shutdown", "description": "Реализация
              Graceful Shutdown Manager с управлением graceful shutdown,\nожиданием
              завершения активных запросов и закрытием соединений.\n", "dependencies":
              ["maintenance-manager"], "estimated_effort": "5 days"}, {"id": "connection-blocker",
              "title": "Реализация блокировщика соединений", "description": "Реализация
              Connection Blocker с блокировкой новых соединений,\nmiddleware для API
              Gateway и возвратом статуса 503.\n", "dependencies": ["maintenance-status-manager"],
              "estimated_effort": "3 days"}, {"id": "maintenance-notification-manager",
              "title": "Реализация менеджера уведомлений", "description": "Реализация
              Maintenance Notification Manager с управлением уведомлениями,\nотправкой
              через различные каналы и логированием.\n", "dependencies": ["maintenance-manager"],
              "estimated_effort": "4 days"}, {"id": "maintenance-analytics-collector",
              "title": "Реализация сборщика аналитики", "description": "Реализация
              Maintenance Analytics Collector с логированием операций,\nсбором метрик
              и интеграцией с Analytics Service.\n", "dependencies": ["maintenance-manager"],
              "estimated_effort": "3 days"}, {"id": "maintenance-telemetry-collector",
              "title": "Реализация сборщика телеметрии", "description": "Реализация
              Maintenance Telemetry Collector с логированием событий,\nсбором телеметрии
              и интеграцией с Analytics Service.\n", "dependencies": ["maintenance-manager"],
              "estimated_effort": "2 days"}, {"id": "websocket-channels", "title":
              "Реализация WebSocket каналов", "description": "Реализация WebSocket
              каналов для realtime обновлений статуса обслуживания\nи уведомлений.\n",
              "dependencies": ["maintenance-manager"], "estimated_effort": "3 days"},
              {"id": "event-bus-integration", "title": "Интеграция с Event Bus", "description":
              "Реализация публикации и подписки на события через Kafka\nдля всех компонентов
              системы обслуживания.\n", "dependencies": ["maintenance-manager"], "estimated_effort":
              "2 days"}, {"id": "database-schema", "title": "Создание схемы БД", "description":
              "Создание таблиц БД для окон обслуживания, статуса, уведомлений\nи телеметрии
              с миграциями Liquibase.\n", "dependencies": [], "estimated_effort":
              "3 days"}]}, "diagrams": {"component_diagram": "```mermaid\ngraph TB\n    Client[UE5
              Client] --> Gateway[API Gateway]\n\n    Gateway --> InfrastructureService[Infrastructure
              Service<br/>8093]\n\n    InfrastructureService --> MM[Maintenance Manager]\n    InfrastructureService
              --> MWM[Maintenance Window Manager]\n    InfrastructureService --> MSM[Maintenance
              Status Manager]\n    InfrastructureService --> SMM[Scheduled Maintenance
              Manager]\n    InfrastructureService --> EMM[Emergency Maintenance Manager]\n    InfrastructureService
              --> GSM[Graceful Shutdown Manager]\n    InfrastructureService --> CB[Connection
              Blocker]\n    InfrastructureService --> MNM[Maintenance Notification
              Manager]\n    InfrastructureService --> MAC[Maintenance Analytics Collector]\n    InfrastructureService
              --> MTC[Maintenance Telemetry Collector]\n\n    MM --> MWM\n    MM -->
              MSM\n    MWM --> SMM\n    MWM --> EMM\n    MSM --> CB\n    MM --> GSM\n    MM
              --> MNM\n\n    InfrastructureService --> APIGateway[API Gateway]\n    InfrastructureService
              --> NotificationService[Notification Service]\n    InfrastructureService
              --> DeploymentService[Deployment Service]\n    InfrastructureService
              --> MonitoringService[Monitoring Service]\n    InfrastructureService
              --> AnalyticsService[Analytics Service]\n\n    InfrastructureService
              --> EventBus[Event Bus<br/>Kafka]\n    EventBus --> RealtimeGateway[Realtime
              Gateway]\n\n    InfrastructureService --> DB[(Infrastructure DB)]\n\n    Client
              --> WSMaintenance[WebSocket<br/>Maintenance]\n    WSMaintenance -->
              InfrastructureService\n```\n", "scheduled_maintenance_flow_diagram":
              "```mermaid\nsequenceDiagram\n    participant Admin as Administrator\n    participant
              MWM as Maintenance Window Manager\n    participant MNM as Maintenance
              Notification Manager\n    participant MSM as Maintenance Status Manager\n    participant
              CB as Connection Blocker\n    participant GSM as Graceful Shutdown Manager\n    participant
              EB as Event Bus\n\n    Admin->>MWM: Create maintenance window\n    MWM->>MWM:
              Save window to DB\n    MWM->>MNM: Schedule notifications (24h, 1h)\n    MWM->>MSM:
              Update status to \"starting\"\n    MSM->>CB: Block new connections\n    MSM->>GSM:
              Start graceful shutdown\n    GSM->>GSM: Wait for active requests\n    GSM->>GSM:
              Close connections\n    GSM->>MSM: Shutdown complete\n    MSM->>MSM:
              Update status to \"completed\"\n    MSM->>MNM: Send completion notification\n    MSM->>EB:
              Publish maintenance.ended\n```\n", "emergency_maintenance_flow_diagram":
              "```mermaid\nsequenceDiagram\n    participant Trigger as Infrastructure
              Alert\n    participant EMM as Emergency Maintenance Manager\n    participant
              MNM as Maintenance Notification Manager\n    participant MSM as Maintenance
              Status Manager\n    participant CB as Connection Blocker\n    participant
              GSM as Graceful Shutdown Manager\n    participant EB as Event Bus\n\n    Trigger->>EMM:
              Emergency maintenance trigger\n    EMM->>EMM: Create emergency window\n    EMM->>MNM:
              Send immediate notification\n    EMM->>MSM: Update status to \"starting\"\n    MSM->>CB:
              Block new connections\n    MSM->>GSM: Start graceful shutdown\n    GSM->>GSM:
              Wait for active requests\n    GSM->>GSM: Close connections\n    GSM->>MSM:
              Shutdown complete\n    MSM->>MSM: Update status to \"completed\"\n    MSM->>MNM:
              Send completion notification\n    MSM->>EB: Publish maintenance.ended\n```\n"},
              "history": [{"version": "1.1.0", "date": "2025-11-30", "author": "Architect
              Agent", "changes": "Добавлена детальная синхронизация данных:\n- Event
              Sourcing для всех изменений состояния режима обслуживания\n- CQRS Pattern
              для разделения команд и запросов\n- Saga Pattern для распределенных
              операций (начало обслуживания, graceful shutdown, завершение обслуживания)\n-
              Outbox Pattern для гарантированной доставки событий\n- Обновлена секция
              data_consistency с механизмами синхронизации\n- Добавлена спецификация
              тикрейта для статуса, окон, обслуживания, graceful shutdown, блокировки
              соединений, уведомлений и обработки событий\n"}, {"version": "1.0.0",
              "date": "2025-11-23", "author": "Architect Agent", "changes": "Создана
              полная архитектура системы режима обслуживания:\n- Определены компоненты
              (Maintenance Manager, Maintenance Window Manager, Maintenance Status
              Manager, Scheduled Maintenance Manager, Emergency Maintenance Manager,
              Graceful Shutdown Manager, Connection Blocker, Maintenance Notification
              Manager)\n- Описаны API endpoints (высокоуровнево)\n- Спроектированы
              потоки данных\n- Определена структура БД (maintenance_windows, maintenance_status,
              maintenance_notifications, maintenance_telemetry)\n- Спроектирована
              система планового обслуживания\n- Спроектирована система экстренного
              обслуживания\n- Спроектирована система graceful shutdown\n- Спроектирована
              система уведомлений\n- Создано техническое задание\n- Разбито на подзадачи\n"}]}'
        - column:
            name: metadata
            value: '{"id": "maintenance-mode-technical", "title": "Архитектура системы
              режима обслуживания - Техническое задание", "document_type": "architecture",
              "category": "systems", "status": "draft", "version": "1.1.0", "last_updated":
              "2025-11-30T20:55:00+00:00", "github_issue": 316, "related_documents":
              [{"id": "maintenance-mode-core", "relation": "extends"}]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\maintenance-mode-technical.yaml
