databaseChangeLog:
- changeSet:
    id: documentation-npc-hiring-system-architecture-2ac85cb4
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '-887301636264905'
        - column:
            name: doc_id
            value: npc-hiring-system-architecture
        - column:
            name: title
            value: Архитектура системы найма NPC
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-23 23:30:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[{"role": "architect", "contact": "architect@necp.game"}]'
        - column:
            name: tags
            value:
            - architecture
            - social
            - npc-hiring
            - workforce-management
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value:
            - social-service
            - economy-service
            - world-service
            - npc-service
        - column:
            name: related_documents
            value: '[{"id": "npc-hiring-system-detailed", "relation": "implements"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - architect
            - backend
            - social
            - api-designer
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "npc-hiring-system-architecture", "title":
              "Архитектура системы найма NPC", "document_type": "architecture", "category":
              "systems", "status": "draft", "version": "1.0.0", "last_updated": "2025-11-23T23:30:00+00:00",
              "owners": [{"role": "architect", "contact": "architect@necp.game"}],
              "tags": ["architecture", "social", "npc-hiring", "workforce-management"],
              "related_systems": ["social-service", "economy-service", "world-service",
              "npc-service"], "related_documents": [{"id": "npc-hiring-system-detailed",
              "relation": "implements"}], "github_issue": 304, "visibility": "internal",
              "audience": ["architect", "backend", "social", "api-designer"]}, "summary":
              {"problem": "Требуется спроектировать архитектуру системы найма NPC,
              включающую:\n- Типы найма (торговцы, фиксеры, телохранители, наемники,
              дипломаты, инженеры, хакеры и т.д.)\n- Процесс найма (поиск, переговоры,
              контракт, запуск)\n- Экономику найма (зарплаты, расходы, доходы, инвестиции,
              налоги)\n- Управление персоналом (назначение задач, мониторинг, коммуникация)\n-
              Эффективность и развитие NPC\n- Ограничения и лимиты\n- Продвинутые
              механики (цепочки найма, групповые контракты, автоматизация)\n", "goal":
              "Создать архитектурную схему системы найма NPC с определением:\n- Компонентов
              для управления наймом\n- REST, WebSocket и Event Bus контрактов\n- Интеграций
              с другими системами\n- Структуры БД\n- Технического задания для реализации\n",
              "essence": "Объединенная архитектура системы найма NPC с поддержкой
              типов найма,\nпроцесса найма, экономики, управления персоналом и продвинутых
              механик.\n"}, "architecture": {"overview": "Архитектура системы найма
              NPC состоит из следующих компонентов:\n1. NPC Hiring Manager - управление
              наймом NPC\n2. NPC Discovery Service - поиск кандидатов\n3. Contract
              Negotiation Manager - переговоры и контракты\n4. Workforce Manager -
              управление нанятым персоналом\n5. Task Assignment Manager - назначение
              задач\n6. Performance Monitor - мониторинг эффективности\n7. Economy
              Manager - управление экономикой найма\n8. Limit Validator - проверка
              ограничений и лимитов\n9. Advanced Mechanics Manager - продвинутые механики\n10.
              NPC Hiring Telemetry Collector - сбор телеметрии\n", "microservices":
              [{"name": "social-service", "port": 8084, "responsibility": "Обработка
              найма NPC:\n- Управление наймом NPC\n- Поиск кандидатов\n- Переговоры
              и контракты\n- Управление персоналом\n- Назначение задач\n- Мониторинг
              эффективности\n- Управление экономикой найма\n- Проверка ограничений\n-
              Продвинутые механики\n- Сбор телеметрии\n", "components": [{"npc-hiring-manager":
              "управление наймом NPC"}, {"npc-discovery-service": "поиск кандидатов"},
              {"contract-negotiation-manager": "переговоры и контракты"}, {"workforce-manager":
              "управление нанятым персоналом"}, {"task-assignment-manager": "назначение
              задач"}, {"performance-monitor": "мониторинг эффективности"}, {"economy-manager":
              "управление экономикой найма"}, {"limit-validator": "проверка ограничений
              и лимитов"}, {"advanced-mechanics-manager": "продвинутые механики"},
              {"npc-hiring-telemetry-collector": "сбор телеметрии"}], "endpoints":
              ["GET /api/v1/social/npc-hiring/candidates - поиск кандидатов", "GET
              /api/v1/social/npc-hiring/candidates/{npcId} - информация о кандидате",
              "POST /api/v1/social/npc-hiring/negotiate - начало переговоров", "POST
              /api/v1/social/npc-hiring/contract/create - создание контракта", "GET
              /api/v1/social/npc-hiring/contracts - список контрактов", "GET /api/v1/social/npc-hiring/contracts/{contractId}
              - информация о контракте", "POST /api/v1/social/npc-hiring/contracts/{contractId}/terminate
              - расторжение контракта", "GET /api/v1/social/npc-hiring/workforce -
              список нанятых NPC", "POST /api/v1/social/npc-hiring/workforce/{npcId}/assign-task
              - назначение задачи", "GET /api/v1/social/npc-hiring/workforce/{npcId}/tasks
              - список задач NPC", "POST /api/v1/social/npc-hiring/workforce/{npcId}/tasks/{taskId}/update
              - обновление задачи", "GET /api/v1/social/npc-hiring/workforce/{npcId}/performance
              - эффективность NPC", "GET /api/v1/social/npc-hiring/workforce/{npcId}/status
              - статус NPC", "POST /api/v1/social/npc-hiring/workforce/{npcId}/interact
              - взаимодействие с NPC", "GET /api/v1/social/npc-hiring/economy/payroll
              - расчет зарплат", "POST /api/v1/social/npc-hiring/economy/pay - выплата
              зарплаты", "GET /api/v1/social/npc-hiring/economy/reports - отчеты по
              экономике", "GET /api/v1/social/npc-hiring/limits - проверка лимитов
              найма", "POST /api/v1/social/npc-hiring/chain/create - создание цепочки
              найма", "POST /api/v1/social/npc-hiring/group/create - создание группового
              контракта", "POST /api/v1/social/npc-hiring/automation/configure - настройка
              автоматизации"], "websocket_channels": ["wss://api.necp.game/v1/social/npc-hiring/{characterId}
              - поток обновлений найма и задач"], "events_published": [{"social.npc-hiring.candidate-found":
              "найден кандидат"}, {"social.npc-hiring.negotiation-started": "начаты
              переговоры"}, {"social.npc-hiring.contract-created": "создан контракт"},
              {"social.npc-hiring.contract-terminated": "расторгнут контракт"}, {"social.npc-hiring.npc-hired":
              "NPC нанят"}, {"social.npc-hiring.task-assigned": "назначена задача"},
              {"social.npc-hiring.task-completed": "задача выполнена"}, {"social.npc-hiring.performance-updated":
              "обновлена эффективность"}, {"social.npc-hiring.payroll-processed":
              "обработана зарплата"}, {"social.npc-hiring.limit-reached": "достигнут
              лимит найма"}, {"social.npc-hiring.chain-created": "создана цепочка
              найма"}, {"social.npc-hiring.group-created": "создан групповой контракт"}],
              "events_subscribed": [{"quest.completed": "завершение квеста"}, {"economy.transaction":
              "транзакция в экономике"}, {"world.event": "событие мира"}, {"npc.interaction":
              "взаимодействие с NPC"}, {"reputation.changed": "изменение репутации"},
              {"character.level-up": "повышение уровня персонажа"}]}], "hiring_types":
              [{"name": "merchant", "description": "Торговец - управляет продажами,
              закупками и кабинетом игрока", "requirements": [{"reputation": "medium"},
              {"skills": ["trading", "negotiation"]}, {"capital": "required"}], "autonomy":
              true}, {"name": "quest_giver", "description": "Квестодатель - формирует
              и управляет квестами", "requirements": [{"reputation": "medium"}, {"skills":
              ["social", "quest_management"]}, {"access": "quest_system"}], "autonomy":
              false}, {"name": "fixer", "description": "Фиксер - организует заказы,
              управляет сетью контактов", "requirements": [{"reputation": "high"},
              {"skills": ["networking", "negotiation"]}, {"network": "required"}],
              "autonomy": true}, {"name": "bodyguard", "description": "Телохранитель
              - обеспечивает защиту игрока и имущества", "requirements": [{"reputation":
              "medium"}, {"skills": ["combat", "protection"]}, {"equipment": "required"}],
              "autonomy": false}, {"name": "mercenary", "description": "Наемник -
              специалист по боевым операциям и рейдам", "requirements": [{"reputation":
              "medium"}, {"skills": ["combat", "tactics"]}, {"equipment": "required"}],
              "autonomy": false}, {"name": "diplomat", "description": "Дипломат -
              ведет переговоры, улучшает отношения с фракциями", "requirements": [{"reputation":
              "high"}, {"skills": ["diplomacy", "negotiation"]}, {"faction_access":
              "required"}], "autonomy": true}, {"name": "engineer", "description":
              "Инженер - ремонт, модификация и создание оборудования", "requirements":
              [{"reputation": "medium"}, {"skills": ["engineering", "crafting"]},
              {"workshop": "required"}], "autonomy": true}, {"name": "hacker", "description":
              "Хакер - сетевые операции, взлом и защита", "requirements": [{"reputation":
              "medium"}, {"skills": ["hacking", "netrunning"]}, {"equipment": "required"}],
              "autonomy": true}], "hiring_process": {"discovery": "- Поиск кандидатов
              через рынок труда\n- Рекомендации от других NPC\n- Прямой поиск по навыкам
              и репутации\n- Фильтрация по требованиям и стоимости\n", "negotiation":
              "- Торг о зарплате и условиях\n- Зависимость от отношений и навыков
              игрока\n- Определение параметров контракта\n- Проверка доступности NPC\n",
              "contract": "- Фиксация обязанностей NPC\n- Определение обязанностей
              игрока\n- Установка сроков контракта\n- Условия расторжения и штрафы\n-
              Тип оплаты (зарплата, разовые выплаты, доля от прибыли)\n", "onboarding":
              "- NPC приступает к задачам\n- Выбор режима управления (прямой, автономный,
              гибридный)\n- Настройка приоритетов задач\n- Запуск мониторинга эффективности\n"},
              "economy_model": {"cost_factors": "- Навыки NPC\n- Уровень отношений\n-
              Тип найма\n- Автономность\n- Условия работы\n- Риск заданий\n", "payment_models":
              "- Зарплата (регулярные выплаты)\n- Разовые выплаты\n- Доля от прибыли\n-
              Комбинированные схемы\n", "player_rewards": "- Прямая прибыль\n- Комиссия
              за операции\n- Экономия времени\n- Доступ к эксклюзивным активностям\n"},
              "management_features": {"management_modes": "- Прямой контроль (игрок
              управляет задачами)\n- Автономная работа (NPC работает самостоятельно)\n-
              Гибридный режим (комбинация прямого и автономного)\n", "task_configuration":
              "- Назначение списка задач\n- Установка приоритетов\n- Ограничение ресурсов\n-
              Динамическое изменение задач\n", "monitoring": "- Статус NPC\n- Прогресс
              заданий\n- Эффективность работы\n- Выявленные проблемы\n- История работы\n",
              "interaction": "- Общение с NPC\n- Обучение NPC\n- Поощрения и критика\n-
              Влияние на отношение и продуктивность\n"}, "effectiveness_system": {"skill_impact":
              "- Навыки и специализация определяют качество выполнения задач\n- Продвижение
              по рангу увеличивает эффективность\n- Обучение открывает уникальные
              сценарии\n", "relationship_levels": "- 5 уровней отношений (враждебность,
              неприязнь, нейтрал, дружба, союз)\n- Коэффициенты эффективности на основе
              отношений\n- Поддержание доверия предотвращает саботаж\n", "working_conditions":
              "- Безопасность заданий\n- Доступность ресурсов\n- Поддержка игрока\n-
              Автономность работы\n- Влияние на устойчивость производительности\n"},
              "limits_system": {"limit_structure": "- Максимальное количество активных
              контрактов по категориям NPC\n- Зависимость от уровня игрока\n- Зависимость
              от состояния организации\n- Зависимость от типа NPC\n", "scaling_factors":
              "- Рост уровня игрока\n- Улучшение репутации\n- Наличие специальных
              навыков\n- Технологии и инфраструктура\n- Создание клана\n", "hiring_requirements":
              "- Репутация с фракцией\n- Наличие ресурсов\n- Релевантные навыки\n-
              Членство в фракциях\n- Доступ к специализированным системам\n"}, "advanced_mechanics":
              {"hiring_chains": "- Цепочки найма для экономии ресурсов\n- Последовательное
              найм NPC\n- Влияние на эффективность\n", "group_contracts": "- Групповые
              контракты для нескольких NPC\n- Синхронизация задач\n- Общие бонусы
              и штрафы\n", "automation": "- Автоматизация найма\n- Автоматическое
              назначение задач\n- Автоматическая оплата\n- Автоматическое управление
              персоналом\n"}, "data_flows": {"hiring_flow": "1. Игрок инициирует поиск
              кандидатов\n2. NPC Discovery Service находит подходящих кандидатов\n3.
              Игрок выбирает кандидата и начинает переговоры\n4. Contract Negotiation
              Manager обрабатывает переговоры\n5. Игрок и NPC согласовывают условия
              контракта\n6. Contract Negotiation Manager создает контракт\n7. NPC
              Hiring Manager добавляет NPC в workforce\n8. Social Service публикует
              событие social.npc-hiring.npc-hired\n9. Realtime Gateway отправляет
              обновление клиентам\n", "task_assignment_flow": "1. Игрок назначает
              задачу NPC\n2. Task Assignment Manager получает запрос\n3. Task Assignment
              Manager проверяет доступность NPC\n4. Task Assignment Manager проверяет
              навыки NPC\n5. Task Assignment Manager назначает задачу\n6. Workforce
              Manager обновляет статус NPC\n7. Social Service публикует событие social.npc-hiring.task-assigned\n8.
              Realtime Gateway отправляет обновление клиентам\n", "performance_monitoring_flow":
              "1. NPC выполняет задачи\n2. Performance Monitor отслеживает прогресс\n3.
              Performance Monitor рассчитывает эффективность\n4. Performance Monitor
              обновляет метрики\n5. Social Service публикует событие social.npc-hiring.performance-updated\n6.
              Realtime Gateway отправляет обновление клиентам\n", "payroll_flow":
              "1. Наступает период выплаты зарплаты\n2. Economy Manager рассчитывает
              зарплаты для всех NPC\n3. Economy Manager проверяет наличие средств
              у игрока\n4. Economy Manager обрабатывает выплаты\n5. Economy Service
              обновляет баланс игрока\n6. Social Service публикует событие social.npc-hiring.payroll-processed\n7.
              Realtime Gateway отправляет обновление клиентам\n"}, "database_structure":
              {"tables": [{"name": "npc_hiring_contracts", "description": "Контракты
              найма NPC", "columns": [{"id": "UUID PRIMARY KEY"}, {"character_id":
              "UUID FOREIGN KEY"}, {"npc_id": "UUID FOREIGN KEY"}, {"hiring_type":
              "VARCHAR(50)"}, {"contract_type": "ENUM (salary, one-time, profit-share,
              combined)"}, {"salary_amount": "DECIMAL(10,2)"}, {"start_date": "TIMESTAMP"},
              {"end_date": "TIMESTAMP"}, {"status": "ENUM (active, terminated, completed)"},
              {"autonomy_level": "ENUM (direct, autonomous, hybrid)"}, {"terms": "JSONB"},
              {"created_at": "TIMESTAMP"}, {"updated_at": "TIMESTAMP"}]}, {"name":
              "npc_hiring_tasks", "description": "Задачи нанятых NPC", "columns":
              [{"id": "UUID PRIMARY KEY"}, {"contract_id": "UUID FOREIGN KEY"}, {"npc_id":
              "UUID FOREIGN KEY"}, {"task_type": "VARCHAR(50)"}, {"task_description":
              "TEXT"}, {"priority": "INTEGER"}, {"status": "ENUM (pending, in-progress,
              completed, failed)"}, {"assigned_at": "TIMESTAMP"}]}]}}}'
        - column:
            name: metadata
            value: '{"id": "npc-hiring-system-architecture", "title": "Архитектура
              системы найма NPC", "document_type": "architecture", "category": "systems",
              "status": "draft", "version": "1.0.0", "last_updated": "2025-11-23T23:30:00+00:00",
              "owners": [{"role": "architect", "contact": "architect@necp.game"}],
              "tags": ["architecture", "social", "npc-hiring", "workforce-management"],
              "related_systems": ["social-service", "economy-service", "world-service",
              "npc-service"], "related_documents": [{"id": "npc-hiring-system-detailed",
              "relation": "implements"}], "github_issue": 304, "visibility": "internal",
              "audience": ["architect", "backend", "social", "api-designer"]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\npc-hiring-system-architecture.yaml
