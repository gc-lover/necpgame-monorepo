databaseChangeLog:
- changeSet:
    id: documentation-part1-lifecycle-heartbeat-70f00eed
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '-624046146995757'
        - column:
            name: doc_id
            value: backend-session-management-part1
        - column:
            name: title
            value: 'Session Management — Part 1: Lifecycle & Heartbeat'
        - column:
            name: document_type
            value: implementation
        - column:
            name: category
            value: backend
        - column:
            name: status
            value: approved
        - column:
            name: version
            value: 1.0.1
        - column:
            name: last_updated
            value: 2025-11-07 21:05:00+00:00
        - column:
            name: concept_approved
            value: true
        - column:
            name: concept_reviewed_at
            value: 2025-11-07 21:05:00+00:00
        - column:
            name: owners
            value: '[{"role": "auth_lead", "contact": "auth@necp.game"}]'
        - column:
            name: tags
            value:
            - sessions
            - heartbeat
            - lifecycle
        - column:
            name: topics
            value:
            - authentication
            - gameplay-infra
        - column:
            name: related_systems
            value:
            - auth-service
            - session-store
            - redis
        - column:
            name: related_documents
            value: '[{"id": "backend-session-management-overview", "relation": "references"},
              {"id": "backend-session-management-part2", "relation": "precedes"}]'
        - column:
            name: source
            value: shared/docs/knowledge/implementation/backend/session-management/part1-lifecycle-heartbeat.md
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - backend
            - auth
        - column:
            name: risk_level
            value: high
        - column:
            name: content
            value: '{"metadata": {"id": "backend-session-management-part1", "title":
              "Session Management — Part 1: Lifecycle & Heartbeat", "document_type":
              "implementation", "category": "backend", "status": "approved", "version":
              "1.0.1", "last_updated": "2025-11-07T21:05:00+00:00", "concept_approved":
              true, "concept_reviewed_at": "2025-11-07T21:05:00+00:00", "owners":
              [{"role": "auth_lead", "contact": "auth@necp.game"}], "tags": ["sessions",
              "heartbeat", "lifecycle"], "topics": ["authentication", "gameplay-infra"],
              "related_systems": ["auth-service", "session-store", "redis"], "related_documents":
              [{"id": "backend-session-management-overview", "relation": "references"},
              {"id": "backend-session-management-part2", "relation": "precedes"}],
              "source": "shared/docs/knowledge/implementation/backend/session-management/part1-lifecycle-heartbeat.md",
              "visibility": "internal", "audience": ["backend", "auth"], "risk_level":
              "high"}, "review": {"chain": [{"role": "auth_lead", "reviewer": "",
              "reviewed_at": "2025-11-07T21:05:00+00:00", "status": "approved"}],
              "next_actions": []}, "summary": {"problem": "Нужен детальный регламент
              жизненного цикла игрового сеанса и heartbeat-потока.", "goal": "Задокументировать
              состояния сессии, схемы БД, кеш Redis и обработку heartbeat.", "essence":
              "Часть 1 фокусируется на создании, отслеживании и обновлении сессий,
              включая batch-обновления и контроль состояний.", "key_points": ["Определены
              состояния сессии и переходы (CREATED → ACTIVE → … → CLOSED).", "SQL
              схемы `player_sessions` и `session_audit_log` с индексами и ограничениями.",
              "Redis ключи `session:{token}` и `active_players:{serverId}`.", "Java
              код `createSession`, heartbeat endpoint и batch обновления."]}, "content":
              {"sections": [{"id": "overview", "title": "Краткое описание", "body":
              "Система управляет созданием, поддержкой и завершением игровых сессий,
              контролируя heartbeats, AFK и авторизации.\n", "mechanics_links": []},
              {"id": "lifecycle", "title": "Жизненный цикл", "body": "Содержит цепочки
              состояний, переходы и критерии (AFK, DISCONNECTED, EXPIRED) для игровых
              сессий.\n", "mechanics_links": []}, {"id": "database", "title": "Схемы
              баз данных", "body": "Подробные SQL определения `player_sessions` и
              `session_audit_log`, индексы, ограничения и уникальности.\n", "mechanics_links":
              []}, {"id": "cache", "title": "Redis Cache", "body": "Описаны структуры
              ключей, TTL, списки активных игроков и назначение кеша.\n", "mechanics_links":
              []}, {"id": "creation", "title": "Создание сессии", "body": "Приведен
              Java сервис `createSession` с обработкой параллельных сессий, кешированием
              и публикацией событий.\n", "mechanics_links": []}, {"id": "heartbeat",
              "title": "Heartbeat механизм", "body": "Определена периодичность heartbeat,
              логика статусов, endpoint и batch-обновления в БД.\n", "mechanics_links":
              []}]}, "appendix": {"glossary": [], "references": [], "decisions": []},
              "implementation": {"github_issue": 136, "needs_task": false, "queue_reference":
              ["shared/trackers/queues/concept/queued.yaml"], "blockers": []}, "history":
              [{"version": "1.0.1", "date": "2025-11-07", "author": "auth_lead", "changes":
              "Добавлены схемы, lifecycle и heartbeat механизмы."}], "validation":
              {"checksum": "", "schema_version": "1.0"}}'
        - column:
            name: metadata
            value: '{"id": "backend-session-management-part1", "title": "Session Management
              — Part 1: Lifecycle & Heartbeat", "document_type": "implementation",
              "category": "backend", "status": "approved", "version": "1.0.1", "last_updated":
              "2025-11-07T21:05:00+00:00", "concept_approved": true, "concept_reviewed_at":
              "2025-11-07T21:05:00+00:00", "owners": [{"role": "auth_lead", "contact":
              "auth@necp.game"}], "tags": ["sessions", "heartbeat", "lifecycle"],
              "topics": ["authentication", "gameplay-infra"], "related_systems": ["auth-service",
              "session-store", "redis"], "related_documents": [{"id": "backend-session-management-overview",
              "relation": "references"}, {"id": "backend-session-management-part2",
              "relation": "precedes"}], "source": "shared/docs/knowledge/implementation/backend/session-management/part1-lifecycle-heartbeat.md",
              "visibility": "internal", "audience": ["backend", "auth"], "risk_level":
              "high"}'
        - column:
            name: source_file
            value: knowledge\implementation\backend\session-management\part1-lifecycle-heartbeat.yaml
