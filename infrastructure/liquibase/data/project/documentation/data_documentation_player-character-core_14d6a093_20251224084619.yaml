databaseChangeLog:
- changeSet:
    id: documentation-player-character-core-14d6a093
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '7980141546890072'
        - column:
            name: doc_id
            value: player-character-core
        - column:
            name: title
            value: Архитектура системы управления персонажами игроков - Основная структура
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.1.0
        - column:
            name: last_updated
            value: 2025-11-30 20:45:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[{"role": "architect", "contact": "architect@necp.game"}]'
        - column:
            name: tags
            value:
            - architecture
            - player-character-management
            - backend
            - character
            - account
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value:
            - character-service-go
            - inventory-service-go
            - quest-service-go
            - session-service-go
        - column:
            name: related_documents
            value: '[{"id": "backend-player-character-management-overview", "relation":
              "extends"}, {"id": "backend-player-character-creation", "relation":
              "extends"}, {"id": "backend-player-character-switching", "relation":
              "extends"}, {"id": "player-character-mechanics", "relation": "extends"},
              {"id": "player-character-data-flows", "relation": "extends"}, {"id":
              "player-character-database", "relation": "extends"}, {"id": "player-character-integrations",
              "relation": "extends"}, {"id": "player-character-technical", "relation":
              "extends"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - architect
            - backend
            - api-designer
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "player-character-core", "title": "Архитектура
              системы управления персонажами игроков - Основная структура", "document_type":
              "architecture", "category": "systems", "status": "draft", "version":
              "1.1.0", "last_updated": "2025-11-30T20:45:00+00:00", "owners": [{"role":
              "architect", "contact": "architect@necp.game"}], "tags": ["architecture",
              "player-character-management", "backend", "character", "account"], "related_systems":
              ["character-service-go", "inventory-service-go", "quest-service-go",
              "session-service-go"], "related_documents": [{"id": "backend-player-character-management-overview",
              "relation": "extends"}, {"id": "backend-player-character-creation",
              "relation": "extends"}, {"id": "backend-player-character-switching",
              "relation": "extends"}, {"id": "player-character-mechanics", "relation":
              "extends"}, {"id": "player-character-data-flows", "relation": "extends"},
              {"id": "player-character-database", "relation": "extends"}, {"id": "player-character-integrations",
              "relation": "extends"}, {"id": "player-character-technical", "relation":
              "extends"}], "github_issue": 389, "visibility": "internal", "audience":
              ["architect", "backend", "api-designer"]}, "summary": {"problem": "Требуется
              спроектировать полную техническую архитектуру системы управления\nперсонажами
              игроков для создания, удаления, переключения и управления\nперсонажами
              с поддержкой слотов, восстановления и синхронизации состояния.\n", "goal":
              "Создать архитектурную схему системы управления персонажами игроков
              с определением:\n- Компонентов системы (микросервисы, модули)\n- API
              endpoints (высокоуровнево)\n- Потоков данных и интеграций\n- Системы
              создания персонажей\n- Системы удаления персонажей\n- Системы переключения
              персонажей\n- Системы управления слотами\n- Технического задания для
              реализации\n", "essence": "Система управления персонажами игроков для
              создания, удаления, переключения\nи управления персонажами с поддержкой
              слотов, восстановления и синхронизации состояния.\n"}, "architecture":
              {"overview": "Система управления персонажами игроков состоит из семи
              основных компонентов:\n1. Character Creation Manager - управление созданием
              персонажей\n2. Character Deletion Manager - управление удалением персонажей
              (soft delete)\n3. Character Restoration Manager - управление восстановлением
              персонажей\n4. Character Switching Manager - управление переключением
              персонажей\n5. Slot Management Manager - управление слотами персонажей\n6.
              Stats Recalculation Manager - пересчёт боевых статов\n7. Character State
              Manager - сохранение и загрузка состояния персонажей\n", "components":
              [{"name": "Character Creation Manager", "location": "character-service-go
              (модуль character-creation)", "responsibility": "- Создание персонажей\n-
              Валидация данных\n- Проверка слотов\n- Выдача стартовых ресурсов\n-
              Инициализация инвентаря и квестов\n", "creation_features": "- Проверка
              доступных слотов\n- Валидация имени персонажа (уникальность)\n- Задание
              атрибутов и навыков по классу и origin\n- Назначение стартовой зоны
              и валюты\n- Создание инвентаря\n- Выдача начальных квестов\n", "endpoints":
              ["POST /api/v1/character/characters - создание персонажа", "GET /api/v1/character/characters/validate-name
              - проверка имени", "GET /api/v1/character/characters/available-slots
              - доступные слоты"]}, {"name": "Character Deletion Manager", "location":
              "character-service-go (модуль character-deletion)", "responsibility":
              "- Удаление персонажей (soft delete)\n- Освобождение слотов\n- Установка
              окна восстановления\n- Публикация событий удаления\n", "deletion_features":
              "- Soft delete (флаг deleted)\n- Установка can_restore_until (30 дней)\n-
              Освобождение слота\n- Публикация CharacterDeleted события\n- Создание
              снапшота для восстановления\n", "endpoints": ["DELETE /api/v1/character/characters/{character_id}
              - удаление персонажа", "GET /api/v1/character/characters/{character_id}/deletion-status
              - статус удаления"]}, {"name": "Character Restoration Manager", "location":
              "character-service-go (модуль character-restoration)", "responsibility":
              "- Восстановление удалённых персонажей\n- Проверка окна восстановления\n-
              Возврат слотов\n- Восстановление состояния\n", "restoration_features":
              "- Проверка окна восстановления (30 дней)\n- Возврат слота\n- Восстановление
              состояния из снапшота\n- Публикация CharacterRestored события\n", "endpoints":
              ["POST /api/v1/character/characters/{character_id}/restore - восстановление
              персонажа", "GET /api/v1/character/characters/deleted - список удалённых
              персонажей"]}, {"name": "Character Switching Manager", "location": "character-service-go
              (модуль character-switching)", "responsibility": "- Переключение между
              персонажами\n- Сохранение текущего персонажа\n- Валидация прав доступа\n-
              Обновление сессии\n", "switching_features": "- Сохранение текущего персонажа\n-
              Проверка прав на нового персонажа\n- Обновление session (current_character_id)\n-
              Обновление last_played_at\n- Публикация CharacterSwitched события\n",
              "endpoints": ["POST /api/v1/character/characters/{character_id}/switch
              - переключение персонажа", "GET /api/v1/character/characters/current
              - текущий персонаж"]}, {"name": "Slot Management Manager", "location":
              "character-service-go (модуль slot-management)", "responsibility": "-
              Управление слотами персонажей\n- Покупка дополнительных слотов\n- Отслеживание
              использования слотов\n- Управление базовыми и премиальными слотами\n",
              "slot_features": "- Базовые слоты (по умолчанию)\n- Премиальные слоты
              (покупка)\n- Отслеживание used_slots\n- Проверка лимитов\n- Списание
              валюты при покупке\n", "endpoints": ["GET /api/v1/character/slots -
              информация о слотах", "POST /api/v1/character/slots/purchase - покупка
              слота", "GET /api/v1/character/slots/available - доступные слоты"]},
              {"name": "Stats Recalculation Manager", "location": "character-service-go
              (модуль stats-recalculation)", "responsibility": "- Пересчёт боевых
              статов персонажа\n- Учёт атрибутов, экипировки и бафов\n- Синхронизация
              здоровья и брони\n- Защита от переполнения\n", "stats_features": "-
              Базовые статы из атрибутов\n- Бонусы от экипировки\n- Бонусы от активных
              бафов\n- Синхронизация здоровья и брони\n- Валидация значений (защита
              от переполнения)\n", "endpoints": ["POST /api/v1/character/characters/{character_id}/recalculate-stats
              - пересчёт статов", "GET /api/v1/character/characters/{character_id}/stats
              - текущие статы"]}, {"name": "Character State Manager", "location":
              "character-service-go (модуль character-state)", "responsibility": "-
              Сохранение состояния персонажа\n- Загрузка состояния персонажа\n- Создание
              снапшотов\n- Синхронизация с другими сервисами\n", "state_features":
              "- Сохранение основных записей\n- Сохранение инвентаря\n- Сохранение
              прогресса квестов\n- Сохранение состояния сессии\n- Создание снапшотов
              для восстановления\n", "endpoints": ["POST /api/v1/character/characters/{character_id}/save-state
              - сохранение состояния", "GET /api/v1/character/characters/{character_id}/load-state
              - загрузка состояния", "POST /api/v1/character/characters/{character_id}/snapshot
              - создание снапшота"]}]}}'
        - column:
            name: metadata
            value: '{"id": "player-character-core", "title": "Архитектура системы
              управления персонажами игроков - Основная структура", "document_type":
              "architecture", "category": "systems", "status": "draft", "version":
              "1.1.0", "last_updated": "2025-11-30T20:45:00+00:00", "owners": [{"role":
              "architect", "contact": "architect@necp.game"}], "tags": ["architecture",
              "player-character-management", "backend", "character", "account"], "related_systems":
              ["character-service-go", "inventory-service-go", "quest-service-go",
              "session-service-go"], "related_documents": [{"id": "backend-player-character-management-overview",
              "relation": "extends"}, {"id": "backend-player-character-creation",
              "relation": "extends"}, {"id": "backend-player-character-switching",
              "relation": "extends"}, {"id": "player-character-mechanics", "relation":
              "extends"}, {"id": "player-character-data-flows", "relation": "extends"},
              {"id": "player-character-database", "relation": "extends"}, {"id": "player-character-integrations",
              "relation": "extends"}, {"id": "player-character-technical", "relation":
              "extends"}], "github_issue": 389, "visibility": "internal", "audience":
              ["architect", "backend", "api-designer"]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\player-character-core.yaml
