databaseChangeLog:
- changeSet:
    id: documentation-player-quest-board-architecture-26a0311e
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '-452567074109738'
        - column:
            name: doc_id
            value: player-quest-board-architecture
        - column:
            name: title
            value: Архитектура Player Quest Board - система создания квестов игроками
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-12-XXT00:00:00Z
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[{"role": "architect", "contact": "architect@necp.game"}]'
        - column:
            name: tags
            value:
            - architecture
            - quests
            - player-created-content
            - creator-economy
            - moderation
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value:
            - quest-service
            - moderation-service
            - social-service
            - creator-platform-service
        - column:
            name: related_documents
            value: '[{"id": "quest-system-architecture", "relation": "extends"}, {"id":
              "creator-economy-platform-architecture", "relation": "integrates"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - architect
            - backend
            - quest
            - api-designer
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "player-quest-board-architecture", "title":
              "Архитектура Player Quest Board - система создания квестов игроками",
              "document_type": "architecture", "category": "systems", "status": "draft",
              "version": "1.0.0", "last_updated": "2025-12-XXT00:00:00Z", "owners":
              [{"role": "architect", "contact": "architect@necp.game"}], "tags": ["architecture",
              "quests", "player-created-content", "creator-economy", "moderation"],
              "related_systems": ["quest-service", "moderation-service", "social-service",
              "creator-platform-service"], "related_documents": [{"id": "quest-system-architecture",
              "relation": "extends"}, {"id": "creator-economy-platform-architecture",
              "relation": "integrates"}], "github_issue": 1461, "visibility": "internal",
              "audience": ["architect", "backend", "quest", "api-designer"]}, "summary":
              {"problem": "Существующая архитектура системы квестов поддерживает тип
              `player_created`, но нет\nдетальной проработки процесса создания, модерации
              и распространения пользовательских квестов.\n", "goal": "Создать архитектурную
              схему Player Quest Board с определением:\n- Компонентов для создания
              квестов игроками (in-game + веб)\n- Системы модерации контента\n- Каталога
              и досок фиксеров\n- Статистики и метрик\n- Механизма превращения в канон\n-
              REST, WebSocket и Event Bus контрактов\n- Структуры БД\n- Технического
              задания для реализации\n", "essence": "Полнофункциональная система для
              создания, модерации, публикации и распространения\nпользовательских
              квестов с возможностью превращения популярных квестов в канон.\n"},
              "architecture": {"overview": "Архитектура Player Quest Board состоит
              из следующих компонентов:\n1. Quest Creator - редактор квестов для игроков\n2.
              Quest Validator - валидация квестов\n3. Quest Moderation Manager - управление
              модерацией\n4. Quest Board Manager - управление досками фиксеров\n5.
              Quest Analytics Collector - сбор статистики\n6. Quest Promotion Manager
              - превращение в канон\n7. Quest Rating System - система рейтингов и
              отзывов\n", "quest_creator": {"creation_interfaces": [{"interface":
              "in_game", "description": "Редактор квестов в игре", "features": [{"visual_editor":
              "визуальный редактор"}, {"template_system": "система шаблонов"}, {"preview_mode":
              "режим предпросмотра"}, {"save_draft": "сохранение черновиков"}]}, {"interface":
              "web", "description": "Веб-редактор квестов", "features": [{"advanced_editor":
              "продвинутый редактор"}, {"collaboration": "совместная работа"}, {"version_control":
              "контроль версий"}, {"export_import": "экспорт/импорт"}]}], "quest_elements":
              [{"element": "objectives", "description": "Цели квеста", "types": [{"kill_targets":
              "убить целей"}, {"collect_items": "собрать предметы"}, {"reach_location":
              "достичь локации"}, {"talk_to_npc": "поговорить с NPC"}, {"complete_objective":
              "выполнить задачу"}]}, {"element": "rewards", "description": "Награды
              квеста", "types": [{"currency": "валюта"}, {"items": "предметы"}, {"experience":
              "опыт"}, {"reputation": "репутация"}]}, {"element": "dialogue", "description":
              "Диалоги квеста", "features": [{"dialogue_tree": "дерево диалогов"},
              {"branching": "ветвление"}, {"choices": "выборы игрока"}]}, {"element":
              "conditions", "description": "Условия квеста", "types": [{"level_requirement":
              "требование уровня"}, {"faction_requirement": "требование фракции"},
              {"quest_prerequisite": "предварительный квест"}, {"item_requirement":
              "требование предмета"}]}]}, "quest_moderation": {"moderation_stages":
              [{"stage": "automatic", "description": "Автоматическая модерация", "checks":
              [{"content_validation": "валидация контента"}, {"profanity_filter":
              "фильтр запрещенных слов"}, {"technical_validation": "техническая валидация"},
              {"balance_check": "проверка баланса"}]}, {"stage": "manual", "description":
              "Ручная модерация", "checks": [{"content_review": "проверка контента"},
              {"lore_compliance": "соответствие лору"}, {"quality_assessment": "оценка
              качества"}, {"policy_compliance": "соответствие политике"}]}], "moderation_workflow":
              "1. Квест создан игроком\n2. Автоматическая валидация (формат, структура)\n3.
              Автоматическая модерация (контент, баланс)\n4. Если автоматическая модерация
              пройдена → очередь ручной модерации\n5. Модератор проверяет квест\n6.
              Если одобрен → публикация на доске\n7. Если отклонен → возврат создателю
              с комментариями\n"}, "quest_board": {"board_types": [{"type": "fixer_board",
              "description": "Доска фиксера", "features": [{"npc_quest_provider":
              "NPC предоставляет квесты"}, {"location_based": "привязана к локации"},
              {"faction_based": "привязана к фракции"}]}, {"type": "global_board",
              "description": "Глобальная доска", "features": [{"all_quests": "все
              опубликованные квесты"}, {"search_filter": "поиск и фильтрация"}, {"sorting":
              "сортировка по рейтингу, популярности"}]}], "board_features": [{"quest_listing":
              "список квестов"}, {"quest_details": "детали квеста"}, {"quest_acceptance":
              "принятие квеста"}, {"quest_rating": "оценка квеста"}, {"quest_reviews":
              "отзывы о квесте"}, {"quest_sharing": "поделиться квестом"}]}, "quest_analytics":
              {"metrics": [{"metric": "completion_rate", "description": "Процент завершения
              квеста"}, {"metric": "average_time", "description": "Среднее время прохождения"},
              {"metric": "player_rating", "description": "Рейтинг игроков"}, {"metric":
              "popularity_score", "description": "Популярность квеста"}, {"metric":
              "revenue_generated", "description": "Доход от квеста (если монетизирован)"}],
              "analytics_dashboard": "- Обзор статистики квеста\n- Графики популярности\n-
              Анализ отзывов\n- Сравнение с другими квестами\n- Рекомендации по улучшению\n"},
              "quest_promotion": {"promotion_criteria": [{"high_completion_rate":
              "высокий процент завершения"}, {"high_rating": "высокий рейтинг"}, {"high_popularity":
              "высокая популярность"}, {"lore_compliance": "соответствие лору"}, {"quality_standards":
              "соответствие стандартам качества"}], "promotion_process": "1. Квест
              достигает критериев продвижения\n2. Автоматическая проверка или ручной
              отбор\n3. Рассмотрение командой разработки\n4. Если одобрен → превращение
              в канон\n5. Интеграция в основную игру\n6. Награда создателю\n"}, "microservices":
              [{"name": "quest-creator-service", "port": 8120, "responsibility": "Создание
              квестов игроками:\n- Quest Creator (in-game + веб)\n- Quest Validator\n-
              Draft Management\n", "components": [{"quest-creator": "редактор квестов"},
              {"quest-validator": "валидация квестов"}, {"draft-manager": "управление
              черновиками"}]}, {"name": "quest-moderation-service", "port": 8121,
              "responsibility": "Модерация квестов:\n- Quest Moderation Manager\n-
              Automatic Moderation\n- Manual Moderation Queue\n", "components": [{"moderation-manager":
              "управление модерацией"}, {"auto-moderation": "автоматическая модерация"},
              {"moderation-queue": "очередь модерации"}]}, {"name": "quest-board-service",
              "port": 8122, "responsibility": "Управление досками квестов:\n- Quest
              Board Manager\n- Fixer Board Integration\n- Quest Listing\n", "components":
              [{"board-manager": "управление досками"}, {"fixer-integration": "интеграция
              с фиксерами"}, {"listing-manager": "управление списками"}]}, {"name":
              "quest-analytics-service", "port": 8123, "responsibility": "Аналитика
              квестов:\n- Quest Analytics Collector\n- Metrics Aggregator\n- Report
              Generator\n", "components": [{"analytics-collector": "сбор аналитики"},
              {"metrics-aggregator": "агрегация метрик"}, {"report-generator": "генерация
              отчетов"}]}], "data_models": [{"name": "PlayerQuest", "fields": [{"id":
              "UUID"}, {"creator_id": "UUID"}, {"title": "string"}, {"description":
              "text"}, {"quest_data": "json"}, {"status": "enum (draft, pending_moderation,
              approved, rejected, published, archived, canonized)"}, {"moderation_status":
              "json"}, {"rating": "float"}, {"completion_count": "int"}, {"popularity_score":
              "float"}, {"created_at": "timestamp"}, {"updated_at": "timestamp"},
              {"published_at": "timestamp"}]}, {"name": "QuestModeration", "fields":
              [{"id": "UUID"}, {"quest_id": "UUID"}, {"moderator_id": "UUID"}, {"moderation_type":
              "enum (automatic, manual)"}, {"status": "enum (pending, approved, rejected)"},
              {"comments": "text"}, {"violations": "json"}, {"created_at": "timestamp"},
              {"reviewed_at": "timestamp"}]}, {"name": "QuestBoard", "fields": [{"id":
              "UUID"}, {"board_type": "enum (fixer, global)"}, {"location_id": "UUID"},
              {"npc_id": "UUID"}, {"quest_ids": "array<UUID>"}, {"created_at": "timestamp"},
              {"updated_at": "timestamp"}]}, {"name": "QuestRating", "fields": [{"id":
              "UUID"}, {"quest_id": "UUID"}, {"player_id": "UUID"}, {"rating": "int
              (1-5)"}, {"review": "text"}, {"helpful_count": "int"}, {"created_at":
              "timestamp"}, {"updated_at": "timestamp"}]}, {"name": "QuestAnalytics",
              "fields": [{"id": "UUID"}, {"quest_id": "UUID"}, {"metric_type": "enum
              (completion_rate, average_time, rating, popularity)"}, {"metric_value":
              "decimal"}, {"period_start": "timestamp"}, {"period_end": "timestamp"},
              {"created_at": "timestamp"}]}], "api_endpoints": {"quest_creation":
              ["POST /api/v1/quest-board/quests/create - создание квеста", "GET /api/v1/quest-board/quests/drafts
              - список черновиков", "GET /api/v1/quest-board/quests/drafts/{id} -
              черновик квеста", "PUT /api/v1/quest-board/quests/drafts/{id} - обновление
              черновика", "POST /api/v1/quest-board/quests/drafts/{id}/publish - публикация
              квеста"], "quest_management": ["GET /api/v1/quest-board/quests - список
              квестов", "GET /api/v1/quest-board/quests/{id} - детали квеста", "PUT
              /api/v1/quest-board/quests/{id} - обновление квеста", "DELETE /api/v1/quest-board/quests/{id}
              - удаление квеста", "POST /api/v1/quest-board/quests/{id}/accept - принятие
              квеста"], "moderation": ["GET /api/v1/quest-board/moderation/queue -
              очередь модерации", "POST /api/v1/quest-board/moderation/{id}/approve
              - одобрение квеста", "POST /api/v1/quest-board/moderation/{id}/reject
              - отклонение квеста", "GET /api/v1/quest-board/moderation/{id} - статус
              модерации"], "quest_board": ["GET /api/v1/quest-board/boards - список
              досок", "GET /api/v1/quest-board/boards/{id} - детали доски", "GET /api/v1/quest-board/boards/{id}/quests
              - квесты на доске", "GET /api/v1/quest-board/fixers/{npcId}/board -
              доска фиксера"], "rating_reviews": ["POST /api/v1/quest-board/quests/{id}/rate
              - оценка квеста", "GET /api/v1/quest-board/quests/{id}/ratings - рейтинги
              квеста", "POST /api/v1/quest-board/quests/{id}/reviews - отзыв о квесте",
              "GET /api/v1/quest-board/quests/{id}/reviews - отзывы о квесте"], "analytics":
              ["GET /api/v1/quest-board/quests/{id}/analytics - аналитика квеста",
              "GET /api/v1/quest-board/creator/{id}/analytics - аналитика создателя"]},
              "websocket_events": ["quest-board:quest-created - квест создан", "quest-board:quest-published
              - квест опубликован", "quest-board:quest-approved - квест одобрен",
              "quest-board:quest-rejected - квест отклонен", "quest-board:quest-rated
              - квест оценен", "quest-board:quest-canonized - квест стал каноном"],
              "event_bus_topics": ["quest-board:quest-created - квест создан", "quest-board:quest-submitted
              - квест отправлен на модерацию", "quest-board:quest-approved - квест
              одобрен", "quest-board:quest-rejected - квест отклонен", "quest-board:quest-published
              - квест опубликован", "quest-board:quest-accepted - квест принят игроком",
              "quest-board:quest-completed - квест завершен", "quest-board:quest-rated
              - квест оценен", "quest-board:quest-canonized - квест стал каноном"],
              "data_synchronization": {"tick_rate": "- Создание квеста: real-time\n-
              Модерация: при событиях\n- Обновление рейтингов: каждые 5 минут\n- Аналитика:
              каждые 1 час\n", "network_load": "- Создание квестов: средняя нагрузка\n-
              Модерация: низкая нагрузка\n- Доски квестов: высокая нагрузка (кэширование)\n-
              Аналитика: средняя нагрузка (периодическая)\n", "caching_strategy":
              "- Список квестов на доске: кэш на 1 минуту\n- Детали квеста: кэш на
              5 минут\n- Рейтинги: кэш на 5 минут\n- Аналитика: кэш на 1 час\n"},
              "integrations": {"with_quest_service": "- Использование Quest Engine
              для выполнения квестов\n- Создание инстансов квестов\n- Отслеживание
              прогресса\n", "with_moderation_service": "- Автоматическая модерация
              контента\n- Ручная модерация\n- Отчеты о нарушениях\n", "with_social_service":
              "- Интеграция с фиксерами (NPC)\n- Социальные функции\n- Уведомления\n",
              "with_creator_platform": "- Создание квестов через Creator Hub\n- Монетизация
              квестов\n- Аналитика создателей\n"}, "technical_tasks": [{"task": "Создать
              quest-creator-service", "description": "Сервис создания квестов с Quest
              Creator, Quest Validator, Draft Manager\n", "estimated_lines": 400},
              {"task": "Создать quest-moderation-service", "description": "Сервис
              модерации с Moderation Manager, Auto Moderation, Moderation Queue\n",
              "estimated_lines": 350}, {"task": "Создать quest-board-service", "description":
              "Сервис досок с Board Manager, Fixer Integration, Listing Manager\n",
              "estimated_lines": 300}, {"task": "Создать quest-analytics-service",
              "description": "Сервис аналитики с Analytics Collector, Metrics Aggregator,
              Report Generator\n", "estimated_lines": 300}, {"task": "Создать структуру
              БД для Player Quest Board", "description": "Таблицы: player_quests,
              quest_moderations, quest_boards, quest_ratings, quest_analytics\n",
              "estimated_lines": 200}, {"task": "Интегрировать с существующими системами",
              "description": "Интеграция с Quest Service, Moderation Service, Social
              Service, Creator Platform\n", "estimated_lines": 250}, {"task": "Создать
              API endpoints", "description": "REST API для Quest Creation, Quest Management,
              Moderation, Quest Board, Rating/Reviews, Analytics\n", "estimated_lines":
              400}, {"task": "Интегрировать с Event Bus", "description": "Подписка
              и публикация событий quest-board:* для интеграции с другими системами\n",
              "estimated_lines": 200}]}}'
        - column:
            name: metadata
            value: '{"id": "player-quest-board-architecture", "title": "Архитектура
              Player Quest Board - система создания квестов игроками", "document_type":
              "architecture", "category": "systems", "status": "draft", "version":
              "1.0.0", "last_updated": "2025-12-XXT00:00:00Z", "owners": [{"role":
              "architect", "contact": "architect@necp.game"}], "tags": ["architecture",
              "quests", "player-created-content", "creator-economy", "moderation"],
              "related_systems": ["quest-service", "moderation-service", "social-service",
              "creator-platform-service"], "related_documents": [{"id": "quest-system-architecture",
              "relation": "extends"}, {"id": "creator-economy-platform-architecture",
              "relation": "integrates"}], "github_issue": 1461, "visibility": "internal",
              "audience": ["architect", "backend", "quest", "api-designer"]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\player-quest-board-architecture.yaml
