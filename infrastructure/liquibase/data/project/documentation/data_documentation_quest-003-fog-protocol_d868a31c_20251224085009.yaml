databaseChangeLog:
- changeSet:
    id: documentation-quest-003-fog-protocol-d868a31c
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '-303899786449897'
        - column:
            name: doc_id
            value: quest-london-2020-2029-fog-protocol
        - column:
            name: title
            value: Лондон 2020-2029 — Протокол тумана
        - column:
            name: document_type
            value: canon
        - column:
            name: category
            value: timeline-quest
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 2.1.0
        - column:
            name: last_updated
            value: 2025-12-01 00:00:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: ''
        - column:
            name: owners
            value: '[{"role": "concept_director", "contact": "concept@necp.game"}]'
        - column:
            name: tags
            value:
            - london
            - fog-protocol
            - urban-hacking
        - column:
            name: topics
            value:
            - repeatable_crime
            - urban_cover
        - column:
            name: related_systems
            value:
            - narrative-service
            - stealth-service
            - liveops-service
        - column:
            name: related_documents
            value: '[]'
        - column:
            name: source
            value: shared/docs/knowledge/canon/lore/timeline-author/quests/europe/london/2020-2029/quest-003-fog-protocol.md
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - concept
            - narrative
            - liveops
        - column:
            name: risk_level
            value: medium
        - column:
            name: content
            value: '{"metadata": {"id": "quest-london-2020-2029-fog-protocol", "title":
              "Лондон 2020-2029 — Протокол тумана", "document_type": "canon", "category":
              "timeline-quest", "status": "draft", "version": "2.1.0", "last_updated":
              "2025-12-01T00:00:00+00:00", "concept_approved": false, "concept_reviewed_at":
              "", "owners": [{"role": "concept_director", "contact": "concept@necp.game"}],
              "tags": ["london", "fog-protocol", "urban-hacking"], "topics": ["repeatable_crime",
              "urban_cover"], "related_systems": ["narrative-service", "stealth-service",
              "liveops-service"], "related_documents": [], "source": "shared/docs/knowledge/canon/lore/timeline-author/quests/europe/london/2020-2029/quest-003-fog-protocol.md",
              "visibility": "internal", "audience": ["concept", "narrative", "liveops"],
              "risk_level": "medium"}, "review": {"chain": [{"role": "concept_director",
              "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions":
              []}, "summary": {"problem": "Необходим повторяемый сценарий, объясняющий
              городскую систему «Протокол Тумана», скрывающую преступников.\n", "goal":
              "Активация генераторов тумана, совершение операции под покровом и успешное
              укрытие до рассеивания дымки.\n", "essence": "Игрок сотрудничает с хакером,
              инициирует искусственный туман и выполняет задачу, оставаясь невидимым
              для полиции.\n", "key_points": ["Туман создаёт тактическую зону, снижая
              видимость сенсоров и камер.", "Временное окно в десять минут требует
              чёткого планирования и отхода.", "Квест можно переигрывать, меняя цели
              (кража, диверсия, освобождение)."]}, "quest_definition": {"quest_type":
              "side", "level_min": 5, "level_max": null, "requirements": {"required_quests":
              [], "required_flags": [], "required_reputation": {}, "required_items":
              []}, "objectives": [{"id": "get_hacker_contract", "text": "Получить
              канал связи с подпольным оператором, который взламывает муниципальные
              генераторы и указывает безопасные маршруты", "type": "interact", "target":
              "hacker_contact", "count": 1, "optional": false}, {"id": "activate_fog_protocol",
              "text": "Запустить генераторы через консоль на выбранном районе, наблюдать
              за ростом тумана и отключением камер", "type": "interact", "target":
              "fog_generator_console", "count": 1, "optional": false}, {"id": "perform_operation",
              "text": "Совершить выбранное преступление в тумане: кражу данных, ограбление
              карго или освобождение пленника", "type": "perform", "target": "fog_operation_zone",
              "count": 1, "optional": false}, {"id": "escape_before_dawn", "text":
              "Покинуть район до рассеивания тумана: использовать дронов, канализацию
              или маскировочный транспорт", "type": "perform", "target": "escape_route",
              "count": 1, "optional": false}, {"id": "complete_protocol", "text":
              "Завершить операцию и повысить статус в сети «Fog Protocol»", "type":
              "interact", "target": "protocol_completion", "count": 1, "optional":
              false}], "rewards": {"experience": 800, "currency": 0, "items": [],
              "reputation": {"fog_protocol_network": 10}, "flags": ["fog_protocol_completed"]},
              "branches": [{"id": "data_theft_path", "unlock_condition": {"type":
              "choice_made", "choice_id": "operation_type_selection", "value": "data_theft"},
              "consequences": {"reputation": {"fog_protocol_network": 5}, "flags":
              ["data_theft_operations_unlocked"], "unlocked_content": [{"quest_type":
              "side", "category": "hacking", "location": "london"}]}}, {"id": "cargo_robbery_path",
              "unlock_condition": {"type": "choice_made", "choice_id": "operation_type_selection",
              "value": "cargo_robbery"}, "consequences": {"reputation": {"fog_protocol_network":
              5}, "flags": ["cargo_robbery_operations_unlocked"], "unlocked_content":
              [{"quest_type": "side", "category": "heist", "location": "london"}]}},
              {"id": "prisoner_rescue_path", "unlock_condition": {"type": "choice_made",
              "choice_id": "operation_type_selection", "value": "prisoner_rescue"},
              "consequences": {"reputation": {"fog_protocol_network": 5}, "flags":
              ["prisoner_rescue_operations_unlocked"], "unlocked_content": [{"quest_type":
              "side", "category": "rescue", "location": "london"}]}}]}, "content":
              {"sections": [{"id": "contract", "title": "Контракт с хакером", "body":
              "Игрок получает канал связи с подпольным оператором, который взламывает
              муниципальные генераторы и указывает безопасные маршруты ухода.\n",
              "mechanics_links": [], "assets": []}, {"id": "fog_activation", "title":
              "Активация протокола", "body": "Через консоль игрок запускает генераторы
              на выбранном районе, наблюдая за ростом густоты тумана и отключением
              камер наблюдения.\n", "mechanics_links": [], "assets": []}, {"id": "operation",
              "title": "Операция в тумане", "body": "В облаке игрок совершает выбранное
              преступление: кражу данных, ограбление карго или освобождение пленника.\n",
              "mechanics_links": [], "assets": []}, {"id": "escape", "title": "Отход
              до рассвета", "body": "Нужно покинуть район до рассеивания тумана. Доступны
              варианты: использование дронов, канализации или маскировочного транспорта.\n",
              "mechanics_links": [], "assets": []}, {"id": "rewards", "title": "Награды",
              "body": "- 800 XP, награда за выбранную операцию и временная неуязвимость
              от патрулей.\n- Повышение статуса в сети «Fog Protocol» и скидки на
              дальнейшие активации.\n", "mechanics_links": [], "assets": []}]}, "appendix":
              {"glossary": [], "references": [], "decisions": []}, "implementation":
              {"github_issue": 651, "needs_task": false, "queue_reference": [], "blockers":
              []}, "history": [{"version": "2.1.0", "date": "2025-12-01", "author":
              "content_writer", "changes": "Добавлен Issue в начало файла. Исправлена
              структура branches (condition -> unlock_condition, убраны objectives
              из branches, добавлены правильные поля consequences). Структура quest_definition
              соответствует архитектуре системы квестов."}, {"version": "2.0.0", "date":
              "2025-11-29", "author": "content_writer", "changes": "Добавлена полная
              структура quest_definition с objectives, rewards и branches. Детализирован
              контент согласно концепции. Добавлены механики повторяемых преступлений
              и городского укрытия."}, {"version": "1.0.0", "date": "2025-11-13",
              "author": "concept_team", "changes": "Квест «Протокол тумана» адаптирован
              под шаблон Concept Director."}], "validation": {"checksum": "", "schema_version":
              "1.0"}}'
        - column:
            name: metadata
            value: '{"id": "quest-london-2020-2029-fog-protocol", "title": "Лондон
              2020-2029 — Протокол тумана", "document_type": "canon", "category":
              "timeline-quest", "status": "draft", "version": "2.1.0", "last_updated":
              "2025-12-01T00:00:00+00:00", "concept_approved": false, "concept_reviewed_at":
              "", "owners": [{"role": "concept_director", "contact": "concept@necp.game"}],
              "tags": ["london", "fog-protocol", "urban-hacking"], "topics": ["repeatable_crime",
              "urban_cover"], "related_systems": ["narrative-service", "stealth-service",
              "liveops-service"], "related_documents": [], "source": "shared/docs/knowledge/canon/lore/timeline-author/quests/europe/london/2020-2029/quest-003-fog-protocol.md",
              "visibility": "internal", "audience": ["concept", "narrative", "liveops"],
              "risk_level": "medium"}'
        - column:
            name: source_file
            value: knowledge\canon\lore\timeline-author\quests\europe\london\2020-2029\quest-003-fog-protocol.yaml
