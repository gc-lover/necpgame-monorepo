databaseChangeLog:
- changeSet:
    id: documentation-quest-engine-backend-7555fd63
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '5460817413185866'
        - column:
            name: doc_id
            value: quest-engine-backend
        - column:
            name: title
            value: Backend движка квестов
        - column:
            name: document_type
            value: implementation
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: approved
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-08 18:15:00+00:00
        - column:
            name: concept_approved
            value: true
        - column:
            name: concept_reviewed_at
            value: 2025-11-08 18:15:00+00:00
        - column:
            name: owners
            value: '[{"role": "concept_director", "contact": "concept@necp.game"}]'
        - column:
            name: tags
            value:
            - backend
            - quests
            - gameplay
        - column:
            name: topics
            value:
            - quest-engine
            - branching
            - dialogue
        - column:
            name: related_systems
            value:
            - gameplay-service
            - character-service
            - economy-service
            - social-service
        - column:
            name: related_documents
            value: '[{"id": "quest-system", "relation": "supports"}, {"id": "gameplay-service-architecture",
              "relation": "references"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - concept
            - backend
            - gameplay
        - column:
            name: risk_level
            value: high
        - column:
            name: content
            value: '{"metadata": {"id": "quest-engine-backend", "title": "Backend
              движка квестов", "document_type": "implementation", "category": "systems",
              "status": "approved", "version": "1.0.0", "last_updated": "2025-11-08T18:15:00+00:00",
              "concept_approved": true, "concept_reviewed_at": "2025-11-08T18:15:00+00:00",
              "owners": [{"role": "concept_director", "contact": "concept@necp.game"}],
              "tags": ["backend", "quests", "gameplay"], "topics": ["quest-engine",
              "branching", "dialogue"], "related_systems": ["gameplay-service", "character-service",
              "economy-service", "social-service"], "related_documents": [{"id": "quest-system",
              "relation": "supports"}, {"id": "gameplay-service-architecture", "relation":
              "references"}], "source": "", "visibility": "internal", "audience":
              ["concept", "backend", "gameplay"], "risk_level": "high"}, "review":
              {"chain": [{"role": "concept_director", "reviewer": "", "reviewed_at":
              "2025-11-08T18:15:00+00:00", "status": "approved"}], "next_actions":
              []}, "summary": {"problem": "Без квестового движка невозможно запускать
              контент и ветвящиеся сценарии.", "goal": "Описать структуру и интеграции
              backend-компонента, обеспечивающего выполнение квестов.", "essence":
              "Микросервис gameplay-service обрабатывает state machine, диалоги и
              skill checks, взаимодействуя с другими сервисами и событиями.", "key_points":
              ["Управление состоянием квеста и ветвлениями диалогов.", "Обработка
              проверок навыков и условий на основе данных персонажа.", "Обмен событиями
              с другими сервисами через event bus."]}, "content": {"sections": [{"id":
              "service-architecture", "title": "Микросервисная архитектура", "body":
              "Quest Engine развёрнут как часть gameplay-service (порт 8083) и доступен
              через маршрут\n`/api/v1/gameplay/quests/*` API Gateway. Он публикует
              события `quest:started`,\n`quest:objective-completed`, `quest:completed`,
              `quest:failed` и подписывается на боевые,\nинвентарные и социальные
              события. Для проверки условий сервис обращается к character-service,\neconomy-service
              и social-service.\n", "mechanics_links": [], "assets": []}, {"id": "data-model",
              "title": "Модель данных", "body": "Движок хранит состояния инстансов
              в таблицах `quest_instances`, `dialogue_state`,\n`skill_check_results`.
              Схема фиксирует активные ветки, посещённые узлы диалога, результаты\nпроверок
              навыков и временные метки. Индексы оптимизируют выборку по персонажу
              и статусу,\nобеспечивая реактивное обновление UI.\n", "mechanics_links":
              [], "assets": []}, {"id": "execution-flow", "title": "Выполнение квеста",
              "body": "При старте квеста сервис проверяет требования, создаёт инстанс,
              инициализирует диалоговое\nсостояние и публикует событие начала. Обработка
              выбора диалогов и проверок навыков обновляет\nсостояние и, при необходимости,
              вызывает переходы на новые ветки или завершение квеста.\nПри выдаче
              наград сервис синхронизируется с экономикой и репутацией.\n", "mechanics_links":
              [], "assets": []}]}, "appendix": {"glossary": [], "references": [{"type":
              "api", "path": "api/v1/gameplay/quests/"}, {"type": "repository", "path":
              "shared/code/backend/gameplay/quest-engine/"}], "decisions": [{"id":
              "adr-quest-engine-backend", "summary": "Утверждена архитектура state
              machine для квестов с event-driven интеграциями."}]}, "implementation":
              {"needs_task": false, "github_issue": 79, "queue_reference": ["shared/trackers/queues/concept/queued.yaml"],
              "blockers": []}, "history": [{"version": "1.0.0", "date": "2025-11-08",
              "author": "Concept Director", "changes": "Утверждена структура backend-движка
              квестов и взаимодействие с микросервисами."}], "validation": {"checksum":
              "", "schema_version": "1.0"}}'
        - column:
            name: metadata
            value: '{"id": "quest-engine-backend", "title": "Backend движка квестов",
              "document_type": "implementation", "category": "systems", "status":
              "approved", "version": "1.0.0", "last_updated": "2025-11-08T18:15:00+00:00",
              "concept_approved": true, "concept_reviewed_at": "2025-11-08T18:15:00+00:00",
              "owners": [{"role": "concept_director", "contact": "concept@necp.game"}],
              "tags": ["backend", "quests", "gameplay"], "topics": ["quest-engine",
              "branching", "dialogue"], "related_systems": ["gameplay-service", "character-service",
              "economy-service", "social-service"], "related_documents": [{"id": "quest-system",
              "relation": "supports"}, {"id": "gameplay-service-architecture", "relation":
              "references"}], "source": "", "visibility": "internal", "audience":
              ["concept", "backend", "gameplay"], "risk_level": "high"}'
        - column:
            name: source_file
            value: knowledge\implementation\backend\quest-engine-backend.yaml
