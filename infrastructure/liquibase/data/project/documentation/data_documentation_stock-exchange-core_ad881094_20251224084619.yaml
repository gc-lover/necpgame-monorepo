databaseChangeLog:
- changeSet:
    id: documentation-stock-exchange-core-ad881094
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '3357409999838460'
        - column:
            name: doc_id
            value: stock-exchange-core
        - column:
            name: title
            value: Архитектура системы фондовой биржи - Основная структура
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-23 14:30:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[{"role": "architect", "contact": "architect@necp.game"}]'
        - column:
            name: tags
            value:
            - architecture
            - economy
            - stock-exchange
            - trading
            - investment
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value:
            - economy-service
            - analytics-service
            - world-service
            - social-service
            - quest-service
        - column:
            name: related_documents
            value: '[{"id": "stock-exchange-overview", "relation": "implements"},
              {"id": "stock-exchange-trading", "relation": "extends"}, {"id": "stock-exchange-dividends",
              "relation": "extends"}, {"id": "stock-exchange-analytics", "relation":
              "extends"}, {"id": "stock-exchange-compliance", "relation": "extends"},
              {"id": "stock-exchange-integrations", "relation": "extends"}, {"id":
              "stock-exchange-database", "relation": "extends"}, {"id": "stock-exchange-events",
              "relation": "extends"}, {"id": "stock-exchange-technical", "relation":
              "extends"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - architect
            - backend
            - economy
            - api-designer
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "stock-exchange-core", "title": "Архитектура
              системы фондовой биржи - Основная структура", "document_type": "architecture",
              "category": "systems", "status": "draft", "version": "1.0.0", "last_updated":
              "2025-11-23T14:30:00+00:00", "owners": [{"role": "architect", "contact":
              "architect@necp.game"}], "tags": ["architecture", "economy", "stock-exchange",
              "trading", "investment"], "related_systems": ["economy-service", "analytics-service",
              "world-service", "social-service", "quest-service"], "related_documents":
              [{"id": "stock-exchange-overview", "relation": "implements"}, {"id":
              "stock-exchange-trading", "relation": "extends"}, {"id": "stock-exchange-dividends",
              "relation": "extends"}, {"id": "stock-exchange-analytics", "relation":
              "extends"}, {"id": "stock-exchange-compliance", "relation": "extends"},
              {"id": "stock-exchange-integrations", "relation": "extends"}, {"id":
              "stock-exchange-database", "relation": "extends"}, {"id": "stock-exchange-events",
              "relation": "extends"}, {"id": "stock-exchange-technical", "relation":
              "extends"}], "github_issue": 393, "visibility": "internal", "audience":
              ["architect", "backend", "economy", "api-designer"]}, "summary": {"problem":
              "Требуется спроектировать архитектуру системы фондовой биржи, которая
              включает:\n- Торговлю акциями корпораций\n- Систему дивидендов и пассивного
              дохода\n- Реакцию на игровые события\n- Индексы и аналитику\n- Защиту
              от манипуляций\n- Интеграции с квестами, фракциями и мировыми событиями\n",
              "goal": "Создать архитектурную схему системы фондовой биржи с определением:\n-
              Компонентов для торговли, дивидендов, событий, индексов и аналитики\n-
              REST, WebSocket и Event Bus контрактов\n- Интеграций с другими системами\n-
              Структуры БД для акций, портфелей, ордеров и дивидендов\n- Технического
              задания для реализации\n", "essence": "Система фондовой биржи обеспечивает
              торговлю акциями корпораций, выплату дивидендов,\nреакцию на игровые
              события, расчет индексов и аналитику. Интегрируется с экономикой,\nквестами,
              фракциями и мировыми событиями через Event Bus.\n"}, "architecture":
              {"overview": "Система фондовой биржи состоит из следующих компонентов:\n1.
              Stock Trading Engine - исполнение ордеров и matching\n2. Stock Pricing
              Engine - расчет цен на основе спроса/предложения и событий\n3. Dividend
              Service - расчет и выплата дивидендов\n4. Stock Events Handler - обработка
              влияния игровых событий на цены\n5. Index Calculator - расчет биржевых
              индексов\n6. Stock Analytics Engine - аналитика и метрики\n7. Compliance
              Monitor - защита от манипуляций\n8. Portfolio Manager - управление портфелями
              игроков\n9. Corporation Registry - реестр корпораций и их акций\n",
              "microservices": [{"name": "economy-service", "port": 8085, "responsibility":
              "Основной сервис для системы фондовой биржи:\n- Управление корпорациями
              и их акциями\n- Торговля акциями (matching engine)\n- Расчет цен на
              основе спроса/предложения\n- Управление портфелями игроков\n- Интеграция
              с другими экономическими системами\n", "components": ["Stock Trading
              Engine", "Stock Pricing Engine", "Portfolio Manager", "Corporation Registry",
              "Order Book Manager", "Trade Executor"], "endpoints": ["GET /api/v1/economy/stocks
              - список акций", "GET /api/v1/economy/stocks/{symbol} - детали акции",
              "GET /api/v1/economy/stocks/{symbol}/price - текущая цена", "GET /api/v1/economy/stocks/{symbol}/history
              - история цен", "POST /api/v1/economy/stocks/orders - создать ордер",
              "GET /api/v1/economy/stocks/orders/{id} - детали ордера", "DELETE /api/v1/economy/stocks/orders/{id}
              - отменить ордер", "GET /api/v1/economy/stocks/portfolio - портфель
              игрока", "GET /api/v1/economy/stocks/portfolio/history - история портфеля",
              "GET /api/v1/economy/stocks/corporations - список корпораций", "GET
              /api/v1/economy/stocks/corporations/{id} - детали корпорации"]}, {"name":
              "dividend-service", "port": 8088, "responsibility": "Управление дивидендами:\n-
              Расчет дивидендов по корпорациям\n- Распределение выплат игрокам\n-
              Управление DRIP (Dividend Reinvestment Plan)\n- Налоговый учет дивидендов\n-
              Уведомления о выплатах\n", "components": ["Dividend Calculator", "Dividend
              Scheduler", "DRIP Manager", "Dividend Distributor", "Tax Calculator"],
              "endpoints": ["GET /api/v1/dividends/schedule - расписание дивидендов",
              "GET /api/v1/dividends/pending - ожидающие выплаты", "GET /api/v1/dividends/history
              - история выплат", "POST /api/v1/dividends/{id}/reinvest - реинвестировать
              дивиденды", "GET /api/v1/dividends/player/{player_id} - дивиденды игрока"]},
              {"name": "stock-analytics-service", "port": 8089, "responsibility":
              "Аналитика и метрики биржи:\n- Расчет индексов (S&P 500 аналог)\n- P/E,
              P/B и другие метрики\n- Технический анализ\n- Тренды и прогнозы\n- Рыночная
              капитализация\n", "components": ["Index Calculator", "Metrics Calculator",
              "Technical Analyzer", "Trend Analyzer", "Market Cap Calculator"], "endpoints":
              ["GET /api/v1/analytics/stocks/indices - список индексов", "GET /api/v1/analytics/stocks/indices/{id}
              - детали индекса", "GET /api/v1/analytics/stocks/{symbol}/metrics -
              метрики акции", "GET /api/v1/analytics/stocks/{symbol}/technical - технический
              анализ", "GET /api/v1/analytics/stocks/trends - рыночные тренды"]},
              {"name": "compliance-service", "port": 8091, "responsibility": "Защита
              от манипуляций:\n- Мониторинг подозрительных сделок\n- Обнаружение инсайдерской
              торговли\n- Circuit breakers\n- Лимиты на позиции\n- Временные ограничения\n",
              "components": ["Trade Monitor", "Insider Trading Detector", "Circuit
              Breaker Manager", "Position Limit Enforcer", "Suspicious Activity Reporter"],
              "endpoints": ["GET /api/v1/compliance/alerts - алерты о нарушениях",
              "POST /api/v1/compliance/circuit-breaker/{symbol} - активировать circuit
              breaker", "GET /api/v1/compliance/limits/{player_id} - лимиты игрока",
              "POST /api/v1/compliance/report - сообщить о нарушении"]}]}}'
        - column:
            name: metadata
            value: '{"id": "stock-exchange-core", "title": "Архитектура системы фондовой
              биржи - Основная структура", "document_type": "architecture", "category":
              "systems", "status": "draft", "version": "1.0.0", "last_updated": "2025-11-23T14:30:00+00:00",
              "owners": [{"role": "architect", "contact": "architect@necp.game"}],
              "tags": ["architecture", "economy", "stock-exchange", "trading", "investment"],
              "related_systems": ["economy-service", "analytics-service", "world-service",
              "social-service", "quest-service"], "related_documents": [{"id": "stock-exchange-overview",
              "relation": "implements"}, {"id": "stock-exchange-trading", "relation":
              "extends"}, {"id": "stock-exchange-dividends", "relation": "extends"},
              {"id": "stock-exchange-analytics", "relation": "extends"}, {"id": "stock-exchange-compliance",
              "relation": "extends"}, {"id": "stock-exchange-integrations", "relation":
              "extends"}, {"id": "stock-exchange-database", "relation": "extends"},
              {"id": "stock-exchange-events", "relation": "extends"}, {"id": "stock-exchange-technical",
              "relation": "extends"}], "github_issue": 393, "visibility": "internal",
              "audience": ["architect", "backend", "economy", "api-designer"]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\stock-exchange-core.yaml
