databaseChangeLog:
- changeSet:
    id: documentation-stock-exchange-database-ace5de32
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '8864922562980709'
        - column:
            name: doc_id
            value: stock-exchange-database
        - column:
            name: title
            value: Архитектура системы фондовой биржи - База данных
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-23 14:30:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[{"role": "architect", "contact": "architect@necp.game"}]'
        - column:
            name: tags
            value:
            - architecture
            - economy
            - stock-exchange
            - database
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value: []
        - column:
            name: related_documents
            value: '[{"id": "stock-exchange-core", "relation": "extends"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - architect
            - backend
            - database
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "stock-exchange-database", "title": "Архитектура
              системы фондовой биржи - База данных", "document_type": "architecture",
              "category": "systems", "status": "draft", "version": "1.0.0", "last_updated":
              "2025-11-23T14:30:00+00:00", "owners": [{"role": "architect", "contact":
              "architect@necp.game"}], "tags": ["architecture", "economy", "stock-exchange",
              "database"], "related_documents": [{"id": "stock-exchange-core", "relation":
              "extends"}], "github_issue": 393, "visibility": "internal", "audience":
              ["architect", "backend", "database"]}, "architecture": {"database":
              {"tables": [{"name": "corporations", "description": "Корпорации на бирже",
              "columns": [{"id": "UUID PRIMARY KEY"}, {"symbol": "VARCHAR(10) UNIQUE"},
              {"name": "VARCHAR(255)"}, {"sector": "VARCHAR(100)"}, {"stock_type":
              "VARCHAR(20) (Common, Preferred)"}, {"total_shares": "BIGINT"}, {"ipo_date":
              "TIMESTAMP"}, {"delisted_at": "TIMESTAMP NULL"}, {"faction_id": "UUID
              NULL"}, {"created_at": "TIMESTAMP"}, {"updated_at": "TIMESTAMP"}]},
              {"name": "stock_prices", "description": "История цен акций", "columns":
              [{"id": "UUID PRIMARY KEY"}, {"corporation_id": "UUID REFERENCES corporations(id)"},
              {"price": "DECIMAL(20, 4)"}, {"volume": "BIGINT"}, {"high": "DECIMAL(20,
              4)"}, {"low": "DECIMAL(20, 4)"}, {"open": "DECIMAL(20, 4)"}, {"close":
              "DECIMAL(20, 4)"}, {"timestamp": "TIMESTAMP"}, {"event_id": "UUID NULL"},
              {"created_at": "TIMESTAMP"}]}, {"name": "stock_orders", "description":
              "Ордера на покупку/продажу", "columns": [{"id": "UUID PRIMARY KEY"},
              {"player_id": "UUID"}, {"corporation_id": "UUID REFERENCES corporations(id)"},
              {"order_type": "VARCHAR(10) (BUY, SELL)"}, {"price_type": "VARCHAR(10)
              (MARKET, LIMIT)"}, {"limit_price": "DECIMAL(20, 4) NULL"}, {"quantity":
              "BIGINT"}, {"filled_quantity": "BIGINT DEFAULT 0"}, {"status": "VARCHAR(20)
              (PENDING, PARTIAL, FILLED, CANCELLED)"}, {"time_in_force": "VARCHAR(10)
              (GTC, IOC, FOK)"}, {"created_at": "TIMESTAMP"}, {"updated_at": "TIMESTAMP"},
              {"expires_at": "TIMESTAMP NULL"}]}, {"name": "stock_trades", "description":
              "Исполненные сделки", "columns": [{"id": "UUID PRIMARY KEY"}, {"buy_order_id":
              "UUID REFERENCES stock_orders(id)"}, {"sell_order_id": "UUID REFERENCES
              stock_orders(id)"}, {"corporation_id": "UUID REFERENCES corporations(id)"},
              {"buyer_id": "UUID"}, {"seller_id": "UUID"}, {"price": "DECIMAL(20,
              4)"}, {"quantity": "BIGINT"}, {"buyer_commission": "DECIMAL(20, 4)"},
              {"seller_commission": "DECIMAL(20, 4)"}, {"executed_at": "TIMESTAMP"},
              {"created_at": "TIMESTAMP"}]}, {"name": "player_portfolios", "description":
              "Портфели игроков", "columns": [{"id": "UUID PRIMARY KEY"}, {"player_id":
              "UUID"}, {"corporation_id": "UUID REFERENCES corporations(id)"}, {"quantity":
              "BIGINT"}, {"average_buy_price": "DECIMAL(20, 4)"}, {"total_invested":
              "DECIMAL(20, 4)"}, {"total_dividends_received": "DECIMAL(20, 4)"}, {"created_at":
              "TIMESTAMP"}, {"updated_at": "TIMESTAMP"}]}, {"name": "dividend_schedules",
              "description": "Расписание дивидендов", "columns": [{"id": "UUID PRIMARY
              KEY"}, {"corporation_id": "UUID REFERENCES corporations(id)"}, {"dividend_type":
              "VARCHAR(20) (QUARTERLY, ANNUAL)"}, {"amount_per_share": "DECIMAL(20,
              4)"}, {"declaration_date": "DATE"}, {"ex_dividend_date": "DATE"}, {"record_date":
              "DATE"}, {"payment_date": "DATE"}, {"status": "VARCHAR(20) (SCHEDULED,
              DECLARED, PAID)"}, {"created_at": "TIMESTAMP"}, {"updated_at": "TIMESTAMP"}]},
              {"name": "dividend_payments", "description": "Выплаты дивидендов", "columns":
              [{"id": "UUID PRIMARY KEY"}, {"dividend_schedule_id": "UUID REFERENCES
              dividend_schedules(id)"}, {"player_id": "UUID"}, {"corporation_id":
              "UUID REFERENCES corporations(id)"}, {"shares_owned": "BIGINT"}, {"dividend_amount":
              "DECIMAL(20, 4)"}, {"tax_amount": "DECIMAL(20, 4)"}, {"net_amount":
              "DECIMAL(20, 4)"}, {"reinvested": "BOOLEAN DEFAULT FALSE"}, {"paid_at":
              "TIMESTAMP"}, {"created_at": "TIMESTAMP"}]}, {"name": "stock_indices",
              "description": "Биржевые индексы", "columns": [{"id": "UUID PRIMARY
              KEY"}, {"name": "VARCHAR(255)"}, {"symbol": "VARCHAR(20) UNIQUE"}, {"calculation_method":
              "VARCHAR(50) (PRICE_WEIGHTED, MARKET_CAP_WEIGHTED)"}, {"base_value":
              "DECIMAL(20, 4)"}, {"current_value": "DECIMAL(20, 4)"}, {"created_at":
              "TIMESTAMP"}, {"updated_at": "TIMESTAMP"}]}, {"name": "index_constituents",
              "description": "Состав индексов", "columns": [{"id": "UUID PRIMARY KEY"},
              {"index_id": "UUID REFERENCES stock_indices(id)"}, {"corporation_id":
              "UUID REFERENCES corporations(id)"}, {"weight": "DECIMAL(10, 6)"}, {"added_at":
              "TIMESTAMP"}, {"removed_at": "TIMESTAMP NULL"}]}, {"name": "index_history",
              "description": "История индексов", "columns": [{"id": "UUID PRIMARY
              KEY"}, {"index_id": "UUID REFERENCES stock_indices(id)"}, {"value":
              "DECIMAL(20, 4)"}, {"change": "DECIMAL(20, 4)"}, {"change_percent":
              "DECIMAL(10, 4)"}, {"timestamp": "TIMESTAMP"}, {"created_at": "TIMESTAMP"}]},
              {"name": "stock_events_impact", "description": "Влияние событий на акции",
              "columns": [{"id": "UUID PRIMARY KEY"}, {"event_id": "UUID"}, {"event_type":
              "VARCHAR(50)"}, {"corporation_id": "UUID REFERENCES corporations(id)"},
              {"impact_percent": "DECIMAL(10, 4)"}, {"base_price": "DECIMAL(20, 4)"},
              {"new_price": "DECIMAL(20, 4)"}, {"duration_hours": "INTEGER"}, {"started_at":
              "TIMESTAMP"}, {"ended_at": "TIMESTAMP NULL"}, {"created_at": "TIMESTAMP"}]},
              {"name": "compliance_alerts", "description": "Алерты о нарушениях",
              "columns": [{"id": "UUID PRIMARY KEY"}, {"player_id": "UUID"}, {"alert_type":
              "VARCHAR(50)"}, {"severity": "VARCHAR(20) (LOW, MEDIUM, HIGH, CRITICAL)"},
              {"description": "TEXT"}, {"trade_id": "UUID NULL"}, {"status": "VARCHAR(20)
              (OPEN, INVESTIGATING, RESOLVED)"}, {"created_at": "TIMESTAMP"}, {"resolved_at":
              "TIMESTAMP NULL"}]}]}}}'
        - column:
            name: metadata
            value: '{"id": "stock-exchange-database", "title": "Архитектура системы
              фондовой биржи - База данных", "document_type": "architecture", "category":
              "systems", "status": "draft", "version": "1.0.0", "last_updated": "2025-11-23T14:30:00+00:00",
              "owners": [{"role": "architect", "contact": "architect@necp.game"}],
              "tags": ["architecture", "economy", "stock-exchange", "database"], "related_documents":
              [{"id": "stock-exchange-core", "relation": "extends"}], "github_issue":
              393, "visibility": "internal", "audience": ["architect", "backend",
              "database"]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\stock-exchange-database.yaml
