databaseChangeLog:
- changeSet:
    id: documentation-support-ticket-technical-f2554cd2
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '3468892582794168'
        - column:
            name: doc_id
            value: support-ticket-technical
        - column:
            name: title
            value: Архитектура системы тикетов поддержки - Техническое задание
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.1.0
        - column:
            name: last_updated
            value: 2025-11-30 20:35:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[]'
        - column:
            name: tags
            value: []
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value: []
        - column:
            name: related_documents
            value: '[{"id": "support-ticket-core", "relation": "extends"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: ''
        - column:
            name: audience
            value: []
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "support-ticket-technical", "title": "Архитектура
              системы тикетов поддержки - Техническое задание", "document_type": "architecture",
              "category": "systems", "status": "draft", "version": "1.1.0", "last_updated":
              "2025-11-30T20:35:00+00:00", "github_issue": 334, "related_documents":
              [{"id": "support-ticket-core", "relation": "extends"}]}, "technical_specification":
              {"subtasks": [{"id": "support-ticket-manager", "title": "Реализация
              менеджера системы тикетов", "description": "Реализация Support Ticket
              Manager с управлением системой тикетов\nи интеграцией с другими компонентами.\n",
              "dependencies": [], "estimated_effort": "5 days"}, {"id": "ticket-creator",
              "title": "Реализация создателя тикетов", "description": "Реализация
              Ticket Creator с созданием тикетов,\nвалидацией данных и генерацией
              номеров.\n", "dependencies": ["support-ticket-manager"], "estimated_effort":
              "3 days"}, {"id": "auto-categorization-engine", "title": "Реализация
              движка автокатегоризации", "description": "Реализация Auto Categorization
              Engine с определением категорий,\nанализом ключевых слов и машинным
              обучением.\n", "dependencies": ["support-ticket-manager"], "estimated_effort":
              "5 days"}, {"id": "priority-assignment-engine", "title": "Реализация
              движка назначения приоритетов", "description": "Реализация Priority
              Assignment Engine с назначением приоритетов,\nприменением правил и анализом
              контента.\n", "dependencies": ["support-ticket-manager"], "estimated_effort":
              "4 days"}, {"id": "agent-queue-manager", "title": "Реализация менеджера
              очередей агентов", "description": "Реализация Agent Queue Manager с
              управлением очередями,\nназначением агентов и стратегиями распределения.\n",
              "dependencies": ["support-ticket-manager"], "estimated_effort": "5 days"},
              {"id": "sla-monitor", "title": "Реализация монитора SLA", "description":
              "Реализация SLA Monitor с мониторингом SLA,\nвычислением метрик и отправкой
              предупреждений.\n", "dependencies": ["support-ticket-manager"], "estimated_effort":
              "4 days"}, {"id": "ticket-response-manager", "title": "Реализация менеджера
              ответов", "description": "Реализация Ticket Response Manager с управлением
              ответами,\nвалидацией и управлением видимостью.\n", "dependencies":
              ["support-ticket-manager"], "estimated_effort": "3 days"}, {"id": "ticket-status-manager",
              "title": "Реализация менеджера статусов", "description": "Реализация
              Ticket Status Manager с управлением статусами,\nвалидацией переходов
              и обновлением метрик.\n", "dependencies": ["support-ticket-manager"],
              "estimated_effort": "3 days"}, {"id": "support-analytics-collector",
              "title": "Реализация сборщика аналитики", "description": "Реализация
              Support Analytics Collector с логированием операций,\nсбором метрик
              и интеграцией с Analytics Service.\n", "dependencies": ["support-ticket-manager"],
              "estimated_effort": "3 days"}, {"id": "support-telemetry-collector",
              "title": "Реализация сборщика телеметрии", "description": "Реализация
              Support Telemetry Collector с логированием событий,\nсбором телеметрии
              и интеграцией с Analytics Service.\n", "dependencies": ["support-ticket-manager"],
              "estimated_effort": "2 days"}, {"id": "websocket-channels", "title":
              "Реализация WebSocket каналов", "description": "Реализация WebSocket
              каналов для realtime обновлений тикетов,\nочереди агентов и уведомлений.\n",
              "dependencies": ["support-ticket-manager"], "estimated_effort": "3 days"},
              {"id": "event-bus-integration", "title": "Интеграция с Event Bus", "description":
              "Реализация публикации и подписки на события через Kafka\nдля всех компонентов
              системы тикетов.\n", "dependencies": ["support-ticket-manager"], "estimated_effort":
              "2 days"}, {"id": "database-schema", "title": "Создание схемы БД", "description":
              "Создание таблиц БД для тикетов, ответов, очередей агентов,\nметрик
              SLA и телеметрии с миграциями Liquibase.\n", "dependencies": [], "estimated_effort":
              "3 days"}]}, "diagrams": {"component_diagram": "```mermaid\ngraph TB\n    Client[UE5
              Client] --> Gateway[API Gateway]\n\n    Gateway --> SupportService[Support
              Service<br/>8095]\n\n    SupportService --> STM[Support Ticket Manager]\n    SupportService
              --> TC[Ticket Creator]\n    SupportService --> ACE[Auto Categorization
              Engine]\n    SupportService --> PAE[Priority Assignment Engine]\n    SupportService
              --> AQM[Agent Queue Manager]\n    SupportService --> SLAM[SLA Monitor]\n    SupportService
              --> TRM[Ticket Response Manager]\n    SupportService --> TSM[Ticket
              Status Manager]\n    SupportService --> SAC[Support Analytics Collector]\n    SupportService
              --> STC[Support Telemetry Collector]\n\n    STM --> TC\n    STM -->
              ACE\n    STM --> PAE\n    STM --> AQM\n    STM --> SLAM\n    STM -->
              TRM\n    STM --> TSM\n\n    SupportService --> NotificationService[Notification
              Service]\n    SupportService --> AccountsService[Accounts Service]\n    SupportService
              --> CharacterService[Character Service]\n    SupportService --> AnalyticsService[Analytics
              Service]\n\n    SupportService --> EventBus[Event Bus<br/>Kafka]\n    EventBus
              --> RealtimeGateway[Realtime Gateway]\n\n    SupportService --> DB[(Support
              DB)]\n\n    Client --> WSTickets[WebSocket<br/>Tickets]\n    WSTickets
              --> SupportService\n```\n", "ticket_creation_flow_diagram": "```mermaid\nsequenceDiagram\n    participant
              Player as Player\n    participant TC as Ticket Creator\n    participant
              ACE as Auto Categorization Engine\n    participant PAE as Priority Assignment
              Engine\n    participant STM as Support Ticket Manager\n    participant
              AQM as Agent Queue Manager\n    participant SLAM as SLA Monitor\n    participant
              NS as Notification Service\n\n    Player->>TC: Create ticket\n    TC->>TC:
              Validate data\n    TC->>ACE: Categorize ticket\n    ACE->>ACE: Analyze
              keywords\n    ACE->>TC: Return category\n    TC->>PAE: Assign priority\n    PAE->>PAE:
              Apply rules\n    PAE->>TC: Return priority\n    TC->>STM: Save ticket\n    STM->>STM:
              Generate ticket number\n    STM->>AQM: Add to queue\n    STM->>SLAM:
              Start SLA monitoring\n    STM->>NS: Notify player\n```\n", "ticket_assignment_flow_diagram":
              "```mermaid\nsequenceDiagram\n    participant AQM as Agent Queue Manager\n    participant
              STM as Support Ticket Manager\n    participant NS as Notification Service\n    participant
              SLAM as SLA Monitor\n\n    AQM->>AQM: Select ticket from queue\n    AQM->>AQM:
              Select agent by strategy\n    AQM->>AQM: Check agent limits\n    AQM->>STM:
              Assign agent\n    STM->>STM: Update status to assigned\n    STM->>NS:
              Notify agent\n    STM->>NS: Notify player\n    STM->>SLAM: Update metrics\n```\n"},
              "history": [{"version": "1.1.0", "date": "2025-11-30", "author": "Architect
              Agent", "changes": "Добавлена детальная синхронизация данных:\n- Event
              Sourcing для всех изменений состояния тикетов\n- CQRS Pattern для разделения
              команд и запросов\n- Saga Pattern для распределенных операций (создание
              тикета, назначение агента, изменение статуса, мониторинг SLA)\n- Outbox
              Pattern для гарантированной доставки событий\n- Обновлена секция data_consistency
              с механизмами синхронизации\n- Добавлена спецификация тикрейта для тикетов,
              назначения, ответов, мониторинга SLA, категоризации, приоритетов, статистики
              и обработки событий\n"}, {"version": "1.0.0", "date": "2025-11-23",
              "author": "Architect Agent", "changes": "Создана полная архитектура
              системы тикетов поддержки:\n- Определены компоненты (Support Ticket
              Manager, Ticket Creator, Auto Categorization Engine, Priority Assignment
              Engine, Agent Queue Manager, SLA Monitor, Ticket Response Manager, Ticket
              Status Manager)\n- Описаны API endpoints (высокоуровнево)\n- Спроектированы
              потоки данных\n- Определена структура БД (support_tickets, ticket_responses,
              agent_queues, ticket_sla_metrics, support_telemetry)\n- Спроектирована
              система создания тикетов\n- Спроектирована система автокатегоризации\n-
              Спроектирована система назначения приоритетов\n- Спроектирована система
              очередей агентов\n- Спроектирована система мониторинга SLA\n- Создано
              техническое задание\n- Разбито на подзадачи\n"}]}'
        - column:
            name: metadata
            value: '{"id": "support-ticket-technical", "title": "Архитектура системы
              тикетов поддержки - Техническое задание", "document_type": "architecture",
              "category": "systems", "status": "draft", "version": "1.1.0", "last_updated":
              "2025-11-30T20:35:00+00:00", "github_issue": 334, "related_documents":
              [{"id": "support-ticket-core", "relation": "extends"}]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\support-ticket-technical.yaml
