databaseChangeLog:
- changeSet:
    id: documentation-voice-lobby-system-5ae62f33
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '-719270374962802'
        - column:
            name: doc_id
            value: backend-voice-lobby-system
        - column:
            name: title
            value: Voice Lobby & Party Finder
        - column:
            name: document_type
            value: implementation
        - column:
            name: category
            value: backend
        - column:
            name: status
            value: approved
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-07 02:50:00+00:00
        - column:
            name: concept_approved
            value: true
        - column:
            name: concept_reviewed_at
            value: 2025-11-07 15:45:00+00:00
        - column:
            name: owners
            value: '[{"role": "voice_systems_lead", "contact": "voice@necp.game"}]'
        - column:
            name: tags
            value:
            - voice-chat
            - party-finder
            - matchmaking
        - column:
            name: topics
            value:
            - communication
            - social
        - column:
            name: related_systems
            value:
            - voice-service
            - party-service
            - guild-service
            - clan-service
        - column:
            name: related_documents
            value: '[{"id": "backend-party-system", "relation": "references"}, {"id":
              "backend-voice-chat-core", "relation": "depends_on"}]'
        - column:
            name: source
            value: shared/docs/knowledge/implementation/backend/voice-lobby/voice-lobby-system.md
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - backend
            - social
        - column:
            name: risk_level
            value: high
        - column:
            name: content
            value: '{"metadata": {"id": "backend-voice-lobby-system", "title": "Voice
              Lobby & Party Finder", "document_type": "implementation", "category":
              "backend", "status": "approved", "version": "1.0.0", "last_updated":
              "2025-11-07T02:50:00+00:00", "concept_approved": true, "concept_reviewed_at":
              "2025-11-07T15:45:00+00:00", "owners": [{"role": "voice_systems_lead",
              "contact": "voice@necp.game"}], "tags": ["voice-chat", "party-finder",
              "matchmaking"], "topics": ["communication", "social"], "related_systems":
              ["voice-service", "party-service", "guild-service", "clan-service"],
              "related_documents": [{"id": "backend-party-system", "relation": "references"},
              {"id": "backend-voice-chat-core", "relation": "depends_on"}], "source":
              "shared/docs/knowledge/implementation/backend/voice-lobby/voice-lobby-system.md",
              "visibility": "internal", "audience": ["backend", "social"], "risk_level":
              "high"}, "review": {"chain": [{"role": "voice_systems_lead", "reviewer":
              "", "reviewed_at": "2025-11-07T15:45:00+00:00", "status": "approved"}],
              "next_actions": []}, "summary": {"problem": "Требовалась формализованная
              спецификация для голосовых лобби, подбора группы и управления подканалами.",
              "goal": "Задокументировать архитектуру Voice Lobby & Party Finder, типы
              комнат, БД, алгоритмы и интеграции.", "essence": "Документ описывает
              подсистемы лобби, структуру данных, party finder, управление подканалами
              и API.", "key_points": ["Перечислены подсистемы (Lobby Directory, Party
              Finder, Subchannel Controller, Permissions).", {"Описаны типы лобби":
              "activity, clan/guild, raid, tournament."}, "Приведены SQL таблицы `voice_lobbies`,
              `lobby_participants`, `lobby_subchannels`.", "Покрыты алгоритмы подбора,
              управление подканалами, права и интеграции."]}, "content": {"sections":
              [{"id": "overview", "title": "Краткое описание", "body": "Voice Lobby
              & Party Finder расширяет голосовой чат: доменные комнаты, подбор по
              ролям/рейтингу, подканалы и управление\nправами с интеграцией в party,
              guild и clan системы.\n", "mechanics_links": []}, {"id": "architecture",
              "title": "Архитектура", "body": "Представлена цепочка Player → Lobby
              Finder → Voice Lobby Service → Voice Provider и перечислены подсистемы:\nLobby
              Directory API, Party Finder, Voice Lobby Manager, Subchannel Controller,
              Permissions Engine, Integration Layer.\n", "mechanics_links": []}, {"id":
              "lobby_types", "title": "Типы голосовых лобби", "body": "Описаны activity,
              clan/guild, raid и tournament лобби с ограничениями по участникам, подканалам
              и правам.\n", "mechanics_links": []}, {"id": "database", "title": "База
              данных", "body": "SQL схемы для `voice_lobbies`, `lobby_participants`,
              `lobby_subchannels` с индексами и атрибутами ролей, статусов, регионов.\n",
              "mechanics_links": []}, {"id": "party_finder", "title": "Алгоритм Party
              Finder", "body": "Параметры подбора (роли, рейтинг, активность, регион,
              язык), flow выбора лобби и Java-код проверки ролей и рейтингов.\n",
              "mechanics_links": []}, {"id": "subchannels", "title": "Управление подканалами",
              "body": "Java методы `ensureSubchannels` и `moveToSubchannel` создают
              основные, ролевые и командирские каналы и переводят участников.\n",
              "mechanics_links": []}, {"id": "permissions", "title": "Права и модерация",
              "body": "Таблица ролей (Leader, Commander, Party Leader, Officer, Member),
              ready-check и countdown механика с примером кода.\n", "mechanics_links":
              []}, {"id": "integrations", "title": "Интеграции и API", "body": "Описаны
              интеграции с party, guild, clan, housing системами и перечислены REST
              endpoints каталога и управления лобби.\n", "mechanics_links": []}]},
              "appendix": {"glossary": [], "references": [], "decisions": []}, "implementation":
              {"github_issue": 136, "needs_task": false, "queue_reference": ["shared/trackers/queues/concept/queued.yaml"],
              "blockers": []}, "history": [{"version": "1.0.0", "date": "2025-11-07",
              "author": "voice_systems_lead", "changes": "Создана спецификация Voice
              Lobby & Party Finder."}], "validation": {"checksum": "", "schema_version":
              "1.0"}}'
        - column:
            name: metadata
            value: '{"id": "backend-voice-lobby-system", "title": "Voice Lobby & Party
              Finder", "document_type": "implementation", "category": "backend", "status":
              "approved", "version": "1.0.0", "last_updated": "2025-11-07T02:50:00+00:00",
              "concept_approved": true, "concept_reviewed_at": "2025-11-07T15:45:00+00:00",
              "owners": [{"role": "voice_systems_lead", "contact": "voice@necp.game"}],
              "tags": ["voice-chat", "party-finder", "matchmaking"], "topics": ["communication",
              "social"], "related_systems": ["voice-service", "party-service", "guild-service",
              "clan-service"], "related_documents": [{"id": "backend-party-system",
              "relation": "references"}, {"id": "backend-voice-chat-core", "relation":
              "depends_on"}], "source": "shared/docs/knowledge/implementation/backend/voice-lobby/voice-lobby-system.md",
              "visibility": "internal", "audience": ["backend", "social"], "risk_level":
              "high"}'
        - column:
            name: source_file
            value: knowledge\implementation\backend\voice-lobby\voice-lobby-system.yaml
