databaseChangeLog:
- changeSet:
    id: documentation-world-events-system-architecture-3aa510e6
    author: content-migration-generator
    changes:
    - insert:
        tableName: project.documentation
        columns:
        - column:
            name: id
            value: '5991398429082766'
        - column:
            name: doc_id
            value: world-events-system-architecture
        - column:
            name: title
            value: Архитектура системы мировых событий
        - column:
            name: document_type
            value: architecture
        - column:
            name: category
            value: systems
        - column:
            name: status
            value: draft
        - column:
            name: version
            value: 1.0.0
        - column:
            name: last_updated
            value: 2025-11-23 23:50:00+00:00
        - column:
            name: concept_approved
            value: false
        - column:
            name: concept_reviewed_at
            value: null
        - column:
            name: owners
            value: '[{"role": "architect", "contact": "architect@necp.game"}]'
        - column:
            name: tags
            value:
            - architecture
            - world
            - events
            - live-ops
            - narrative
        - column:
            name: topics
            value: []
        - column:
            name: related_systems
            value:
            - world-service
            - social-service
            - gameplay-service
            - economy-service
            - analytics-service
            - quest-service
            - reputation-service
        - column:
            name: related_documents
            value: '[{"id": "analysis-ideas-2025-11-03-events-brainstorm", "relation":
              "implements"}, {"id": "travel-events-system-architecture", "relation":
              "extends"}, {"id": "economy-events-system-architecture", "relation":
              "extends"}, {"id": "world-events-1990-2000", "relation": "implements"},
              {"id": "world-events-2060-2077", "relation": "implements"}, {"id": "world-events-2077",
              "relation": "implements"}, {"id": "world-events-framework", "relation":
              "implements"}]'
        - column:
            name: source
            value: ''
        - column:
            name: visibility
            value: internal
        - column:
            name: audience
            value:
            - architect
            - backend
            - world
            - live-ops
            - api-designer
        - column:
            name: risk_level
            value: ''
        - column:
            name: content
            value: '{"metadata": {"id": "world-events-system-architecture", "title":
              "Архитектура системы мировых событий", "document_type": "architecture",
              "category": "systems", "status": "draft", "version": "1.0.0", "last_updated":
              "2025-11-23T23:50:00+00:00", "owners": [{"role": "architect", "contact":
              "architect@necp.game"}], "tags": ["architecture", "world", "events",
              "live-ops", "narrative"], "related_systems": ["world-service", "social-service",
              "gameplay-service", "economy-service", "analytics-service", "quest-service",
              "reputation-service"], "related_documents": [{"id": "analysis-ideas-2025-11-03-events-brainstorm",
              "relation": "implements"}, {"id": "travel-events-system-architecture",
              "relation": "extends"}, {"id": "economy-events-system-architecture",
              "relation": "extends"}, {"id": "world-events-1990-2000", "relation":
              "implements"}, {"id": "world-events-2060-2077", "relation": "implements"},
              {"id": "world-events-2077", "relation": "implements"}, {"id": "world-events-framework",
              "relation": "implements"}], "github_issue": 44, "related_github_issues":
              [464], "visibility": "internal", "audience": ["architect", "backend",
              "world", "live-ops", "api-designer"]}, "summary": {"problem": "Требуется
              спроектировать архитектуру системы мировых событий для управления крупными
              событиями,\nкоторые влияют на весь мир игры или большие регионы:\n-
              События разных типов (технологические, политические, военные, спортивные,
              экологические, сюжетные)\n- События разных масштабов (глобальные, региональные,
              городские, локальные)\n- События разной частоты (разовые, периодические,
              регулярные)\n- Влияние на множественные системы (экономика, фракции,
              социальная динамика, боевая система)\n- Координация между множеством
              сервисов\n- Планирование и автоматический запуск событий\n- Коммуникация
              с игроками (баннеры, уведомления, новости)\n", "goal": "Создать архитектурную
              схему системы мировых событий с определением:\n- Микросервисов для управления
              событиями\n- Компонентов для планирования, выполнения и мониторинга
              событий\n- API endpoints (высокоуровнево)\n- Интеграций с другими системами\n-
              Структуры БД для хранения событий и их эффектов\n- Технического задания
              для реализации\n", "essence": "Система мировых событий управляет жизненным
              циклом крупных событий, влияющих на мир игры,\nкоординирует изменения
              в множественных системах, синхронизирует через Event Bus и предоставляет\nAPI
              для мониторинга и управления событиями.\n"}, "architecture": {"overview":
              "Система мировых событий состоит из следующих компонентов:\n1. World
              Events Manager - управление жизненным циклом событий\n2. Event Scheduler
              - планирование и автоматический запуск событий\n3. Event Effects Coordinator
              - координация применения эффектов к различным системам\n4. Event Monitor
              - мониторинг активных событий и метрик\n5. Event Communication Manager
              - коммуникация с игроками (баннеры, уведомления, новости)\n6. Event
              Analytics Collector - сбор аналитики по событиям\n7. Event Integration
              Manager - интеграция с другими сервисами\n8. Event State Manager - управление
              состоянием событий\n9. Event Scale Manager - управление масштабом событий
              (глобальные, региональные, городские, локальные)\n10. Event Type Handler
              - обработчики для разных типов событий\n", "microservices": [{"name":
              "world-service", "port": 8086, "responsibility": "Основной сервис для
              управления мировыми событиями:\n- CRUD операции с событиями\n- Управление
              жизненным циклом событий\n- Координация эффектов с другими сервисами\n-
              Управление масштабом и типом событий\n", "components": ["World Events
              Manager", "Event Effects Coordinator", "Event State Manager", "Event
              Scale Manager", "Event Type Handler"], "endpoints": ["GET /api/v1/world/events
              - список событий", "GET /api/v1/world/events/{id} - детали события",
              "POST /api/v1/world/events - создание события", "PUT /api/v1/world/events/{id}
              - обновление события", "DELETE /api/v1/world/events/{id} - удаление
              события", "POST /api/v1/world/events/{id}/announce - анонс события",
              "POST /api/v1/world/events/{id}/activate - активация события", "POST
              /api/v1/world/events/{id}/deactivate - деактивация события", "GET /api/v1/world/events/active
              - активные события", "GET /api/v1/world/events/planned - запланированные
              события", "GET /api/v1/world/events/by-scale/{scale} - события по масштабу",
              "GET /api/v1/world/events/by-type/{type} - события по типу", "GET /api/v1/world/events/by-frequency/{frequency}
              - события по частоте"]}, {"name": "event-scheduler-service", "port":
              8090, "responsibility": "Планирование и автоматический запуск событий:\n-
              Cron-задачи для запланированных событий\n- Триггеры от квестов и симуляции\n-
              Ограничения на количество активных событий\n- Минимальные перерывы между
              событиями\n- Управление периодическими и регулярными событиями\n", "components":
              ["Event Scheduler", "Trigger Manager", "Constraint Validator", "Frequency
              Manager"], "endpoints": ["POST /api/v1/scheduler/world-events/schedule
              - запланировать событие", "GET /api/v1/scheduler/world-events/scheduled
              - запланированные события", "POST /api/v1/scheduler/world-events/{id}/trigger
              - ручной запуск", "GET /api/v1/scheduler/world-events/calendar - календарь
              событий"]}, {"name": "economy-service", "port": 8085, "responsibility":
              "Применение экономических эффектов от мировых событий:\n- Модификация
              цен на ресурсы\n- Изменение курсов валют\n- Влияние на торговлю\n- Экономические
              кризисы и бумы\n", "components": ["Economic Effects Handler", "Price
              Modifier Calculator"], "endpoints": ["POST /api/v1/economy/apply-world-event-effects
              - применить эффекты события", "GET /api/v1/economy/world-event-effects/{event_id}
              - эффекты события"]}, {"name": "social-service", "port": 8084, "responsibility":
              "Применение социальных эффектов от мировых событий:\n- Изменение репутации
              фракций\n- Влияние на отношения между фракциями\n- Социальные движения
              и протесты\n- Изменение настроений NPC\n", "components": ["Social Effects
              Handler", "Faction Relations Modifier"], "endpoints": ["POST /api/v1/social/apply-world-event-effects
              - применить эффекты события", "GET /api/v1/social/world-event-effects/{event_id}
              - эффекты события"]}, {"name": "gameplay-service", "port": 8083, "responsibility":
              "Применение игровых эффектов от мировых событий:\n- Изменение TTK (Time
              To Kill)\n- Модификация боевых параметров\n- Влияние на доступность
              контента\n- Военные конфликты и операции\n", "components": ["Gameplay
              Effects Handler", "Combat Modifier Calculator"], "endpoints": ["POST
              /api/v1/gameplay/apply-world-event-effects - применить эффекты события",
              "GET /api/v1/gameplay/world-event-effects/{event_id} - эффекты события"]},
              {"name": "analytics-service", "port": 8095, "responsibility": "Сбор
              и анализ метрик по мировым событиям:\n- Player Engagement (вовлеченность
              игроков)\n- Economic Impact (экономическое влияние)\n- Social Impact
              (социальное влияние)\n- Event Uptime (время активности событий)\n- Алерты
              при нарушении прогнозов\n", "components": ["Event Analytics Collector",
              "Metrics Calculator", "Alert Manager"], "endpoints": ["GET /api/v1/analytics/world-events/{id}/metrics
              - метрики события", "GET /api/v1/analytics/world-events/{id}/engagement
              - вовлеченность", "GET /api/v1/analytics/world-events/{id}/impact -
              влияние на системы", "GET /api/v1/analytics/world-events/alerts - активные
              алерты"]}, {"name": "notification-service", "port": 8092, "responsibility":
              "Коммуникация с игроками о мировых событиях:\n- Баннеры и уведомления\n-
              Новости и объявления\n- In-game сообщения\n- Push-уведомления\n", "components":
              ["Event Communication Manager", "Notification Dispatcher"], "endpoints":
              ["POST /api/v1/notifications/world-events/{id}/announce - анонс события",
              "GET /api/v1/notifications/world-events/active - активные уведомления"]}],
              "components": [{"name": "World Events Manager", "location": "world-service",
              "responsibility": "Управление жизненным циклом событий:\n- Создание,
              обновление, удаление событий\n- Переходы между состояниями (PLANNED
              → ANNOUNCED → ACTIVE → COOLDOWN → ARCHIVED)\n- Валидация данных событий\n-
              Управление версиями событий\n- Управление зависимостями между событиями\n",
              "dependencies": ["Event State Manager", "Event Type Handler", "Event
              Scale Manager"]}, {"name": "Event Scheduler", "location": "event-scheduler-service",
              "responsibility": "Планирование и автоматический запуск событий:\n-
              Cron-задачи для запланированных событий\n- Триггеры от квестов и симуляции\n-
              Ограничения на количество активных событий\n- Минимальные перерывы между
              событиями\n- Управление периодическими и регулярными событиями\n", "dependencies":
              ["World Events Manager", "Constraint Validator", "Frequency Manager"]},
              {"name": "Event Effects Coordinator", "location": "world-service", "responsibility":
              "Координация применения эффектов к различным системам:\n- Определение
              целевых систем для эффектов\n- Последовательное применение эффектов\n-
              Откат эффектов при завершении события\n- Управление конфликтами между
              эффектами\n", "dependencies": ["Economy Service", "Social Service",
              "Gameplay Service", "Event State Manager"]}, {"name": "Event Monitor",
              "location": "world-service", "responsibility": "Мониторинг активных
              событий и метрик:\n- Отслеживание состояния событий\n- Сбор метрик производительности\n-
              Мониторинг влияния на системы\n- Алерты при проблемах\n", "dependencies":
              ["Analytics Service", "Event State Manager"]}, {"name": "Event Communication
              Manager", "location": "notification-service", "responsibility": "Коммуникация
              с игроками о мировых событиях:\n- Генерация баннеров и уведомлений\n-
              Создание новостей и объявлений\n- In-game сообщения\n- Push-уведомления\n",
              "dependencies": ["World Events Manager", "Notification Dispatcher"]},
              {"name": "Event Analytics Collector", "location": "analytics-service",
              "responsibility": "Сбор аналитики по событиям:\n- Player Engagement
              метрики\n- Economic Impact метрики\n- Social Impact метрики\n- Event
              Uptime метрики\n- Генерация отчетов\n", "dependencies": ["World Events
              Manager", "Event Monitor"]}, {"name": "Event Integration Manager", "location":
              "world-service", "responsibility": "Интеграция с другими сервисами:\n-
              Синхронизация через Event Bus\n- Управление зависимостями\n- Обработка
              ошибок интеграции\n- Retry логика\n", "dependencies": ["Event Bus (Kafka)",
              "All related services"]}, {"name": "Event State Manager", "location":
              "world-service", "responsibility": "Управление состоянием событий:\n-
              Хранение состояния событий\n- Переходы между состояниями\n- Валидация
              переходов\n- История изменений состояния\n", "dependencies": ["Database"]},
              {"name": "Event Scale Manager", "location": "world-service", "responsibility":
              "Управление масштабом событий:\n- Глобальные события (весь мир)\n- Региональные
              события (регион)\n- Городские события (город)\n- Локальные события (область)\n-
              Определение целевых регионов\n", "dependencies": ["World Events Manager"]},
              {"name": "Event Type Handler", "location": "world-service", "responsibility":
              "Обработчики для разных типов событий:\n- Сюжетные события\n- Технологические
              события\n- Экономические события\n- Политические события\n- Военные
              события\n- Спортивные события\n- Экологические события\n", "dependencies":
              ["World Events Manager", "Event Effects Coordinator"]}], "data_models":
              {"world_event": {"fields": [{"id": "UUID"}, {"title": "string"}, {"description":
              "string"}, {"type": "enum (STORY, TECHNOLOGICAL, ECONOMIC, POLITICAL,
              MILITARY, SPORTS, ENVIRONMENTAL)"}, {"scale": "enum (GLOBAL, REGIONAL,
              CITY, LOCAL)"}, {"frequency": "enum (ONE_TIME, PERIODIC, REGULAR)"},
              {"status": "enum (PLANNED, ANNOUNCED, ACTIVE, COOLDOWN, ARCHIVED)"},
              {"start_time": "timestamp"}, {"end_time": "timestamp"}, {"duration":
              "duration"}, {"effects": "array of EventEffect"}, {"target_regions":
              "array of string"}, {"target_factions": "array of UUID"}, {"prerequisites":
              "array of UUID"}, {"cooldown_duration": "duration"}, {"max_concurrent":
              "integer"}, {"created_at": "timestamp"}, {"updated_at": "timestamp"},
              {"version": "integer"}]}, "event_effect": {"fields": [{"id": "UUID"},
              {"event_id": "UUID"}, {"target_system": "enum (ECONOMY, SOCIAL, GAMEPLAY,
              REPUTATION, QUEST)"}, {"effect_type": "string"}, {"parameters": "json"},
              {"start_time": "timestamp"}, {"end_time": "timestamp"}, {"is_active":
              "boolean"}]}, "event_schedule": {"fields": [{"id": "UUID"}, {"event_id":
              "UUID"}, {"scheduled_time": "timestamp"}, {"trigger_type": "enum (CRON,
              MANUAL, QUEST, SIMULATION)"}, {"trigger_parameters": "json"}, {"status":
              "enum (SCHEDULED, TRIGGERED, CANCELLED)"}, {"created_at": "timestamp"}]}},
              "api_endpoints": {"world_service": {"base_path": "/api/v1/world/events",
              "endpoints": [{"method": "GET", "path": "/", "description": "Список
              всех событий с фильтрацией", "query_params": null}]}}}}'
        - column:
            name: metadata
            value: '{"id": "world-events-system-architecture", "title": "Архитектура
              системы мировых событий", "document_type": "architecture", "category":
              "systems", "status": "draft", "version": "1.0.0", "last_updated": "2025-11-23T23:50:00+00:00",
              "owners": [{"role": "architect", "contact": "architect@necp.game"}],
              "tags": ["architecture", "world", "events", "live-ops", "narrative"],
              "related_systems": ["world-service", "social-service", "gameplay-service",
              "economy-service", "analytics-service", "quest-service", "reputation-service"],
              "related_documents": [{"id": "analysis-ideas-2025-11-03-events-brainstorm",
              "relation": "implements"}, {"id": "travel-events-system-architecture",
              "relation": "extends"}, {"id": "economy-events-system-architecture",
              "relation": "extends"}, {"id": "world-events-1990-2000", "relation":
              "implements"}, {"id": "world-events-2060-2077", "relation": "implements"},
              {"id": "world-events-2077", "relation": "implements"}, {"id": "world-events-framework",
              "relation": "implements"}], "github_issue": 44, "related_github_issues":
              [464], "visibility": "internal", "audience": ["architect", "backend",
              "world", "live-ops", "api-designer"]}'
        - column:
            name: source_file
            value: knowledge\implementation\architecture\world-events-system-architecture.yaml
