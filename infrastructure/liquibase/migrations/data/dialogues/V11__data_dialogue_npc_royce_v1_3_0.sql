-- Issue: #50
-- Import dialogue from: npc-royce.yaml
-- Version: 1.3.0
-- Generated: 2025-12-13T21:13:37.176948
-- WARNING  WARNING: Requires 'dialogue_nodes' table (create via Database agent)

BEGIN;

-- Dialogue: canon-narrative-dialogue-royce
INSERT INTO narrative.dialogue_nodes (dialogue_id, title, content_data, version, is_active) VALUES ('canon-narrative-dialogue-royce', 'Диалоги — Ройс (Maelstrom)', '{"metadata": {"id": "canon-narrative-dialogue-royce", "title": "Диалоги — Ройс (Maelstrom)", "document_type": "canon", "category": "narrative", "status": "approved", "version": "1.3.0", "last_updated": "2025-11-11T00:00:00+00:00", "concept_approved": true, "concept_reviewed_at": "2025-11-07T21:13:00+00:00", "owners": [{"role": "narrative_director", "contact": "narrative@necp.game"}], "tags": ["dialogue", "maelstrom"], "topics": ["narrative", "raids"], "related_systems": ["narrative-service", "world-service", "social-service"], "related_documents": [{"id": "canon-npc-royce", "relation": "references"}, {"id": "canon-quests-side-sq-maelstrom-double-cross", "relation": "complements"}, {"id": "canon-gameplay-world-events-framework", "relation": "references"}], "source": "shared/docs/knowledge/canon/narrative/dialogues/npc-royce.md", "visibility": "internal", "audience": ["narrative", "systems-design", "liveops"], "risk_level": "high"}, "review": {"chain": [{"role": "narrative_director", "reviewer": "Maelstrom Narrative Cell", "reviewed_at": "2025-11-07T21:13:00+00:00", "status": "approved"}], "next_actions": []}, "summary": {"problem": "Диалог лидера Maelstrom Ройса оставался в Markdown и не соответствовал стандарту YAML для многоуровневых рейдовых веток и подозрений.", "goal": "Зафиксировать состояния Maelstrom (intake, trusted, paranoid, raid-mode), проверки, события и награды для интеграции с сервисами narrative/world/social.", "essence": "Документ описывает инициацию Maelstrom, выдачу имплантов, рейдовые команды и допросы при подозрении в работе на корпорации.", "key_points": ["Состояния intake, trusted, paranoid и raid-mode зависят от репутации `rep.gang.maelstrom`, синхронизации импланта и мировых событий Underlink.", "Узлы `intake-scan`, `trusted-offer`, `paranoid-interrogation` и `raid-command` управляют тестами, выдачей имплантов, двойными агентами и рейдами.", "Проверки Intimidation, Technical, Hacking, Deception и Insight определяют лут, события и риски blacklist или казни."]}, "content": {"sections": [{"id": "context", "title": "Контекст Maelstrom", "body": "Ройс — харизматичный лидер Maelstrom, управляющий техно-культом между корпорациями и Blackwall. Диалог отражает\\nего безумный стиль, отсылки к мемам хаоса 2020-х и взаимодействие с Militech/NCPD через double-cross.\\n", "mechanics_links": [], "assets": []}, {"id": "states", "title": "Состояния и условия", "body": "Состояния intake, trusted, paranoid и raid-mode активируются репутацией банды, флагами `flag.maelstrom.*` и\\nсобытием `world.event.maelstrom_underlink_raid`. Paranoid усиливается при контактах с корпорациями или NCPD.\\n", "mechanics_links": ["../../02-gameplay/social/reputation-formulas.md", "../../02-gameplay/world/events/world-events-framework.md"], "assets": []}, {"id": "dialogue_nodes", "title": "Узлы и опции", "body": "Узлы `intake-scan`, `trusted-offer`, `paranoid-interrogation` и `raid-command` описывают проверку новичка,\\nвыдачу имплантов, допрос заказчиков корпораций и командование рейдом. Исходы управляют флагами, контрактами и\\nмировыми событиями.\\n", "mechanics_links": [], "assets": []}, {"id": "checks", "title": "Проверки и критические исходы", "body": "Таблица проверок содержит Intimidation, Technical, Hacking, Deception и Insight. Успехи дают импланты,\\nконтракты `maelstrom-gun-heist`, лидерство рейда; провалы вызывают nerve_burn, blacklist и события «maelstrom-breach».\\n", "mechanics_links": [], "assets": []}, {"id": "events", "title": "Событийные реакции", "body": "Диалог реагирует на `world.event.maelstrom_underlink_raid` и `world.event.corporate_war_escalation`, изменяя DC,\\nвыдавая баф `maelstrom_frenzy` и открывая ветку рейда.\\n", "mechanics_links": [], "assets": []}, {"id": "rewards", "title": "Награды и последствия", "body": "Игрок получает импланты `maelstrom-spike`, `maelstrom-ripper-chip`, репутацию банды, рейдовые схемы и может быть\\nзанесён в чёрный список или казнён при провале. Контракты запускают события `maelstrom-underlink-raid` и\\n`maelstrom-double-cross`.\\n", "mechanics_links": [], "assets": []}]}, "appendix": {"glossary": [], "references": [{"title": "Royce Lore Dossier", "link": "../npc-lore/important/royce.md"}, {"title": "Maelstrom Double Cross Quest", "link": "../quests/side/SQ-maelstrom-double-cross.md"}, {"title": "Underlink Raid Event", "link": "../../02-gameplay/world/events/world-events-framework.md"}], "decisions": []}, "implementation": {"needs_task": false, "github_issue": 107, "queue_reference": ["shared/trackers/queues/concept/queued.yaml"], "blockers": []}, "history": [{"version": "1.3.0", "date": "2025-11-11", "author": "narrative_team", "changes": "Диалог Ройса перенесён в YAML, структурированы состояния Maelstrom, рейды и проверки подозрений."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 1, true) ON CONFLICT (dialogue_id) DO UPDATE SET title = EXCLUDED.title, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 dialogue