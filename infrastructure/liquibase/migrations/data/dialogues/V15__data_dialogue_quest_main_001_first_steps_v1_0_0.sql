-- Issue: #50
-- Import dialogue from: quest-main-001-first-steps.yaml
-- Version: 1.0.0
-- Generated: 2025-12-06T21:13:01.282501
-- WARNING  WARNING: Requires 'dialogue_nodes' table (create via Database agent)

BEGIN;

-- Dialogue: canon-dialogue-quest-main-001-first-steps
INSERT INTO narrative.dialogue_nodes (dialogue_id, title, content_data, version, is_active) VALUES ('canon-dialogue-quest-main-001-first-steps', 'Диалог: квест 1.1 «Первые шаги»', '{"metadata": {"id": "canon-dialogue-quest-main-001-first-steps", "title": "Диалог: квест 1.1 «Первые шаги»", "document_type": "canon", "category": "narrative", "status": "approved", "version": "1.0.0", "last_updated": "2025-11-08T09:26:00+00:00", "concept_approved": false, "concept_reviewed_at": "", "owners": [{"role": "narrative_team", "contact": "narrative@necp.game"}], "tags": ["tutorial", "watson", "marco-sanchez"], "topics": ["onboarding", "progression"], "related_systems": ["narrative-service", "tutorial-system", "social-service"], "related_documents": [{"id": "canon-quest-main-001-first-steps", "relation": "quest-brief"}, {"id": "canon-dialogue-npc-marco-fix-sanchez", "relation": "guide"}], "source": "shared/docs/knowledge/canon/narrative/dialogues/quest-main-001-first-steps.md", "visibility": "internal", "audience": ["narrative", "onboarding", "qa"], "risk_level": "medium"}, "review": {"chain": [{"role": "narrative_lead", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "Стартовый диалог обучения был в Markdown и не связывался с системой подсказок и телеметрией.", "goal": "Структурировать обучение «Первые шаги» для автоматизации бросков, HUD-подсказок и передачи выбора дальше по кампании.", "essence": "Марко Санчес проводит игрока через паркур, коммуникацию, стелс и тех-проверку, подготавливая к выбору фракции.", "key_points": ["Включает обязательные проверки Perception, Parkour, Communication, Stealth и Tech.", "HUD-подсказки обучают работе с бросками d20 и журналом.", "Выбор в финале сохраняет предпочтение для квеста «Выбор пути»."]}, "content": {"sections": [{"id": "flow", "title": "Поток сценария", "body": "- `arrival`: знакомство с Watson, первая проверка Perception и саркастические напутствия.\\n- `market-run`: паркур или обход, возможность перейти в ветку стелса.\\n- `tutorial-hud`: объяснение HUD-журнала и бросков.\\n- `fixer-brief`: знакомство с Марко и Джейком, контроль первой подработки.\\n- `stealth-route` и `tech-door`: опциональные и основные проверки Stealth/Tech.\\n- `wrap-up`: выбор ориентира (корпы, улицы, фриланс) и передача данных в квест 1.2.\\n", "mechanics_links": ["shared/docs/knowledge/canon/narrative/npc-lore/important/marco-fix-sanchez.yaml"], "assets": []}, {"id": "mechanics", "title": "Проверки и обучение", "body": "- Минимальные пороги стартовых проверок: Perception 10, Parkour 10, Communication 10, Stealth 10, Tech 12–14.\\n- HUD показывает журнал проверок, подсказки и дебаффы (`perception_noise`, `movement_slow`, `stealth_cooldown`).\\n- Критические успехи выдают лут (motion-capture chip, nano-компоненты) и social пасхалки (#WatsonWalk).\\n", "mechanics_links": ["shared/docs/knowledge/content/quests/main/mq-001-first-steps.yaml"], "assets": []}, {"id": "integrations", "title": "Интеграции и телеметрия", "body": "- Narrative-service использует экспорт YAML, HUD обновляет подсказки, social-service публикует моменты (клипы, мемы).\\n- `validate-quest-dialogue.ps1` и `dialogue-simulator.ps1 -Scenario first-steps` проверяют последовательность флагов и подсказок.\\n- Метрики: `tutorial-perception-success-rate`, `tutorial-parkour-success-rate`, `tutorial-stealth-alerts`, `tutorial-tech-critical-failures`.\\n", "mechanics_links": [], "assets": []}, {"id": "outcomes", "title": "Награды и передача выбора", "body": "- Репутация: `rep.fixers.marco` ±8, `rep.street` ±3, `rep.corp.arasaka +3` (корп-путь), `rep.law.ncpd +2` при успешном взломе.\\n- Предметы: `loot.micro`, `chip.motion-capture`, `component.nano`, наклейка «Ever Given 2077».\\n- Флаги `flag.main001.choice_{corp|gang|free}` подготавливают ветви квеста «Выбор пути».\\n", "mechanics_links": [], "assets": []}]}, "appendix": {"glossary": [], "references": [{"title": "Starter Quest Flow", "link": "../../content/quests/main/mq-001-first-steps.yaml"}, {"title": "Social Metrics Overview", "link": "../../02-gameplay/social/reputation-formulas.md"}], "decisions": []}, "implementation": {"needs_task": false, "github_issue": 106, "queue_reference": [], "blockers": []}, "history": [{"version": "1.0.0", "date": "2025-11-08", "author": "narrative_team", "changes": "Подтверждена готовность квеста, добавлены подсказки HUD и телеметрия."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 1, true) ON CONFLICT (dialogue_id) DO UPDATE SET title = EXCLUDED.title, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 dialogue