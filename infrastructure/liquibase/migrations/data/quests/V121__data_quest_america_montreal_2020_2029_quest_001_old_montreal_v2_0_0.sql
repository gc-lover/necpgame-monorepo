-- Issue: #50
-- Import quest from: america\montreal\2020-2029\quest-001-old-montreal.yaml
-- Generated: 2025-12-13T21:13:33.820740

BEGIN;

-- Quest: canon-quest-montreal-old-montreal
INSERT INTO gameplay.quest_definitions (quest_id, title, description, quest_type, level_min, level_max, requirements, objectives, rewards, branches, content_data, version, is_active) VALUES ('canon-quest-montreal-old-montreal', 'Монреаль — Старый город', 'Игрок исследует площади Старого Монреаля, посещает базилику Нотр-Дам и открывает европейское наследие города.', 'side', 1, NULL, '{"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}'::jsonb, '[{"id": "start_at_place_jacques_cartier", "text": "Начать прогулку на Place Jacques-Cartier и получить карту исторических маршрутов", "type": "interact", "target": "place_jacques_cartier", "count": 1, "optional": false}, {"id": "visit_notre_dame", "text": "Посетить базилику Нотр-Дам, оценить световое шоу и орган", "type": "interact", "target": "notre_dame_basilica", "count": 1, "optional": false}, {"id": "explore_cobblestone_streets", "text": "Исследовать узкие мощёные улочки и ремесленные лавки", "type": "interact", "target": "cobblestone_streets_shops", "count": 1, "optional": false}, {"id": "visit_old_port", "text": "Выйти к старому порту, наблюдать за туристическими судами и артистами", "type": "interact", "target": "old_port_observation", "count": 1, "optional": false}, {"id": "prepare_photo_report", "text": "Подготовить фотоотчёт для культурного архива и получить скидки в локальных кафе", "type": "interact", "target": "cultural_archive_report", "count": 1, "optional": false}]'::jsonb, '{"xp": 1500, "currency": -20, "items": [], "reputation": {"culture": 20}, "achievements": [{"id": "old_city_keeper", "name": "Хранитель Старого Города"}], "skill_boosts": {}}'::jsonb, '[]'::jsonb, '{"metadata": {"id": "canon-quest-montreal-old-montreal", "title": "Монреаль — Старый город", "document_type": "canon", "category": "quest", "status": "approved", "version": "2.0.0", "last_updated": "2025-11-29T13:14:00+00:00", "concept_approved": true, "concept_reviewed_at": "2025-11-06T13:14:00+00:00", "owners": [{"role": "narrative_team", "contact": "narrative@necp.game"}], "tags": ["montreal", "history", "architecture"], "topics": ["regional-content", "cultural-heritage"], "related_systems": ["exploration-system", "social-system"], "related_documents": [{"id": "canon-quest-montreal-french-language", "relation": "complements"}], "source": "shared/docs/knowledge/canon/lore/_03-lore/timeline-author/quests/america/montreal/2020-2029/quest-001-old-montreal.md", "visibility": "internal", "audience": ["lore", "narrative", "quest-design"], "risk_level": "low"}, "review": {"chain": [{"role": "narrative_lead", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "Прогулка по Vieux-Montréal не была описана в базе знаний и не связывалась с историческими системами.", "goal": "Оформить туристический квест в YAML с акцентом на европейскую архитектуру и культурные бонусы.", "essence": "Игрок исследует площади Старого Монреаля, посещает базилику Нотр-Дам и открывает европейское наследие города.", "key_points": ["Vieux-Montréal основан в 1642 и сохраняет мощёные улочки.", "Базилика Нотр-Дам синим интерьером и органом на 7,000 труб создаёт уникальный визуал.", "Квест даёт культурные очки и вводит в историческую линию Монреаля."]}, "quest_definition": {"quest_type": "side", "level_min": 1, "level_max": null, "requirements": {"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}, "objectives": [{"id": "start_at_place_jacques_cartier", "text": "Начать прогулку на Place Jacques-Cartier и получить карту исторических маршрутов", "type": "interact", "target": "place_jacques_cartier", "count": 1, "optional": false}, {"id": "visit_notre_dame", "text": "Посетить базилику Нотр-Дам, оценить световое шоу и орган", "type": "interact", "target": "notre_dame_basilica", "count": 1, "optional": false}, {"id": "explore_cobblestone_streets", "text": "Исследовать узкие мощёные улочки и ремесленные лавки", "type": "interact", "target": "cobblestone_streets_shops", "count": 1, "optional": false}, {"id": "visit_old_port", "text": "Выйти к старому порту, наблюдать за туристическими судами и артистами", "type": "interact", "target": "old_port_observation", "count": 1, "optional": false}, {"id": "prepare_photo_report", "text": "Подготовить фотоотчёт для культурного архива и получить скидки в локальных кафе", "type": "interact", "target": "cultural_archive_report", "count": 1, "optional": false}], "rewards": {"xp": 1500, "currency": -20, "items": [], "reputation": {"culture": 20}, "achievements": [{"id": "old_city_keeper", "name": "Хранитель Старого Города"}], "skill_boosts": {}}, "branches": []}, "content": {"sections": [{"id": "quest_profile", "title": "Параметры квеста", "body": "Тип: social, сложность: easy, формат: solo, длительность: 2-4 часа.\\nНаграды: 1,500 XP, -20 валюты, +20 к атрибуту «Культура», достижение «Хранитель Старого Города».\\n", "mechanics_links": [], "assets": []}, {"id": "stages", "title": "Этапы", "body": "1. Начать прогулку на Place Jacques-Cartier и получить карту исторических маршрутов.\\n2. Посетить базилику Нотр-Дам, оценить световое шоу и орган.\\n3. Исследовать узкие мощёные улочки и ремесленные лавки.\\n4. Выйти к старому порту, наблюдать за туристическими судами и артистами.\\n5. Подготовить фотоотчёт для культурного архива и получить скидки в локальных кафе.\\n", "mechanics_links": [], "assets": []}, {"id": "regional_context", "title": "Региональные детали", "body": "Старый Монреаль — исторический центр города с архитектурой XVII–XIX веков.\\nГотическая базилика Нотр-Дам контрастирует с современными небоскрёбами.\\nКаменные фасады и брусчатка создают ощущение Европы в Северной Америке.\\n", "mechanics_links": [], "assets": []}, {"id": "systems_hooks", "title": "Системные крючки", "body": "Квест активирует туристические бонусы, открывает гайды по хранению наследия и взаимодействие с гидами.\\nМожет запускать цепочки, связанные с фестивалями, уличными артистами и историческими экскурсиями.\\n", "mechanics_links": [], "assets": []}]}, "appendix": {"glossary": [], "references": [{"title": "Old Montreal", "link": "https://en.wikipedia.org/wiki/Old_Montreal"}], "decisions": []}, "implementation": {"github_issue": 132, "needs_task": false, "queue_reference": ["shared/trackers/queues/concept/queued.yaml"], "blockers": []}, "history": [{"version": "2.0.0", "date": "2025-11-06", "author": "narrative_team", "changes": "Прогулка по Старому Монреалю оформлена в YAML с историческими и туристическими механиками."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 1, true) ON CONFLICT (quest_id) DO UPDATE SET title = EXCLUDED.title, description = EXCLUDED.description, quest_type = EXCLUDED.quest_type, level_min = EXCLUDED.level_min, level_max = EXCLUDED.level_max, requirements = EXCLUDED.requirements, objectives = EXCLUDED.objectives, rewards = EXCLUDED.rewards, branches = EXCLUDED.branches, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 quest