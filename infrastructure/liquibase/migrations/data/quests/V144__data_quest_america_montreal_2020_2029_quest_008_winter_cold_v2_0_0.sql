-- Issue: #50
-- Import quest from: america\montreal\2020-2029\quest-008-winter-cold.yaml
-- Generated: 2025-12-14T16:03:04.874630

BEGIN;

-- Quest: canon-quest-montreal-winter-cold
INSERT INTO gameplay.quest_definitions (quest_id, title, description, quest_type, level_min, level_max, requirements, objectives, rewards, branches, content_data, version, is_active) VALUES ('canon-quest-montreal-winter-cold', 'Монреаль 2020-2029 — Зимний холод', 'Игрок выходит на улицы Монреаля при -30 °C, сталкивается с обжигающим ветром, снегом по пояс, возвращается в подземный RÉSO и
адаптирует экипировку и стратегии выживания.
', 'side', 2, NULL, '{"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}'::jsonb, '[{"id": "check_equipment_exit", "text": "Проверить экипировку и выйти на улицу при -30 °C", "type": "interact", "target": "winter_equipment_check", "count": 1, "optional": false}, {"id": "survive_wind_effect", "text": "Пережить воздействие ветра, образующего эффект -40 °C, и наблюдать мгновенное обмерзание", "type": "interact", "target": "wind_chill_experience", "count": 1, "optional": false}, {"id": "find_shelter_snowstorm", "text": "Попасть в снежную бурю с нулевой видимостью и найти укрытие", "type": "interact", "target": "snowstorm_shelter", "count": 1, "optional": false}, {"id": "descend_reso_recover", "text": "Спуститься в RÉSO и восстановить ресурсы", "type": "interact", "target": "reso_recovery", "count": 1, "optional": false}, {"id": "analyze_experience_plan", "text": "Проанализировать полученный опыт и подготовить план на будущее", "type": "interact", "target": "winter_survival_planning", "count": 1, "optional": false}]'::jsonb, '{"experience": 2500, "money": 0, "items": [], "reputation": {}, "unlocks": {"achievements": ["Выживший в канадской зиме"], "flags": []}}'::jsonb, '[]'::jsonb, '{"metadata": {"id": "canon-quest-montreal-winter-cold", "title": "Монреаль 2020-2029 — Зимний холод", "document_type": "canon", "category": "quest", "status": "draft", "version": "2.0.0", "last_updated": "2025-12-06T11:20:00+00:00", "concept_approved": true, "concept_reviewed_at": "", "owners": [{"role": "narrative_lead", "contact": "narrative@necp.game"}], "tags": ["montreal", "climate", "survival"], "topics": ["environment", "lifestyle"], "related_systems": ["narrative-service", "survival-system"], "related_documents": [{"id": "canon-lore-timeline-author-index", "relation": "references"}], "source": "shared/docs/knowledge/canon/lore/_03-lore/timeline-author/quests/america/montreal/2020-2029/quest-008-winter-cold.md", "visibility": "internal", "audience": ["narrative", "gameplay", "survival"], "risk_level": "medium"}, "review": {"chain": [{"role": "concept_director", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "Сценарий переживания монреальской зимы был в Markdown и не интегрировался в пайплайны знаний.", "goal": "Зафиксировать зимние риски и механики выживания в YAML, подчеркнув экстремальные температуры и роль RÉSO.", "essence": "Игрок выходит на улицы Монреаля при -30 °C, сталкивается с обжигающим ветром, снегом по пояс, возвращается в подземный RÉSO и\\nадаптирует экипировку и стратегии выживания.\\n", "key_points": ["Подробно описаны этапы выхода наружу, воздействие холода и использование подземных маршрутов.", "Уточнены температуры до -40 °C с ветром, замерзание дыхания и необходимость быстрой эвакуации.", "Награды усиливают выносливость, а дебафф отражает усталость при длительном воздействии холода."]}, "quest_definition": {"quest_type": "side", "level_min": 2, "level_max": null, "requirements": {"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}, "objectives": [{"id": "check_equipment_exit", "text": "Проверить экипировку и выйти на улицу при -30 °C", "type": "interact", "target": "winter_equipment_check", "count": 1, "optional": false}, {"id": "survive_wind_effect", "text": "Пережить воздействие ветра, образующего эффект -40 °C, и наблюдать мгновенное обмерзание", "type": "interact", "target": "wind_chill_experience", "count": 1, "optional": false}, {"id": "find_shelter_snowstorm", "text": "Попасть в снежную бурю с нулевой видимостью и найти укрытие", "type": "interact", "target": "snowstorm_shelter", "count": 1, "optional": false}, {"id": "descend_reso_recover", "text": "Спуститься в RÉSO и восстановить ресурсы", "type": "interact", "target": "reso_recovery", "count": 1, "optional": false}, {"id": "analyze_experience_plan", "text": "Проанализировать полученный опыт и подготовить план на будущее", "type": "interact", "target": "winter_survival_planning", "count": 1, "optional": false}], "rewards": {"experience": 2500, "money": 0, "items": [], "reputation": {}, "unlocks": {"achievements": ["Выживший в канадской зиме"], "flags": []}}, "branches": []}, "content": {"sections": [{"id": "quest_overview", "title": "Описание", "body": "Квест демонстрирует монреальскую зиму как испытание: экстремальные температуры, снежные бури и зависимость от подземной\\nинфраструктуры.\\n", "mechanics_links": [], "assets": []}, {"id": "quest_flow", "title": "Этапы выживания", "body": "1. Проверить экипировку и выйти на улицу при -30 °C.\\n2. Пережить воздействие ветра, образующего эффект -40 °C, и наблюдать мгновенное обмерзание.\\n3. Попасть в снежную бурю с нулевой видимостью и найти укрытие.\\n4. Спуститься в RÉSO и восстановить ресурсы.\\n5. Проанализировать полученный опыт и подготовить план на будущее.\\n", "mechanics_links": [], "assets": []}, {"id": "regional_details", "title": "Региональные детали", "body": "Уточнены средние температуры января, влияние ветра, объём осадков и роль подземной сети RÉSO как спасения от холода.\\n", "mechanics_links": [], "assets": []}, {"id": "rewards", "title": "Награды и эффекты", "body": "Квест выдаёт 2 500 XP, не требует затрат, добавляет +25 к выносливости и накладывает временный дебафф -30% Stamina при\\nповторном воздействии холода. Игрок получает достижение «Выживший в канадской зиме».\\n", "mechanics_links": [], "assets": []}]}, "appendix": {"glossary": [], "references": [], "decisions": []}, "implementation": {"github_issue": 1098, "needs_task": false, "queue_reference": ["shared/trackers/queues/concept/queued.yaml#canon-quest-montreal-winter-cold"], "blockers": []}, "history": [{"version": "2.0.0", "date": "2025-11-11", "author": "narrative_auto_converter", "changes": "Конвертация квеста «Зимний холод» в структуру знаний."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 1, true) ON CONFLICT (quest_id) DO UPDATE SET title = EXCLUDED.title, description = EXCLUDED.description, quest_type = EXCLUDED.quest_type, level_min = EXCLUDED.level_min, level_max = EXCLUDED.level_max, requirements = EXCLUDED.requirements, objectives = EXCLUDED.objectives, rewards = EXCLUDED.rewards, branches = EXCLUDED.branches, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 quest