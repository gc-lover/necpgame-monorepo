-- Issue: #50
-- Import quest from: america\san-francisco\2020-2029\quest-002-alcatraz-escape.yaml
-- Generated: 2025-12-06T21:12:57.955767

BEGIN;

-- Quest: canon-quest-sf-alcatraz-escape
INSERT INTO gameplay.quest_definitions (quest_id, title, description, quest_type, level_min, level_max, requirements, objectives, rewards, branches, content_data, version, is_active) VALUES ('canon-quest-sf-alcatraz-escape', 'Сан-Франциско — Побег из Алькатраса', 'Игрок инсценирует арест, проникает в корпоративный Алькатрас и повторяет легендарный побег через вентиляцию и ледяной залив.', 'main', 10, NULL, '{"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}'::jsonb, '[{"id": "get_arrest_warrant", "text": "Получить поддельный ордер на арест или добровольно сдаться, чтобы попасть в блок", "type": "choice", "target": "arrest_method", "count": 1, "optional": false}, {"id": "study_prison_routine", "text": "Изучить распорядок, лазейки в охране и распределение силовых полей", "type": "interact", "target": "prison_reconnaissance", "count": 1, "optional": false}, {"id": "organize_workshop", "text": "Организовать подпольный цех: собирать инструменты, печь головы манекенов, вербовать соузников", "type": "interact", "target": "escape_workshop", "count": 1, "optional": false}, {"id": "dig_through_vent", "text": "Прокопаться за вентиляционные решётки, отключить датчики и добраться до крыши", "type": "interact", "target": "ventilation_escape", "count": 1, "optional": false}, {"id": "escape_to_boat", "text": "Спуститься по внешним кабелям, миновать прожекторы и вплавь добраться до катера у Форт-Мэйсон", "type": "interact", "target": "final_escape", "count": 1, "optional": false}]'::jsonb, '{"xp": 15000, "currency": 200000, "items": [], "reputation": {}, "achievements": [{"id": "alcatraz_escape", "name": "Побег из Алькатраса"}], "skill_boosts": {}}'::jsonb, '[{"condition": "Успешный побег", "outcome": "Доступ к сетке побегов и линейке контрактов «Prison Break»", "next_quests": []}, {"condition": "Провал", "outcome": "Изъятие снаряжения, штрафы, усиление охраны в регионе", "next_quests": []}]'::jsonb, '{"metadata": {"id": "canon-quest-sf-alcatraz-escape", "title": "Сан-Франциско — Побег из Алькатраса", "document_type": "canon", "category": "quest", "status": "approved", "version": "2.0.0", "last_updated": "2025-11-29T16:32:00+00:00", "concept_approved": true, "concept_reviewed_at": "2025-11-11T16:32:00+00:00", "owners": [{"role": "narrative_team", "contact": "narrative@necp.game"}], "tags": ["san_francisco", "alcatraz", "prison_break"], "topics": ["heists", "survival", "prison-break"], "related_systems": ["stealth-system", "combat-system", "survival-system"], "related_documents": [{"path": "shared/docs/knowledge/canon/lore/_03-lore/timeline-author/quests/russia/saint-petersburg/2020-2029/quest-003-petropavlovskaya-fortress.yaml", "relation": "contrast"}], "source": "shared/docs/knowledge/canon/lore/timeline-author/quests/america/san-francisco/2020-2029/quest-002-alcatraz-escape.md", "visibility": "internal", "audience": ["narrative", "systems", "gameplay"], "risk_level": "critical"}, "review": {"chain": [{"role": "narrative_lead", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "Квест Алькатраса существовал только в Markdown и не описывал логику побега и риски системохоста.", "goal": "Формализовать тюремный побег, связав с системами стелса, выживания и боя.", "essence": "Игрок инсценирует арест, проникает в корпоративный Алькатрас и повторяет легендарный побег через вентиляцию и ледяной залив.", "key_points": ["Расписаны этапы подготовки, наблюдения, копания и выхода через крышу.", "Добавлены системные связи для охраны, тревог, здоровья и температурного стресса.", "Определены награды, титулы и последствия провала, включая повторный арест."]}, "quest_definition": {"quest_type": "main", "level_min": 10, "level_max": null, "requirements": {"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}, "objectives": [{"id": "get_arrest_warrant", "text": "Получить поддельный ордер на арест или добровольно сдаться, чтобы попасть в блок", "type": "choice", "target": "arrest_method", "count": 1, "optional": false}, {"id": "study_prison_routine", "text": "Изучить распорядок, лазейки в охране и распределение силовых полей", "type": "interact", "target": "prison_reconnaissance", "count": 1, "optional": false}, {"id": "organize_workshop", "text": "Организовать подпольный цех: собирать инструменты, печь головы манекенов, вербовать соузников", "type": "interact", "target": "escape_workshop", "count": 1, "optional": false}, {"id": "dig_through_vent", "text": "Прокопаться за вентиляционные решётки, отключить датчики и добраться до крыши", "type": "interact", "target": "ventilation_escape", "count": 1, "optional": false}, {"id": "escape_to_boat", "text": "Спуститься по внешним кабелям, миновать прожекторы и вплавь добраться до катера у Форт-Мэйсон", "type": "interact", "target": "final_escape", "count": 1, "optional": false}], "rewards": {"xp": 15000, "currency": 200000, "items": [], "reputation": {}, "achievements": [{"id": "alcatraz_escape", "name": "Побег из Алькатраса"}], "skill_boosts": {}}, "branches": [{"condition": "Успешный побег", "outcome": "Доступ к сетке побегов и линейке контрактов «Prison Break»", "next_quests": []}, {"condition": "Провал", "outcome": "Изъятие снаряжения, штрафы, усиление охраны в регионе", "next_quests": []}]}, "content": {"sections": [{"id": "quest_profile", "title": "Параметры квеста", "body": "Тип: main. Сложность: extreme. Формат: group 2–4. Длительность: 4+ часов.\\nНаграды: 15 000 XP, 200 000 едди, титул «Побег из Алькатраса», доступ к сетке побегов.\\n", "mechanics_links": [], "assets": []}, {"id": "stages", "title": "Этапы", "body": "1. Получить поддельный ордер на арест или добровольно сдаться, чтобы попасть в блок.\\n2. Изучить распорядок, лазейки в охране и распределение силовых полей.\\n3. Организовать подпольный цех: собирать инструменты, печь головы манекенов, вербовать соузников.\\n4. Прокопаться за вентиляционные решётки, отключить датчики и добраться до крыши.\\n5. Спуститься по внешним кабелям, миновать прожекторы и вплавь добраться до катера у Форт-Мэйсон.\\n", "mechanics_links": [], "assets": []}, {"id": "systems_hooks", "title": "Системные крючки", "body": "stealth-system обрабатывает укрытия, шумы и уровни тревоги.\\nsurvival-system отслеживает переохлаждение и усталость в ледяной воде, combat-system активируется при столкновении с охраной.\\n", "mechanics_links": [], "assets": []}, {"id": "regional_details", "title": "Региональные детали", "body": "Описаны бетонные камеры 1.5×2.7 м, холодный туман, сирены и крики чаек над заливом.\\nУказаны архивные отсылки к побегу 1962 года и корпоративная модернизация блока безопасности.\\n", "mechanics_links": [], "assets": []}, {"id": "decision_points", "title": "Решения и ветвления", "body": "Игрок выбирает между насильственным или скрытным выходом, может оставить союзника и получить бонус репутации или попытаться спасти всех.\\nВозможно вызвать отвлекающие беспорядки или применить сетевые взломы для отключения охраны.\\n", "mechanics_links": [], "assets": []}, {"id": "rewards", "title": "Награды и последствия", "body": "Успех открывает линейку контрактов «Prison Break» и доступ к сетевым союзникам.\\nПровал ведёт к изъятию снаряжения, штрафам и усилению охраны в регионе.\\n", "mechanics_links": [], "assets": []}]}, "appendix": {"glossary": [], "references": [{"title": "Alcatraz Federal Penitentiary History", "link": "https://www.nps.gov/alca"}, {"title": "San Francisco Bay Water Temperature", "link": "https://www.sfnoaa.org"}], "decisions": []}, "implementation": {"github_issue": 248, "needs_task": false, "queue_reference": ["shared/trackers/queues/concept/queued.yaml"], "blockers": []}, "history": [{"version": "2.0.0", "date": "2025-11-11", "author": "narrative_team", "changes": "Добавлены системные крючки, этапы побега и ветвления исходов."}, {"version": "0.1.0", "date": "2025-11-09", "author": "narrative_team", "changes": "Markdown-описание побега из Алькатраса."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 1, true) ON CONFLICT (quest_id) DO UPDATE SET title = EXCLUDED.title, description = EXCLUDED.description, quest_type = EXCLUDED.quest_type, level_min = EXCLUDED.level_min, level_max = EXCLUDED.level_max, requirements = EXCLUDED.requirements, objectives = EXCLUDED.objectives, rewards = EXCLUDED.rewards, branches = EXCLUDED.branches, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 quest