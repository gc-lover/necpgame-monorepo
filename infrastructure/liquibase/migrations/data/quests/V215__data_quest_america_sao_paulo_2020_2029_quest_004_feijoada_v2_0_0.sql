-- Issue: #50
-- Import quest from: america\sao-paulo\2020-2029\quest-004-feijoada.yaml
-- Generated: 2025-12-06T21:12:58.030141

BEGIN;

-- Quest: canon-quest-sao-paulo-feijoada
INSERT INTO gameplay.quest_definitions (quest_id, title, description, quest_type, level_min, level_max, requirements, objectives, rewards, branches, content_data, version, is_active) VALUES ('canon-quest-sao-paulo-feijoada', 'Сан-Паулу — Рецепт традиций', 'Игрок должен помочь семье Silva решить судьбу легендарного ресторана feijoada: продать рецепт BrasilFood (700K, традиция умирает), модернизировать (crowdfunding, delivery), или открыть рецепт публично (open source legacy).', 'side', 10, NULL, '{"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}'::jsonb, '[{"id": "try_both_feijoada", "text": "Попробовать обе feijoada (Silva vs BrasilFood) и оценить качество", "type": "interact", "target": "restaurant_silva", "count": 1, "optional": false}, {"id": "evaluate_strategies", "text": "Оценить три стратегии: качество/скорость/история", "type": "choice", "target": "strategy_evaluation", "count": 1, "optional": false}, {"id": "make_final_decision", "text": "Выбрать путь: продать рецепт/модернизировать/открыть публично", "type": "choice", "target": "final_decision", "count": 1, "optional": false}]'::jsonb, '{"experience": 2000, "money": 0, "items": [{"item_id": "achievement_legacy_creator", "quantity": 1}], "reputation": {}, "unlocks": ["culinary_quests", "business_management_system"]}'::jsonb, '[{"branch_id": "sell_recipe", "description": "Продать рецепт BrasilFood (700K, традиция умирает)", "consequences": {"money": 700000, "world_state": {"tradition_lost": true, "restaurant_closed": true}, "reputation": {"Corporations": 20, "Traditionalists": -40}, "experience": 2000}}, {"branch_id": "modernize_restaurant", "description": "Модернизировать (crowdfunding, delivery, соцсети)", "consequences": {"money": -50000, "world_state": {"restaurant_modernized": true, "tradition_preserved": true}, "reputation": {"Entrepreneurs": 30, "Traditionalists": 10}, "experience": 3000, "skill_requirement": {"business": 0.6}}}, {"branch_id": "open_source_recipe", "description": "Открыть рецепт публично (open source legacy, radical choice)", "consequences": {"world_state": {"recipe_open_source": true, "legacy_preserved": true, "tradition_shared": true}, "reputation": {"Open_Source_Community": 50, "Traditionalists": -20, "Food_Culture": 30}, "experience": 5000}}]'::jsonb, '{"metadata": {"id": "canon-quest-sao-paulo-feijoada", "title": "Сан-Паулу — Рецепт традиций", "document_type": "canon", "category": "quest", "status": "approved", "version": "2.0.0", "last_updated": "2025-11-29T00:00:00+00:00", "concept_approved": true, "concept_reviewed_at": "2025-11-11T15:49:30+00:00", "owners": [{"role": "narrative_team", "contact": "narrative@necp.game"}], "tags": ["sao_paulo", "cuisine", "tradition"], "topics": ["cultural-food", "community", "history"], "related_systems": ["cooking-system", "business-management-system", "crowdfunding-system", "dialogue-system", "reputation-system", "world-state-system", "quest-engine"], "related_documents": [{"id": "canon-quest-sao-paulo-street-art", "relation": "complements"}, {"id": "github-issue-365", "title": "GitHub Issue", "link": "https://github.com/gc-lover/necpgame-monorepo/issues/365", "relation": "migrated_to", "migrated_at": "2025-11-22T21:10:00+00:00"}], "source": "shared/docs/knowledge/canon/lore/_03-lore/timeline-author/quests/america/sao-paulo/2020-2029/quest-004-feijoada.md", "visibility": "internal", "audience": ["lore", "narrative", "quest-design"], "risk_level": "low"}, "review": {"chain": [{"role": "narrative_lead", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "Квест семейной драмы вокруг ресторана feijoada требует детализации business management mechanics, family drama dialogue trees и crowdfunding system.", "goal": "Создать полноценный контентный квест с cooking mini-game, моральными выборами о традиции vs модернизации и семейной драмой.", "essence": "Игрок должен помочь семье Silva решить судьбу легендарного ресторана feijoada: продать рецепт BrasilFood (700K, традиция умирает), модернизировать (crowdfunding, delivery), или открыть рецепт публично (open source legacy).", "key_points": [{"Семейная драма": "Дона Мария (72 года) хранит традицию, внук Лукас хочет продать, дочь Карла хочет модернизировать."}, "Cooking mini-game для оценки качества feijoada.", {"Три стратегии": "качество/скорость/история."}, "Crowdfunding system для модернизации.", "Моральный выбор между деньгами, традицией и инновациями."]}, "quest_definition": {"quest_type": "side", "level_min": 10, "level_max": null, "requirements": {"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}, "objectives": [{"id": "try_both_feijoada", "text": "Попробовать обе feijoada (Silva vs BrasilFood) и оценить качество", "type": "interact", "target": "restaurant_silva", "count": 1, "optional": false}, {"id": "evaluate_strategies", "text": "Оценить три стратегии: качество/скорость/история", "type": "choice", "target": "strategy_evaluation", "count": 1, "optional": false}, {"id": "make_final_decision", "text": "Выбрать путь: продать рецепт/модернизировать/открыть публично", "type": "choice", "target": "final_decision", "count": 1, "optional": false}], "rewards": {"experience": 2000, "money": 0, "items": [{"item_id": "achievement_legacy_creator", "quantity": 1}], "reputation": {}, "unlocks": ["culinary_quests", "business_management_system"]}, "branches": [{"branch_id": "sell_recipe", "description": "Продать рецепт BrasilFood (700K, традиция умирает)", "consequences": {"money": 700000, "world_state": {"tradition_lost": true, "restaurant_closed": true}, "reputation": {"Corporations": 20, "Traditionalists": -40}, "experience": 2000}}, {"branch_id": "modernize_restaurant", "description": "Модернизировать (crowdfunding, delivery, соцсети)", "consequences": {"money": -50000, "world_state": {"restaurant_modernized": true, "tradition_preserved": true}, "reputation": {"Entrepreneurs": 30, "Traditionalists": 10}, "experience": 3000, "skill_requirement": {"business": 0.6}}}, {"branch_id": "open_source_recipe", "description": "Открыть рецепт публично (open source legacy, radical choice)", "consequences": {"world_state": {"recipe_open_source": true, "legacy_preserved": true, "tradition_shared": true}, "reputation": {"Open_Source_Community": 50, "Traditionalists": -20, "Food_Culture": 30}, "experience": 5000}}]}, "content": {"sections": [{"id": "quest_profile", "title": "Параметры квеста", "body": "Тип: side quest (family drama, business management). Сложность: medium. Формат: solo. Длительность: 2-3 часа.\\nНаграды: 2 000-5 000 XP (зависит от выбора), ачивка «Создатель наследия» (за open source), репутация с фракциями, разблокировка culinary quests.\\n", "mechanics_links": [], "assets": []}, {"id": "stages", "title": "Этапы квеста", "body": "1. Попробовать обе feijoada (Restaurante Silva vs BrasilFood) и оценить качество через cooking mini-game.\\n2. Оценить три стратегии: качество (традиция), скорость (модернизация), история (наследие).\\n3. Встретиться с семьей Silva: Дона Мария (традиция), Лукас (продажа), Карла (модернизация).\\n4. Принять решение: продать рецепт BrasilFood (700K, традиция умирает), модернизировать (crowdfunding, delivery, соцсети), или открыть рецепт публично (open source legacy).\\n", "mechanics_links": [], "assets": []}, {"id": "systems_hooks", "title": "Системные крючки", "body": "cooking-system обрабатывает mini-game для оценки качества feijoada, business-management-system управляет решениями о модернизации, crowdfunding-system обрабатывает сбор средств, dialogue-system управляет семейными диалогами, reputation-system обновляет отношения с Traditionalists/Corporations/Entrepreneurs, world-state-system фиксирует судьбу ресторана и рецепта.\\n", "mechanics_links": [], "assets": []}, {"id": "regional_details", "title": "Региональные детали", "body": "Restaurante Silva работает с 1952 года. Лучшая feijoada в городе. Секретный рецепт трёх поколений. Дона Мария (72 года) хранит традицию. Внук Лукас хочет продать за 500K реалов и заняться стартапами. Дочь Карла хочет модернизировать. Семья разваливается. BrasilFood предлагает 700K за рецепт. Feijoada — национальное блюдо Бразилии с корнями в рабском прошлом.\\n", "mechanics_links": [], "assets": []}, {"id": "family_drama", "title": "Семейная драма", "body": "Дона Мария: \\"Рецепт передавался три поколения. Это наша душа.\\" (традиция превыше всего)\\nЛукас: \\"500K реалов — это шанс начать новую жизнь. Ресторан умирает.\\" (прагматизм)\\nКарла: \\"Мы можем модернизировать, сохранив традицию. Delivery, соцсети, crowdfunding.\\" (компромисс)\\nИгрок должен помочь семье найти решение, которое либо сохранит традицию, либо принесет деньги, либо создаст новое наследие.\\n", "mechanics_links": [], "assets": []}, {"id": "rewards", "title": "Награды и последствия", "body": "Продать рецепт: 700K эдди, 2 000 XP, репутация Corporations +20, Traditionalists -40. Традиция умирает, ресторан закрывается.\\nМодернизировать: -50K эдди (инвестиции), 3 000 XP, репутация Entrepreneurs +30, Traditionalists +10. Ресторан модернизируется, традиция сохраняется. Требует business skill 0.6.\\nOpen source: 5 000 XP, ачивка «Создатель наследия», репутация Open_Source_Community +50, Food_Culture +30. Рецепт становится публичным достоянием, наследие сохраняется навсегда.\\n", "mechanics_links": [], "assets": []}]}, "appendix": {"glossary": [], "references": [{"title": "História da Feijoada", "link": "https://vejasp.abril.com.br"}, {"title": "Saturday Feijoada Traditions", "link": "https://www.estado.com.br"}], "decisions": []}, "implementation": {"github_issue": 249, "needs_task": false, "queue_reference": ["shared/trackers/queues/concept/queued.yaml"], "blockers": []}, "history": [{"version": "2.0.0", "date": "2025-11-29", "author": "content_writer", "changes": "Добавлена полная структура quest_definition с objectives, rewards и branches. Детализирован контент согласно концепции \\"Рецепт традиций\\". Добавлены cooking mini-game, business management mechanics, family drama dialogue trees и crowdfunding system. Интеграция с системами кулинарии, бизнеса и репутации."}, {"version": "1.1.0", "date": "2025-11-11", "author": "narrative_team", "changes": "Структурированы этапы, добавлены системные крючки и культурные источники."}, {"version": "0.1.0", "date": "2025-11-09", "author": "narrative_team", "changes": "Markdown-описание традиции фейжоады."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 1, true) ON CONFLICT (quest_id) DO UPDATE SET title = EXCLUDED.title, description = EXCLUDED.description, quest_type = EXCLUDED.quest_type, level_min = EXCLUDED.level_min, level_max = EXCLUDED.level_max, requirements = EXCLUDED.requirements, objectives = EXCLUDED.objectives, rewards = EXCLUDED.rewards, branches = EXCLUDED.branches, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 quest