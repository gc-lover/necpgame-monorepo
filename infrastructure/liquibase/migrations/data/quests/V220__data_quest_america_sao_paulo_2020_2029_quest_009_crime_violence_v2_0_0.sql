-- Issue: #50
-- Import quest from: america\sao-paulo\2020-2029\quest-009-crime-violence.yaml
-- Generated: 2025-12-13T21:13:34.287506

BEGIN;

-- Quest: canon-quest-sao-paulo-crime-violence
INSERT INTO gameplay.quest_definitions (quest_id, title, description, quest_type, level_min, level_max, requirements, objectives, rewards, branches, content_data, version, is_active) VALUES ('canon-quest-sao-paulo-crime-violence', 'Сан-Паулу — Преступность и насилие', 'Игрок формирует survival guide по опасному Сан-Паулу: встреча с аналитиком безопасности, разведка в районах PCC, сбор советов, формирование протокола, тестирование в симуляции и выбор стратегии.', 'side', 25, NULL, '{"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}'::jsonb, '[{"id": "meet_security_analyst", "text": "Встретиться с аналитиком безопасности, получить карту инцидентов", "type": "interact", "target": "security_analyst_npc", "count": 1, "optional": false}, {"id": "recon_pcc_areas", "text": "Провести разведку в районах активности PCC (фавелы, перекрёстки, торговые зоны)", "type": "investigate", "target": "pcc_controlled_zones", "count": 5, "optional": false}, {"id": "gather_survival_tips", "text": "Собрать советы от журналистов, полиции, жителей", "type": "collect", "target": "survival_tips", "count": 10, "optional": false}, {"id": "build_security_protocol", "text": "Сформировать протокол безопасности для команды", "type": "interact", "target": "protocol_building", "count": 1, "optional": false}, {"id": "test_simulation", "text": "Протестировать протокол в симуляции", "type": "interact", "target": "security_simulation", "count": 1, "optional": false}, {"id": "make_final_choice", "text": "Выбрать: сотрудничать с городскими программами или полагаться на собственные меры", "type": "choice", "target": "security_strategy_choice", "count": 1, "optional": false}]'::jsonb, '{"experience": 3000, "money": 0, "items": [{"item_id": "achievement_street_survivor", "quantity": 1}], "reputation": {}, "unlocks": ["survival_skills", "security_protocols"]}'::jsonb, '[{"branch_id": "cooperate_city_programs", "description": "Сотрудничать с городскими программами безопасности", "consequences": {"world_state": {"city_cooperation": true, "security_improved": true}, "reputation": {"City_Administration": 30, "Police": 20}, "experience": 3000, "unlocks": ["city_security_programs"]}}, {"branch_id": "self_reliant", "description": "Полагаться на собственные меры безопасности", "consequences": {"world_state": {"independent_security": true, "protocol_refined": true}, "reputation": {"Independent_Operators": 25, "City_Administration": -10}, "experience": 3000, "unlocks": ["advanced_survival_skills"]}}]'::jsonb, '{"metadata": {"id": "canon-quest-sao-paulo-crime-violence", "title": "Сан-Паулу — Преступность и насилие", "document_type": "canon", "category": "quest", "status": "draft", "version": "2.0.0", "last_updated": "2025-12-06T11:05:00+00:00", "concept_approved": true, "concept_reviewed_at": "2025-11-11T15:52:00+00:00", "owners": [{"role": "narrative_team", "contact": "narrative@necp.game"}], "tags": ["sao_paulo", "crime", "pcc"], "topics": ["urban-security", "survival", "ethics"], "related_systems": ["risk-assessment-system", "security-protocol-building-system", "stealth-system", "awareness-mini-game-system", "crime-network-mapping-system", "reputation-system", "world-state-system", "quest-engine"], "related_documents": [{"id": "canon-quest-sao-paulo-mega-city", "relation": "contrasts"}, {"id": "github-issue-366", "title": "GitHub Issue", "link": "https://github.com/gc-lover/necpgame-monorepo/issues/366", "relation": "migrated_to", "migrated_at": "2025-11-22T21:30:00+00:00"}], "source": "shared/docs/knowledge/canon/lore/_03-lore/timeline-author/quests/america/sao-paulo/2020-2029/quest-009-crime-violence.md", "visibility": "internal", "audience": ["lore", "narrative", "systems-design"], "risk_level": "high"}, "review": {"chain": [{"role": "narrative_lead", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "Квест survival guide требует детализации risk assessment system, security protocol building, stealth и awareness mini-games, crime network mapping.", "goal": "Создать полноценный контентный квест с механиками выживания, протоколами безопасности и выбором между сотрудничеством с городом и самостоятельными мерами.", "essence": "Игрок формирует survival guide по опасному Сан-Паулу: встреча с аналитиком безопасности, разведка в районах PCC, сбор советов, формирование протокола, тестирование в симуляции и выбор стратегии.", "key_points": ["Risk assessment system для анализа опасных районов и инцидентов.", "Security protocol building для команды.", "Stealth и awareness mini-games для разведки.", "Crime network mapping для PCC.", {"Выбор": "сотрудничать с городскими программами или полагаться на собственные меры."}]}, "quest_definition": {"quest_type": "side", "level_min": 25, "level_max": null, "requirements": {"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}, "objectives": [{"id": "meet_security_analyst", "text": "Встретиться с аналитиком безопасности, получить карту инцидентов", "type": "interact", "target": "security_analyst_npc", "count": 1, "optional": false}, {"id": "recon_pcc_areas", "text": "Провести разведку в районах активности PCC (фавелы, перекрёстки, торговые зоны)", "type": "investigate", "target": "pcc_controlled_zones", "count": 5, "optional": false}, {"id": "gather_survival_tips", "text": "Собрать советы от журналистов, полиции, жителей", "type": "collect", "target": "survival_tips", "count": 10, "optional": false}, {"id": "build_security_protocol", "text": "Сформировать протокол безопасности для команды", "type": "interact", "target": "protocol_building", "count": 1, "optional": false}, {"id": "test_simulation", "text": "Протестировать протокол в симуляции", "type": "interact", "target": "security_simulation", "count": 1, "optional": false}, {"id": "make_final_choice", "text": "Выбрать: сотрудничать с городскими программами или полагаться на собственные меры", "type": "choice", "target": "security_strategy_choice", "count": 1, "optional": false}], "rewards": {"experience": 3000, "money": 0, "items": [{"item_id": "achievement_street_survivor", "quantity": 1}], "reputation": {}, "unlocks": ["survival_skills", "security_protocols"]}, "branches": [{"branch_id": "cooperate_city_programs", "description": "Сотрудничать с городскими программами безопасности", "consequences": {"world_state": {"city_cooperation": true, "security_improved": true}, "reputation": {"City_Administration": 30, "Police": 20}, "experience": 3000, "unlocks": ["city_security_programs"]}}, {"branch_id": "self_reliant", "description": "Полагаться на собственные меры безопасности", "consequences": {"world_state": {"independent_security": true, "protocol_refined": true}, "reputation": {"Independent_Operators": 25, "City_Administration": -10}, "experience": 3000, "unlocks": ["advanced_survival_skills"]}}]}, "content": {"sections": [{"id": "quest_profile", "title": "Параметры квеста", "body": "Тип: side quest (survival, security). Сложность: hard. Формат: solo. Длительность: 3-4 часа.\\nНаграды: 3 000 XP, навык «Выживание в мегаполисе» +25, ачивка «Уличный выживший», разблокировка survival skills и security protocols.\\n", "mechanics_links": [], "assets": []}, {"id": "stages", "title": "Этапы квеста", "body": "1. Встретиться с аналитиком безопасности, получить карту инцидентов от PCC, экспресс-похищений, грабежей.\\n2. Провести разведку в 5 районах активности PCC: фавелы, перекрёстки, торговые зоны, соблюдая протоколы безопасности.\\n3. Собрать 10 советов от журналистов, полиции, жителей: не демонстрировать гаджеты, знать опасные районы, избегать ночных маршрутов.\\n4. Сформировать протокол безопасности для команды на основе собранных данных.\\n5. Протестировать протокол в симуляции опасных ситуаций.\\n6. Выбрать стратегию: сотрудничать с городскими программами (видеонаблюдение, общинная полиция) или полагаться на собственные меры.\\n", "mechanics_links": [], "assets": []}, {"id": "systems_hooks", "title": "Системные крючки", "body": "risk-assessment-system обрабатывает анализ опасных районов и инцидентов, security-protocol-building-system управляет созданием протоколов безопасности, stealth-system обрабатывает скрытную разведку, awareness-mini-game-system управляет проверками внимательности, crime-network-mapping-system отслеживает активность PCC, reputation-system обновляет отношения с City_Administration/Police/Independent_Operators, world-state-system фиксирует стратегию безопасности.\\n", "mechanics_links": [], "assets": []}, {"id": "regional_details", "title": "Региональные детали", "body": "PCC (Primeiro Comando da Capital) контролирует часть фавел. Экспресс-похищения на светофорах, грабежи, насилие остаются рисками несмотря на улучшение статистики. Город вводит видеонаблюдение и общинную полицию, но требуется personal awareness. Не демонстрировать гаджеты, знать опасные районы, избегать ночных маршрутов. Карта инцидентов показывает hotspots преступности и активности PCC.\\n", "mechanics_links": [], "assets": []}, {"id": "survival_protocol", "title": "Протокол выживания", "body": "Сбор советов: не демонстрировать гаджеты на улице, знать опасные районы (фавелы, перекрёстки), избегать ночных маршрутов, иметь план эвакуации, знать контакты полиции и экстренных служб.\\nРазведка: stealth и awareness mini-games для безопасного прохождения опасных зон. Отслеживание активности PCC, понимание их зон контроля.\\nФормирование протокола: компиляция советов в единый документ безопасности для команды.\\n", "mechanics_links": [], "assets": []}, {"id": "strategy_choices", "title": "Стратегические выборы", "body": "Сотрудничать с городскими программами: видеонаблюдение, общинная полиция, программы улучшения безопасности. Репутация City Administration +30, Police +20. Разблокировка city_security_programs. 3 000 XP.\\nПолагаться на собственные меры: независимые протоколы, продвинутые навыки выживания, самодостаточность. Репутация Independent Operators +25, City Administration -10. Разблокировка advanced_survival_skills. 3 000 XP.\\n", "mechanics_links": [], "assets": []}, {"id": "rewards", "title": "Награды и последствия", "body": "Награды: 3 000 XP, навык «Выживание в мегаполисе» +25, ачивка «Уличный выживший», разблокировка survival skills и security protocols.\\nWorld state изменяется: city_cooperation/independent_security, security_improved, protocol_refined в зависимости от выбора.\\nРазблокировка: city_security_programs или advanced_survival_skills.\\n", "mechanics_links": [], "assets": []}]}, "appendix": {"glossary": [], "references": [{"title": "PCC Crime Report", "link": "https://www1.folha.uol.com.br"}, {"title": "São Paulo Public Security Data", "link": "https://www.ssp.sp.gov.br"}], "decisions": []}, "implementation": {"github_issue": 1069, "needs_task": false, "queue_reference": ["shared/trackers/queues/concept/queued.yaml"], "blockers": []}, "history": [{"version": "2.0.0", "date": "2025-12-06", "author": "content_writer", "changes": "Обновлен github_issue на 1069, статус изменен на draft."}, {"version": "2.0.0", "date": "2025-11-29", "author": "content_writer", "changes": "Добавлена полная структура quest_definition с objectives, rewards и branches. Детализирован контент согласно концепции \\"Выжить в мегаполисе\\". Добавлены risk assessment system, security protocol building, stealth и awareness mini-games, crime network mapping, стратегические выборы между сотрудничеством с городом и самостоятельными мерами. Интеграция с системами безопасности, выживания и world state."}, {"version": "1.1.0", "date": "2025-11-11", "author": "narrative_team", "changes": "Добавлены системные крючки, этапы, исходы и источники."}, {"version": "0.1.0", "date": "2025-11-09", "author": "narrative_team", "changes": "Markdown-описание преступности Сан-Паулу."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 1, true) ON CONFLICT (quest_id) DO UPDATE SET title = EXCLUDED.title, description = EXCLUDED.description, quest_type = EXCLUDED.quest_type, level_min = EXCLUDED.level_min, level_max = EXCLUDED.level_max, requirements = EXCLUDED.requirements, objectives = EXCLUDED.objectives, rewards = EXCLUDED.rewards, branches = EXCLUDED.branches, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 quest