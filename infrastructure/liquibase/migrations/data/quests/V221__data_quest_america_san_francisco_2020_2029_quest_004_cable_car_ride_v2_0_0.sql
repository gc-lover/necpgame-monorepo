-- Issue: #50
-- Import quest from: america\san-francisco\2020-2029\quest-004-cable-car-ride.yaml
-- Generated: 2025-12-14T16:03:05.277087

BEGIN;

-- Quest: canon-quest-sf-cable-car-ride
INSERT INTO gameplay.quest_definitions (quest_id, title, description, quest_type, level_min, level_max, requirements, objectives, rewards, branches, content_data, version, is_active) VALUES ('canon-quest-sf-cable-car-ride', 'Сан-Франциско — Поездка на канатном трамвае', 'Игрок садится на исторический cable car, путешествует по крутым улицам и завершает маршрут у Fisherman''s Wharf, собирая атмосферные баффы.', 'side', 1, NULL, '{"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}'::jsonb, '[{"id": "buy_ticket", "text": "Купить билет на Powell Street и занять внешнюю платформу трамвая", "type": "interact", "target": "cable_car_ticket_purchase", "count": 1, "optional": false}, {"id": "ride_hill", "text": "Пережить подъём по 17-градусному холму, удерживаясь за поручни", "type": "interact", "target": "cable_car_hill_ascent", "count": 1, "optional": false}, {"id": "see_lombard_street", "text": "Проехать поворот на Lombard Street, сделать снимки извилистой улицы", "type": "interact", "target": "lombard_street_view", "count": 1, "optional": false}, {"id": "enjoy_views", "text": "Насладиться видами на залив, Алькатрас и небоскрёбы", "type": "interact", "target": "bay_views", "count": 1, "optional": false}, {"id": "arrive_fishermans_wharf", "text": "Сойти у Fisherman''s Wharf и продолжить туристическую линию района", "type": "interact", "target": "fishermans_wharf_arrival", "count": 1, "optional": false}]'::jsonb, '{"xp": 500, "currency": 0, "items": [], "reputation": {}, "achievements": [{"id": "cable_car_rider", "name": "Наездник Cable Car"}], "skill_boosts": {"nostalgia": 10}}'::jsonb, '[]'::jsonb, '{"metadata": {"id": "canon-quest-sf-cable-car-ride", "title": "Сан-Франциско — Поездка на канатном трамвае", "document_type": "canon", "category": "quest", "status": "approved", "version": "2.0.0", "last_updated": "2025-11-29T16:36:00+00:00", "concept_approved": true, "concept_reviewed_at": "2025-11-11T16:36:00+00:00", "owners": [{"role": "narrative_team", "contact": "narrative@necp.game"}], "tags": ["san_francisco", "cable_car", "tourism"], "topics": ["lifestyle", "transport", "heritage"], "related_systems": ["tourism-system", "mood-system", "transport-system"], "related_documents": [], "source": "shared/docs/knowledge/canon/lore/timeline-author/quests/america/san-francisco/2020-2029/quest-004-cable-car-ride.md", "visibility": "internal", "audience": ["narrative", "vision", "content"], "risk_level": "low"}, "review": {"chain": [{"role": "narrative_lead", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "Описание поездки на канатном трамвае находилось в Markdown и не связывалось с системами настроения и туризма.", "goal": "Структурировать городской туристический опыт с учётом атмосферных баффов и транспортных механик.", "essence": "Игрок садится на исторический cable car, путешествует по крутым улицам и завершает маршрут у Fisherman''s Wharf, собирая атмосферные баффы.", "key_points": ["Расписаны этапы маршрута, включая выход к заливу и Ломбард-стрит.", "Добавлены системные крючки для mood-, tourism- и transport-system.", "Описаны награды, эстетические эффекты и влияние на туристические ветки."]}, "quest_definition": {"quest_type": "side", "level_min": 1, "level_max": null, "requirements": {"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}, "objectives": [{"id": "buy_ticket", "text": "Купить билет на Powell Street и занять внешнюю платформу трамвая", "type": "interact", "target": "cable_car_ticket_purchase", "count": 1, "optional": false}, {"id": "ride_hill", "text": "Пережить подъём по 17-градусному холму, удерживаясь за поручни", "type": "interact", "target": "cable_car_hill_ascent", "count": 1, "optional": false}, {"id": "see_lombard_street", "text": "Проехать поворот на Lombard Street, сделать снимки извилистой улицы", "type": "interact", "target": "lombard_street_view", "count": 1, "optional": false}, {"id": "enjoy_views", "text": "Насладиться видами на залив, Алькатрас и небоскрёбы", "type": "interact", "target": "bay_views", "count": 1, "optional": false}, {"id": "arrive_fishermans_wharf", "text": "Сойти у Fisherman''s Wharf и продолжить туристическую линию района", "type": "interact", "target": "fishermans_wharf_arrival", "count": 1, "optional": false}], "rewards": {"xp": 500, "currency": 0, "items": [], "reputation": {}, "achievements": [{"id": "cable_car_rider", "name": "Наездник Cable Car"}], "skill_boosts": {"nostalgia": 10}}, "branches": []}, "content": {"sections": [{"id": "quest_profile", "title": "Параметры квеста", "body": "Тип: social. Сложность: easy. Формат: solo. Длительность: 30–60 минут.\\nНаграды: 500 XP, ностальгический бафф +10, титул «Наездник Cable Car».\\n", "mechanics_links": [], "assets": []}, {"id": "stages", "title": "Этапы", "body": "1. Купить билет на Powell Street и занять внешнюю платформу трамвая.\\n2. Пережить подъём по 17-градусному холму, удерживаясь за поручни.\\n3. Проехать поворот на Lombard Street, сделать снимки извилистой улицы.\\n4. Насладиться видами на залив, Алькатрас и небоскрёбы.\\n5. Сойти у Fisherman''s Wharf и продолжить туристическую линию района.\\n", "mechanics_links": [], "assets": []}, {"id": "systems_hooks", "title": "Системные крючки", "body": "tourism-system фиксирует посещённые достопримечательности, mood-system добавляет эстетический бафф.\\ntransport-system отслеживает загрузку маршрута и динамику трамвая на крутых улицах.\\n", "mechanics_links": [], "assets": []}, {"id": "regional_details", "title": "Региональные детали", "body": "Описаны деревянные вагоны, звон колоколов «ding-ding», туристы на подножках и реклама Rice-A-Roni.\\nУчтены перепады высот, туман и остановки у знаковых перекрёстков.\\n", "mechanics_links": [], "assets": []}, {"id": "rewards", "title": "Награды и последствия", "body": "Награды усиливают туристическую ветку и открывают скидки на городские экскурсии.\\nПропуск остановок снижает качество опыта и уменьшает бафф настроения.\\n", "mechanics_links": [], "assets": []}]}, "appendix": {"glossary": [], "references": [{"title": "San Francisco Cable Car System", "link": "https://www.sfmta.com"}, {"title": "Lombard Street Travel Guide", "link": "https://www.sftravel.com"}], "decisions": []}, "implementation": {"github_issue": 248, "needs_task": false, "queue_reference": ["shared/trackers/queues/concept/queued.yaml"], "blockers": []}, "history": [{"version": "2.0.0", "date": "2025-11-11", "author": "narrative_team", "changes": "Добавлены системные крючки и атмосферные награды для канатного трамвая."}, {"version": "0.1.0", "date": "2025-11-09", "author": "narrative_team", "changes": "Markdown-описание поездки на канатном трамвае."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 1, true) ON CONFLICT (quest_id) DO UPDATE SET title = EXCLUDED.title, description = EXCLUDED.description, quest_type = EXCLUDED.quest_type, level_min = EXCLUDED.level_min, level_max = EXCLUDED.level_max, requirements = EXCLUDED.requirements, objectives = EXCLUDED.objectives, rewards = EXCLUDED.rewards, branches = EXCLUDED.branches, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 quest