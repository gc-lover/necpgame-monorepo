-- Issue: #50
-- Import quest from: america\washington-dc\2020-2029\quest-009-cherry-blossoms.yaml
-- Generated: 2025-12-21T02:15:35.501273

BEGIN;

-- Quest: quest-009-cherry-blossoms
INSERT INTO gameplay.quest_definitions (quest_id, title, description, quest_type, level_min, level_max, requirements,
                                        objectives, rewards, branches, content_data, version, is_active)
VALUES ('quest-009-cherry-blossoms', 'Вашингтон — Цветение сакуры',
        'Игрок планирует визит на Tidal Basin, наблюдает цветение 3 020 деревьев и участвует в фестивальных активностях.',
        'side', 1, NULL,
        '{"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}'::jsonb,
        '[{"id": "track_bloom_forecast", "text": "Отслеживать прогноз пика цветения и резервировать слоты посещения", "type": "interact", "target": "cherry_bloom_tracking", "count": 1, "optional": false}, {"id": "visit_tidal_basin", "text": "Посетить Tidal Basin, активировать AR-гид по истории деревьев и дару Японии", "type": "interact", "target": "tidal_basin_visit", "count": 1, "optional": false}, {"id": "participate_festival", "text": "Участвовать в фестивальной активности (парад, фотоконкурс или ярмарка)", "type": "interact", "target": "festival_activities", "count": 1, "optional": false}, {"id": "photograph_jefferson_memorial", "text": "Сделать фото Jefferson Memorial на фоне цветения и загрузить в туристический журнал", "type": "interact", "target": "jefferson_photo_blossoms", "count": 1, "optional": false}, {"id": "sync_economy_data", "text": "Синхронизировать данные с экономической системой — рост посещаемости и расходов", "type": "interact", "target": "tourism_economy_sync", "count": 1, "optional": false}]'::jsonb,
        '{"xp": 1500, "currency": 0, "items": [], "reputation": {"aesthetics": 25, "tourism": 15}, "achievements": [{"id": "witness_of_bloom", "name": "Свидетель цветения"}], "skill_boosts": {"aesthetics": 10}}'::jsonb,
        '[]'::jsonb,
        '{"metadata": {"id": "quest-009-cherry-blossoms", "title": "Вашингтон — Цветение сакуры", "document_type": "canon", "category": "lore", "status": "draft", "version": "2.0.0", "last_updated": "2025-11-29T00:00:00+00:00", "concept_approved": true, "concept_reviewed_at": "", "owners": [{"role": "concept_director", "contact": "concept@necp.game"}], "tags": ["washington-dc", "cherry-blossom", "festivals"], "topics": ["timeline_author", "regional_quests"], "related_systems": ["quest-engine", "tourism-service", "economy-service"], "related_documents": [{"id": "questline-washington-nature", "relation": "collection"}, {"id": "github-issue-379", "title": "GitHub Issue", "link": "https://github.com/gc-lover/necpgame-monorepo/issues/379", "relation": "migrated_to", "migrated_at": "2025-11-22T22:10:00+00:00"}], "source": "shared/docs/knowledge/canon/lore/_03-lore/timeline-author/quests/america/washington-dc/2020-2029/quest-009-cherry-blossoms.md", "visibility": "internal", "audience": ["concept", "narrative", "liveops"], "risk_level": "medium"}, "review": {"chain": [{"role": "concept_director", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "Квест сезонного цветения сакуры описан текстово и не учитывает события фестиваля, экономические эффекты и расписание.", "goal": "Структурировать сезонный опыт National Cherry Blossom Festival с интеграцией в туристическую и экономическую системы.", "essence": "Игрок планирует визит на Tidal Basin, наблюдает цветение 3 020 деревьев и участвует в фестивальных активностях.", "key_points": ["Сакура — подарок Японии 1912 года, цветёт ~2 недели весной.", "Фестиваль привлекает тысяч туристов и влияет на городскую экономику.", "Квест выдаёт бафф эстетики и открывает природную линию."]}, "quest_definition": {"quest_type": "side", "level_min": 1, "level_max": null, "requirements": {"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}, "objectives": [{"id": "track_bloom_forecast", "text": "Отслеживать прогноз пика цветения и резервировать слоты посещения", "type": "interact", "target": "cherry_bloom_tracking", "count": 1, "optional": false}, {"id": "visit_tidal_basin", "text": "Посетить Tidal Basin, активировать AR-гид по истории деревьев и дару Японии", "type": "interact", "target": "tidal_basin_visit", "count": 1, "optional": false}, {"id": "participate_festival", "text": "Участвовать в фестивальной активности (парад, фотоконкурс или ярмарка)", "type": "interact", "target": "festival_activities", "count": 1, "optional": false}, {"id": "photograph_jefferson_memorial", "text": "Сделать фото Jefferson Memorial на фоне цветения и загрузить в туристический журнал", "type": "interact", "target": "jefferson_photo_blossoms", "count": 1, "optional": false}, {"id": "sync_economy_data", "text": "Синхронизировать данные с экономической системой — рост посещаемости и расходов", "type": "interact", "target": "tourism_economy_sync", "count": 1, "optional": false}], "rewards": {"xp": 1500, "currency": 0, "items": [], "reputation": {"aesthetics": 25, "tourism": 15}, "achievements": [{"id": "witness_of_bloom", "name": "Свидетель цветения"}], "skill_boosts": {"aesthetics": 10}}, "branches": []}, "content": {"sections": [{"id": "introduction", "title": "Введение", "body": "Национальный фестиваль сакуры проходит на Tidal Basin в марте-апреле, создавая розовое облако вокруг Jefferson\\nMemorial. Квест управляет расписанием, прогнозами цветения и туристическими событиями.\\n", "mechanics_links": ["mechanics/quests/quest-structure.yaml", "mechanics/tourism/city-tour-flow.yaml"], "assets": []}, {"id": "seasonal_context", "title": "Сезон и история", "body": "- В 1912 году Япония подарила США 3 020 деревьев сакуры.\\n- Цветение длится около двух недель; пик прогнозируется Национальной службой парков.\\n- Festival включает парады, ярмарки, концерты и конкурсы фотографий.\\n- Локация: Tidal Basin, West Potomac Park, Jefferson Memorial.\\n", "mechanics_links": ["canon/lore/_03-lore/timeline-author/quests/america/washington-dc/index.yaml"], "assets": []}, {"id": "quest_flow", "title": "Этапы квеста", "body": "1. Отслеживать прогноз пика цветения и резервировать слоты посещения.\\n2. Посетить Tidal Basin, активировать AR-гид по истории деревьев и дару Японии.\\n3. Участвовать в фестивальной активности (парад, фотоконкурс или ярмарка).\\n4. Сделать фото Jefferson Memorial на фоне цветения и загрузить в туристический журнал.\\n5. Синхронизировать данные с экономической системой — рост посещаемости и расходов.\\n", "mechanics_links": ["mechanics/progression/quest-checkpoints.yaml", "mechanics/economy/tourism-kpi.yaml"], "assets": []}, {"id": "rewards", "title": "Награды и эффекты", "body": "- 1 500 XP, +25 эстетического влияния, репутация туристической ветки +15.\\n- Ачивка «Свидетель цветения».\\n- Разблокировка квестов природной линии и сезонных мероприятий Японии.\\n", "mechanics_links": ["mechanics/progression/rewards-catalog.yaml"], "assets": []}, {"id": "mechanics", "title": "Особенности", "body": "- Сезонное окно запуска квеста требует планирования и управления погодными условиями.\\n- Фестиваль увеличивает плотность NPC и шанс случайных событий.\\n- Экономические показатели фиксируют рост продаж и влияют на городскую экономику.\\n", "mechanics_links": ["mechanics/weather/event-impacts.yaml", "mechanics/social/random-encounters.yaml"], "assets": []}]}, "appendix": {"glossary": [], "references": [], "decisions": []}, "implementation": {"github_issue": 379, "needs_task": false, "queue_reference": [], "blockers": []}, "history": [{"version": "2.0.0", "date": "2025-11-11", "author": "concept_team", "changes": "Конверсия квеста «Цветение сакуры» в структурированный формат."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb,
        1, true) ON CONFLICT (quest_id) DO
UPDATE
    SET title = EXCLUDED.title, description = EXCLUDED.description, quest_type = EXCLUDED.quest_type, level_min = EXCLUDED.level_min, level_max = EXCLUDED.level_max, requirements = EXCLUDED.requirements, objectives = EXCLUDED.objectives, rewards = EXCLUDED.rewards, branches = EXCLUDED.branches, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 quest