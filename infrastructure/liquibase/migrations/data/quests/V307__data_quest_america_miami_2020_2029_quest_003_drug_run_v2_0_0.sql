-- Issue: #50
-- Import quest from: america\miami\2020-2029\quest-003-drug-run.yaml
-- Version: 2.0.0
-- Generated: 2025-12-07T01:14:46.092058

BEGIN;

-- Quest: canon-quest-miami-drug-run-2020-2029
INSERT INTO gameplay.quest_definitions (quest_id, title, description, quest_type, level_min, level_max, requirements, objectives, rewards, branches, content_data, version, is_active) VALUES ('canon-quest-miami-drug-run-2020-2029', 'Майами: наркоперевозка', 'Команда выполняет опасный рейс на скоростной лодке, решая судьбу груза.', 'side', 7, NULL, '{"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}'::jsonb, '[{"id": "negotiate_with_cartel", "text": "Вести переговоры с картелем о транспортировке груза", "type": "interact", "target": "cartel_contact", "count": 1, "optional": false}, {"id": "prepare_speedboat", "text": "Подготовить скоростную лодку к рейсу", "type": "interact", "target": "speedboat_preparation", "count": 1, "optional": false}, {"id": "race_to_miami", "text": "Провести груз через Багамы в Майами, избегая береговой охраны", "type": "interact", "target": "drug_run_race", "count": 1, "optional": false}, {"id": "make_moral_choice", "text": "Принять решение о судьбе груза и отношения к заказчикам", "type": "choice", "target": "moral_choice_point", "count": 1, "optional": false}]'::jsonb, '{"xp": 1500, "currency": 2000, "attributes": {"stealth": 10, "courage": 10}, "achievements": [{"id": "cocaine_cowboys", "name": "Cocaine Cowboys"}], "reputation": {"cartels": 10, "law_enforcement": -5}, "items": []}'::jsonb, '[{"condition": "Передать груз картелю", "outcome": "Получить полное вознаграждение, увеличение репутации с картелями", "next_quests": []}, {"condition": "Предать картель", "outcome": "Уменьшенное вознаграждение, враждебность картелей, повышение репутации с властями", "next_quests": []}]'::jsonb, '{"metadata": {"id": "canon-quest-miami-drug-run-2020-2029", "title": "Майами: наркоперевозка", "document_type": "canon", "category": "quests", "status": "draft", "version": "2.0.0", "last_updated": "2025-11-29T00:00:00+00:00", "concept_approved": true, "concept_reviewed_at": "", "owners": [{"role": "concept_director", "contact": "concept@necp.game"}], "tags": ["miami", "crime", "quest"], "topics": ["smuggling", "choices", "quests"], "related_systems": ["narrative-service", "gameplay-service", "quest-service", "character-service", "economy-service", "security-service", "infiltration-service"], "related_documents": [{"id": "canon-lore-regions-america-2020-2093", "relation": "complements"}], "source": "shared/docs/knowledge/canon/lore/timeline-author/quests/america/miami/2020-2029/quest-003-drug-run.md", "visibility": "restricted", "audience": ["concept", "narrative", "live-ops"], "risk_level": "high"}, "review": {"chain": [{"role": "concept_director", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "Криминальная линия Майами требовала высокорискового квеста про морской контрабандный маршрут.", "goal": "Дать игроку выбор между лояльностью картелю, сотрудничеством с DEA или личной наживой.", "essence": "Команда выполняет опасный рейс на скоростной лодке, решая судьбу груза.", "key_points": ["Отсылка к истории «Cocaine Cowboys» и культуре 1980-х.", "Адреналиновая гонка от береговой охраны в ночном океане.", "Моральный выбор формирует репутацию и последствия."]}, "quest_definition": {"quest_type": "side", "level_min": 7, "level_max": null, "requirements": {"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}, "objectives": [{"id": "negotiate_with_cartel", "text": "Вести переговоры с картелем о транспортировке груза", "type": "interact", "target": "cartel_contact", "count": 1, "optional": false}, {"id": "prepare_speedboat", "text": "Подготовить скоростную лодку к рейсу", "type": "interact", "target": "speedboat_preparation", "count": 1, "optional": false}, {"id": "race_to_miami", "text": "Провести груз через Багамы в Майами, избегая береговой охраны", "type": "interact", "target": "drug_run_race", "count": 1, "optional": false}, {"id": "make_moral_choice", "text": "Принять решение о судьбе груза и отношения к заказчикам", "type": "choice", "target": "moral_choice_point", "count": 1, "optional": false}], "rewards": {"xp": 1500, "currency": 2000, "attributes": {"stealth": 10, "courage": 10}, "achievements": [{"id": "cocaine_cowboys", "name": "Cocaine Cowboys"}], "reputation": {"cartels": 10, "law_enforcement": -5}, "items": []}, "branches": [{"condition": "Передать груз картелю", "outcome": "Получить полное вознаграждение, увеличение репутации с картелями", "next_quests": []}, {"condition": "Предать картель", "outcome": "Уменьшенное вознаграждение, враждебность картелей, повышение репутации с властями", "next_quests": []}]}, "content": {"sections": [{"id": "overview", "title": "Обзор квеста", "body": "Картель предлагает героям провести груз через Багамы в Майами. Задача включает переговоры, подготовку\\nскоростной лодки, гонку и выбор отношения к заказчикам.\\n", "mechanics_links": ["mechanics/quests/quest-system.yaml"], "assets": []}, {"id": "stages", "title": "Последовательность этапов", "body": "1. Получить контракт и инструкции от картеля.\\n2. Встретиться с контактами в Багамах и загрузить контейнеры.\\n3. Пройти океанский участок, уклоняясь от Coast Guard.\\n4. Достигнуть Майами и выбрать финальную стратегию.\\n5. Разрешить последствия выбора (награждение, розыск, защита).\\n", "mechanics_links": [], "assets": []}, {"id": "choices", "title": "Ключевые выборы", "body": "- Доставить груз картелю: высокий доход и репутация, но риск ареста.\\n- Сдать груз DEA: умеренная награда, защита от преследования.\\n- Украсть груз: максимум денег, но вечная вражда картеля.\\n", "mechanics_links": [], "assets": []}, {"id": "regional_context", "title": "Региональные детали", "body": "- Майами 1980-х известен наркотрафиком и быстрыми лодками.\\n- Coast Guard патрулирует маршруты из Карибского бассейна.\\n- Квест использует атмосферу фильмов «Scarface» и хроник «Miami Drug War».\\n", "mechanics_links": [], "assets": []}, {"id": "rewards", "title": "Награды и эффекты", "body": "- Финальные награды зависят от выбора: от 5 000 до 15 000 XP, до 1 000 000 едди.\\n- Репутация с картелями, DEA или криминальный розыск.\\n", "mechanics_links": [], "assets": []}, {"id": "mechanics", "title": "Задействованные механики", "body": "- Морские гонки и избегание преследования.\\n- Интерактивные переговоры и принятие решений.\\n- Сетевой кооператив (до четырёх игроков).\\n", "mechanics_links": ["mechanics/social/player-orders-creation.yaml"], "assets": []}, {"id": "connections", "title": "Связи и продолжения", "body": "Квест открывает цепочку криминальных историй Майами, миссии картелей и ответных операций DEA.\\n", "mechanics_links": [], "assets": []}]}, "appendix": {"glossary": [], "references": [], "decisions": []}, "implementation": {"github_issue": 1105, "needs_task": false, "queue_reference": [], "blockers": []}, "history": [{"version": "2.0.0", "date": "2025-11-12", "author": "concept_team", "changes": "Создан YAML-квест «Наркоперевозка» с выбором картель/DEA/личная выгода."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 1, true) ON CONFLICT (quest_id) DO UPDATE SET title = EXCLUDED.title, description = EXCLUDED.description, quest_type = EXCLUDED.quest_type, level_min = EXCLUDED.level_min, level_max = EXCLUDED.level_max, requirements = EXCLUDED.requirements, objectives = EXCLUDED.objectives, rewards = EXCLUDED.rewards, branches = EXCLUDED.branches, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 quest