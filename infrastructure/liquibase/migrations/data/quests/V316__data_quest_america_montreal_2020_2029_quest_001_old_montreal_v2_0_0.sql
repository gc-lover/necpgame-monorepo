-- Issue: #50
-- Import quest from: america\montreal\2020-2029\quest-001-old-montreal.yaml
-- Version: 2.0.0
-- Generated: 2025-12-07T01:14:46.177732

BEGIN;

-- Quest: quest-montreal-2029-old-montreal
INSERT INTO gameplay.quest_definitions (quest_id, title, description, quest_type, level_min, level_max, requirements, objectives, rewards, branches, content_data, version, is_active) VALUES ('quest-montreal-2029-old-montreal', 'Монреаль 2020-2029 — Прогулка по Vieux-Montréal', 'Игрок исследует площадь Жака Картье, базилику Нотр-Дам и порт, сравнивая атмосферу с европейскими городами.', 'side', 3, NULL, '{"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}'::jsonb, '[{"id": "start_place_jacques_cartier", "text": "Начать на Place Jacques-Cartier и изучить уличные представления", "type": "interact", "target": "place_jacques_cartier", "count": 1, "optional": false}, {"id": "visit_notre_dame_basilica", "text": "Посетить базилику Нотр-Дам, оценить световое оформление и орган", "type": "interact", "target": "notre_dame_basilica", "count": 1, "optional": false}, {"id": "walk_cobblestone_streets", "text": "Пройти по мощёным улочкам к старому порту", "type": "explore", "target": "cobblestone_streets", "count": 1, "optional": false}, {"id": "explore_waterfront", "text": "Исследовать набережную и исторические склады", "type": "explore", "target": "old_port_waterfront", "count": 2, "optional": false}, {"id": "complete_atmosphere_reflection", "text": "Зафиксировать атмосферу европейского квартала в американском мегаполисе", "type": "interact", "target": "european_quarter_atmosphere", "count": 1, "optional": false}]'::jsonb, '{"experience": 1500, "money": -20, "items": [{"item_id": "achievement_old_city_keeper", "quantity": 1}], "reputation": {}, "unlocks": ["historical_quests", "tourism_access"]}'::jsonb, '[{"branch_id": "heritage_enthusiast", "description": "Стать энтузиастом исторического наследия", "consequences": {"skills": {"culture": 25, "history": 15}, "reputation": {"Tourism_Industry": 20}, "unlocks": ["exclusive_heritage_access"]}}]'::jsonb, '{"metadata": {"id": "quest-montreal-2029-old-montreal", "title": "Монреаль 2020-2029 — Прогулка по Vieux-Montréal", "document_type": "canon", "category": "timeline-quest", "status": "draft", "version": "2.0.0", "last_updated": "2025-11-29T00:00:00+00:00", "concept_approved": true, "concept_reviewed_at": "", "owners": [{"role": "concept_director", "contact": "concept@necp.game"}], "tags": ["montreal", "heritage", "tourism"], "topics": ["cultural_history", "architecture"], "related_systems": ["narrative-service"], "related_documents": [{"id": "timeline-author-quests-index", "relation": "references"}], "source": "shared/docs/knowledge/canon/lore/timeline-author/quests/america/montreal/2020-2029/quest-001-old-montreal.md", "visibility": "internal", "audience": ["concept", "narrative"], "risk_level": "low"}, "review": {"chain": [{"role": "concept_director", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "Историческая линия Монреаля не включала структурированный маршрут по Vieux-Montréal.", "goal": "Представить ключевые достопримечательности Старого Монреаля и их ценность для городской идентичности.", "essence": "Игрок исследует площадь Жака Картье, базилику Нотр-Дам и порт, сравнивая атмосферу с европейскими городами.", "key_points": ["Район основан в 1642 году и сохранил европейскую архитектуру.", "Базилика Нотр-Дам с органом на 7 000 труб — центральный объект маршрута.", "Мощёные улицы и старый порт усиливают туристическую привлекательность."]}, "quest_definition": {"quest_type": "side", "level_min": 3, "level_max": null, "requirements": {"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}, "objectives": [{"id": "start_place_jacques_cartier", "text": "Начать на Place Jacques-Cartier и изучить уличные представления", "type": "interact", "target": "place_jacques_cartier", "count": 1, "optional": false}, {"id": "visit_notre_dame_basilica", "text": "Посетить базилику Нотр-Дам, оценить световое оформление и орган", "type": "interact", "target": "notre_dame_basilica", "count": 1, "optional": false}, {"id": "walk_cobblestone_streets", "text": "Пройти по мощёным улочкам к старому порту", "type": "explore", "target": "cobblestone_streets", "count": 1, "optional": false}, {"id": "explore_waterfront", "text": "Исследовать набережную и исторические склады", "type": "explore", "target": "old_port_waterfront", "count": 2, "optional": false}, {"id": "complete_atmosphere_reflection", "text": "Зафиксировать атмосферу европейского квартала в американском мегаполисе", "type": "interact", "target": "european_quarter_atmosphere", "count": 1, "optional": false}], "rewards": {"experience": 1500, "money": -20, "items": [{"item_id": "achievement_old_city_keeper", "quantity": 1}], "reputation": {}, "unlocks": ["historical_quests", "tourism_access"]}, "branches": [{"branch_id": "heritage_enthusiast", "description": "Стать энтузиастом исторического наследия", "consequences": {"skills": {"culture": 25, "history": 15}, "reputation": {"Tourism_Industry": 20}, "unlocks": ["exclusive_heritage_access"]}}]}, "content": {"sections": [{"id": "overview", "title": "Описание", "body": "Квест знакомит игрока со Старым Монреалем. Маршрут подчёркивает сочетание французского наследия и североамериканской\\nдинамики, позволяя собрать культурные впечатления и подготовить фон для последующих миссий в городе.\\n", "mechanics_links": [], "assets": []}, {"id": "stages", "title": "Этапы", "body": "1. Начать на Place Jacques-Cartier и изучить уличные представления.\\n2. Посетить базилику Нотр-Дам, оценить световое оформление и орган.\\n3. Пройти по мощёным улочкам к старому порту.\\n4. Исследовать набережную и исторические склады.\\n5. Зафиксировать атмосферу европейского квартала в американском мегаполисе.\\n", "mechanics_links": [], "assets": []}, {"id": "regional_details", "title": "Региональные детали", "body": "Vieux-Montréal сохраняет архитектуру XVII–XIX веков. Базилика Нотр-Дам известна голубым сводом со звёздами, а площадь\\nЖака Картье служит местом общественных событий. Исторический порт связывает район с торговым прошлым города.\\n", "mechanics_links": [], "assets": []}, {"id": "rewards", "title": "Награды", "body": "- Опыт: 1 500 XP\\n- Расходы: 20 единиц валюты\\n- Атрибут «Культура»: +20\\n- Ачивка: «Хранитель Старого города»\\n", "mechanics_links": [], "assets": []}, {"id": "mechanics", "title": "Механики", "body": "Квест использует туристические и исторические механики, открывает доступ к экскурсионным NPC и повышает культурную\\nрепутацию.\\n", "mechanics_links": [], "assets": []}, {"id": "connections", "title": "Связи", "body": "Связан с исторической линией Монреаля и сюжетами о франкоязычной идентичности, а также подготавливает к заданиям\\nо развитии порта.\\n", "mechanics_links": [], "assets": []}]}, "appendix": {"glossary": [], "references": [], "decisions": []}, "implementation": {"github_issue": 1101, "needs_task": false, "queue_reference": [], "blockers": []}, "history": [{"version": "2.0.0", "date": "2025-11-29", "author": "content_writer", "changes": "Добавлена полная структура quest_definition с objectives, rewards и branches. Детализирован контент согласно концепции. Добавлены механики исторического квеста, туризма и европейского наследия."}, {"version": "1.0.0", "date": "2025-11-12", "author": "concept_team", "changes": "Конвертирован квест «Старый Монреаль» в формат знаний."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 1, true) ON CONFLICT (quest_id) DO UPDATE SET title = EXCLUDED.title, description = EXCLUDED.description, quest_type = EXCLUDED.quest_type, level_min = EXCLUDED.level_min, level_max = EXCLUDED.level_max, requirements = EXCLUDED.requirements, objectives = EXCLUDED.objectives, rewards = EXCLUDED.rewards, branches = EXCLUDED.branches, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 quest