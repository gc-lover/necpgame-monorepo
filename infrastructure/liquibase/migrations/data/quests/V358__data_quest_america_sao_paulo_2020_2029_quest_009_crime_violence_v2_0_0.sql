-- Issue: #50
-- Import quest from: america\sao-paulo\2020-2029\quest-009-crime-violence.yaml
-- Version: 2.0.0
-- Generated: 2025-12-07T01:14:46.525237

BEGIN;

-- Quest: quest-sao-paulo-2029-crime-and-violence
INSERT INTO gameplay.quest_definitions (quest_id, title, description, quest_type, level_min, level_max, requirements, objectives, rewards, branches, content_data, version, is_active) VALUES ('quest-sao-paulo-2029-crime-and-violence', 'Сан-Паулу 2020-2029 — Преступность и безопасность', 'Игрок анализирует влияние PCC, собирает советы от местных жителей и определяет, как безопасно перемещаться по городу.', 'main', 5, NULL, '{"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}'::jsonb, '[{"id": "meet_security_analyst", "text": "Встретиться с аналитиком безопасности и получить карту инцидентов", "type": "interact", "target": "security_analyst", "count": 1, "optional": false}, {"id": "scout_pcc_areas", "text": "Провести разведку в районах, где активна PCC (фавелы, светофоры, торговые зоны)", "type": "investigate", "target": "pcc_active_areas", "count": 3, "optional": false}, {"id": "collect_safety_tips", "text": "Собрать советы по безопасности: не демонстрировать гаджеты, избегать рискованных маршрутов", "type": "research", "target": "safety_protocols", "count": 1, "optional": false}, {"id": "create_protocol", "text": "Сформировать протокол поведения для команды и протестировать его в симуляции", "type": "craft", "target": "team_safety_protocol", "count": 1, "optional": false}, {"id": "make_decision", "text": "Принять решение: сотрудничать с городскими программами или полагаться на собственные меры", "type": "interact", "target": "security_choice", "count": 1, "optional": false}]'::jsonb, '{"experience": 3000, "currency": 0, "items": [], "reputation": {"sao_paulo_survival": 25}, "flags": ["street_survivor_title"]}'::jsonb, '[{"id": "cooperate_with_city", "condition": "player_choice == ''cooperate_with_city''", "rewards": {"reputation": {"sao_paulo_authorities": 10}, "flags": ["city_program_participant"]}, "next_quest": null}, {"id": "rely_on_own_measures", "condition": "player_choice == ''rely_on_own_measures''", "rewards": {"reputation": {"sao_paulo_independents": 10}, "flags": ["independent_security_expert"]}, "next_quest": null}]'::jsonb, '{"metadata": {"id": "quest-sao-paulo-2029-crime-and-violence", "title": "Сан-Паулу 2020-2029 — Преступность и безопасность", "document_type": "canon", "category": "timeline-author", "status": "draft", "version": "2.0.0", "last_updated": "2025-11-29T17:12:21+00:00", "concept_approved": false, "concept_reviewed_at": "", "owners": [{"role": "concept_director", "contact": "concept@necp.game"}], "tags": ["sao-paulo", "crime", "survival"], "topics": ["security", "urban-life"], "related_systems": ["narrative-service", "gameplay-service", "quest-service", "character-service", "economy-service", "security-service", "survival-service"], "related_documents": [{"id": "quest-sao-paulo-2029-favelas", "relation": "parallels"}, {"id": "github-issue-1069", "title": "GitHub Issue", "link": "https://github.com/gc-lover/necpgame-monorepo/issues/1069", "relation": "migrated_to", "migrated_at": "2025-11-23T02:35:00+00:00"}], "source": "shared/docs/knowledge/canon/lore/timeline-author/quests/america/sao-paulo/2020-2029/quest-009-crime-violence.md", "visibility": "internal", "audience": ["concept", "narrative"], "risk_level": "high"}, "review": {"chain": [{"role": "concept_director", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "Криминальный профиль Сан-Паулу требовал квеста, который показывает угрозы PCC и даёт игроку инструменты самозащиты.", "goal": "Исследовать опасные районы, понять динамику преступности и сформировать протоколы поведения.", "essence": "Игрок анализирует влияние PCC, собирает советы от местных жителей и определяет, как безопасно перемещаться по городу.", "key_points": ["PCC контролирует часть фавел, грабежи и экспресс-похищения остаются риском.", "Город улучшает показатели безопасности, но требует осознанного поведения.", "Квест повышает навыки выживания и открывает сеть контактов для последующих миссий."]}, "quest_definition": {"quest_type": "main", "level_min": 5, "level_max": null, "requirements": {"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}, "objectives": [{"id": "meet_security_analyst", "text": "Встретиться с аналитиком безопасности и получить карту инцидентов", "type": "interact", "target": "security_analyst", "count": 1, "optional": false}, {"id": "scout_pcc_areas", "text": "Провести разведку в районах, где активна PCC (фавелы, светофоры, торговые зоны)", "type": "investigate", "target": "pcc_active_areas", "count": 3, "optional": false}, {"id": "collect_safety_tips", "text": "Собрать советы по безопасности: не демонстрировать гаджеты, избегать рискованных маршрутов", "type": "research", "target": "safety_protocols", "count": 1, "optional": false}, {"id": "create_protocol", "text": "Сформировать протокол поведения для команды и протестировать его в симуляции", "type": "craft", "target": "team_safety_protocol", "count": 1, "optional": false}, {"id": "make_decision", "text": "Принять решение: сотрудничать с городскими программами или полагаться на собственные меры", "type": "interact", "target": "security_choice", "count": 1, "optional": false}], "rewards": {"experience": 3000, "currency": 0, "items": [], "reputation": {"sao_paulo_survival": 25}, "flags": ["street_survivor_title"]}, "branches": [{"id": "cooperate_with_city", "condition": "player_choice == ''cooperate_with_city''", "rewards": {"reputation": {"sao_paulo_authorities": 10}, "flags": ["city_program_participant"]}, "next_quest": null}, {"id": "rely_on_own_measures", "condition": "player_choice == ''rely_on_own_measures''", "rewards": {"reputation": {"sao_paulo_independents": 10}, "flags": ["independent_security_expert"]}, "next_quest": null}]}, "content": {"sections": [{"id": "overview", "title": "Описание", "body": "Игрок прибывает в Сан-Паулу и оценивает уровень преступности: интервью с журналистами, полицией и жителями дают\\nкартину реальных угроз. Нужно разработать собственный план действий, чтобы безопасно продолжать операции в мегаполисе.\\n", "mechanics_links": [], "assets": []}, {"id": "stages", "title": "Этапы", "body": "1. Встретиться с аналитиком безопасности и получить карту инцидентов.\\n2. Провести разведку в районах, где активна PCC (фавелы, светофоры, торговые зоны).\\n3. Собрать советы по безопасности: не демонстрировать гаджеты, избегать рискованных маршрутов.\\n4. Сформировать протокол поведения для команды и протестировать его в симуляции.\\n5. Принять решение: сотрудничать с городскими программами или полагаться на собственные меры.\\n", "mechanics_links": [], "assets": []}, {"id": "regional_details", "title": "Региональные детали", "body": "PCC остаётся крупнейшей криминальной сетью города; экспресс-похищения и грабежи на перекрёстках — типичные угрозы.\\nВ то же время статистика улучшается, появляются новые программы видеонаблюдения и общинной полиции.\\n", "mechanics_links": [], "assets": []}, {"id": "rewards", "title": "Награды", "body": "- Опыт: 3 000 XP.\\n- Навык «Выживание в мегаполисе» +25.\\n- Ачивка «Уличный выживший».\\n", "mechanics_links": [], "assets": []}, {"id": "mechanics", "title": "Механики", "body": "Социальный анализ, оценка рисков, внедрение протоколов безопасности.\\n", "mechanics_links": [], "assets": []}, {"id": "connections", "title": "Связи", "body": "Квест интегрируется с криминальной линией Сан-Паулу и открывает миссии по реформе городских программ.\\n", "mechanics_links": [], "assets": []}]}, "appendix": {"glossary": [], "references": [], "decisions": []}, "implementation": {"github_issue": 1069, "needs_task": false, "queue_reference": [], "blockers": []}, "history": [{"version": "2.0.0", "date": "2025-11-29", "author": "content_writer", "changes": "Добавлена полная структура quest_definition с objectives, rewards и branches. Детализирован контент согласно концепции. Добавлены механики анализа безопасности, разведки районов, сбора советов и создания протоколов."}, {"version": "1.0.0", "date": "2025-11-12", "author": "concept_team", "changes": "Конвертирован квест «Преступность и безопасность» в формат знаний Concept Director."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 1, true) ON CONFLICT (quest_id) DO UPDATE SET title = EXCLUDED.title, description = EXCLUDED.description, quest_type = EXCLUDED.quest_type, level_min = EXCLUDED.level_min, level_max = EXCLUDED.level_max, requirements = EXCLUDED.requirements, objectives = EXCLUDED.objectives, rewards = EXCLUDED.rewards, branches = EXCLUDED.branches, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 quest