-- Issue: #50
-- Import quest from: america\vancouver\2020-2029\quest-007-cannabis-culture.yaml
-- Version: 2.0.0
-- Generated: 2025-12-07T01:14:46.728344

BEGIN;

-- Quest: quest-vancouver-2029-cannabis-culture
INSERT INTO gameplay.quest_definitions (quest_id, title, description, quest_type, level_min, level_max, requirements, objectives, rewards, branches, content_data, version, is_active) VALUES ('quest-vancouver-2029-cannabis-culture', 'Ванкувер 2020-2029 — Культура каннабиса', 'Игрок встречает легендарного гровера, исследует конфликт между CannaCorp и Green Underground, организует подпольный фестиваль и делает выбор между культурной свободой и корпоративным компромиссом.', 'main', 8, NULL, '{"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}'::jsonb, '[{"id": "meet_ray_green_guru", "text": "Встретиться с Рэем ''Зеленый Гуру'' Джонсоном и узнать о ситуации с CannaCorp", "type": "interact", "target": "ray_green_guru_meeting", "count": 1, "optional": false}, {"id": "explore_cannacorp_tower", "text": "Исследовать CannaCorp Tower и понять масштаб корпоративного контроля", "type": "interact", "target": "cannacorp_tower", "count": 1, "optional": false}, {"id": "visit_secret_grow_op", "text": "Посетить Secret Grow Op и познакомиться с Green Underground", "type": "interact", "target": "secret_grow_op", "count": 1, "optional": false}, {"id": "organize_420_festival", "text": "Организовать подпольный 420 Festival с координацией сообщества", "type": "interact", "target": "festival_organization", "count": 1, "optional": false}, {"id": "protect_festival", "text": "Защитить фестиваль от корпоративных агентов и полиции", "type": "stealth", "target": "festival_protection", "count": 1, "optional": false}, {"id": "attend_420_festival", "text": "Присутствовать на финальной сцене 420 Festival и сделать выбор", "type": "choice", "target": "festival_final_choice", "count": 1, "optional": false}]'::jsonb, '{"experience": 4000, "money": -50, "items": [{"item_id": "achievement_green_revolution", "quantity": 1}], "reputation": {"Vancouver_Cannabis_Community": 25, "Green_Underground": 20}, "unlocks": ["cannabis_culture_quests", "underground_events_access"]}'::jsonb, '[{"branch_id": "cultural_victory_path", "description": "Культурная победа - фестиваль проходит, движение растет", "consequences": {"skills": {"charisma": 30, "social": 25}, "reputation": {"Green_Underground": 30, "Vancouver_Cannabis_Community": 30}, "unlocks": ["legal_cannabis_cooperative"]}}, {"branch_id": "compromise_path", "description": "Компромисс - CannaCorp создает артизанскую линейку", "consequences": {"skills": {"diplomacy": 25, "negotiation": 20}, "reputation": {"CannaCorp": 15, "Green_Underground": 15}, "unlocks": ["artisan_cannabis_line"]}}]'::jsonb, '{"metadata": {"id": "quest-vancouver-2029-cannabis-culture", "title": "Ванкувер 2020-2029 — Культура каннабиса", "document_type": "canon", "category": "timeline-quest", "status": "content-ready", "version": "2.0.0", "last_updated": "2025-11-29T00:00:00+00:00", "concept_approved": true, "concept_reviewed_at": "", "owners": [{"role": "concept_director", "contact": "concept@necp.game"}], "tags": ["vancouver", "cannabis", "legislation"], "topics": ["social_policy", "lifestyle"], "related_systems": ["narrative-service", "economy-service"], "related_documents": [{"id": "github-issue-1047", "title": "GitHub Issue", "link": "https://github.com/gc-lover/necpgame-monorepo/issues/1047", "relation": "migrated_to", "migrated_at": "2025-11-23T12:00:00+00:00"}], "source": "shared/docs/knowledge/canon/lore/timeline-author/quests/america/vancouver/2020-2029/quest-007-cannabis-culture.md", "visibility": "internal", "audience": ["concept", "narrative"], "risk_level": "medium"}, "review": {"chain": [{"role": "concept_director", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "К 2027 году корпорация CannaCorp монополизировала индустрию каннабиса, превратив контркультуру в корпоративный продукт. Подпольная культура гроверов борется за сохранение традиции против корпоративной синтетики.", "goal": "Помочь Рэю \\"Зеленый Гуру\\" Джонсону организовать последний настоящий 420 Festival и противостоять корпоративному контролю CannaCorp.", "essence": "Игрок встречает легендарного гровера, исследует конфликт между CannaCorp и Green Underground, организует подпольный фестиваль и делает выбор между культурной свободой и корпоративным компромиссом.", "key_points": ["CannaCorp контролирует 90% рынка, создавая синтетический THC в лабораториях.", "Green Underground - движение за возврат к натуральному каннабису и культуре.", {"Философский вопрос": "можно ли монетизировать контркультуру, не убив ее сущность?"}, "Финальная сцена - подпольный 420 Festival с выбором между культурной победой и компромиссом."]}, "quest_definition": {"quest_type": "main", "level_min": 8, "level_max": null, "requirements": {"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}, "objectives": [{"id": "meet_ray_green_guru", "text": "Встретиться с Рэем ''Зеленый Гуру'' Джонсоном и узнать о ситуации с CannaCorp", "type": "interact", "target": "ray_green_guru_meeting", "count": 1, "optional": false}, {"id": "explore_cannacorp_tower", "text": "Исследовать CannaCorp Tower и понять масштаб корпоративного контроля", "type": "interact", "target": "cannacorp_tower", "count": 1, "optional": false}, {"id": "visit_secret_grow_op", "text": "Посетить Secret Grow Op и познакомиться с Green Underground", "type": "interact", "target": "secret_grow_op", "count": 1, "optional": false}, {"id": "organize_420_festival", "text": "Организовать подпольный 420 Festival с координацией сообщества", "type": "interact", "target": "festival_organization", "count": 1, "optional": false}, {"id": "protect_festival", "text": "Защитить фестиваль от корпоративных агентов и полиции", "type": "stealth", "target": "festival_protection", "count": 1, "optional": false}, {"id": "attend_420_festival", "text": "Присутствовать на финальной сцене 420 Festival и сделать выбор", "type": "choice", "target": "festival_final_choice", "count": 1, "optional": false}], "rewards": {"experience": 4000, "money": -50, "items": [{"item_id": "achievement_green_revolution", "quantity": 1}], "reputation": {"Vancouver_Cannabis_Community": 25, "Green_Underground": 20}, "unlocks": ["cannabis_culture_quests", "underground_events_access"]}, "branches": [{"branch_id": "cultural_victory_path", "description": "Культурная победа - фестиваль проходит, движение растет", "consequences": {"skills": {"charisma": 30, "social": 25}, "reputation": {"Green_Underground": 30, "Vancouver_Cannabis_Community": 30}, "unlocks": ["legal_cannabis_cooperative"]}}, {"branch_id": "compromise_path", "description": "Компромисс - CannaCorp создает артизанскую линейку", "consequences": {"skills": {"diplomacy": 25, "negotiation": 20}, "reputation": {"CannaCorp": 15, "Green_Underground": 15}, "unlocks": ["artisan_cannabis_line"]}}]}, "content": {"sections": [{"id": "overview", "title": "Описание", "body": "Квест \\"Зеленая революция 2.0\\" исследует конфликт между корпоративной монополией CannaCorp и подпольной культурой\\nнатуральных гроверов. Игрок помогает Рэю \\"Зеленый Гуру\\" Джонсону организовать последний настоящий 420 Festival,\\nпротивостоя корпоративному контролю и защищая культурную традицию каннабиса.\\n", "mechanics_links": [], "assets": []}, {"id": "stages", "title": "Этапы", "body": "1. Встретиться с Рэем \\"Зеленый Гуру\\" Джонсоном и узнать о ситуации с CannaCorp.\\n2. Исследовать CannaCorp Tower и понять масштаб корпоративного контроля.\\n3. Посетить Secret Grow Op и познакомиться с Green Underground.\\n4. Организовать подпольный 420 Festival с координацией сообщества.\\n5. Защитить фестиваль от корпоративных агентов и полиции.\\n6. Присутствовать на финальной сцене 420 Festival и сделать выбор между культурной победой и компромиссом.\\n", "mechanics_links": [], "assets": []}, {"id": "regional_details", "title": "Региональные детали", "body": "Ванкувер исторически поддерживал либеральную политику в отношении каннабиса. После легализации город стал примером\\nрегулируемого рынка с разнообразием продуктов и туристических программ.\\n", "mechanics_links": [], "assets": []}, {"id": "rewards", "title": "Награды", "body": "- Опыт: 4 000 XP\\n- Расходы: 50 единиц валюты (на организацию фестиваля)\\n- Репутация: Vancouver_Cannabis_Community +25, Green_Underground +20\\n- Ачивка: «Green Revolution»\\n- Разблокировка: cannabis_culture_quests, underground_events_access\\n", "mechanics_links": [], "assets": []}, {"id": "mechanics", "title": "Механики", "body": "Квест использует социальные и моральные механики, влияя на доступ к событиям контркультуры и поддерживая экономику\\nканнабис-индустрии.\\n", "mechanics_links": [], "assets": []}, {"id": "connections", "title": "Связи", "body": "Связан с социальной линией Ванкувера, сюжетами о политике регулирования и миссиями кооперации с предпринимателями.\\n", "mechanics_links": [], "assets": []}]}, "appendix": {"glossary": [], "references": [], "decisions": []}, "implementation": {"github_issue": 1047, "needs_task": false, "queue_reference": [], "blockers": []}, "history": [{"version": "0.1.0", "date": "2025-11-13", "author": "concept_team", "changes": "Конвертирован квест «Культура каннабиса» в формат знаний."}, {"version": "2.0.0", "date": "2025-11-29", "author": "content_writer", "changes": "Добавлена полная структура quest_definition с objectives, rewards и branches на основе концепции \\"Зеленая революция 2.0\\". Обновлена версия до 2.0.0, статус изменен на content-ready."}, {"version": "1.0.0", "date": "2025-11-23", "author": "content_writer", "changes": "Добавлен детальный контент на основе концепции: этапы с локациями и целями (встреча с Рэем, исследование CannaCorp Tower, посещение Secret Grow Op, организация 420 Festival, защита фестиваля, финальная сцена), диалоги с NPC (Рэй \\"Зеленый Гуру\\" Джонсон, Майя Грин, Боб Марли-2, Доктор Линда Сатива, Офицер Чад Хайнс), проверки навыков, ветвления и выборы, детальные награды с ачивкой Green Revolution и репутацией."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 1, true) ON CONFLICT (quest_id) DO UPDATE SET title = EXCLUDED.title, description = EXCLUDED.description, quest_type = EXCLUDED.quest_type, level_min = EXCLUDED.level_min, level_max = EXCLUDED.level_max, requirements = EXCLUDED.requirements, objectives = EXCLUDED.objectives, rewards = EXCLUDED.rewards, branches = EXCLUDED.branches, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 quest