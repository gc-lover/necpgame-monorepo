-- Issue: #50
-- Import quest from: cis\moscow\2078-2093\quest-046-simulation-escape.yaml
-- Version: 1.0.0
-- Generated: 2025-12-07T01:14:47.645805

BEGIN;

-- Quest: quest-moscow-2093-simulation-escape
INSERT INTO gameplay.quest_definitions (quest_id, title, description, quest_type, level_min, level_max, requirements, objectives, rewards, branches, content_data, version, is_active) VALUES ('quest-moscow-2093-simulation-escape', 'Москва 2078-2093 — Побег из симуляции', 'Игрок собирает устройство прорыва, активирует его и выбирает одну из трёх развёрнутых концовок — успех, ловушка или отказ.', 'main', 40, NULL, '{"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}'::jsonb, '[{"id": "develop_escape_plan", "text": "Разработать план побега", "type": "interact", "target": "netrunner_data", "count": 1, "optional": false}, {"id": "collect_components", "text": "Собрать компоненты для Прорывателя симуляции", "type": "collect", "target": "simulation_breaker_component", "count": 5, "optional": false}, {"id": "construct_device", "text": "Сконструировать устройство", "type": "interact", "target": "device_construction_station", "count": 1, "optional": false}, {"id": "prepare_activation_site", "text": "Подготовить место активации", "type": "interact", "target": "activation_site", "count": 1, "optional": false}, {"id": "activate_device", "text": "Активировать механизм", "type": "interact", "target": "simulation_breaker_device", "count": 1, "optional": false}, {"id": "survive_anomalies", "text": "Пережить волну аномалий", "type": "interact", "target": "anomaly_wave", "count": 1, "optional": false}, {"id": "make_final_choice", "text": "Принять финальное решение", "type": "interact", "target": "final_choice_point", "count": 1, "optional": false}]'::jsonb, '{"experience": 20000, "money": 0, "items": [], "reputation": {}, "unlocks": ["next_league_starting_bonuses"]}'::jsonb, '[{"branch_id": "success_ending", "description": "Успешный побег", "consequences": {"items": [{"item_id": "title_escapee", "quantity": 1}], "unlocks": ["return_option"]}}, {"branch_id": "trap_ending", "description": "Попасть в ловушку", "consequences": {"unlocks": ["recursive_simulation_cycle"]}}, {"branch_id": "refusal_ending", "description": "Остаться в симуляции", "consequences": {"items": [{"item_id": "title_remaining", "quantity": 1}], "unlocks": ["enhanced_simulation_influence"]}}]'::jsonb, '{"metadata": {"id": "quest-moscow-2093-simulation-escape", "title": "Москва 2078-2093 — Побег из симуляции", "document_type": "canon", "category": "timeline-quest", "status": "draft", "version": "1.0.0", "last_updated": "2025-11-13T00:00:00+00:00", "concept_approved": false, "concept_reviewed_at": "", "owners": [{"role": "concept_director", "contact": "concept@necp.game"}], "tags": ["moscow", "finale", "simulation"], "topics": ["reality-questioning", "meta-narrative"], "related_systems": ["narrative-service", "anomaly-service", "legacy-service"], "related_documents": [], "source": "shared/docs/knowledge/canon/lore/timeline-author/quests/cis/moscow/2078-2093/quest-046-simulation-escape.md", "visibility": "internal", "audience": ["concept", "narrative"], "risk_level": "extreme"}, "review": {"chain": [{"role": "concept_director", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "Московская линия требовала финального мета-квеста, позволяющего игроку попытаться покинуть симуляцию.", "goal": "Дать игроку инструменты для побега и показать множественные исходы, влияющие на лор и будущие лиги.", "essence": "Игрок собирает устройство прорыва, активирует его и выбирает одну из трёх развёрнутых концовок — успех, ловушка или отказ.", "key_points": ["Побег требует редких компонентов и сложной подготовки.", "Концовки отражают философский выбор между реальностью и комфортом симуляции.", "Исход влияет на доступные титулы и стартовые бонусы следующих сезонов."]}, "quest_definition": {"quest_type": "main", "level_min": 40, "level_max": null, "requirements": {"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}, "objectives": [{"id": "develop_escape_plan", "text": "Разработать план побега", "type": "interact", "target": "netrunner_data", "count": 1, "optional": false}, {"id": "collect_components", "text": "Собрать компоненты для Прорывателя симуляции", "type": "collect", "target": "simulation_breaker_component", "count": 5, "optional": false}, {"id": "construct_device", "text": "Сконструировать устройство", "type": "interact", "target": "device_construction_station", "count": 1, "optional": false}, {"id": "prepare_activation_site", "text": "Подготовить место активации", "type": "interact", "target": "activation_site", "count": 1, "optional": false}, {"id": "activate_device", "text": "Активировать механизм", "type": "interact", "target": "simulation_breaker_device", "count": 1, "optional": false}, {"id": "survive_anomalies", "text": "Пережить волну аномалий", "type": "interact", "target": "anomaly_wave", "count": 1, "optional": false}, {"id": "make_final_choice", "text": "Принять финальное решение", "type": "interact", "target": "final_choice_point", "count": 1, "optional": false}], "rewards": {"experience": 20000, "money": 0, "items": [], "reputation": {}, "unlocks": ["next_league_starting_bonuses"]}, "branches": [{"branch_id": "success_ending", "description": "Успешный побег", "consequences": {"items": [{"item_id": "title_escapee", "quantity": 1}], "unlocks": ["return_option"]}}, {"branch_id": "trap_ending", "description": "Попасть в ловушку", "consequences": {"unlocks": ["recursive_simulation_cycle"]}}, {"branch_id": "refusal_ending", "description": "Остаться в симуляции", "consequences": {"items": [{"item_id": "title_remaining", "quantity": 1}], "unlocks": ["enhanced_simulation_influence"]}}]}, "content": {"sections": [{"id": "overview", "title": "Описание", "body": "Квест завершает мета-арку Москвы. Игрок объединяет подсказки из предыдущих миссий и строит устройство, которое может\\nпробить границы симуляции.\\n", "mechanics_links": [], "assets": []}, {"id": "stages", "title": "Этапы", "body": "1. Разработать план побега, собрав данные от нетраннеров и учёных.\\n2. Найти и собрать компоненты для «Прорывателя симуляции».\\n3. Сконструировать устройство и подготовить место активации.\\n4. Активировать механизм, пережить волну аномалий и принять финальное решение.\\n", "mechanics_links": [], "assets": []}, {"id": "regional_details", "title": "Региональные детали", "body": "Побег готовится в скрытых лабораториях архологии и цифровых подпольях. Аномалии, вызванные подготовкой устройства, отражаются\\nв глитчах окружающей среды, отключениях NetWatch и случайных рестартах купола.\\n", "mechanics_links": [], "assets": []}, {"id": "endings", "title": "Концовки", "body": "- **Успех:** Игрок выходит в киберпанк-антиутопию, получает титул «Беглец» и опцию возвращения.\\n- **Ловушка:** Открывается новая симуляция, запускающая рекурсивный цикл поиска истины.\\n- **Отказ:** Игрок остаётся, усиливая влияние в симуляции и получая титул «Оставшийся».\\n", "mechanics_links": [], "assets": []}, {"id": "rewards", "title": "Награды", "body": "- Опыт: 20 000 XP.\\n- Титулы «Беглец» или «Оставшийся» в зависимости от выбора.\\n- Метагейм-последствия, влияющие на стартовые условия следующей лиги.\\n", "mechanics_links": [], "assets": []}, {"id": "mechanics", "title": "Механики", "body": "Философский выбор, множественные концовки, взаимодействие с системой симуляции и мета-нарратив.\\n", "mechanics_links": [], "assets": []}, {"id": "connections", "title": "Связи", "body": "Связан с предыдущими квестами арки симуляции и альтернативными финалами Москвы; влияет на запуск лиги 2094+.\\n", "mechanics_links": [], "assets": []}]}, "appendix": {"glossary": [], "references": [], "decisions": []}, "implementation": {"github_issue": 856, "needs_task": false, "queue_reference": [], "blockers": []}, "history": [{"version": "1.0.0", "date": "2025-11-13", "author": "concept_team", "changes": "Квест «Побег из симуляции» адаптирован под шаблон Concept Director."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 1, true) ON CONFLICT (quest_id) DO UPDATE SET title = EXCLUDED.title, description = EXCLUDED.description, quest_type = EXCLUDED.quest_type, level_min = EXCLUDED.level_min, level_max = EXCLUDED.level_max, requirements = EXCLUDED.requirements, objectives = EXCLUDED.objectives, rewards = EXCLUDED.rewards, branches = EXCLUDED.branches, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 quest