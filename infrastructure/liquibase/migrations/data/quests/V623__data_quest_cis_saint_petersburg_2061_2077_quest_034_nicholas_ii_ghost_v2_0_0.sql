-- Issue: #50
-- Import quest from: cis\saint-petersburg\2061-2077\quest-034-nicholas-ii-ghost.yaml
-- Version: 2.0.0
-- Generated: 2025-12-07T01:14:47.833338

BEGIN;

-- Quest: quest-saint-petersburg-2061-2077-nicholas-ii-ghost
INSERT INTO gameplay.quest_definitions (quest_id, title, description, quest_type, level_min, level_max, requirements, objectives, rewards, branches, content_data, version, is_active) VALUES ('quest-saint-petersburg-2061-2077-nicholas-ii-ghost', 'Санкт-Петербург 2061-2077 — «Призрак Николая II»', 'Ночной визит приводит к диалогу с Николаем II, VR-погружению в последние дни семьи и поиску потерянного наследия.', 'side', 12, NULL, '{"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}'::jsonb, '[{"id": "visit_alexander_palace", "text": "Прибыть в личные покои Николая II в Александровском дворце, активировать ИИ-систему с голограммами семьи и начать приватную беседу", "type": "interact", "target": "nicholas_ii_palace_visit", "count": 1, "optional": false}, {"id": "emperor_testimony", "text": "Выслушать исповедь императора о последних днях империи, оценить его ошибки и заслужить доверие", "type": "interact", "target": "nicholas_ii_testimony", "count": 1, "optional": false}, {"id": "vr_immersion_1917", "text": "Погрузиться в VR-симуляцию ключевых событий 1917-1918 годов: отречение, Тобольск, Екатеринбург, выполнить задачи по сохранению семьи", "type": "perform", "target": "nicholas_ii_vr_immersion", "count": 1, "optional": false}, {"id": "historical_choice", "text": "Принять решение: помочь семье бежать, оставить историю неизменной или использовать знания для политической выгоды", "type": "interact", "target": "nicholas_ii_historical_choice", "count": 1, "optional": false}]'::jsonb, '{"experience": 5000, "currency": 0, "items": [], "reputation": {"Romanov_Guardians": 100}, "flags": ["romanov_guardian_status", "romanov_secret_archives_access"]}'::jsonb, '[{"id": "help_family_escape", "condition": "choice == \\"help_escape\\"", "objectives": [{"id": "organize_escape", "text": "Организовать побег семьи Романовых из Екатеринбурга", "type": "perform", "target": "romanov_escape_mission", "count": 1, "optional": false}], "rewards": {"experience": 2000, "currency": 0, "items": [], "reputation": {"Monarchists": 50}, "flags": ["romanov_family_saved"]}}, {"id": "preserve_history", "condition": "choice == \\"preserve_history\\"", "objectives": [{"id": "witness_history", "text": "Стать свидетелем исторических событий без вмешательства", "type": "interact", "target": "romanov_history_witness", "count": 1, "optional": false}], "rewards": {"experience": 1000, "currency": 0, "items": [], "reputation": {"Historians": 30}, "flags": ["historical_preservation_achievement"]}}, {"id": "political_advantage", "condition": "choice == \\"political_advantage\\"", "objectives": [{"id": "use_knowledge", "text": "Использовать знания о Романовых для политической выгоды", "type": "perform", "target": "romanov_political_manipulation", "count": 1, "optional": false}], "rewards": {"experience": 1500, "currency": 10000, "items": [], "reputation": {"Political_Elite": 40}, "flags": ["romanov_political_advantage"]}}]'::jsonb, '{"metadata": {"id": "quest-saint-petersburg-2061-2077-nicholas-ii-ghost", "title": "Санкт-Петербург 2061-2077 — «Призрак Николая II»", "document_type": "canon", "category": "timeline-quest", "status": "draft", "version": "2.0.0", "last_updated": "2025-12-01T21:53:00+00:00", "concept_approved": false, "concept_reviewed_at": "", "owners": [{"role": "concept_director", "contact": "concept@necp.game"}], "tags": ["saint-petersburg", "imperial-history", "ai-ghost"], "topics": ["historical-drama", "branching-narrative"], "related_systems": ["narrative-service", "vr-service", "legacy-service"], "related_documents": [], "source": "shared/docs/knowledge/canon/lore/timeline-author/quests/cis/saint-petersburg/2061-2077/quest-034-nicholas-ii-ghost.md", "visibility": "internal", "audience": ["concept", "narrative", "liveops"], "risk_level": "high"}, "review": {"chain": [{"role": "concept_director", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "Императорской ветке требовался драматический квест с участием Николая II и альтернативными исходами.", "goal": "Позволить игроку встретить ИИ-призрак императора в Александровском дворце и решить, менять ли историю.", "essence": "Ночной визит приводит к диалогу с Николаем II, VR-погружению в последние дни семьи и поиску потерянного наследия.", "key_points": ["История Романовых раскрыта через эмоциональные сцены.", "Выбор игрока влияет на легенду об Анастасии и отношение фракций монархистов.", "Квест соединяет прошлое и цифровую память монарха."]}, "quest_definition": {"quest_type": "side", "level_min": 12, "level_max": null, "requirements": {"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}, "objectives": [{"id": "visit_alexander_palace", "text": "Прибыть в личные покои Николая II в Александровском дворце, активировать ИИ-систему с голограммами семьи и начать приватную беседу", "type": "interact", "target": "nicholas_ii_palace_visit", "count": 1, "optional": false}, {"id": "emperor_testimony", "text": "Выслушать исповедь императора о последних днях империи, оценить его ошибки и заслужить доверие", "type": "interact", "target": "nicholas_ii_testimony", "count": 1, "optional": false}, {"id": "vr_immersion_1917", "text": "Погрузиться в VR-симуляцию ключевых событий 1917-1918 годов: отречение, Тобольск, Екатеринбург, выполнить задачи по сохранению семьи", "type": "perform", "target": "nicholas_ii_vr_immersion", "count": 1, "optional": false}, {"id": "historical_choice", "text": "Принять решение: помочь семье бежать, оставить историю неизменной или использовать знания для политической выгоды", "type": "interact", "target": "nicholas_ii_historical_choice", "count": 1, "optional": false}], "rewards": {"experience": 5000, "currency": 0, "items": [], "reputation": {"Romanov_Guardians": 100}, "flags": ["romanov_guardian_status", "romanov_secret_archives_access"]}, "branches": [{"id": "help_family_escape", "condition": "choice == \\"help_escape\\"", "objectives": [{"id": "organize_escape", "text": "Организовать побег семьи Романовых из Екатеринбурга", "type": "perform", "target": "romanov_escape_mission", "count": 1, "optional": false}], "rewards": {"experience": 2000, "currency": 0, "items": [], "reputation": {"Monarchists": 50}, "flags": ["romanov_family_saved"]}}, {"id": "preserve_history", "condition": "choice == \\"preserve_history\\"", "objectives": [{"id": "witness_history", "text": "Стать свидетелем исторических событий без вмешательства", "type": "interact", "target": "romanov_history_witness", "count": 1, "optional": false}], "rewards": {"experience": 1000, "currency": 0, "items": [], "reputation": {"Historians": 30}, "flags": ["historical_preservation_achievement"]}}, {"id": "political_advantage", "condition": "choice == \\"political_advantage\\"", "objectives": [{"id": "use_knowledge", "text": "Использовать знания о Романовых для политической выгоды", "type": "perform", "target": "romanov_political_manipulation", "count": 1, "optional": false}], "rewards": {"experience": 1500, "currency": 10000, "items": [], "reputation": {"Political_Elite": 40}, "flags": ["romanov_political_advantage"]}}]}, "content": {"sections": [{"id": "arrival", "title": "Ночной визит в Александровский дворец", "body": "Игрок прибывает в личные покои Николая II. ИИ-система активирует голограммы семьи и приглашает к приватной беседе.\\n", "mechanics_links": ["mechanics/narrative/cinematic-trigger.yaml"], "assets": []}, {"id": "testimony", "title": "Исповедь императора", "body": "Николай рассказывает о последних днях империи, просит оценить ошибки и решает, достоин ли игрок доверия.\\n", "mechanics_links": ["mechanics/narrative/dialog-choice.yaml"], "assets": []}, {"id": "immersion", "title": "VR-погружение в 1917-1918 годы", "body": "Игрок перенаправляется в ключевые события: отречение, Тобольск, Екатеринбург. Требуется выполнять задачи по сохранению семьи.\\n", "mechanics_links": ["mechanics/vr/scene-transition.yaml"], "assets": []}, {"id": "choice", "title": "Альтернативы истории", "body": "Предложено три пути: помочь семье бежать, оставить историю неизменной или использовать знания для политической выгоды.\\n", "mechanics_links": ["mechanics/narrative/branching-outcome.yaml"], "assets": []}, {"id": "rewards", "title": "Награды", "body": "- 5 000 XP и культурный статус «Хранитель Романовых».\\n- Доступ к секретным архивам, эмоут «Последний монарх».\\n", "mechanics_links": ["mechanics/progression/legacy-impact.yaml"], "assets": []}]}, "appendix": {"glossary": [], "references": [], "decisions": []}, "implementation": {"github_issue": 827, "needs_task": false, "queue_reference": [], "blockers": []}, "history": [{"version": "2.0.0", "date": "2025-12-01", "author": "content_writer", "changes": "Добавлена полная структура quest_definition с objectives, rewards и branches. Детализирован контент согласно концепции. Добавлены три ветки с альтернативными исходами: помощь семье, сохранение истории, политическая выгода."}, {"version": "1.0.0", "date": "2025-11-13", "author": "concept_team", "changes": "Квест «Призрак Николая II» адаптирован под шаблон Concept Director."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 1, true) ON CONFLICT (quest_id) DO UPDATE SET title = EXCLUDED.title, description = EXCLUDED.description, quest_type = EXCLUDED.quest_type, level_min = EXCLUDED.level_min, level_max = EXCLUDED.level_max, requirements = EXCLUDED.requirements, objectives = EXCLUDED.objectives, rewards = EXCLUDED.rewards, branches = EXCLUDED.branches, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 quest