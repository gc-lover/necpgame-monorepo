-- Issue: #50, #34
-- Import quest from: europe/brussels/2020-2029/quest-001-eu-capital.yaml
-- Version: 2.0.0
-- Generated: 2025-12-12T00:49:14.713924

BEGIN;

-- Quest: quest-brussels-2029-eu-capital
INSERT INTO gameplay.quest_definitions (quest_id, title, description, quest_type, level_min, level_max, requirements, objectives, rewards, branches, content_data, version, is_active) VALUES (
'quest-brussels-2029-eu-capital', 
'Брюссель 2020-2029 — Столица ЕС', 
'Игрок посещает ключевые институты, взаимодействует с евродепутатами и фиксирует процессы голосования.', 
'main', 
5, 
NULL, 
'{"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}'::jsonb, 
'[{"id": "get_eu_pass", "text": "Получить пропуск в Европейский квартал, ознакомиться с картой и расписанием пленарных заседаний", "type": "interact", "target": "eu_quarter_entrance", "count": 1, "optional": false}, {"id": "visit_parlamentarium", "text": "Посетить Parlamentarium, пройти интерактивную экспозицию и мини-игру по истории ЕС", "type": "interact", "target": "parlamentarium_museum", "count": 1, "optional": false}, {"id": "attend_parliament_session", "text": "Присутствовать на пленарном заседании Европарламента, наблюдать за голосованием и задать вопрос евродепутату", "type": "interact", "target": "european_parliament_session", "count": 1, "optional": false}, {"id": "meet_commission", "text": "Встретиться с сотрудниками Европейской комиссии в Берлемоне, изучить процессы подготовки директив", "type": "interact", "target": "european_commission_berlaymont", "count": 1, "optional": false}, {"id": "create_policy_report", "text": "Сформировать аналитическую записку для своей фракции, выбрав акценты: экономика, безопасность или культура", "type": "craft", "target": "policy_report_creation", "count": 1, "optional": false}]'::jsonb, 
'{"experience": 2500, "currency": 0, "items": [{"item_id": "eu_crat_title", "name": "Титул «Еврократ»", "quantity": 1}], "reputation": {"european_union": 25, "brussels_citizens": 15}, "flags": ["eu_capital_quest_completed", "eu_diplomatic_storylines_unlocked", "eu_week_liveops_unlocked"]}'::jsonb, 
'[{"id": "economic_focus_path", "unlock_condition": {"type": "choice_made", "choice_id": "policy_report_focus", "value": "economy"}, "consequences": {"currency": 0, "reputation": {"european_union": 10, "brussels_citizens": 5}, "flags": ["eu_economic_storylines_unlocked"], "unlocked_content": [{"quest_type": "side", "category": "economic", "location": "brussels"}]}}, {"id": "security_focus_path", "unlock_condition": {"type": "choice_made", "choice_id": "policy_report_focus", "value": "security"}, "consequences": {"currency": 0, "reputation": {"european_union": 10, "brussels_citizens": 5}, "flags": ["eu_security_storylines_unlocked"], "unlocked_content": [{"quest_type": "side", "category": "security", "location": "brussels"}]}}, {"id": "culture_focus_path", "unlock_condition": {"type": "choice_made", "choice_id": "policy_report_focus", "value": "culture"}, "consequences": {"currency": 0, "reputation": {"european_union": 10, "brussels_citizens": 5}, "flags": ["eu_culture_storylines_unlocked"], "unlocked_content": [{"quest_type": "side", "category": "cultural", "location": "brussels"}]}}]'::jsonb, 
'{"metadata": {"id": "quest-brussels-2029-eu-capital", "title": "Брюссель 2020-2029 — Столица ЕС", "document_type": "canon", "category": "timeline-quest", "status": "draft", "version": "2.0.0", "last_updated": "2025-12-01T00:00:00+00:00", "concept_approved": false, "concept_reviewed_at": "", "owners": [{"role": "concept_director", "contact": "concept@necp.game"}], "tags": ["brussels", "politics", "european-union"], "topics": ["supranational_governance", "civic_education"], "related_systems": ["narrative-service", "gameplay-service", "quest-service", "character-service", "economy-service", "diplomacy-service", "education-service", "governance-system"], "related_documents": [], "source": "shared/docs/knowledge/canon/lore/timeline-author/quests/europe/brussels/2020-2029/quest-001-eu-capital.md", "visibility": "internal", "audience": ["concept", "narrative", "liveops"], "risk_level": "medium"}, "review": {"chain": [{"role": "concept_director", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "Политической ветке Брюсселя нужен был вводный квест о структурах Европейского союза.", "goal": "Организовать образовательный тур по кварталу ЕС и показать, как принимаются общеевропейские решения.", "essence": "Игрок посещает ключевые институты, взаимодействует с евродепутатами и фиксирует процессы голосования.", "key_points": [{"Используются реальные локации": "Европарламент, Берлемон, Parlamentarium."}, "Минитесты по истории интеграции.", "Итоговый отчёт влияет на дипломатические линии других городов."]}, "quest_definition": {"quest_type": "main", "level_min": 5, "level_max": null, "requirements": {"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}, "objectives": [{"id": "get_eu_pass", "text": "Получить пропуск в Европейский квартал, ознакомиться с картой и расписанием пленарных заседаний", "type": "interact", "target": "eu_quarter_entrance", "count": 1, "optional": false}, {"id": "visit_parlamentarium", "text": "Посетить Parlamentarium, пройти интерактивную экспозицию и мини-игру по истории ЕС", "type": "interact", "target": "parlamentarium_museum", "count": 1, "optional": false}, {"id": "attend_parliament_session", "text": "Присутствовать на пленарном заседании Европарламента, наблюдать за голосованием и задать вопрос евродепутату", "type": "interact", "target": "european_parliament_session", "count": 1, "optional": false}, {"id": "meet_commission", "text": "Встретиться с сотрудниками Европейской комиссии в Берлемоне, изучить процессы подготовки директив", "type": "interact", "target": "european_commission_berlaymont", "count": 1, "optional": false}, {"id": "create_policy_report", "text": "Сформировать аналитическую записку для своей фракции, выбрав акценты: экономика, безопасность или культура", "type": "craft", "target": "policy_report_creation", "count": 1, "optional": false}], "rewards": {"experience": 2500, "currency": 0, "items": [{"item_id": "eu_crat_title", "name": "Титул «Еврократ»", "quantity": 1}], "reputation": {"european_union": 25, "brussels_citizens": 15}, "flags": ["eu_capital_quest_completed", "eu_diplomatic_storylines_unlocked", "eu_week_liveops_unlocked"]}, "branches": [{"id": "economic_focus_path", "unlock_condition": {"type": "choice_made", "choice_id": "policy_report_focus", "value": "economy"}, "consequences": {"currency": 0, "reputation": {"european_union": 10, "brussels_citizens": 5}, "flags": ["eu_economic_storylines_unlocked"], "unlocked_content": [{"quest_type": "side", "category": "economic", "location": "brussels"}]}}, {"id": "security_focus_path", "unlock_condition": {"type": "choice_made", "choice_id": "policy_report_focus", "value": "security"}, "consequences": {"currency": 0, "reputation": {"european_union": 10, "brussels_citizens": 5}, "flags": ["eu_security_storylines_unlocked"], "unlocked_content": [{"quest_type": "side", "category": "security", "location": "brussels"}]}}, {"id": "culture_focus_path", "unlock_condition": {"type": "choice_made", "choice_id": "policy_report_focus", "value": "culture"}, "consequences": {"currency": 0, "reputation": {"european_union": 10, "brussels_citizens": 5}, "flags": ["eu_culture_storylines_unlocked"], "unlocked_content": [{"quest_type": "side", "category": "cultural", "location": "brussels"}]}}]}, "content": {"sections": [{"id": "briefing", "title": "Европейский квартал", "body": "Игрок получает пропуск, знакомится с картой квартала и расписанием пленарных заседаний.\\n", "mechanics_links": ["mechanics/planning/institutional-tour.yaml"], "assets": []}, {"id": "parlamentarium", "title": "Parlamentarium", "body": "Интерактивная экспозиция рассказывает историю ЕС. Мини-игра проверяет знание ключевых договоров.\\n", "mechanics_links": ["mechanics/education/timeline-quiz.yaml"], "assets": []}, {"id": "parliament", "title": "Европарламент", "body": "Игрок присутствует на пленарном заседании, наблюдает за голосованием и может задать вопрос евродепутату.\\n", "mechanics_links": ["mechanics/diplomacy/observer-role.yaml"], "assets": []}, {"id": "commission", "title": "Берлемон и Комиссия", "body": "Встреча с сотрудниками Европейской комиссии раскрывает процессы подготовки директив и переговоров с государствами-членами.\\n", "mechanics_links": ["mechanics/social/policy-briefing.yaml"], "assets": []}, {"id": "reflection", "title": "Отчёт об объединённой Европе", "body": "Игрок формирует аналитическую записку для своей фракции, выбирая акценты: экономика, безопасность, культура.\\n", "mechanics_links": ["mechanics/progression/policy-report.yaml"], "assets": []}, {"id": "rewards", "title": "Награды", "body": "- 2 500 XP, политика +25, титул «Еврократ».\\n- Открытие дипломатических сюжетов и liveops «Европейская неделя».\\n", "mechanics_links": ["mechanics/progression/title-unlock.yaml"], "assets": []}]}, "appendix": {"glossary": [], "references": [], "decisions": []}, "implementation": {"github_issue": 683, "needs_task": false, "queue_reference": [], "blockers": []}, "history": [{"version": "2.0.0", "date": "2025-12-01", "author": "content_writer", "changes": "Добавлен Issue в начало файла. Добавлена полная структура quest_definition с objectives, rewards и branches согласно архитектуре системы квестов. Детализированы objectives на основе контента квеста. Добавлены 3 branches в зависимости от выбора фокуса отчёта (экономика, безопасность, культура)."}, {"version": "1.0.0", "date": "2025-11-13", "author": "concept_team", "changes": "Квест «Столица ЕС» адаптирован под шаблон Concept Director."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 
1, 
true
) ON CONFLICT (quest_id) DO UPDATE SET title = EXCLUDED.title, description = EXCLUDED.description, quest_type = EXCLUDED.quest_type, level_min = EXCLUDED.level_min, level_max = EXCLUDED.level_max, requirements = EXCLUDED.requirements, objectives = EXCLUDED.objectives, rewards = EXCLUDED.rewards, branches = EXCLUDED.branches, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 quest
