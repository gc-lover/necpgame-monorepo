-- Issue: #50, #34
-- Import quest from: europe/brussels/2020-2029/quest-003-belgian-chocolate.yaml
-- Version: 2.0.0
-- Generated: 2025-12-12T00:49:14.727541

BEGIN;

-- Quest: quest-brussels-2020-2029-belgian-chocolate
INSERT INTO gameplay.quest_definitions (quest_id, title, description, quest_type, level_min, level_max, requirements, objectives, rewards, branches, content_data, version, is_active) VALUES (
'quest-brussels-2020-2029-belgian-chocolate', 
'Брюссель 2020-2029 — «Бельгийский шоколад»', 
'Игрок дегустирует pralines, изучает историю брендов и формирует подарочную коробку для социальной линии.', 
'side', 
3, 
NULL, 
'{"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}'::jsonb, 
'[{"id": "get_chocolate_guide", "text": "Получить holo-гид по шоколадным домам на Grand Place, выбрать три точки для визита и настроить план дегустации", "type": "interact", "target": "grand_place_tourism_center", "count": 1, "optional": false}, {"id": "visit_chocolate_houses", "text": "Посетить три ключевых шоколадных дома, изучить их историю и витрины", "type": "travel", "target": "brussels_chocolate_houses", "count": 3, "optional": false}, {"id": "play_tasting_game", "text": "Пройти мини-игру дегустации pralines, сочетая тёмный, молочный и белый шоколад с начинками", "type": "perform", "target": "chocolate_tasting_minigame", "count": 1, "optional": false}, {"id": "learn_neuhaus_history", "text": "Посетить фирменный бутик Neuhaus, сканировать AR-архив 1912 года и узнать о рождении praline", "type": "investigate", "target": "neuhaus_boutique", "count": 1, "optional": false}, {"id": "create_gift_box", "text": "Собрать подарочную коробку из пяти конфет для VIP-клиента, выбрав оптимальную комбинацию", "type": "craft", "target": "chocolate_gift_box_assembly", "count": 1, "optional": false}]'::jsonb, 
'{"experience": 1000, "currency": 0, "items": [{"item_id": "sweet_energy_buff", "name": "Бафф «Sweet Energy» (+20% Energy на 6 часов)", "quantity": 1}, {"item_id": "chocolate_gourmet_title", "name": "Титул «Шоколадный гурман»", "quantity": 1}], "reputation": {"brussels_tourism": 15, "brussels_gastronomy": 10}, "flags": ["belgian_chocolate_quest_completed", "praline_week_liveops_unlocked"]}'::jsonb, 
'[{"id": "premium_chocolate_path", "unlock_condition": {"type": "skill_check", "skill": "taste", "min_value": 0.7}, "consequences": {"currency": 0, "reputation": {"brussels_gastronomy": 15}, "flags": ["premium_chocolate_quests_unlocked"], "unlocked_content": [{"quest_type": "side", "category": "gastronomy", "location": "brussels"}]}}, {"id": "social_gift_path", "unlock_condition": {"type": "quest_completion", "quest_id": "quest-brussels-2020-2029-belgian-chocolate"}, "consequences": {"currency": 0, "reputation": {"brussels_tourism": 10}, "flags": ["social_gift_events_unlocked"], "unlocked_content": [{"event_type": "social", "location": "brussels"}]}}]'::jsonb, 
'{"metadata": {"id": "quest-brussels-2020-2029-belgian-chocolate", "title": "Брюссель 2020-2029 — «Бельгийский шоколад»", "document_type": "canon", "category": "timeline-quest", "status": "draft", "version": "2.0.0", "last_updated": "2025-12-01T00:00:00+00:00", "concept_approved": false, "concept_reviewed_at": "", "owners": [{"role": "concept_director", "contact": "concept@necp.game"}], "tags": ["brussels", "chocolate", "gastronomy"], "topics": ["culinary_exploration", "heritage_story"], "related_systems": ["narrative-service", "gameplay-service", "quest-service", "character-service", "economy-service", "wellbeing-service", "tourism-service", "social-service"], "related_documents": [], "source": "shared/docs/knowledge/canon/lore/timeline-author/quests/europe/brussels/2020-2029/quest-003-belgian-chocolate.md", "visibility": "internal", "audience": ["concept", "narrative", "liveops"], "risk_level": "low"}, "review": {"chain": [{"role": "concept_director", "reviewer": "", "reviewed_at": "", "status": "pending"}], "next_actions": []}, "summary": {"problem": "Кулинарной линии Брюсселя требовался квест о pralines и шоколадных домах, подчёркивающий местное наследие.", "goal": "Провести игрока по витринам Grand Place, познакомить с Neuhaus и собрать коллекцию премиальных вкусов.", "essence": "Игрок дегустирует pralines, изучает историю брендов и формирует подарочную коробку для социальной линии.", "key_points": ["Формирует маршрут по ключевым шоколадным домам с короткими историями.", "Мини-игра дегустации даёт временный бафф энергии.", "Собранная коробка активирует событие liveops с экспортом деликатесов."]}, "quest_definition": {"quest_type": "side", "level_min": 3, "level_max": null, "requirements": {"required_quests": [], "required_flags": [], "required_reputation": {}, "required_items": []}, "objectives": [{"id": "get_chocolate_guide", "text": "Получить holo-гид по шоколадным домам на Grand Place, выбрать три точки для визита и настроить план дегустации", "type": "interact", "target": "grand_place_tourism_center", "count": 1, "optional": false}, {"id": "visit_chocolate_houses", "text": "Посетить три ключевых шоколадных дома, изучить их историю и витрины", "type": "travel", "target": "brussels_chocolate_houses", "count": 3, "optional": false}, {"id": "play_tasting_game", "text": "Пройти мини-игру дегустации pralines, сочетая тёмный, молочный и белый шоколад с начинками", "type": "perform", "target": "chocolate_tasting_minigame", "count": 1, "optional": false}, {"id": "learn_neuhaus_history", "text": "Посетить фирменный бутик Neuhaus, сканировать AR-архив 1912 года и узнать о рождении praline", "type": "investigate", "target": "neuhaus_boutique", "count": 1, "optional": false}, {"id": "create_gift_box", "text": "Собрать подарочную коробку из пяти конфет для VIP-клиента, выбрав оптимальную комбинацию", "type": "craft", "target": "chocolate_gift_box_assembly", "count": 1, "optional": false}], "rewards": {"experience": 1000, "currency": 0, "items": [{"item_id": "sweet_energy_buff", "name": "Бафф «Sweet Energy» (+20% Energy на 6 часов)", "quantity": 1}, {"item_id": "chocolate_gourmet_title", "name": "Титул «Шоколадный гурман»", "quantity": 1}], "reputation": {"brussels_tourism": 15, "brussels_gastronomy": 10}, "flags": ["belgian_chocolate_quest_completed", "praline_week_liveops_unlocked"]}, "branches": [{"id": "premium_chocolate_path", "unlock_condition": {"type": "skill_check", "skill": "taste", "min_value": 0.7}, "consequences": {"currency": 0, "reputation": {"brussels_gastronomy": 15}, "flags": ["premium_chocolate_quests_unlocked"], "unlocked_content": [{"quest_type": "side", "category": "gastronomy", "location": "brussels"}]}}, {"id": "social_gift_path", "unlock_condition": {"type": "quest_completion", "quest_id": "quest-brussels-2020-2029-belgian-chocolate"}, "consequences": {"currency": 0, "reputation": {"brussels_tourism": 10}, "flags": ["social_gift_events_unlocked"], "unlocked_content": [{"event_type": "social", "location": "brussels"}]}}]}, "content": {"sections": [{"id": "grand_place", "title": "Пролог на Grand Place", "body": "Игрок получает holo-гид по шоколадным домам, выбирает три точки для визита и настраивает план дегустации.\\n", "mechanics_links": ["mechanics/tourism/route-planning.yaml"], "assets": []}, {"id": "degustation", "title": "Дегустация pralines", "body": "Мини-игра предлагает сочетания тёмного, молочного и белого шоколада с начинками. Выбор влияет на качество итоговой коробки.\\n", "mechanics_links": ["mechanics/wellbeing/taste-challenge.yaml"], "assets": []}, {"id": "neuhaus_story", "title": "История Neuhaus", "body": "В фирменном бутике игрок сканирует AR-архив 1912 года и узнаёт о рождении praline. Открывается коллекционная карточка бренда.\\n", "mechanics_links": ["mechanics/narrative/heritage-node.yaml"], "assets": []}, {"id": "gift_box", "title": "Сбор подарка", "body": "Необходимо выбрать набор из пяти конфет для VIP-клиента. Комбинация определяет бонусы репутации.\\n", "mechanics_links": ["mechanics/social/gift-composition.yaml"], "assets": []}, {"id": "rewards", "title": "Награды", "body": "- 1 000 XP, бафф «Sweet Energy» (+20% Energy на 6 часов).\\n- Титул «Шоколадный гурман» и доступ к liveops-ивенту «Praline Week».\\n", "mechanics_links": ["mechanics/progression/buff-unlock.yaml"], "assets": []}]}, "appendix": {"glossary": [], "references": [], "decisions": []}, "implementation": {"github_issue": 685, "needs_task": false, "queue_reference": [], "blockers": []}, "history": [{"version": "2.0.0", "date": "2025-12-01", "author": "content_writer", "changes": "Добавлен Issue в начало файла. Добавлена полная структура quest_definition с objectives, rewards и branches согласно архитектуре системы квестов. Создано 5 objectives на основе контента квеста (получить гид, посетить шоколадные дома, пройти дегустацию, изучить историю Neuhaus, собрать подарочную коробку). Добавлены rewards: 1000 XP, бафф \\"Sweet Energy\\", титул \\"Шоколадный гурман\\", репутация, флаги для разблокировки liveops. Добавлены 2 branches (premium_chocolate_path, social_gift_path) с правильной структурой unlock_condition и consequences."}, {"version": "1.0.0", "date": "2025-11-13", "author": "concept_team", "changes": "Квест «Бельгийский шоколад» адаптирован под шаблон Concept Director."}], "validation": {"checksum": "", "schema_version": "1.0"}}'::jsonb, 
1, 
true
) ON CONFLICT (quest_id) DO UPDATE SET title = EXCLUDED.title, description = EXCLUDED.description, quest_type = EXCLUDED.quest_type, level_min = EXCLUDED.level_min, level_max = EXCLUDED.level_max, requirements = EXCLUDED.requirements, objectives = EXCLUDED.objectives, rewards = EXCLUDED.rewards, branches = EXCLUDED.branches, content_data = EXCLUDED.content_data, updated_at = CURRENT_TIMESTAMP;

COMMIT;

-- Total imported: 1 quest
