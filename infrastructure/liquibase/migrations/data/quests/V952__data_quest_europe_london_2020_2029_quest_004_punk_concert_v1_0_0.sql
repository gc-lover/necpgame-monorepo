-- Issue: #1918
-- Import quest from: knowledge/canon/lore/timeline-author/quests/europe/london/2020-2029/quest-004-punk-concert.yaml
-- Version: 1.0.0
-- Generated: 2025-12-20T12:00:00.000000
-- WARNING  WARNING: Requires 'gameplay.quest_definitions' table (create via Database agent)

BEGIN;

-- Quest: quest-london-2020-2029-punk-concert
INSERT INTO gameplay.quest_definitions (
    quest_id, title, quest_type, level_min, level_max,
    requirements, objectives, rewards, content_data, is_active
)
VALUES (
    'quest-london-2020-2029-punk-concert',
    'Underground Punk Revolution',
    'side',
    3,
    10,
    '{"player_level": {"min": 3, "max": 10}, "location": "London", "reputation": {"punk_scene": 10}}'::jsonb,
    '[{"id": "find_entrance", "description": "Find the hidden entrance to the underground punk club", "type": "exploration", "order": 1, "optional": false}, {"id": "pass_audition", "description": "Pass the club audition by showing punk style and knowledge", "type": "social", "order": 2, "optional": false}, {"id": "socialize_band", "description": "Socialize with the punk band members and learn their story", "type": "social", "order": 3, "optional": false}, {"id": "join_concert", "description": "Participate in the underground concert with mini-games", "type": "activity", "order": 4, "optional": false}, {"id": "help_band", "description": "Help the band with their problems (corporate pressure, rival gangs)", "type": "quest", "order": 5, "optional": true}]'::jsonb,
    '{"experience": 1500, "money": 8000, "reputation": {"punk_scene": 30, "london_underground": 20}, "items": ["punk_jacket", "glow_stick"], "implants": ["neural_music_enhancer"]}'::jsonb,
    '{"metadata":{"id":"quest-london-2020-2029-punk-concert","title":"Quest: Punk Concert (London 2020-2029)","document_type":"canon","category":"quest","status":"ready_for_backend","version":"1.0.0","last_updated":"2025-12-20T05:14:00Z","concept_approved":true,"concept_reviewed_at":"2025-12-20T05:14:00Z","owners":[{"role":"lore_archivist","contact":"lore@necp.game"}],"tags":["quest","london","punk","underground","music","social","cyberpunk"],"topics":["urban_culture","underground_music","social_networking","live_events"],"related_systems":["narrative-service","quest-service","social-service","world-service"],"related_documents":[{"id":"canon-lore-london-2020-2029","relation":"setting"}],"source":"shared/docs/knowledge/canon/lore/timeline-author/quests/europe/london/2020-2029/quest-004-punk-concert.yaml","visibility":"internal","audience":["concept","narrative","quest-design","localization"],"risk_level":"medium"},"review":{"chain":[{"role":"content_writer","reviewer":"Content Writer Agent","reviewed_at":"2025-12-20T05:14:00Z","status":"approved"}],"next_actions":[{"action":"backend_import","description":"Import Punk Concert quest to database for gameplay integration","assignee":"backend_agent"}]},"summary":{"problem":"Нужен атмосферный квест о панк-сцене в заброшенном метро Лондона 2020-2029 годов.","goal":"Создать квест, где игрок находит подпольный клуб, проходит отбор и участвует в концерте с мини-играми и социальными контактами.","essence":"Игрок погружается в панк-сцену, танцует, общается с музыкантами и открывает доступ к панк-фракции.","key_points":["Вход требует панк-стиля и знания кодового слова","Концерт совмещает танцевальные, драковые и социальные мини-игры","Музыканты имеют личные истории и проблемы","Открывает доступ к панк-фракции и underground сети","Включает элементы британской панк-культуры"]}},"quest_structure":{"title":"Underground Punk Revolution","subtitle":"London''s Cyberpunk Music Scene","period":"2020-2029","location":"London Underground, East End districts","duration":"Short (2-3 hours gameplay)","difficulty":"Easy-Medium","player_level":"3-10","synopsis":"В 2023 году Лондон бурлит подпольной панк-сценой. Игрок слышит слухи о легендарном концерте в заброшенном метро. Чтобы попасть на шоу, нужно найти скрытый вход, пройти отбор и завоевать доверие музыкантов. Концерт становится не просто выступлением, а gateway в мир лондонского андерграунда.","main_objectives":["Find the hidden entrance to the underground punk club","Pass the club audition by showing punk style and knowledge","Socialize with the punk band members and learn their story","Participate in the underground concert with mini-games","Help the band with their problems (corporate pressure, rival gangs)"],"side_objectives":["Collect punk memorabilia from abandoned stations","Help local street performers","Sabotage corporate surveillance in the underground","Organize a small punk gathering"],"rewards":{"experience":1500,"money":8000,"reputation":{"punk_scene":30,"london_underground":20},"items":["punk_jacket","glow_stick"],"implants":["neural_music_enhancer"]}},"narrative":{"theme":"Underground music scene in cyberpunk London","conflict":"Punk bands vs corporate control vs rival gangs","player_role":"Newcomer discovering London''s hidden music culture","moral_choices":"Support punk ideals vs pragmatic survival","endings":["Join punk faction","Corporate sellout","Gang alliance","Independent artist"]},"gameplay":{"exploration":"Navigate abandoned underground network","social":"Complex interactions with punk characters","activity":"Concert mini-games (rhythm, dance, mosh pit)","stealth":"Avoid corporate security patrols"},"atmosphere":{"locations":["Abandoned tube stations","Makeshift concert halls","Graffiti-covered tunnels","Neon-lit underground bars"],"characters":["Rebellious band leader","Shy but talented singer","Street-smart sound engineer","Corporate infiltrator"],"cultural_elements":["UK punk heritage","Cyberpunk aesthetics","Underground resistance","Music as rebellion"]},"mechanics":{"punk_style":"Outfit and attitude affect interactions","concert_minigames":"Rhythm games, dance challenges","social_networking":"Build relationships with punk community","reputation_system":"Punk scene standing affects future opportunities"}},"technical":{"quest_id":"quest-london-2020-2029-punk-concert","prerequisites":{"level":3,"location":"london","style":"punk"},"triggers":{"rumor":"underground_concert","location":"east_london"},"states":{"discovery":1,"audition":2,"socializing":3,"concert":4,"resolution":5},"completion":{"time_limit":"3 days","failure_conditions":["corporate_raid","betray_band"]}}},"localization":{"british_culture":"Punk rock heritage and working-class spirit","cyberpunk_elements":"Neon aesthetics and underground rebellion","london_setting":"Tube network and East End districts","music_culture":"Punk lyrics and band dynamics"}},"testing":{"edge_cases":["Player fails audition multiple times","Corporate raid during concert","Band member betrayal"],"performance":"Light social quest with mini-games","balance":"Rewards scaled for 3-10 level range","accessibility":"Multiple paths for different playstyles"}},"implementation":{"needs_task":true,"backend_import_required":true,"github_issue":1918,"queue_reference":[],"blockers":[]},"history":[{"version":"1.0.0","date":"2025-12-20","author":"backend-agent","changes":"Imported quest to database via V952 migration."},{"version":"0.1.0","date":"2025-12-20","author":"content-writer","changes":"Created comprehensive punk concert quest with underground music theme."}],"validation":{"checksum":"","schema_version":"1.0"}}'::jsonb,
    true
) ON CONFLICT (quest_id) DO UPDATE SET
    title = EXCLUDED.title,
    quest_type = EXCLUDED.quest_type,
    level_min = EXCLUDED.level_min,
    level_max = EXCLUDED.level_max,
    requirements = EXCLUDED.requirements,
    objectives = EXCLUDED.objectives,
    rewards = EXCLUDED.rewards,
    content_data = EXCLUDED.content_data;

COMMIT;

-- Total imported: 1 quest