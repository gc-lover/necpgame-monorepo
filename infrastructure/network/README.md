# Network Infrastructure Configuration

**Issue:** #142109960  
**Агент:** Network Engineer  
**Версия:** 1.0.0

## Описание

Директория содержит конфигурационные файлы и документацию для сетевой инфраструктуры игры, включая спецификацию тикрейта для разных типов активностей и конфигурацию адаптивного тикрейта.

## Структура файлов

### `tickrate-specification.yaml`

Спецификация требований к тикрейту для различных типов активностей:
- PvE зоны (MMORPG)
- PvP small (5-20 игроков)
- GvG 200 (100v100)
- GvG 400 (200v200)
- Massive war (2000+ игроков)

Включает:
- Базовые требования к тикрейту
- Расчеты сетевой нагрузки
- Требования к протоколам
- Оптимизации для каждого типа активности

### `tickrate-config.yaml`

Runtime конфигурация тикрейта для использования в коде:
- Конфигурация для каждого типа зоны
- Настройки для различных механик
- Параметры оптимизации
- Настройки адаптивного тикрейта

Используется сервисами для чтения текущей конфигурации тикрейта.

### `adaptive-tickrate-config.yaml`

Детальная конфигурация системы адаптивного тикрейта:
- Факторы влияния (количество игроков, задержка, CPU)
- Пороговые значения для адаптации
- Приоритетные и защищенные механики
- Зональные конфигурации
- Методы расчета и сглаживания

### `tickrate-documentation.md`

Полная документация требований к тикрейту:
- Описание всех типов зон
- Расчеты сетевой нагрузки
- Оптимизации и их эффективность
- Примеры использования
- Рекомендации по реализации

### `tickrate-integration-guide.md`

Руководство по интеграции тикрейта в существующий код:
- Этапы интеграции
- Примеры кода
- Конфигурация окружения
- Миграция существующего кода

### `udp-gateway-specification.yaml`

Спецификация модуля UDP Gateway:
- Система надежности поверх UDP (sequence numbers, ACK/NACK)
- Управление соединениями и жизненным циклом
- QoS управление с приоритетами пакетов
- Anti-cheat валидация и rate limiting
- Поддержка всех типов PvP зон

### `protocol-switch-manager-specification.yaml`

Спецификация модуля динамического переключения протоколов:
- Триггеры переключения WebSocket ↔ UDP
- Процесс переключения с overlap периодом
- Механизм отката (fallback) при ошибках
- Управление состояниями переключения
- Интеграция с другими модулями

### `spatial-partitioning-specification.yaml`

Спецификация модуля оптимизации для средних битв:
- Grid-система 100x100 метров
- Visibility radius 3x3 ячейки
- Снижение трафика на 80-90%
- Фильтрация обновлений по близости
- Приоритизация обновлений

### `network-security-config.yaml`

Конфигурация сетевой безопасности:
- Rate limiting для WebSocket и UDP
- Лимиты на количество соединений
- CORS настройки
- Конфигурация TLS
- Защита от DDoS
- Валидация входных данных
- Мониторинг и алерты

### `database-schema.sql`

Схема PostgreSQL для гибридной сетевой системы:
- Таблицы для протоколов и сессий
- Таблицы для spatial partitioning и sharding
- Таблицы для метрик сети
- Таблицы для UDP соединений
- Views для аналитики
- Triggers для автоматического обновления

## Использование

### Для разработчиков

Конфигурационные файлы YAML можно загружать в Go сервисы для настройки тикрейта:

```go
import "gopkg.in/yaml.v3"

type TickrateConfig struct {
    TickrateConfig struct {
        Zones map[string]ZoneConfig `yaml:"zones"`
    } `yaml:"tickrate_config"`
}

// Загрузка конфигурации
config := loadTickrateConfig("infrastructure/network/tickrate-config.yaml")
```

### Для Network Engineer

Все файлы должны быть синхронизированы:
- При изменении спецификации обновить конфигурацию
- При изменении конфигурации обновить документацию
- Все изменения должны быть согласованы с архитектурой

## Связанные файлы

- `knowledge/implementation/architecture/hybrid-network-system-architecture.yaml` - архитектура гибридной сетевой системы
- `knowledge/implementation/architecture/game-mechanics-systems-architecture.yaml` - требования к тикрейту для механик
- `services/realtime-gateway-go/` - реализация realtime gateway
- `infrastructure/envoy/envoy.yaml` - конфигурация Envoy proxy

## Важные замечания

1. **Тикрейт проектируется на Architect, реализуется на Network Engineer после Backend Developer**
2. Все файлы должны содержать номер Issue в начале
3. Максимальный размер файлов: 500 строк (при превышении разбивать на несколько)
4. Конфигурации должны быть валидными YAML
5. Документация должна быть актуальной и соответствовать конфигурациям

## Версионирование

Все файлы содержат поле `version` для отслеживания изменений:
- Версия изменяется при критических изменениях
- Минорные изменения не требуют изменения версии
- Мажорные изменения требуют обновления документации

## Обновления

При изменении тикрейта:
1. Обновить `tickrate-specification.yaml` (спецификацию)
2. Обновить `tickrate-config.yaml` (конфигурацию)
3. Обновить `adaptive-tickrate-config.yaml` (если затронута адаптация)
4. Обновить `tickrate-documentation.md` (документацию)
5. Обновить архитектурные файлы (если требуется)

## Поддержка

Все вопросы и предложения по улучшению конфигураций должны быть обсуждены с Network Engineer и Architect перед внесением изменений.

