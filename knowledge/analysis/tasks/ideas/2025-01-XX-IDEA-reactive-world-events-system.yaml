metadata:
  id: analysis-ideas-2025-01-reactive-world-events
  title: Система реактивных глобальных событий с масштабированием
  document_type: analysis
  category: world-events
  status: in_progress
  version: '0.1.0'
  last_updated: 2025-01-XXT00:00:00Z
  concept_approved: false
  concept_reviewed_at: ''
  processed_by: idea-writer
  processed_at: 2025-01-XXT00:00:00Z
  github_issue_number: 1454
  owners:
    - role: brain_manager
      contact: brain.manager@necp.game
  tags:
    - reactive-events
    - world
    - player-impact
    - dynamic-systems
  topics:
    - player-triggered-events
    - world-simulation
    - event-scaling
  related_systems:
    - world-service
    - quest-service
    - economy-service
    - social-service
    - analytics-service
  related_documents:
    - id: github-issue-1454
      title: GitHub Issue #1454
      link: https://github.com/gc-lover/necpgame-monorepo/issues/1454
      relation: migrated_to
      migrated_at: 2025-01-XXT00:00:00Z
    - id: player-impact-systems
      relation: extends
    - id: world-events-system-architecture
      relation: extends
    - id: live-events-system
      relation: complements
  source: knowledge/analysis/tasks/ideas/2025-01-XX-IDEA-reactive-world-events-system.yaml
  visibility: internal
  audience:
    - concept
    - world
    - gameplay
  risk_level: high
review:
  chain:
    - role: brain_manager
      reviewer: ''
      reviewed_at: ''
      status: pending
  next_actions: []
summary:
  problem: |
    Требуется система, где действия игроков, завершение квестов и накопленная активность могут вызывать 
    глобальные события разных масштабов. Сейчас есть система запланированных событий (Live Events System), 
    но нет механики реактивных событий, триггеримых действиями игроков.
  goal: |
    Создать систему реактивных глобальных событий, которая позволяет действиям игроков и квестам вызывать 
    события разных масштабов (локальный, городской, региональный, континентальный, планетарный, межпланетарный), 
    интегрируется с существующей системой влияния игроков и определяет условия триггера для каждого масштаба.
  essence: |
    Система реактивных событий связывает активность игроков с динамическими изменениями мира через накопление 
    активности, пороги активации и каскадные эффекты. События масштабируются от локальных до межпланетарных, 
    влияя на экономику, фракции, NPC и игровой опыт.
  key_points:
    - Определены шесть масштабов событий: локальный, городской, региональный, континентальный, планетарный, межпланетарный
    - Механика накопления активности игроков с временными окнами
    - Пороги активации для каждого масштаба с учетом количества игроков и типов действий
    - Интеграция с player-impact и world-events системами
    - Каскадные эффекты: локальные события могут триггерить события большего масштаба
    - Влияние на экономику, фракции, NPC и UI уведомления
content:
  sections:
    - id: concept_overview
      title: Концепция системы
      body: |
        Система реактивных глобальных событий позволяет миру игры реагировать на действия игроков, создавая 
        ощущение живого, динамичного мира. В отличие от запланированных событий (Live Events), реактивные события 
        возникают спонтанно в ответ на накопленную активность игроков, завершение ключевых квестов или достижение 
        коллективных целей.
        
        Система работает по принципу накопления "вклада" игроков в различные категории активности. Когда вклад 
        достигает порога для определенного масштаба, активируется соответствующее событие. События могут каскадно 
        влиять друг на друга: локальное событие может создать условия для городского, городское - для регионального 
        и так далее.
      mechanics_links:
        - mechanics/world/world-state/player-impact-systems.yaml
        - mechanics/world/events/live-events-system.yaml
      assets: []
    
    - id: event_scales
      title: Масштабы событий
      body: |
        ## Локальный (District) - Масштаб: 1
        
        Влияние: район города, несколько кварталов (например, Watson, Heywood, Pacifica в Night City)
        
        Примеры событий:
        - Восстание банды в районе
        - Технологический сбой в локальной сети
        - Открытие нового торгового центра
        - Экологическая катастрофа в районе
        
        Порог активации: 50-100 активных игроков в районе, 1000+ действий определенного типа за 24 часа
        
        ## Городской (City) - Масштаб: 2
        
        Влияние: весь город (Night City, London, Tokyo, Moscow и т.д.)
        
        Примеры событий:
        - Корпоративная война между Arasaka и Militech
        - Массовые протесты против корпораций
        - Технологический прорыв в городе
        - Кризис инфраструктуры
        
        Порог активации: 500-1000 активных игроков в городе, 10000+ действий определенного типа за 48 часов
        
        ## Региональный (Country/Region) - Масштаб: 3
        
        Влияние: страна или крупный регион (Калифорния, Великобритания, Япония, Россия и т.д.)
        
        Примеры событий:
        - Политический кризис в регионе
        - Экономический бум или рецессия
        - Военный конфликт между странами
        - Технологическая революция
        
        Порог активации: 2000-5000 активных игроков в регионе, 50000+ действий определенного типа за 72 часа
        
        ## Континентальный (Continent) - Масштаб: 4
        
        Влияние: весь континент (Северная Америка, Европа, Азия, СНГ и т.д.)
        
        Примеры событий:
        - Континентальный торговый договор
        - Массовая миграция населения
        - Континентальная война
        - Глобальная технологическая сеть
        
        Порог активации: 10000-20000 активных игроков на континенте, 200000+ действий определенного типа за 7 дней
        
        ## Планетарный (Planetary) - Масштаб: 5
        
        Влияние: вся планета Земля
        
        Примеры событий:
        - Падение Blackwall
        - Глобальная пандемия
        - Планетарный энергетический кризис
        - Объединение корпораций в мега-конгломерат
        
        Порог активация: 50000+ активных игроков глобально, 1000000+ действий определенного типа за 14 дней
        
        ## Межпланетарный (Interplanetary) - Масштаб: 6
        
        Влияние: другие планеты, колонии, космические станции (Марс, Луна, орбитальные станции)
        
        Примеры событий:
        - Открытие новой колонии на Марсе
        - Космическая война за ресурсы
        - Контакт с внеземной цивилизацией
        - Технологический прорыв в космических путешествиях
        
        Порог активации: 10000+ активных игроков на других планетах, 500000+ действий определенного типа за 30 дней
      mechanics_links:
        - mechanics/world/events/world-events-framework.yaml
      assets: []
    
    - id: activity_accumulation
      title: Механика накопления активности
      body: |
        Система отслеживает различные типы активности игроков и накапливает "вклад" в категории событий:
        
        ## Категории активности
        
        ### Боевая активность
        - Убийства врагов (NPC и игроков)
        - Завершение рейдов
        - Победы в PvP
        - Захват территорий
        
        ### Экономическая активность
        - Торговля предметами
        - Производство ресурсов
        - Завершение экономических контрактов
        - Инвестиции в корпорации
        
        ### Социальная активность
        - Завершение квестов
        - Взаимодействие с NPC
        - Изменение репутации фракций
        - Участие в социальных событиях
        
        ### Технологическая активность
        - Взломы систем
        - Установка имплантов
        - Исследования технологий
        - Создание киберпространственных артефактов
        
        ## Временные окна
        
        Активность накапливается в скользящих временных окнах:
        - Локальные события: 24 часа
        - Городские события: 48 часов
        - Региональные события: 72 часа
        - Континентальные события: 7 дней
        - Планетарные события: 14 дней
        - Межпланетарные события: 30 дней
        
        ## Веса действий
        
        Разные действия имеют разные веса вклада:
        - Завершение ключевого квеста: 100 очков
        - Завершение обычного квеста: 10 очков
        - Убийство босса: 50 очков
        - Торговля на сумму >100K: 20 очков
        - Изменение репутации фракции: 5 очков
        
        ## Пороги активации
        
        Пороги комбинируют:
        - Количество уникальных игроков, внесших вклад
        - Общее количество очков активности
        - Географическое распределение активности
        - Тип активности (боевая, экономическая, социальная, технологическая)
      mechanics_links:
        - mechanics/world/world-state/player-impact-systems.yaml
      assets: []
    
    - id: trigger_conditions
      title: Условия триггера событий
      body: |
        События активируются при выполнении комбинации условий:
        
        ## Базовые условия
        
        1. **Порог активности**: накоплено достаточно очков активности в категории
        2. **Минимальное количество игроков**: участвовало минимальное количество уникальных игроков
        3. **Географическое распределение**: активность распределена по нужной территории
        4. **Временное окно**: активность накоплена в пределах временного окна
        
        ## Дополнительные условия
        
        - **Квестовые триггеры**: завершение определенных ключевых квестов может напрямую триггерить события
        - **Фракционные условия**: определенные фракции должны иметь определенный уровень влияния
        - **Экономические условия**: экономические показатели должны быть в определенном диапазоне
        - **Технологические условия**: определенные технологии должны быть доступны
        
        ## Каскадные эффекты
        
        Локальное событие может создать условия для городского:
        - Если локальное событие длится >48 часов и накоплено достаточно активности
        - Если локальное событие влияет на несколько районов города
        
        Аналогично, городское может триггерить региональное, региональное - континентальное и т.д.
      mechanics_links:
        - mechanics/world/events/world-events-framework.yaml
      assets: []
    
    - id: event_effects
      title: Эффекты событий
      body: |
        События влияют на различные системы игры:
        
        ## Экономические эффекты
        
        - Изменение цен на ресурсы
        - Доступность предметов
        - Новые торговые маршруты
        - Экономические санкции или бонусы
        
        ## Фракционные эффекты
        
        - Изменение влияния фракций
        - Новые союзы или конфликты
        - Изменение поведения NPC фракций
        - Доступность фракционных контрактов
        
        ## Игровые эффекты
        
        - Новые квесты и контракты
        - Изменение сложности контента
        - Новые локации или доступ к локациям
        - Временные модификаторы (баффы/дебаффы)
        
        ## Социальные эффекты
        
        - Изменение репутации игроков
        - Новые социальные активности
        - Изменение NPC диалогов и поведения
        - События в социальных сетях игры
      mechanics_links:
        - mechanics/economy/economy-resources-catalog.yaml
        - mechanics/world/world-bosses-catalog.yaml
      assets: []
    
    - id: integration
      title: Интеграция с существующими системами
      body: |
        ## Player Impact Systems
        
        Система реактивных событий расширяет player-impact-systems:
        - События `QuestChoiceMade` могут триггерить накопление активности
        - События `WorldStateChange` могут активировать реактивные события
        - События `NpcFateChange` могут влиять на пороги активации
        
        ## World Events System
        
        Реактивные события интегрируются с архитектурой мировых событий:
        - Используют Event Scale Manager для определения масштаба
        - Используют Event Effects Coordinator для применения эффектов
        - Используют Event Communication Manager для уведомлений
        
        ## Global State Events
        
        Реактивные события публикуют события в global-state:
        - `REACTIVE_EVENT_TRIGGERED` - событие активировано
        - `REACTIVE_EVENT_PROGRESS` - прогресс накопления активности
        - `REACTIVE_EVENT_COMPLETED` - событие завершено
        
        ## Analytics Service
        
        Система отслеживает метрики:
        - Скорость накопления активности по масштабам
        - Частота активации событий
        - Влияние событий на retention и engagement
        - Эффективность каскадных эффектов
      mechanics_links:
        - mechanics/world/world-state/player-impact-systems.yaml
        - implementation/architecture/world-events-system-architecture.yaml
        - implementation/global-state/global-state-events.yaml
      assets: []
    
    - id: examples
      title: Примеры событий
      body: |
        ## Локальный масштаб: Восстание в Watson
        
        **Триггер**: 1000+ убийств бандитов в районе Watson за 24 часа, 50+ уникальных игроков
        
        **Эффекты**:
        - Увеличение патрулей NCPD в районе
        - Новые квесты на очистку района
        - Снижение цен на оружие в районе
        - Увеличение репутации с NCPD для участников
        
        **Каскад**: Если событие длится >48 часов, может триггерить городское событие "Кризис безопасности в Night City"
        
        ## Городской масштаб: Корпоративная война Arasaka vs Militech
        
        **Триггер**: 10000+ боевых действий против корпоративных сил, 500+ уникальных игроков в Night City за 48 часов
        
        **Эффекты**:
        - Блокпосты корпораций в городе
        - Новые PvP зоны
        - Изменение цен на импланты и оружие
        - Новые корпоративные контракты
        - Изменение репутации с корпорациями
        
        **Каскад**: Может триггерить региональное событие "Корпоративная война в Калифорнии"
        
        ## Региональный масштаб: Экономический кризис в Европе
        
        **Триггер**: 50000+ экономических транзакций с убытком, 2000+ уникальных игроков в Европе за 72 часа
        
        **Эффекты**:
        - Снижение цен на все ресурсы в регионе
        - Новые экономические квесты
        - Изменение курсов валют
        - Миграция NPC и игроков
        - Новые торговые возможности
        
        ## Планетарный масштаб: Падение Blackwall
        
        **Триггер**: 1000000+ взломов в киберпространстве, 50000+ уникальных игроков глобально за 14 дней
        
        **Эффекты**:
        - Глобальная нестабильность сетей
        - Новые опасности в киберпространстве
        - Изменение доступности технологий
        - Глобальные квесты на восстановление
        - Изменение баланса сил корпораций
        
        ## Межпланетарный масштаб: Открытие колонии на Марсе
        
        **Триггер**: 500000+ исследовательских действий, 10000+ уникальных игроков на Марсе за 30 дней
        
        **Эффекты**:
        - Новая игровая зона на Марсе
        - Новые ресурсы и технологии
        - Новые фракции и NPC
        - Космические путешествия
        - Межпланетарная торговля
      mechanics_links:
        - mechanics/world/events/global-events-2020-2093.yaml
      assets: []
    
    - id: ui_notifications
      title: UI и уведомления
      body: |
        ## Индикаторы прогресса
        
        - Прогресс-бар накопления активности для каждого масштаба
        - Карта мира с визуализацией зон активности
        - Список активных реактивных событий
        - История завершенных событий
        
        ## Уведомления
        
        - Уведомление при достижении 50% порога активации
        - Уведомление при активации события
        - Уведомление о вкладе игрока в событие
        - Уведомление о завершении события и наградах
        
        ## Новости и лор
        
        - Новостные ленты о событиях в мире
        - Диалоги NPC о текущих событиях
        - Изменение атмосферы локаций
        - Временные визуальные эффекты
      mechanics_links:
        - mechanics/world/events/live-events-system.yaml
      assets: []
    
    - id: open_questions
      title: Вопросы для проработки
      body: |
        - Как балансировать частоту активации событий разных масштабов?
        - Как предотвратить злоупотребление системой (фарм активности)?
        - Как обрабатывать конфликты между реактивными и запланированными событиями?
        - Как масштабировать систему на большое количество игроков?
        - Как обеспечить справедливость вклада игроков разных уровней?
        - Как интегрировать с системой лиг и соревнований?
        - Как обрабатывать события на разных серверах/регионах?
      mechanics_links: []
      assets: []
appendix:
  glossary:
    - term: Реактивное событие
      definition: Событие, активируемое действиями игроков, а не по расписанию
    - term: Порог активации
      definition: Комбинация условий, при которой активируется событие
    - term: Каскадный эффект
      definition: Механика, где событие меньшего масштаба может триггерить событие большего масштаба
    - term: Временное окно
      definition: Период времени, в течение которого накапливается активность для события
  references:
    - type: internal
      link: mechanics/world/world-state/player-impact-systems.yaml
    - type: internal
      link: implementation/architecture/world-events-system-architecture.yaml
    - type: internal
      link: mechanics/world/events/live-events-system.yaml
  decisions: []
implementation:
  github_issue: 1454
  needs_task: true
  queue_reference:
    - shared/trackers/queues/concept/queued.yaml#analysis-ideas-2025-01-reactive-world-events
  blockers: []
history:
  - version: '0.1.0'
    date: 2025-01-XX
    author: idea-writer
    changes: Создана концепция системы реактивных глобальных событий с масштабированием
validation:
  checksum: ''
  schema_version: '1.0'























