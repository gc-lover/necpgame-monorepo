# Issue: #1505
metadata:
  id: idea-difficulty-rating-system-2025-12-12
  title: Система рейтинга сложности и авто-подстройки
  document_type: idea
  category: gameplay
  status: draft
  version: "0.1.0"
  last_updated: 2025-12-12T09:00:00Z
  github_issue_number: 1505
  owners:
    - role: idea_writer
      contact: ideas@necp.game
  tags:
    - gameplay
    - dynamic-difficulty
    - matchmaking
    - analytics
  related_systems:
    - gameplay-service
    - matchmaking-service
    - analytics-service
    - leaderboard-service
  related_documents:
    - id: progression-classes
      title: Classes Overview
      link: mechanics/progression/classes-overview.yaml
      relation: depends_on

summary:
  problem: Игроки получают несоответствующую сложность; нет прозрачного рейтинга контента.
  goal: Автоматически подстраивать сложность под навыки команды, давать рекомендации и рейтинговать контент.
  pillars:
    - Skill Rating игрока и команды на основе телеметрии.
    - Difficulty Rating контента (Easy/Medium/Hard/Extreme) с данными прохождений.
    - Рекомендации и авто-тюнинг параметров в пределах допустимых рамок.

skill_rating_model:
  inputs:
    - kpi: damage_out_per_sec, healing_per_sec, mitigation, deaths, avoidable_hits
    - context: роль, состав группы, уровень контента, аффиксы
    - outcomes: успех/вайп, время прохождения, ресурсы
  scoring:
    - base: MMR-like, обновление после каждого прохождения
    - decay: -5% за 2 недели неактивности в высоком уровне
    - roles: отдельные кривые для tank/dps/support/hacker
  outputs:
    - player_skill_score: 0..5000
    - team_skill_band: T1..T5 (кластеры для матчмейкинга)

difficulty_rating_content:
  buckets:
    - Easy: высокие шансы успеха T1-T2
    - Medium: таргет для T2-T3
    - Hard: таргет для T3-T4
    - Extreme: для T4-T5, ручная валидация
  metrics:
    - success_rate, avg_time, wipe_zones
    - per-affix deltas для M+ и seasonal
  publication:
    - UI маркеры сложности в очередях/лидербордах
    - предупреждения при несоответствии скилла и очереди

auto_tuning:
  knobs:
    - hp/damage scaling (±15%)
    - add_spawn_rate (±10%)
    - mechanic_timeout (±10%)
  constraints:
    - фиксированные брейкпоинты для fairness
    - запрет на смену механик; только числа
  flow:
    - предварительный подбор сложности по team_skill_band
    - live-adjust в первые 2 механики (soft)
    - заморозка параметров после середины боя

recommendations:
  surfaces:
    - pre-queue: рекомендуем диапазон сложности и рольные требования
    - post-run: совет по улучшению (умирал от АоЕ → учи механику X)
    - weekly: предложение контента для роста рейтинга
  rewards_alignment:
    - бонус за «правильный матч» (skill ↔ difficulty) +10-20% валюты
    - штраф за owergear/underskill фарм

risks_and_mitigations:
  - risk: Смурфинг и манипуляции рейтингом.
    mitigation: detection всплесков, флажок «probation» для резких спадов/ростов.
  - risk: Непрозрачность авто-тюнинга.
    mitigation: UI уведомление об активных модификаторах и причинах.
  - risk: Переусложнение матча.
    mitigation: жёсткие пределы регулировок и ручные профили для рейдов.

handoff:
  target_agent: Architect
  rationale: нужна детализация сервисов, контрактов и формул балансировки.

