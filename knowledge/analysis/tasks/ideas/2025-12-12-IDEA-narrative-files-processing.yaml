# Issue: none
metadata:
  id: idea-narrative-files-processing
  title: Narrative - обработка файлов
  document_type: analysis
  category: narrative
  status: in-progress
  version: '0.1.0'
  last_updated: 2025-12-12T17:55:00Z
  concept_approved: false
  concept_reviewed_at: ''
  processed_by: idea-writer
  processed_at: 2025-12-12T17:55:00Z
  github_issue_number: null
  owners:
    - role: narrative
      contact: narrative@necp.game
  tags:
    - narrative
    - files
    - pipeline
  topics:
    - lore
    - pipelines
  related_systems:
    - world-service
    - social-service
    - analytics-service
    - auth-service
  visibility: internal
  audience:
    - design
    - narrative
    - analytics
  risk_level: low
summary:
  problem: Требуется описать, как обрабатывать narrative-файлы (лоры/диалоги) без привязки к issue.
  goal: Дать минимальные шаги по приёму, валидации, аннотации и маршрутизации файлов.
  essence: Файлы проходят схему: загрузка → проверка формата → аннотации метаданных → логирование → маршрутизация в контент/мир/аудио.
content:
  sections:
    - id: intake
      title: Приём и форматы
      body: |
        - Поддержка: .md/.yaml/.json, кодировка UTF-8, max 1MB.
        - Требуемые поля: title, locale (ru/en), type (dialogue/lore/log), source (npc/device/location).
    - id: validation
      title: Валидация
      body: |
        - Схема: проверка полей, длины (≤1200 слов), отсутствие запрещённых тегов.
        - Авто-лог: filename, hash, uploader_id, timestamp.
    - id: annotation
      title: Аннотации
      body: |
        - Теги: локация, персонаж, эпоха, эмоциональный тон.
        - Маркеры spoiler/age_rating, флаг сетевых упоминаний (Blackwall/корп/фракции).
    - id: routing
      title: Маршрутизация
      body: |
        - Диалоги → контент-пайплайн для озвучки/субтитров.
        - Лор-логи → мир/устройства (терминалы, артефакты).
        - Отчёты/лог-файлы → аналитика/события мира.
    - id: telemetry
      title: Телеметрия
      body: |
        - События: narrative_upload, narrative_validate, narrative_route.
        - Поля: file_id, type, locale, tags, route, validation_errors.
history:
  - version: '0.1.0'
    date: 2025-12-12
    author: idea-writer
    changes: Черновик пайплайна приема/валидации/маршрутизации narrative-файлов.
validation:
  checksum: ''
  schema_version: '1.0'

