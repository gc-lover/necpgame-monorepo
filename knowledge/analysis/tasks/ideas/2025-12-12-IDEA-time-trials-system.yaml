# Issue: #1508
metadata:
  id: idea-time-trials-system-2025-12-12
  title: Система временных испытаний (Time Trials)
  document_type: idea
  category: gameplay
  status: in_progress
  version: "0.1.0"
  last_updated: 2025-12-12T09:00:00Z
  github_issue_number: 1508
  owners:
    - role: idea_writer
      contact: ideas@necp.game
  tags:
    - time-trials
    - competitive
    - leaderboards
    - hardcore
  related_systems:
    - gameplay-service
    - leaderboard-service
    - achievement-service
    - notification-service
    - analytics-service
  related_documents:
    - id: leaderboard-models
      title: Leaderboard Service Models
      link: services/leaderboard-service-go/models/leaderboard.go
      relation: depends_on
    - id: seasonal-challenges
      title: Seasonal Challenges System
      link: knowledge/analysis/tasks/ideas/2025-12-12-IDEA-seasonal-challenges-system.yaml
      relation: complements

summary:
  problem: Нет соревновательной гонки на время с устойчивыми лидербордами и наградами.
  goal: Дать speedrun-режимы для рейдов/подземелий с weekly/seasonal лидербордами и наградами.
  pillars:
    - Speedrun Raids, Time Attack Dungeons, Weekly Time Challenges.
    - Многослойные лидерборды (глобальные, по классам, по командам, сезонные).
    - Награды за рекорды и участие, телеметрия для анти-чит валидации.

trial_types:
  speedrun_raids:
    rules:
      - старт с входа в инстанс, стоп при смерти финального босса
      - разрешены оптимизации маршрута, запрещены эксплойты/читы
    leaderboards: global / class / team / seasonal
    rewards:
      - топ-1: титул "Speedrun Champion", эксклюзивная косметика
      - топ-10: титул "Speedrun Master", редкая косметика
      - топ-100: титул "Speedrunner", бонусные награды
  time_attack_dungeons:
    thresholds:
      - bronze: base_time × 1.50, +10% награды
      - silver: base_time × 1.25, +25%
      - gold: base_time × 1.00, +50%
      - platinum: base_time × 0.75, +100% + уникальный предмет
    rewards: временные бафы, моды, косметика
  weekly_time_challenges:
    modes: solo / team / class-locked
    rewards: сезонная валюта, титулы, эксклюзивные предметы

leaderboards:
  storage:
    - realtime обновление для активных испытаний
    - история 30 дней (глобальные), весь сезон (seasonal)
  metrics:
    - clear_time
    - deaths
    - abilities_used / route_heatmap (для анти-чит)
  validation:
    - серверный таймер, проверка телеметрии
    - повторное воспроизведение ключевых событий (ghost)
    - флаги подозрительных забегов → ручная модерация

flows:
  start:
    - POST /gameplay/time-trials/start (тип, партия, состав)
    - выдача session_id, старт таймера
  complete:
    - POST /gameplay/time-trials/complete (session_id, clear_time, метрики)
    - push в leaderboard-service и achievement-service
  weekly_rotation:
    - новые испытания каждый понедельник
    - сброс еженедельных лидербордов, сезонные остаются

risks_and_mitigations:
  - risk: Эксплойты маршрутов.
    mitigation: telemetry heatmaps, ручная модерация топов, патчи маршрутов.
  - risk: Читерство таймера.
    mitigation: серверный отсчёт, сверка пакетов, воспроизведение ghost.
  - risk: Усталость игроков.
    mitigation: weekly ротация модов/аффиксов, награды за участие.

handoff:
  target_agent: Architect
  rationale: требуется проектирование сервисов, API и анти-чит логики.
# Issue: #1508
metadata:
  id: analysis-ideas-2025-12-12-time-trials-system
  title: Система временных испытаний (Time Trials)
  document_type: analysis
  category: gameplay
  status: draft
  version: '0.1.0'
  last_updated: 2025-12-12T00:00:00Z
  concept_approved: false
  concept_reviewed_at: ''
  processed_by: idea-writer
  processed_at: 2025-12-12T00:00:00Z
  github_issue_number: 1508
  owners:
    - role: concept_director
      contact: concept@necp.game
  tags:
    - time-trial
    - leaderboard
    - speedrun
    - competitive
  topics:
    - gameplay
    - liveops
    - analytics
  related_systems:
    - gameplay-service
    - leaderboard-service
    - achievement-service
    - telemetry
  related_documents: []
  source: knowledge/analysis/tasks/ideas/2025-12-12-IDEA-time-trials-system.yaml
  visibility: internal
  audience:
    - concept
    - gameplay
    - analytics
  risk_level: medium
review:
  chain:
    - role: concept_director
      reviewer: ''
      reviewed_at: ''
      status: pending
  next_actions: []
summary:
  problem: Нет соревновательных режимов на скорость с лидербордами и наградами.
  goal: Задать ядро Time Trials с типами испытаний, наградами, валидацией и метриками.
  essence: Спидран рейдов/подземелий, еженедельные челленджи, лидерборды и анти-чит поток.
  key_points:
    - Три режима: Speedrun Raids, Time Attack Dungeons, Weekly Challenges.
    - Лидерборды (solo/party/class/season), валидация попыток, анти-чит.
    - Награды: титулы, косметика, сезонная валюта; расписание на неделю.
content:
  sections:
    - id: modes
      title: Режимы
      body: |
        - Speedrun Raids: время от входа до убийства босса; допускает маршрутизацию и хаки, но проверяется валидатором.
        - Time Attack Dungeons: Bronze/Silver/Gold/Platinum по порогам 1.5x/1.25x/1.0x/0.75x базового таймера.
        - Weekly Challenges: solo и party задания с фиксированным модификатором недели; обновление каждую пятницу.
      mechanics_links: []
      assets: []
    - id: rewards
      title: Награды и прогрессия
      body: |
        - Титулы: Champion/Master/Runner (по глобальным позициям).
        - Косметика: шейдеры и баннеры за топ-N; сезонная валюта для магазина.
        - Повторяемость: участие даёт токены участия; рекорд — бонусный токен.
      mechanics_links: []
      assets: []
    - id: validation
      title: Валидация и анти-абуз
      body: |
        - Серверное время, запись инвентаря/баффов, проверка телепортов и аномальных скоростей.
        - Автокик попытки при десинхроне >3 сек или при невозможных координатах.
        - Ограничения попыток: 5 в сутки на рейд, 10 на подземелья; weekly — 3 free retries.
      mechanics_links: []
      assets: []
    - id: telemetry
      title: Метрики
      body: |
        - Успешные попытки, % фейлов по причинам (десинхрон, нарушение правил).
        - Среднее время по режимам, 95-й перцентиль, распределение по классам/пати.
        - Конверсия участие→награда; удержание D1/D7 у участников; новый рекорд события.
      mechanics_links: []
      assets: []
    - id: integrations
      title: Интеграции
      body: |
        - gameplay-service: таймеры, правила, детект нарушений.
        - leaderboard-service: ранги, сезонные таблицы, истории 30 дней.
        - achievement-service: титулы и уведомления; telemetry: события попыток.
      mechanics_links: []
      assets: []
appendix:
  glossary: []
  references: []
  decisions: []
implementation:
  github_issue: 1508
  needs_task: false
  queue_reference: []
  blockers: []
history:
  - version: '0.1.0'
    date: 2025-12-12
    author: idea-writer
    changes: Черновик системы Time Trials с режимами, наградами и анти-абузом.
validation:
  checksum: ''
  schema_version: '1.0'

