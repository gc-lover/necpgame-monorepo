<!-- Issue: #142076215 -->

# Система сбора статистики и балансировки боевых механик

## Обзор

Единый контур телеметрии боя (PvE/PvP) для балансировки оружия, перков и акробатики. Цель — предсказуемые метрики, быстрые итерации баланса, защита от абьюза и дашборды для дизайнеров.

## Ключевые цели
- Сбор: урон/попадания/спред/TTK/DTK, использования перков и движений.
- Анализ: перк-шейпы, outlier-оружие, карты тепла по вертикальным слоям.
- Реакция: быстрая корректировка весов/множителей, эксперименты через фичфлаги.
- Безопасность: анти-бот сигнатуры, фильтрация чит-трафика.

## Данные и метрики
- Бой: TTK/DTK, DPS по броне/щиту/плоти, HS rate, крит, stagger uptime.
- Движение: скорость, высота, Wall Run длина, Slide частота, падения/самоурон.
- Оружие: спред, отдача, урон/пуля, точность на дистанциях, моды.
- Перки/импланты: частота активаций, средняя ценность (ΔDPS/ΔTTK), синергии.
- Контекст: слой высоты, биом, время суток, пинг, платформа.

## Цикл работы
1) Сбор сырых событий (kill, hit, miss, ability_use, move_state).  
2) Агрегации: пер-сессия, пер-матч, пер-оружие/пер-перк.  
3) Аналитика: детект выбросов, перцентильные кривые, корреляции.  
4) Тюнинг: таблицы баланса (CSV/FeatureFlag), A/B слоты.  
5) Валидация: контрольные матчи, сравнение с целевыми KPI.  
6) Деплой: включение/откат через фичфлаг, мониторинг регрессий.

## Награды / геймплейные связи
- Бонус XP за участие в тестовых плейлистах; косметика «Balance Tester».
- Ограниченные баффы при участии в A/B (косметические, не боевые).

## Анти-абьюз и фильтрация
- Детект аномалий: сверхнизкий TTK, сверхточность, повторяющийся ввод.
- Сигнатуры анти-бот: темп кликов, нереалистичные траектории, идеальная реакция.
- Фильтр: исключение подозрительных сессий из баланс-агрегатов.

## Метрики успеха
- Воронка: собранные события → чистые события → отчёты → принятые изменения.
- Баланс: отклонение TTK/DTK от целевых ±X%; доля оружия в мета < Y%.
- Качество: задержка данных < 5 мин, ошибка агрегации <1%.
- Игроки: участие в плейлистах баланс-теста, удовлетворённость (NPS), жалобы на несправедливость.

## Интеграции
- Telemetry/Analytics service, Combat service, Movement, Perk/Implant, Feature Flags, Anti-cheat.

## История
- v0.1.0 (2025-12-12, idea_writer): Черновик контура сбора/аналитики/тюнинга, метрики, анти-абьюз.

