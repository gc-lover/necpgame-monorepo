<!-- Issue: #1335 -->

# Система обратной связи от игроков: in-game форма для создания Issues

## Лор и атмосфера

В мире 2077 года корпорации постоянно собирают обратную связь от граждан для улучшения своих продуктов и услуг. Система обратной связи представлена как "Корпоративный канал связи" или "Система обращений к администрации" - высокотехнологичный интерфейс, позволяющий игрокам напрямую взаимодействовать с разработчиками через игровой мир.

Визуальный стиль системы отражает киберпанк-эстетику: неоновые элементы интерфейса, голографические эффекты, цифровые анимации передачи данных. Игроки могут отправлять обращения через терминалы в игровом мире или через интерфейс персонажа, создавая ощущение интеграции с цифровым миром.

## Основные концепции

### Проблема

В настоящее время игроки не имеют возможности напрямую из игры отправлять предложения, идеи и пожелания разработчикам. Вся обратная связь происходит через внешние каналы (Discord, форумы, email), что создает барьер для игроков и усложняет сбор и обработку обратной связи.

### Цель

Создать интегрированную систему обратной связи, которая позволяет игрокам:
- Отправлять предложения, идеи и пожелания прямо из игры
- Видеть статус своих предложений
- Получать уведомления о рассмотрении предложений
- Автоматически создавать GitHub Issues для обработки предложений агентами

## Компоненты системы

### 1. In-Game UI форма (UE5)

**Визуальный дизайн:**
- Cyberpunk стиль интерфейса с неоновыми элементами
- Модальное окно, доступное через меню игры или горячую клавишу (например, F12)
- Адаптивный дизайн для разных разрешений экрана

**Поля формы:**
- **Тип обращения:**
  - Предложение/Идея (feature request)
  - Баг репорт (bug report)
  - Пожелание (wishlist)
  - Вопрос/Обратная связь (feedback)
  
- **Категория:**
  - Геймплей (gameplay)
  - Баланс (balance)
  - Контент (content)
  - Техническое (technical)
  - Лор/Сюжет (lore/narrative)
  - UI/UX
  - Другое (other)

- **Заголовок** (обязательное, до 100 символов)
- **Описание** (обязательное, до 2000 символов, многострочное)
- **Приоритет** (опционально, для игрока):
  - Низкий
  - Средний
  - Высокий
  - Критический

- **Скриншоты/Видео** (опционально, до 3 файлов)
- **Контекст игры** (автоматически собирается):
  - Версия игры
  - Локация игрока
  - Уровень персонажа
  - Активные квесты
  - Время в игре

**UX механики:**
- Автосохранение черновика при закрытии формы
- Валидация полей перед отправкой
- Анимация отправки (прогресс бар)
- Подтверждение успешной отправки
- История отправленных обращений (локальная)

### 2. Бекенд сервис (Go)

**Новый микросервис: `feedback-service`**

**Основные функции:**
- Прием данных от клиента через REST API
- Валидация и санитизация данных
- Сохранение обращений в БД
- Интеграция с GitHub API для создания Issues
- Управление статусами обращений
- Уведомления игрокам о статусе

**API Endpoints:**
- `POST /api/v1/feedback/submit` - создание обращения
- `GET /api/v1/feedback/{id}` - получение обращения по ID
- `GET /api/v1/feedback/player/{player_id}` - история обращений игрока
- `POST /api/v1/feedback/{id}/update-status` - обновление статуса
- `GET /api/v1/feedback/board` - доска идей (публичные предложения)
- `POST /api/v1/feedback/{id}/vote` - голосование за предложение
- `DELETE /api/v1/feedback/{id}/vote` - отзыв голоса
- `GET /api/v1/feedback/stats` - статистика обращений

**Интеграция с GitHub:**
- Использование GitHub API для создания Issues
- Автоматическое добавление меток на основе категории
- Создание Issue с шаблоном, включающим:
  - Данные игрока (анонимизированные)
  - Контекст игры
  - Скриншоты (если есть)
  - Ссылка на обращение в БД

**Метки для Issues:**
- `player-feedback` - все обращения от игроков
- `agent:idea-writer` - для идей и предложений
- `agent:qa` - для баг репортов
- `priority-*` - на основе приоритета
- Категория (например, `gameplay`, `balance`, `content`)

### 3. Агент для обработки предложений

**Новый агент или расширение Idea Writer: `agent:player-feedback`**

**Ответственность:**
- Мониторинг Issues с меткой `player-feedback`
- Классификация обращений по типу
- Первичная обработка и структурирование
- Маршрутизация к соответствующим агентам:
  - Идеи → `agent:idea-writer`
  - Баги → `agent:qa`
  - Баланс → `agent:game-balance`
  - Техническое → `agent:backend` или `agent:ue5`
- Обновление статусов обращений
- Уведомление игроков о рассмотрении

**Workflow обработки:**
1. Агент получает новое обращение (Issue с `player-feedback`)
2. Анализирует тип и категорию
3. Структурирует информацию
4. Добавляет соответствующие метки
5. Передает соответствующему агенту
6. Отслеживает прогресс обработки
7. Обновляет статус в БД и уведомляет игрока

## Интеграции

- **GitHub API** - создание Issues
- **Character Service** - получение данных игрока
- **Session Service** - валидация сессии
- **Notification Service** - уведомления игрокам

## Безопасность

- Rate limiting для предотвращения спама
- Валидация данных на клиенте и сервере
- Анонимизация данных игрока в Issues
- Аутентификация через игровую сессию

## Приоритет

**High** - система обратной связи критична для развития игры и вовлечения сообщества

## Связанные системы

- **GitHub Issues** - автоматическое создание Issues из обращений
- **Notification System** - уведомления игрокам о статусе
- **Character System** - получение данных игрока
- **Session System** - валидация сессии

