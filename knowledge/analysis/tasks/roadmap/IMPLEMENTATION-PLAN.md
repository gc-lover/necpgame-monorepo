# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤ –¥–ª—è NECPGAME

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

OK **–ó–∞–≤–µ—Ä—à–µ–Ω–æ (v0.1 Tech Demo)**:
- –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (Docker Compose)
- Go —Å–µ—Ä–≤–∏—Å—ã: inventory, character, movement
- WebSocket Gateway –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è
- UE5 –∫–ª–∏–µ–Ω—Ç —Å –±–∞–∑–æ–≤—ã–º –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ–º

‚è≥ **–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø (v0.2 MVP Foundation)**:
- Auth Integration –≤ character-service
- Economy Service
- UE5 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
- Gameplay Service

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –° —á–µ–≥–æ –Ω–∞—á–∞—Ç—å

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: Auth Integration –≤ character-service (2-3 –¥–Ω—è)**

–≠—Ç–æ –ª–æ–≥–∏—á–Ω—ã–π —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥, –ø–æ—Ç–æ–º—É —á—Ç–æ:
1. OK Keycloak —É–∂–µ –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
2. OK character-service —É–∂–µ –∏–º–µ–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `KEYCLOAK_URL`
3. OK realtime-gateway-go —É–∂–µ –∏–º–µ–µ—Ç JWT –≤–∞–ª–∏–¥–∞—Ü–∏—é (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –ø—Ä–∏–º–µ—Ä)
4. OK –ë–µ–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–µ–ª—å–∑—è –±–µ–∑–æ–ø–∞—Å–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å API

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å**:
1. –°–æ–∑–¥–∞—Ç—å `server/auth.go` —Å JWT –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ Keycloak JWKS
2. –î–æ–±–∞–≤–∏—Ç—å middleware `authMiddleware` –≤ HTTP —Å–µ—Ä–≤–µ—Ä
3. –ó–∞—â–∏—Ç–∏—Ç—å endpoints (POST /api/v1/accounts, POST /api/v1/characters)
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º JWT —Ç–æ–∫–µ–Ω–æ–º –æ—Ç Keycloak

## üìù –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω

### –≠—Ç–∞–ø 1: Auth Integration (2-3 –¥–Ω—è)

**–î–µ–Ω—å 1**:
- –ò–∑—É—á–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é JWT –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ realtime-gateway-go
- –°–æ–∑–¥–∞—Ç—å `server/auth.go` –¥–ª—è character-service
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Keycloak JWKS –∫–ª–∏–µ–Ω—Ç
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å JWT –≤–∞–ª–∏–¥–∞—Ü–∏—é

**–î–µ–Ω—å 2**:
- –î–æ–±–∞–≤–∏—Ç—å auth middleware –≤ HTTP —Å–µ—Ä–≤–µ—Ä
- –ó–∞—â–∏—Ç–∏—Ç—å API endpoints
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å curl/Postman

**–î–µ–Ω—å 3**:
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –≠—Ç–∞–ø 2: Economy Service (3-4 –¥–Ω—è)

**–î–µ–Ω—å 1-2**:
- –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ (economy-service-go)
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å repository –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏ –∫—Ä–∞—Ñ—Ç–∞
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å service —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π

**–î–µ–Ω—å 3**:
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å HTTP —Å–µ—Ä–≤–µ—Ä —Å REST API
- –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ Prometheus
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–î–µ–Ω—å 4**:
- Dockerfile –∏ docker-compose.yml
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –≠—Ç–∞–ø 3: UE5 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è (2-3 –¥–Ω—è)

**–î–µ–Ω—å 1**:
- –°–æ–∑–¥–∞—Ç—å REST API –∫–ª–∏–µ–Ω—Ç –¥–ª—è inventory-service
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –ø—Ä–∏ –≤—Ö–æ–¥–µ

**–î–µ–Ω—å 2**:
- –°–æ–∑–¥–∞—Ç—å UI –¥–ª—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è (HUD)
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º

**–î–µ–Ω—å 3**:
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥–º–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ GameState
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Auth Integration

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** (–¥–æ–±–∞–≤–∏—Ç—å –≤ go.mod):
```go
github.com/golang-jwt/jwt/v5 v5.2.0
github.com/lestrrat-go/jwx/v2 v2.1.0  // –¥–ª—è JWKS
```

**–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã**:
```go
// server/auth.go
type AuthMiddleware struct {
    validator *JwtValidator
}

func NewAuthMiddleware(keycloakURL string) *AuthMiddleware {
    jwksURL := keycloakURL + "/realms/necpgame/protocol/openid-connect/certs"
    return &AuthMiddleware{
        validator: NewJwtValidator(keycloakURL, jwksURL),
    }
}

func (m *AuthMiddleware) Middleware(next http.Handler) http.Handler {
    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞
        // ...
    })
}
```

### Economy Service

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**:
```
services/economy-service-go/
‚îú‚îÄ‚îÄ main.go
‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îú‚îÄ‚îÄ logger.go
‚îÇ   ‚îú‚îÄ‚îÄ metrics.go
‚îÇ   ‚îú‚îÄ‚îÄ economy_repository.go
‚îÇ   ‚îú‚îÄ‚îÄ economy_service.go
‚îÇ   ‚îî‚îÄ‚îÄ http_server.go
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ economy.go
‚îú‚îÄ‚îÄ Dockerfile
‚îî‚îÄ‚îÄ README.md
```

**API endpoints**:
- `POST /api/v1/trade/buy` - –ø–æ–∫—É–ø–∫–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
- `POST /api/v1/trade/sell` - –ø—Ä–æ–¥–∞–∂–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
- `POST /api/v1/craft` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
- `GET /api/v1/craft/recipes` - —Å–ø–∏—Å–æ–∫ —Ä–µ—Ü–µ–ø—Ç–æ–≤

## OK –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

### Auth Integration
- OK JWT –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Keycloak JWKS
- OK API endpoints –∑–∞—â–∏—â–µ–Ω—ã
- OK –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- OK –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

### Economy Service
- OK REST API —Ä–∞–±–æ—Ç–∞–µ—Ç
- OK –¢–æ—Ä–≥–æ–≤–ª—è –∏ –∫—Ä–∞—Ñ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- OK –ú–µ—Ç—Ä–∏–∫–∏ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞—é—Ç
- OK Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- OK –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

### UE5 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- OK –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—Ö–æ–¥–µ
- OK UI –¥–ª—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- OK –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ GameState —Ä–∞–±–æ—Ç–∞–µ—Ç
- OK –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ Go —Å–µ—Ä–≤–∏—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (logger, metrics, HTTP server)
- –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –ë–î —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏
- Redis —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- Keycloak —É–∂–µ –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üöÄ –ì–æ—Ç–æ–≤ –Ω–∞—á–∞—Ç—å?

–ü—Ä–µ–¥–ª–∞–≥–∞—é –Ω–∞—á–∞—Ç—å —Å **Auth Integration –≤ character-service**, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –æ—Å–Ω–æ–≤–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.










