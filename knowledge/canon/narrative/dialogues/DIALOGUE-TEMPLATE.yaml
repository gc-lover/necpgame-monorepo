metadata:
  id: canon-narrative-dialogue-template
  title: 'Шаблон диалогового файла'
  document_type: canon
  category: narrative
  status: approved
  version: '1.0.0'
  last_updated: 2025-11-11T00:00:00Z
  concept_approved: true
  concept_reviewed_at: 2025-11-07T17:45:00Z
  owners:
    - role: narrative_director
      contact: narrative@necp.game
  tags:
    - template
    - dialogue
  topics:
    - narrative
    - tooling
  related_systems:
    - narrative-service
  related_documents:
    - id: canon-narrative-dialogues-faction-social-lines
      relation: references
    - id: canon-narrative-dialogue-aisha-frost
      relation: complements
  source: shared/docs/knowledge/canon/narrative/dialogues/DIALOGUE-TEMPLATE.md
  visibility: internal
  audience:
    - narrative
    - systems-design
    - liveops
  risk_level: low
review:
  chain:
    - role: narrative_director
      reviewer: Brain Manager
      reviewed_at: 2025-11-07T17:45:00Z
      status: approved
  next_actions: []
summary:
  problem: Шаблон диалогов NPC/квестов существовал в Markdown и не был унифицирован в базе знаний.
  goal: Зафиксировать структуру состояний, узлов, проверок и API-контуров для создания диалогов.
  essence: Документ задаёт обязательные разделы, таблицы и YAML-блоки для описания сложных диалогов NECPGAME.
  key_points:
    - Форматы контекста, состояний и репутационных условий.
    - Структура узлов, D&D проверок и реакций на события.
    - Перечень связанных материалов и история изменений.
content:
  sections:
    - id: scope
      title: Контекст и цели шаблона
      body: |
        Шаблон описывает обязательные поля диалога (ID, тип, статус, приоритет), ожидаемый синопсис и интеграцию с
        системами репутации и world-state.
      mechanics_links: []
      assets: []
    - id: states
      title: Состояния и условия
      body: |
        Таблица состояний определяет описание, триггеры и используемые флаги. Указываются репутационные пороги,
        проверки D&D и связи с глобальными событиями.
      mechanics_links: []
      assets: []
    - id: structure
      title: Структура узлов
      body: |
        Диалоговые узлы оформляются в YAML с уникальными идентификаторами, условиями входа, опциями игрока и исходами.
        Рекомендовано фиксировать критические успехи и провалы.
      mechanics_links: []
      assets: []
    - id: checks
      title: Проверки и события
      body: |
        Таблица проверок фиксирует тип D&D, DC, модификаторы и последствия. Отдельный раздел описывает реакции на
        world events и изменения репутации.
      mechanics_links: []
      assets: []
    - id: references
      title: Связанные материалы
      body: |
        Шаблон перечисляет связанные документы: NPC лор, квесты, системы репутации, UI и технические спецификации для
        интеграции.
      mechanics_links: []
      assets: []
appendix:
  glossary: []
  references:
    - title: Reputation Formulas
      link: ../../02-gameplay/social/reputation-formulas.md
    - title: Dialogue System UI Spec
      link: ../../05-technical/ui/dialogue-system.md
  decisions: []
implementation:
  needs_task: false
  queue_reference:
    - shared/trackers/queues/concept/queued.yaml
  blockers: []
history:
  - version: '1.0.0'
    date: 2025-11-11
    author: narrative_team
    changes: Шаблон диалогового файла перенесён в YAML и дополнен ключевыми инструкциями.
validation:
  checksum: ''
  schema_version: '1.0'

