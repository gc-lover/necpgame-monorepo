# Issue: #109
metadata:
  id: narrative-coherence-player-impact-hybrid-system
  title: "Гибридная система влияния игроков на мир"
  document_type: canon
  category: narrative-coherence
  status: approved
  version: '1.0.0'
  last_updated: 2025-11-13T00:00:00Z
  concept_approved: true
  concept_reviewed_at: 2025-11-06T23:32:00Z
  owners:
    - role: narrative_systems
      contact: systems@necp.game
  tags:
    - player-impact
    - world-state
    - hybrid-system
  topics:
    - dynamic-world
    - player-agency
  related_systems:
    - narrative-service
    - gameplay-service
    - faction-service
  related_documents:
    - id: narrative-coherence-personal-system
      relation: references
    - id: narrative-coherence-server-system
      relation: references
    - id: narrative-coherence-faction-system
      relation: references
    - id: narrative-coherence-world-state-tables
      relation: references
  source: "shared/docs/knowledge/canon/narrative/narrative-coherence/phase5-player-impact/hybrid/hybrid-system.md"
  visibility: internal
  audience:
    - concept
    - narrative
    - systems
  risk_level: medium
review:
  chain:
    - role: concept_director
      reviewer: ''
      reviewed_at: ''
      status: pending
  next_actions: []
summary:
  problem: "Необходимо описать единую модель влияния игроков на мир, объединяющую личные, серверные и фракционные решения."
  goal: "Определить уровни воздействия, приоритеты и интеграцию с квестами и мировым состоянием."
  essence: "Система объединяет личное влияние, коллективные решения сервера и действия фракций, автоматически разрешая конфликты."
  key_points:
    - "Три уровня: Personal, Server и Faction с различной областью действия."
    - "Конфликты решаются приоритетами: Server > Faction > Personal."
    - "Квесты и мир используют комбинированное состояние."
content:
  sections:
    - id: overview
      title: "Краткое описание"
      body: |
        Гибридная система определяет, как решения игроков меняют мир. Личное влияние отражает выборы персонажа, серверное — коллективные решения, а фракционное — усилия альянсов. Всё объединяется в единую модель мирового состояния.
      mechanics_links: []
      assets: []
    - id: levels
      title: "Три уровня влияния"
      body: |
        ### Personal Impact  
        • Область: только персонаж.  
        • Примеры: персональные квесты, отношения с NPC, репутация.  
        • Хранение: `player_world_state` (видит только игрок).

        ### Server Impact  
        • Область: весь сервер.  
        • Механика: голосования, глобальные события, войны фракций.  
        • Порог: >=60% игроков.  
        • Хранение: `server_world_state` (видят все).

        ### Faction Impact  
        • Область: члены фракции.  
        • Механика: коллективные операции, территориальный контроль.  
        • Хранение: `faction_world_state` (видят фракция и затронутые игроки).
      mechanics_links: []
      assets: []
    - id: priorities
      title: "Разрешение конфликтов"
      body: |
        • Основной приоритет: **Server > Faction > Personal** для глобальных событий.  
        • Для персональных квестов преимущество за личным состоянием.  
        • Для контроля территории фракции превосходят индивидуальные выборы.  
        Пример: сервер выбирает победу Arasaka, но личный выбор игрока отражается в персональных квестах, а фракция влияет на территориальные бонусы.
      mechanics_links: []
      assets: []
    - id: integration
      title: "Интеграция с системами"
      body: |
        **Quest System:** проверяет все уровни перед выдачей квестов и фиксирует результаты.  
        **World State:** объединяет значения, логирует конфликты и обновляет показатели.  
        **Backend:** таблицы `player_world_state`, `server_world_state`, `faction_world_state` синхронизируются по приоритетам.
      mechanics_links: []
      assets: []
appendix:
  glossary: []
  references: []
  decisions: []
implementation:
  github_issue: 133
  needs_task: false
  queue_reference: []
  blockers: []
history:
  - version: '1.0.0'
    date: 2025-11-13
    author: concept_director
    changes: "Конвертация гибридной системы влияния игроков из MD в YAML."
validation:
  checksum: ''
  schema_version: '1.0'

