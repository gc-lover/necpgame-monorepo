# Issue: #1842
metadata:
  id: canon-content-underground-interactives
  title: "Интерактивы (подполье/гетто): чёрные рынки, лаби, люки, тоннели"
  document_type: canon
  category: content
  status: ready_for_backend
  version: "1.0.0"
  last_updated: 2025-12-14T15:30:00Z
  concept_approved: true
  concept_reviewed_at: 2025-12-08T22:02:52Z
  owners:
    - role: content_writer
      contact: content@necp.game
  tags:
    - interactive
    - underground
    - ghetto
    - cyberpunk
    - gameplay
    - mechanics
    - black-market
    - crafting
    - stealth
  topics:
    - content
    - gameplay
    - world-interactions
    - interactive-objects
    - underground
  related_systems:
    - gameplay-service
    - economy-service
    - telemetry-service
    - security-service
    - crafting-service
  related_documents:
    - id: canon-mechanics-underground-environment
      relation: implements
    - id: canon-narrative-underground-world
      relation: extends
  source: knowledge/canon/content/interactives/underground-interactives.yaml
  visibility: internal
  audience:
    - content
    - world-design
    - gameplay-devs
    - economy-devs
  risk_level: high

review:
  chain:
    - role: content_writer
      reviewer: Content Writer Agent
      timestamp: 2025-12-14T15:30:00Z
      status: approved
      notes: "Underground interactives content created with black market mechanics, crafting risks, and stealth systems"
    - role: backend
      reviewer: Backend Agent
      timestamp: pending
      status: pending
      notes: "Backend import validation pending"
    - role: qa
      reviewer: QA Agent
      timestamp: pending
      status: pending
      notes: "Integration testing pending"

summary:
  overview: Создать интерактивные объекты для подпольных зон с механиками чёрного рынка, крафта и скрытности
  goal: Реализовать функциональные объекты отражающие опасности и возможности теневого мира
  essence: Подпольные интерактивы подчеркивающие риски нелегальной деятельности и скрытые возможности
  key_points:
    - Чёрные рынки как источники редких предметов и квестовых контактов
    - Лаборатории с рискованным крафтом и апгрейдами
    - Тоннели для скрытного перемещения с шансом засад

content:
  interactives:
    - name: black_market
      display_name: "Чёрный Рынок"
      category: trade_network
      description: |
        Подпольные торговые точки в заброшенных помещениях и бэкрумах.
        Обмен редкостей, нелегальные товары и контакты с квестовыми NPC.

      mechanics:
        market_types:
          weapon_dealer:
            inventory_focus: combat_equipment
            rarity_level: high
            contact_network: street_gangs
            quest_opportunities: ["arms_deals", "protection_contracts"]

          tech_vendor:
            inventory_focus: cybernetic_upgrades
            rarity_level: legendary
            contact_network: black_hat_hackers
            quest_opportunities: ["data_thefts", "system_hacks"]

          informant_hub:
            inventory_focus: information_packets
            rarity_level: variable
            contact_network: underground_network
            quest_opportunities: ["intelligence_gathering", "target_acquisition"]

        trade_mechanics:
          barter_system:
            accepted_goods: ["street_cred", "contraband", "stolen_data", "faction_rep"]
            price_modifiers: ["market_demand", "buyer_reputation", "item_condition"]
            negotiation_skills: ["intimidation", "persuasion", "street_smarts"]

          risk_assessment:
            raid_probability: 15-45%
            betrayal_chance: 5-25%
            quality_guarantee: 60-95%
            law_enforcement_alert: 10-30%

        social_interactions:
          npc_relationships:
            merchant_types: ["desperate_seller", "greedy_broker", "loyal_contact"]
            reputation_system: ["unknown", "acquainted", "trusted", "valued_customer"]
            loyalty_benefits: ["better_prices", "exclusive_items", "quest_hooks"]

          faction_connections:
            gang_affiliations: ["street_punks", "corporate_defectors", "nomad_packs"]
            territory_claims: ["neutral_ground", "controlled_area", "disputed_zone"]
            alliance_benefits: ["safe_passage", "backup_support", "information_network"]

        security_measures:
          access_control:
            entry_requirements: ["password", "biometric_scan", "personal_recommendation"]
            surveillance_level: ["minimal", "standard", "paranoid"]
            escape_routes: ["hidden_exits", "sewer_access", "roof_escape"]

          alarm_systems:
            detection_methods: ["motion_sensors", "microphones", "surveillance_cameras"]
            response_time: 30-120_seconds
            alert_radius: 500-2000_meters

      telemetry_events:
        - market_transactions_completed
        - item_types_traded
        - raid_events_occurred
        - npc_relationship_changes
        - security_breaches_detected

    - name: improvised_lab
      display_name: "Импровизированная Лаборатория"
      category: crafting_facility
      description: |
        Самодельные мастерские для крафта и апгрейдов с высоким риском аварий.
        Создание уникального оборудования из подручных материалов.

      mechanics:
        lab_specializations:
          weapon_modding:
            craft_focus: firearm_enhancements
            material_requirements: ["scrap_metal", "electronic_parts", "chemicals"]
            success_rate: 70%
            explosion_risk: 20%

          cybernetic_surgery:
            craft_focus: implant_upgrades
            material_requirements: ["medical_supplies", "neural_interfaces", "power_cells"]
            success_rate: 60%
            infection_risk: 30%

          tech_hacking:
            craft_focus: device_modifications
            material_requirements: ["circuit_boards", "software_tools", "data_crystals"]
            success_rate: 80%
            system_crash_risk: 15%

        crafting_process:
          preparation_phase:
            time_required: 30-60_seconds
            material_gathering: ["scavenge_components", "trade_for_parts", "steal_supplies"]
            workspace_setup: ["equipment_arrangement", "safety_measures", "power_connection"]

          execution_phase:
            time_required: 120-600_seconds
            skill_checks: ["technical_knowledge", "precision_work", "risk_assessment"]
            critical_moments: ["power_surge", "material_failure", "environmental_hazard"]

          completion_phase:
            success_outcomes: ["perfect_craft", "good_quality", "functional_item"]
            failure_outcomes: ["partial_success", "critical_failure", "catastrophic_explosion"]
            bonus_effects: ["skill_improvement", "recipe_unlock", "unique_modifiers"]

        risk_system:
          accident_types:
            chemical_reaction: ["toxic_gas", "corrosive_leak", "unstable_compound"]
            electrical_failure: ["power_surge", "short_circuit", "equipment_overload"]
            structural_collapse: ["floor_instability", "wall_crack", "ceiling_cave_in"]

          consequence_severity:
            minor_accident: ["equipment_damage", "material_loss", "time_penalty"]
            major_accident: ["health_damage", "location_compromise", "wanted_status"]
            catastrophic_failure: ["permanent_injury", "location_destruction", "faction_retaliation"]

          mitigation_strategies:
            safety_equipment: ["protective_gear", "emergency_shutdown", "fire_suppression"]
            skill_based: ["expertise_bonus", "careful_work", "rush_penalty_reduction"]
            environmental: ["ventilation_system", "stable_power", "reinforced_structure"]

        upgrade_system:
          quality_tiers:
            basic_craft: "standard_functionality"
            enhanced_craft: "improved_performance"
            masterwork_craft: "exceptional_quality"
            legendary_craft: "unique_modifiers"

          specialization_bonuses:
            weapon_specialist: ["accuracy_bonus", "damage_increase", "ammo_efficiency"]
            cyber_specialist: ["compatibility_boost", "power_efficiency", "neural_link"]
            tech_specialist: ["processing_speed", "memory_capacity", "security_level"]

      telemetry_events:
        - crafting_attempts_started
        - success_rates_by_type
        - accident_types_occurred
        - material_consumption_tracked
        - upgrade_quality_distribution

    - name: contraband_tunnel
      display_name: "Контрабандный Тоннель"
      category: stealth_transport
      description: |
        Скрытые подземные проходы для быстрого перемещения между районами.
        Риск случайных встреч, засад и структурных обвалов.

      mechanics:
        tunnel_network:
          route_types:
            maintenance_access: ["sewer_systems", "utility_tunnels", "service_corridors"]
            abandoned_mines: ["old_excavations", "collapsed_shaft", "flooded_chambers"]
            smugglers_paths: ["hidden_entrances", "reinforced_passages", "camouflaged_exits"]

          route_characteristics:
            travel_time: 60-600_seconds
            security_level: ["unguarded", "occasional_patrols", "heavily_monitored"]
            structural_integrity: ["stable", "unstable", "collapsing"]

        encounter_system:
          random_events:
            wildlife_encounters: ["mutated_rats", "underground_creatures", "toxic_sludge"]
            human_elements: ["homeless_squatters", "rival_smugglers", "law_enforcement"]
            environmental_hazards: ["flooding", "gas_leak", "structural_failure"]

          ambush_mechanics:
            detection_chance: 20-60%
            response_time: 15-45_seconds
            escape_options: ["fight", "flee", "negotiate", "hide"]

          loot_opportunities:
            abandoned_supplies: ["medical_kits", "ammo_caches", "tech_components"]
            smugglers_stashes: ["contraband_goods", "stolen_data", "hidden_weapons"]
            environmental_findings: ["rare_minerals", "ancient_artifacts", "mutant_specimens"]

        navigation_system:
          path_marking:
            visual_cues: ["graffiti_marks", "led_indicators", "chemical_trails"]
            audio_signals: ["distant_echoes", "water_drops", "machinery_hum"]
            tactical_signs: ["warning_symbols", "safe_route_marks", "danger_indicators"]

          orientation_tools:
            basic_navigation: ["mental_mapping", "instinct_guidance", "trial_and_error"]
            tech_assisted: ["gps_jammer", "motion_tracker", "thermal_vision"]
            local_knowledge: ["smugglers_maps", "resident_guides", "faction_intel"]

          exit_strategies:
            planned_routes: ["marked_entrances", "maintenance_hatches", "storm_drains"]
            emergency_exits: ["weakened_walls", "ventilation_shafts", "construction_sites"]
            alternative_paths: ["parallel_tunnels", "surface_access", "flooded_routes"]

        maintenance_mechanics:
          tunnel_condition:
            upkeep_level: ["well_maintained", "neglected", "derelict"]
            hazard_probability: ["low_risk", "moderate_danger", "extreme_peril"]
            accessibility_rating: ["easy_access", "difficult_passage", "treacherous_route"]

          environmental_effects:
            weather_impact: ["surface_rain", "temperature_changes", "pressure_variations"]
            human_activity: ["construction_work", "security_patrols", "maintenance_crews"]
            natural_processes: ["erosion", "groundwater_flow", "earthquake_damage"]

      telemetry_events:
        - tunnel_usage_frequency
        - travel_time_distribution
        - encounter_types_experienced
        - successful_navigations
        - structural_failures_reported

balance:
  difficulty_scaling:
    player_level_ranges:
      novice: 1-15
      intermediate: 16-35
      advanced: 36-55
      expert: 56-75
      master: 76+

    adaptive_difficulty:
      market_risks: "scales_with_player_reputation"
      crafting_complexity: "increases_with_skill_level"
      tunnel_dangers: "varies_with_route_condition"

  reward_balance:
    economy_integration:
      market_value: "affects_black_market_economy"
      crafting_value: "influences_equipment_quality"
      exploration_value: "rewards_risky_behavior"

    success_rates:
      safe_activities: 85-95%
      risky_activities: 60-80%
      dangerous_activities: 30-50%

  risk_reward_ratio:
    calculated_risks: "market_trading_and_lab_crafting"
    high_stakes: "tunnel_navigation_and_raid_survival"
    extreme_gambles: "high-value_deals_and_experimental_crafts"

telemetry:
  primary_metrics:
    - economic_activity_volume
    - crafting_success_rates
    - tunnel_usage_patterns

  secondary_metrics:
    - accident_frequency_rates
    - player_survival_statistics
    - item_quality_distributions

  data_collection:
    anonymized_player_data: ["trading_patterns", "crafting_preferences", "route_selections"]
    system_health_data: ["market_stability", "lab_safety", "tunnel_integrity"]
    balance_adjustment_data: ["risk_perception", "reward_expectation", "difficulty_scaling"]

implementation:
  backend_requirements:
    - database_tables: ["underground_interactives", "market_transactions", "crafting_sessions"]
    - api_endpoints: ["market_trades", "lab_crafting", "tunnel_navigation"]
    - real_time_processing: ["risk_calculations", "accident_simulation", "route_generation"]

  frontend_integration:
    - ui_components: ["market_interface", "crafting_workbench", "tunnel_minimap"]
    - visual_effects: ["market_ambience", "lab_sparks", "tunnel_darkness"]
    - audio_design: ["bargaining_sounds", "machinery_noises", "distant_echoes"]

  testing_requirements:
    - unit_tests: ["mechanics_validation", "balance_checks", "data_integrity"]
    - integration_tests: ["full_interaction_flows", "multiplayer_scenarios"]
    - performance_tests: ["risk_calculations", "accident_simulation", "route_generation"]

roadmap:
  phase_1: "Basic markets and simple crafting labs"
  phase_2: "Tunnel networks with encounter systems"
  phase_3: "Advanced trading mechanics and specialization bonuses"
  phase_4: "Dynamic economy and procedural content generation"