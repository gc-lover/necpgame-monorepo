metadata:
  id: api-mvp-system-endpoints
  title: 'MVP System Endpoints — Системные операции'
  document_type: implementation
  category: api
  status: approved
  version: '1.0.0'
  last_updated: 2025-11-07T06:05:00Z
  concept_approved: true
  concept_reviewed_at: 2025-11-07T06:05:00Z
  owners:
    - role: api_lead
      contact: api@necp.game
  tags:
    - api
    - observability
    - reliability
  topics:
    - platform-operations
    - error-handling
  related_systems:
    - api-gateway
    - auth-service
    - character-service
    - gameplay-service
    - social-service
    - economy-service
    - world-service
  related_documents:
    - id: api-mvp-auth-endpoints
      relation: complements
    - id: api-mvp-gameplay-endpoints
      relation: complements
    - id: api-mvp-content-endpoints
      relation: complements
  source: shared/docs/knowledge/implementation/api-requirements/mvp-endpoints/system-endpoints.md
  visibility: internal
  audience:
    - backend
    - api
    - devops
  risk_level: medium
review:
  chain:
    - role: api_lead
      reviewer: ''
      reviewed_at: 2025-11-07T06:05:00Z
      status: approved
  next_actions: []
summary:
  problem: Требуется унифицированное описание системных endpoint'ов, формата ошибок и health checks для всех сервисов MVP.
  goal: Зафиксировать маршруты, формат стандартной ошибки, набор кодов и правила валидации для интеграции команд и мониторинга.
  essence: Документ перечисляет actuator endpoint'ы, стандартный JSON ошибки, общие правила валидации и пример ответа `/api/v1/health`.
  key_points:
    - 'Каждый сервис публикует `/actuator/health`, gateway имеет собственный health endpoint.'
    - 'Ошибки следуют общему JSON формату с кодами AUTH_*, CHAR_*, QUEST_* и т.д.'
    - 'Валидация охватывает UUID, строки и числовые диапазоны.'
    - '`/api/v1/health` предоставляет сводный статус базы, Redis и event bus.'
content:
  sections:
    - id: service_health
      title: Health endpoint'ы
      body: |
        Описаны `/actuator/health` и `/actuator/info` в auth-service и `/actuator/health` в остальных сервисах. Gateway
        обеспечивает `/actuator/health`, а мониторинг регистрации доступен через Eureka dashboard.
      mechanics_links: []
      assets: []
    - id: error_format
      title: Формат ошибок и коды
      body: |
        Приведён стандартный JSON-ответ (success=false, объект error) и перечень кодов (AUTH_001, CHAR_001, QUEST_001 и т.д.),
        которые применяются сервисами для унификации обработки ошибок.
      mechanics_links: []
      assets: []
    - id: validation_rules
      title: Общие правила валидации
      body: |
        Содержит обязательные проверки для UUID, строк и чисел: например, username 3–20 символов, уровень 1–100, цена >= 0.
        Эти правила дополняют стандартные ошибки и применяются при генерации API.
      mechanics_links: []
      assets: []
    - id: composite_health
      title: Сводный health check
      body: |
        `GET /api/v1/health` возвращает агрегированный статус платформы и состояние компонентов (database, redis, eventBus),
        что пригодно для интеграции с системами мониторинга.
      mechanics_links: []
      assets: []
appendix:
  glossary: []
  references: []
  decisions: []
implementation:
  needs_task: false
  queue_reference:
    - shared/trackers/queues/concept/queued.yaml#api-mvp-system-endpoints
  blockers: []
history:
  - version: '1.0.0'
    date: 2025-11-07
    author: ai_brain_manager
    changes: Зафиксированы системные endpoint'ы, формат ошибок, валидация и health check.
validation:
  checksum: ''
  schema_version: '1.0'