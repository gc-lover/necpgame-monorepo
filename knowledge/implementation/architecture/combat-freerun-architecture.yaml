metadata:
  id: combat-freerun-architecture
  title: Архитектура системы Freerun (паркур в бою)
  document_type: architecture
  category: systems
  status: draft
  version: "1.2.0"
  last_updated: 2025-11-30T19:25:00Z
  owners:
    - role: architect
      contact: architect@necp.game
  tags:
    - architecture
    - combat
    - freerun
    - parkour
    - movement
    - stamina
  related_systems:
    - gameplay-service
    - quest-service
    - analytics-service
  related_documents:
    - id: combat-freerun
      relation: implements
    - id: analysis-combat-freerun-brief
      relation: extends
  github_issue: 1513
  visibility: internal
  audience:
    - architect
    - backend
    - gameplay
    - api-designer

summary:
  problem: |
    Требуется спроектировать архитектуру системы Freerun (паркур в бою), включающую:
    - Смешанный контроль паркура (автоматический и ручной)
    - Элементы паркура (прыжки, лазание, скольжение, гравиботы)
    - Систему выносливости (stamina)
    - Интеграцию с боем (атаки с воздуха, стрельба в движении, мобильные способности)
    - Комбо паркура
    - Пользовательские маршруты
    - Телеметрию и античит
  goal: |
    Создать архитектурную схему системы Freerun с определением:
    - Компонентов для управления паркуром
    - REST, WebSocket и Event Bus контрактов
    - Интеграций с другими системами
    - Структуры БД
    - Технического задания для реализации
  essence: |
    Объединенная архитектура системы Freerun с поддержкой паркура в бою,
    управления выносливостью, комбо и интеграции с боевой системой.

architecture:
  overview: |
    Архитектура системы Freerun состоит из следующих компонентов:
    1. Freerun Action Manager - управление действиями паркура
    2. Stamina Manager - управление выносливостью
    3. Freerun Combo System - система комбо паркура
    4. Route Manager - управление маршрутами
    5. Mobile Ability Integrator - интеграция мобильных способностей
    6. Freerun Telemetry Collector - сбор телеметрии
    7. Anti-Cheat Validator - валидация античит

  microservices:
    - name: gameplay-service
      port: 8083
      responsibility: |
        Обработка Freerun:
        - Управление действиями паркура
        - Управление выносливостью
        - Обработка комбо паркура
        - Управление маршрутами
        - Интеграция мобильных способностей
        - Сбор телеметрии
        - Валидация античит
      components:
        - freerun-action-manager: управление действиями паркура
        - stamina-manager: управление выносливостью
        - freerun-combo-system: система комбо паркура
        - route-manager: управление маршрутами
        - mobile-ability-integrator: интеграция мобильных способностей
        - freerun-telemetry-collector: сбор телеметрии
        - anti-cheat-validator: валидация античит
      endpoints:
        - POST /api/v1/gameplay/combat/freerun/actions - выполнение действия паркура
        - GET /api/v1/gameplay/combat/freerun/actions/available - доступные действия
        - POST /api/v1/gameplay/combat/freerun/actions/wall-run - активация Wall Run
        - POST /api/v1/gameplay/combat/freerun/actions/double-jump - выполнение Double Jump
        - POST /api/v1/gameplay/combat/freerun/actions/slide - активация Slide
        - POST /api/v1/gameplay/combat/freerun/actions/air-dash - выполнение Air Dash
        - POST /api/v1/gameplay/combat/freerun/actions/wall-kick - выполнение Wall Kick
        - POST /api/v1/gameplay/combat/freerun/actions/vault - выполнение Vault
        - POST /api/v1/gameplay/combat/freerun/actions/air-dash - выполнение Air Dash
        - POST /api/v1/gameplay/combat/freerun/actions/wall-kick - выполнение Wall Kick
        - POST /api/v1/gameplay/combat/freerun/actions/roof-jump - выполнение Roof Jump
        - POST /api/v1/gameplay/combat/freerun/actions/wire-slide - выполнение Wire Slide
        - POST /api/v1/gameplay/combat/freerun/actions/hook-grab - выполнение Hook Grab
        - POST /api/v1/gameplay/combat/freerun/actions/gravibot-boost - выполнение Gravibot Boost
        - POST /api/v1/gameplay/combat/freerun/actions/cyberware-sprint - активация Leg Implant Sprint
        - POST /api/v1/gameplay/combat/freerun/combo - выполнение комбо паркура
        - POST /api/v1/gameplay/combat/freerun/combo/acrobatics - выполнение комбо акробатики
        - POST /api/v1/gameplay/combat/freerun/movement-attack - атака во время движения
        - POST /api/v1/gameplay/combat/freerun/movement-combo - комбо из движения
        - GET /api/v1/gameplay/combat/freerun/stamina - состояние выносливости
        - POST /api/v1/gameplay/combat/freerun/stamina/recover - восстановление выносливости
        - GET /api/v1/gameplay/combat/freerun/loadout - получение лоадаута паркура
        - POST /api/v1/gameplay/combat/freerun/loadout - обновление лоадаута
        - POST /api/v1/gameplay/combat/freerun/mobile-ability - активация мобильной способности
        - POST /api/v1/gameplay/combat/freerun/route - создание пользовательского маршрута
        - GET /api/v1/gameplay/combat/freerun/route/{routeId} - получение маршрута
        - GET /api/v1/gameplay/combat/freerun/telemetry - телеметрия паркура
      websocket_channels:
        - wss://api.necp.game/v1/gameplay/combat/freerun/{sessionId} - поток действий и состояния stamina
        - wss://api.necp.game/v1/gameplay/combat/freerun/telemetry/{characterId} - телеметрия тренировки
      events_published:
        - combat.freerun.action: выполнение действия паркура
        - combat.freerun.wall-run.started: начало Wall Run
        - combat.freerun.wall-run.ended: окончание Wall Run
        - combat.freerun.double-jump: выполнение Double Jump
        - combat.freerun.slide.started: начало Slide
        - combat.freerun.slide.ended: окончание Slide
        - combat.freerun.air-dash: выполнение Air Dash
        - combat.freerun.wall-kick: выполнение Wall Kick
        - combat.freerun.vault: выполнение Vault
        - combat.freerun.air-dash.started: начало Air Dash
        - combat.freerun.air-dash.ended: окончание Air Dash
        - combat.freerun.wall-kick: выполнение Wall Kick
        - combat.freerun.roof-jump: выполнение Roof Jump
        - combat.freerun.wire-slide.started: начало Wire Slide
        - combat.freerun.wire-slide.ended: окончание Wire Slide
        - combat.freerun.hook-grab: выполнение Hook Grab
        - combat.freerun.gravibot-boost.started: начало Gravibot Boost
        - combat.freerun.gravibot-boost.ended: окончание Gravibot Boost
        - combat.freerun.cyberware-sprint.started: начало Cyberware Sprint
        - combat.freerun.cyberware-sprint.ended: окончание Cyberware Sprint
        - combat.freerun.combo: выполнение комбо паркура
        - combat.freerun.acrobatics-combo: выполнение комбо акробатики
        - combat.freerun.movement-attack: атака во время движения
        - combat.freerun.movement-combo: комбо из движения
        - combat.freerun.stamina: изменение выносливости
        - combat.freerun.mobile-ability: активация мобильной способности
        - combat.freerun.route-created: создание пользовательского маршрута
        - combat.freerun.route-completed: завершение маршрута
      events_subscribed:
        - combat.session.started: начало боевой сессии
        - combat.ability.activated: активация способности
        - combat.implant.activated: активация импланта
        - quest.trigger: триггеры квестов
        - progression.skill-updated: обновление навыков

  acrobatics_elements:
    basic_acrobatics:
      - name: wall_run
        description: Бег по стенам - позволяет вертикальное перемещение по стенам
        stamina_cost: 15
        stamina_per_second: 15
        cooldown: 0.5
        automation_level: "auto/manual"
        max_duration: 3.0
        min_speed: 8.0
        max_speed: 12.0
        transition_bonus: "Может переходить в другие элементы акробатики"
        combat_integration: "Возможны атаки с стены"

      - name: double_jump
        description: Двойной прыжок - второй прыжок в воздухе для продления полета
        stamina_cost: 12
        cooldown: 0.1
        automation_level: "auto/manual"
        height_bonus: 2.5
        air_control: 0.8
        combo_window: 1.5
        transition_bonus: "Может переходить в Air Dash или Wall Run"

      - name: slide
        description: Скольжение - быстрое скольжение по горизонтальным поверхностям
        stamina_cost: 6
        cooldown: 0.2
        automation_level: "auto/manual"
        max_duration: 2.0
        speed_multiplier: 1.8
        low_profile: true
        transition_bonus: "Может переходить в Wall Run или Vault"

    advanced_acrobatics:
      - name: air_dash
        description: Воздушный рывок - мощный рывок в воздухе для изменения траектории
        stamina_cost: 18
        cooldown: 2.0
        automation_level: "manual"
        dash_distance: 8.0
        dash_speed: 25.0
        air_control_recovery: 1.2
        combo_multiplier: 1.5
        transition_bonus: "Идеален для изменения направления в комбо"

      - name: wall_kick
        description: Отталкивание от стены - мощное отталкивание для изменения направления
        stamina_cost: 10
        cooldown: 0.3
        automation_level: "auto/manual"
        kick_force: 15.0
        angle_control: 45
        height_gain: 3.0
        wall_detection_range: 2.0
        transition_bonus: "Отличный для смены направления в воздухе"

      - name: vault
        description: Перепрыгивание - плавное перепрыгивание через препятствия
        stamina_cost: 8
        cooldown: 0.1
        automation_level: "auto/manual"
        vault_height: 2.0
        vault_distance: 4.0
        obstacle_detection: 3.0
        momentum_preservation: 0.9
        transition_bonus: "Плавный переход через препятствия"

    environmental_elements:
      - name: roof_jump
        description: Прыжки между крышами - специализированные прыжки для высотных зданий
        stamina_cost: 20
        automation_level: "auto/manual"
        building_detection: true
        height_calculation: "Автоматический расчет безопасной высоты"

      - name: wire_slide
        description: Скольжение по проводам - использование городской инфраструктуры
        stamina_cost: 10
        automation_level: "auto/manual"
        wire_detection: true
        momentum_transfer: 0.95
        safety_system: "Автоматическое отцепление при угрозе"

      - name: hook_grab
        description: Захват крюками - использование grappling hook системы
        stamina_cost: 12
        automation_level: "auto/manual"
        hook_range: 15.0
        retraction_speed: 20.0
        swing_physics: true

      - name: gravibot_boost
        description: Ускорение с гравиботами - использование антигравитационных устройств
        stamina_cost: 25
        automation_level: "auto/manual"
        boost_duration: 5.0
        speed_multiplier: 2.2
        gravity_modulation: 0.3

    cyberware_elements:
      - name: leg_implant_sprint
        description: Импланты ног для спринта - кибернетическое усиление бега
        stamina_cost: 18
        automation_level: "auto/manual"
        speed_bonus: 1.4
        duration: 10.0
        heat_generation: 15

      - name: neural_reflex_boost
        description: Нейронное ускорение рефлексов - улучшение реакции для акробатики
        stamina_cost: 22
        automation_level: "auto/manual"
        reaction_time_bonus: 0.8
        prediction_accuracy: 0.85
        duration: 8.0

      - name: balance_augmentation
        description: Улучшение баланса - кибернетическая стабилизация
        stamina_cost: 14
        automation_level: "auto/manual"
        stability_bonus: 0.9
        fall_damage_reduction: 0.7
        always_active: true

  acrobatics_combos:
    basic_combos:
      - name: wall_run_to_double_jump
        description: Wall Run + Double Jump для вертикального ускорения
        sequence: ["wall_run", "double_jump"]
        stamina_cost: 27
        bonus_multiplier: 1.2
        transition_time: 0.3

      - name: slide_to_wall_run
        description: Slide + Wall Run для быстрого вертикального подъема
        sequence: ["slide", "wall_run"]
        stamina_cost: 21
        bonus_multiplier: 1.15
        transition_time: 0.2

    advanced_combos:
      - name: air_dash_wall_kick
        description: Air Dash + Wall Kick для сложных маневров
        sequence: ["air_dash", "wall_kick"]
        stamina_cost: 28
        bonus_multiplier: 1.4
        transition_time: 0.4
        difficulty: "expert"

      - name: vault_air_dash
        description: Vault + Air Dash для преодоления больших расстояний
        sequence: ["vault", "air_dash"]
        stamina_cost: 26
        bonus_multiplier: 1.3
        transition_time: 0.5

    environmental_combos:
      - name: wire_slide_hook_grab
        description: Wire Slide + Hook Grab для городской навигации
        sequence: ["wire_slide", "hook_grab"]
        stamina_cost: 22
        bonus_multiplier: 1.25
        transition_time: 0.6

      - name: roof_jump_gravibot
        description: Roof Jump + Gravibot для высотного паркура
        sequence: ["roof_jump", "gravibot_boost"]
        stamina_cost: 45
        bonus_multiplier: 1.5
        transition_time: 0.8

  acrobatics_integration:
    combat_integration:
      - name: aerial_attacks
        description: Атаки с воздуха во время акробатических элементов
        compatible_elements: ["wall_run", "air_dash", "double_jump"]
        damage_multiplier: 1.3
        accuracy_penalty: 0.8

      - name: momentum_attacks
        description: Атаки с использованием импульса движения
        compatible_elements: ["slide", "wall_kick"]
        damage_multiplier: 1.4
        knockback_bonus: 1.5

      - name: combo_finisher
        description: Завершающие атаки из акробатических комбо
        compatible_combos: ["air_dash_wall_kick", "vault_air_dash"]
        damage_multiplier: 2.0
        critical_chance: 0.25

    ability_integration:
      - name: dash_abilities
        description: Способности использующие dash механику
        compatible_elements: ["air_dash"]
        ability_types: ["teleport", "phase", "burst"]

      - name: wall_abilities
        description: Способности для взаимодействия со стенами
        compatible_elements: ["wall_run", "wall_kick"]
        ability_types: ["climb", "explode", "grapple"]

    progression_integration:
      - name: skill_unlocks
        description: Разблокировка элементов акробатики через навыки
        basic_threshold: 5
        advanced_threshold: 15
        environmental_threshold: 25

      - name: implant_upgrades
        description: Улучшения имплантов для акробатики
        cyberware_level: 2
        neural_level: 3

  control_modes:
    - name: basic
      description: Базовый режим с автоматизацией
      automation_level: "high"
      features: "Автоматическое удержание на маршрутах, помощь в манёврах"

    - name: advanced
      description: Продвинутый режим с полным контролем
      automation_level: "low"
      features: "Полный контроль для точных манёвров, соревновательная игра"

  data_flows:
    freerun_action_flow: |
      1. Игрок выполняет действие паркура
      2. Freerun Action Manager получает запрос через POST /api/v1/gameplay/combat/freerun/actions
      3. Freerun Action Manager проверяет доступность действия
      4. Stamina Manager проверяет наличие выносливости
      5. Anti-Cheat Validator валидирует действие
      6. Freerun Action Manager выполняет действие
      7. Stamina Manager расходует выносливость
      8. Freerun Combo System проверяет комбо
      9. Mobile Ability Integrator проверяет мобильные способности
      10. Gameplay Service публикует событие combat.freerun.action
      11. Realtime Gateway отправляет обновление клиентам

    stamina_management_flow: |
      1. Игрок выполняет действие паркура
      2. Stamina Manager рассчитывает расход выносливости
      3. Stamina Manager учитывает навыки и импланты
      4. Stamina Manager обновляет состояние выносливости
      5. Если выносливость обнулена, Stamina Manager блокирует действия
      6. Stamina Manager запускает восстановление выносливости
      7. Gameplay Service публикует событие combat.freerun.stamina
      8. Realtime Gateway отправляет обновление клиентам

    freerun_combo_flow: |
      1. Игрок выполняет последовательность действий паркура
      2. Freerun Combo System отслеживает последовательность
      3. Freerun Combo System проверяет соответствие комбо
      4. Freerun Combo System применяет бонусы комбо
      5. Freerun Combo System интегрирует с боевыми комбо
      6. Gameplay Service публикует событие combat.freerun.combo
      7. Realtime Gateway отправляет обновление клиентам

    mobile_ability_flow: |
      1. Игрок активирует способность во время паркура
      2. Mobile Ability Integrator проверяет доступность способности
      3. Mobile Ability Integrator проверяет совместимость с текущим действием
      4. Mobile Ability Integrator применяет мобильную версию способности
      5. Mobile Ability Integrator корректирует затраты способности
      6. Gameplay Service публикует событие combat.freerun.mobile-ability
      7. Realtime Gateway отправляет обновление клиентам

    route_creation_flow: |
      1. Игрок создает пользовательский маршрут
      2. Route Manager получает запрос через POST /api/v1/gameplay/combat/freerun/route
      3. Route Manager валидирует маршрут
      4. Route Manager проверяет доступность элементов маршрута
      5. Route Manager сохраняет маршрут
      6. Gameplay Service публикует событие combat.freerun.route-created
      7. Realtime Gateway отправляет обновление клиентам

  database_structure:
    tables:
      - name: freerun_actions
        description: Действия паркура
        columns:
          - id: UUID PRIMARY KEY
          - character_id: UUID FOREIGN KEY
          - action_type: ENUM (roof_jump, wall_climb, wire_slide, rock_climb, hook_grab, gravibot_boost, leg_implant_sprint, wall_run, double_jump, slide, air_dash, wall_kick, vault, neural_reflex_boost, balance_augmentation)
          - position_before: JSONB
          - position_after: JSONB
          - stamina_cost: INTEGER
          - automation_level: VARCHAR(50)
          - timestamp: TIMESTAMP

      - name: freerun_profiles
        description: Профили паркура персонажей
        columns:
          - id: UUID PRIMARY KEY
          - character_id: UUID FOREIGN KEY
          - control_mode: ENUM (basic, advanced)
          - preferred_automation: DECIMAL(3,2)
          - loadout: JSONB
          - created_at: TIMESTAMP
          - updated_at: TIMESTAMP

      - name: freerun_combos_history
        description: История комбо паркура
        columns:
          - id: UUID PRIMARY KEY
          - character_id: UUID FOREIGN KEY
          - combo_sequence: JSONB
          - bonuses_applied: JSONB
          - combat_integration: BOOLEAN
          - timestamp: TIMESTAMP

      - name: freerun_stamina_state
        description: Состояние выносливости
        columns:
          - id: UUID PRIMARY KEY
          - character_id: UUID FOREIGN KEY
          - current_stamina: INTEGER
          - max_stamina: INTEGER
          - recovery_rate: DECIMAL(5,2)
          - modifiers: JSONB
          - last_update: TIMESTAMP

      - name: freerun_routes
        description: Пользовательские маршруты
        columns:
          - id: UUID PRIMARY KEY
          - character_id: UUID FOREIGN KEY
          - name: VARCHAR(255)
          - route_points: JSONB
          - difficulty: VARCHAR(50)
          - is_public: BOOLEAN
          - created_at: TIMESTAMP
          - updated_at: TIMESTAMP

      - name: freerun_telemetry
        description: Телеметрия паркура
        columns:
          - id: UUID PRIMARY KEY
          - character_id: UUID FOREIGN KEY
          - action_type: VARCHAR(100)
          - duration: INTEGER
          - distance: DECIMAL(10,2)
          - stamina_used: INTEGER
          - combo_triggered: BOOLEAN
          - timestamp: TIMESTAMP

      - name: freerun_audit_log
        description: Журнал аудита для античита
        columns:
          - id: UUID PRIMARY KEY
          - character_id: UUID FOREIGN KEY
          - action_type: VARCHAR(100)
          - validation_result: VARCHAR(50)
          - suspicious_flags: JSONB
          - timestamp: TIMESTAMP

  integrations:
    combat_session: |
      - Интеграция действий паркура с боевой сессией
      - Синхронизация позиций и состояний
      - Обработка атак с воздуха и стрельбы в движении

    ability_service: |
      - Получение мобильных версий способностей
      - Корректировка затрат способностей для паркура
      - Интеграция способностей с действиями паркура

    implant_service: |
      - Получение данных об имплантах для паркура
      - Расчет бонусов имплантов для выносливости
      - Интеграция имплантов с элементами паркура

    progression_service: |
      - Получение данных о навыках паркура
      - Расчет бонусов навыков для выносливости
      - Обновление навыков на основе действий паркура

    quest_service: |
      - Триггеры квестов при выполнении маршрутов
      - Проверка требований квестов для паркура
      - Интеграция с квестовыми маршрутами

    analytics_service: |
      - Логирование всех действий паркура
      - Сбор метрик эффективности
      - Анализ паттернов использования паркура
      - Детект эксплойтов

    inventory_service: |
      - Проверка экипировки для паркура
      - Получение данных о гравиботах и оборудовании
      - Расчет модификаторов экипировки

    realtime_gateway: |
      - Отправка realtime обновлений действий паркура
      - Синхронизация состояния выносливости
      - Уведомления о комбо и мобильных способностях

  data_consistency:
    strategy: Strong Consistency (ACID транзакции) для критичных операций
    mechanisms:
      - ACID транзакции для создания действий паркура и обновления состояния
      - Оптимистичные блокировки (versioning) для предотвращения конфликтов
      - Валидация перед выполнением действий паркура
      - Синхронизация с другими сервисами через Event Bus
      - Outbox Pattern для гарантированной доставки событий
      - Saga Pattern для распределенных операций (действие паркура, расход stamina, комбо)

  data_synchronization:
    event_sourcing: |
      Все изменения состояния паркура (выполнение действий, изменение stamina, комбо)
      записываются как события в Event Store. Это обеспечивает полный аудит,
      возможность восстановления состояния и "time travel" для отладки.
      Примеры событий: FreerunActionExecutedEvent, StaminaChangedEvent, ComboTriggeredEvent.
    cqrs_pattern: |
      Разделение команд (выполнение действий паркура, обновление stamina) и запросов
      (получение состояния паркура, история действий) для оптимизации производительности
      и масштабируемости. Read-модели могут быть кэшированы в Redis для быстрых запросов.
    saga_pattern: |
      Для распределенных транзакций, таких как выполнение действия паркура (проверка stamina,
      выполнение действия, расход stamina, проверка комбо, интеграция с боем), используется
      Saga Pattern для обеспечения атомарности операций между Gameplay Service,
      Stamina Manager и Combat Service.
    outbox_pattern: |
      Для гарантированной доставки событий в Event Bus используется Outbox Pattern,
      который записывает события в транзакционную таблицу перед публикацией.

  tickrate_and_network_requirements:
    freerun_actions:
      tickrate: 60-128 Hz
      network_load: |
        - Позиции персонажа: 60-128 updates/sec
        - Состояние действий: event-based, ~10-20 events/sec
        - Обновление stamina: 20-30 updates/sec
        - Общий трафик: ~5-10 KB/sec на игрока
      sync_strategy: Strong Consistency для позиций, Eventual для статистики

    wall_run:
      tickrate: 60-128 Hz
      network_load: |
        - Позиция во время Wall Run: 60-128 updates/sec
        - События начала/окончания: event-based
        - Общий трафик: ~2-3 KB/sec на игрока
      sync_strategy: Strong Consistency

    double_jump:
      tickrate: Event-based (on-demand)
      network_load: |
        - Событие прыжка: event-based, ~1-2 events/sec
        - Обновление позиции: 60-128 updates/sec
        - Общий трафик: ~0.5-1 KB/sec на игрока
      sync_strategy: Strong Consistency

    slide:
      tickrate: 60-128 Hz
      network_load: |
        - Позиция во время Slide: 60-128 updates/sec
        - События начала/окончания: event-based
        - Общий трафик: ~2-3 KB/sec на игрока
      sync_strategy: Strong Consistency

    air_dash:
      tickrate: Event-based (on-demand)
      network_load: |
        - Событие Air Dash: event-based, ~0.5-1 events/sec
        - Обновление позиции: 60-128 updates/sec
        - Общий трафик: ~0.5-1 KB/sec на игрока
      sync_strategy: Strong Consistency

    movement_attacks:
      tickrate: 60-128 Hz
      network_load: |
        - Атаки в движении: event-based, ~5-10 events/sec
        - Обновление позиции: 60-128 updates/sec
        - Общий трафик: ~3-5 KB/sec на игрока
      sync_strategy: Strong Consistency

    movement_combos:
      tickrate: Event-based (on-demand)
      network_load: |
        - Комбо из движения: event-based, ~1-3 events/sec
        - Обновление состояния: event-based
        - Общий трафик: ~0.5-1 KB/sec на игрока
      sync_strategy: Strong Consistency

technical_specification:
  reference: combat-freerun-architecture-spec.yaml

diagrams:
  reference: combat-freerun-architecture-spec.yaml

history:
  - version: '1.2.0'
    date: 2025-12-27
    author: Architect Agent
    changes: |
      Расширена архитектура Freerun с детальными элементами акробатики:
      - Добавлена классификация: basic_acrobatics, advanced_acrobatics, environmental_elements, cyberware_elements
      - Детально описаны параметры каждого элемента (stamina_cost, cooldown, automation_level, bonuses)
      - Добавлены acrobatics_combos: basic_combos, advanced_combos, environmental_combos
      - Добавлена интеграция с боевой системой: aerial_attacks, momentum_attacks, combo_finisher
      - Добавлена интеграция со способностями: dash_abilities, wall_abilities
      - Добавлена интеграция с прогрессией: skill_unlocks, implant_upgrades
      - Добавлены новые API endpoints для всех элементов акробатики
      - Добавлены новые события для акробатических элементов
      - Обновлена структура БД с новыми типами действий
  - version: '1.1.0'
    date: 2025-11-30
    author: Architect Agent
    changes: |
      Добавлена детальная синхронизация данных:
      - Event Sourcing для всех изменений состояния паркура
      - CQRS Pattern для разделения команд и запросов
      - Saga Pattern для распределенных операций
      - Outbox Pattern для гарантированной доставки событий
      - Обновлена секция data_consistency с механизмами синхронизации
  - version: '1.0.0'
    date: 2025-11-23
    author: Architect Agent
    changes: |
      Создана базовая архитектура системы Freerun:
      - Определены компоненты для управления паркуром
      - Описаны API endpoints и WebSocket каналы
      - Спроектированы потоки данных
      - Определена структура БД
      - Добавлены базовые элементы акробатики (wall_run, double_jump, slide, air_dash, wall_kick, vault)
      - Добавлена спецификация тикрейта и сетевой нагрузки

