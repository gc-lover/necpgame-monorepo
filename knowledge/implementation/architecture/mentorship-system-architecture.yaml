metadata:
  id: mentorship-system-architecture
  title: Архитектура системы наставничества
  document_type: architecture
  category: systems
  status: draft
  version: "1.0.0"
  last_updated: 2025-11-23T23:45:00Z
  owners:
    - role: architect
      contact: architect@necp.game
  tags:
    - architecture
    - social
    - mentorship
    - education
  related_systems:
    - social-service
    - economy-service
    - world-service
    - gameplay-service
    - content-service
  related_documents:
    - id: mentorship-system-detailed
      relation: implements
  github_issue: 303
  visibility: internal
  audience:
    - architect
    - backend
    - social
    - api-designer

summary:
  problem: |
    Требуется спроектировать архитектуру системы наставничества, включающую:
    - Типы наставничества (игрок→игрок, игрок→NPC, NPC→игрок, NPC→NPC, академии)
    - Пайплайн наставничества (инициирование, договоры, расписание, уроки, оценка)
    - Форматы обучения (теоретические, практические, контентные, экзаменационные, групповые, VR)
    - Навыки и награды
    - Репутацию наставника
    - Академии и образовательные центры
    - Цепочки наставничества
    - Экономику наставничества
  goal: |
    Создать архитектурную схему системы наставничества с определением:
    - Компонентов для управления наставничеством
    - REST, WebSocket и Event Bus контрактов
    - Интеграций с другими системами
    - Структуры БД
    - Технического задания для реализации
  essence: |
    Объединенная архитектура системы наставничества с поддержкой типов наставничества,
    процесса обучения, академий, цепочек наставничества и экономики.

architecture:
  overview: |
    Архитектура системы наставничества состоит из следующих компонентов:
    1. Mentorship Manager - управление наставничеством
    2. Mentorship Discovery Service - поиск наставников и учеников
    3. Contract Manager - управление договорами наставничества
    4. Schedule Manager - управление расписанием уроков
    5. Lesson Manager - управление уроками
    6. Learning Format Manager - управление форматами обучения
    7. Skill Progress Tracker - отслеживание прогресса навыков
    8. Mentor Reputation Manager - управление репутацией наставника
    9. Academy Manager - управление академиями
    10. Mentorship Chain Manager - управление цепочками наставничества
    11. Content Manager - управление учебным контентом
    12. Economy Manager - управление экономикой наставничества
    13. Mentorship Telemetry Collector - сбор телеметрии

  microservices:
    - name: social-service
      port: 8084
      responsibility: |
        Обработка наставничества:
        - Управление наставничеством
        - Поиск наставников и учеников
        - Управление договорами
        - Управление расписанием
        - Управление уроками
        - Управление форматами обучения
        - Отслеживание прогресса навыков
        - Управление репутацией наставника
        - Управление академиями
        - Управление цепочками наставничества
        - Управление учебным контентом
        - Управление экономикой наставничества
        - Сбор телеметрии
      components:
        - mentorship-manager: управление наставничеством
        - mentorship-discovery-service: поиск наставников и учеников
        - contract-manager: управление договорами наставничества
        - schedule-manager: управление расписанием уроков
        - lesson-manager: управление уроками
        - learning-format-manager: управление форматами обучения
        - skill-progress-tracker: отслеживание прогресса навыков
        - mentor-reputation-manager: управление репутацией наставника
        - academy-manager: управление академиями
        - mentorship-chain-manager: управление цепочками наставничества
        - content-manager: управление учебным контентом
        - economy-manager: управление экономикой наставничества
        - mentorship-telemetry-collector: сбор телеметрии
      endpoints:
        - GET /api/v1/social/mentorship/mentors - поиск наставников
        - GET /api/v1/social/mentorship/mentees - поиск учеников
        - GET /api/v1/social/mentorship/mentors/{mentorId} - информация о наставнике
        - POST /api/v1/social/mentorship/proposal/create - создание предложения наставничества
        - POST /api/v1/social/mentorship/proposal/{proposalId}/accept - принятие предложения
        - POST /api/v1/social/mentorship/proposal/{proposalId}/reject - отклонение предложения
        - POST /api/v1/social/mentorship/contract/create - создание договора
        - GET /api/v1/social/mentorship/contracts - список договоров
        - GET /api/v1/social/mentorship/contracts/{contractId} - информация о договоре
        - POST /api/v1/social/mentorship/contracts/{contractId}/terminate - расторжение договора
        - POST /api/v1/social/mentorship/schedule/create - создание расписания
        - GET /api/v1/social/mentorship/schedule/{contractId} - расписание договора
        - POST /api/v1/social/mentorship/schedule/{scheduleId}/update - обновление расписания
        - POST /api/v1/social/mentorship/lesson/create - создание урока
        - GET /api/v1/social/mentorship/lessons/{contractId} - список уроков
        - GET /api/v1/social/mentorship/lessons/{lessonId} - информация об уроке
        - POST /api/v1/social/mentorship/lessons/{lessonId}/start - начало урока
        - POST /api/v1/social/mentorship/lessons/{lessonId}/complete - завершение урока
        - POST /api/v1/social/mentorship/lessons/{lessonId}/evaluate - оценка урока
        - GET /api/v1/social/mentorship/skills/progress/{contractId} - прогресс навыков
        - GET /api/v1/social/mentorship/reputation/{mentorId} - репутация наставника
        - POST /api/v1/social/mentorship/reputation/{mentorId}/review - отзыв о наставнике
        - GET /api/v1/social/mentorship/academies - список академий
        - GET /api/v1/social/mentorship/academies/{academyId} - информация об академии
        - POST /api/v1/social/mentorship/academies/{academyId}/enroll - запись в академию
        - GET /api/v1/social/mentorship/academies/{academyId}/programs - программы академии
        - POST /api/v1/social/mentorship/chains/create - создание цепочки наставничества
        - GET /api/v1/social/mentorship/chains/{characterId} - цепочки наставничества персонажа
        - GET /api/v1/social/mentorship/content - поиск учебного контента
        - POST /api/v1/social/mentorship/content/create - создание учебного контента
        - GET /api/v1/social/mentorship/content/{contentId} - информация о контенте
        - GET /api/v1/social/mentorship/economy/payments - платежи наставничества
        - POST /api/v1/social/mentorship/economy/pay - обработка платежа
      websocket_channels:
        - wss://api.necp.game/v1/social/mentorship/{characterId} - поток обновлений наставничества и уроков
      events_published:
        - social.mentorship.proposal-created: создано предложение наставничества
        - social.mentorship.proposal-accepted: предложение принято
        - social.mentorship.proposal-rejected: предложение отклонено
        - social.mentorship.contract-created: создан договор
        - social.mentorship.contract-terminated: расторгнут договор
        - social.mentorship.schedule-created: создано расписание
        - social.mentorship.lesson-created: создан урок
        - social.mentorship.lesson-started: урок начат
        - social.mentorship.lesson-completed: урок завершен
        - social.mentorship.lesson-evaluated: урок оценен
        - social.mentorship.skill-progress-updated: обновлен прогресс навыков
        - social.mentorship.reputation-updated: обновлена репутация наставника
        - social.mentorship.academy-enrolled: запись в академию
        - social.mentorship.chain-created: создана цепочка наставничества
        - social.mentorship.content-created: создан учебный контент
        - social.mentorship.payment-processed: обработан платеж
      events_subscribed:
        - quest.completed: завершение квеста
        - character.level-up: повышение уровня персонажа
        - skill.level-up: повышение уровня навыка
        - reputation.changed: изменение репутации
        - economy.transaction: транзакция в экономике
        - world.event: событие мира
        - npc.interaction: взаимодействие с NPC

  mentorship_types:
    - name: player_to_player
      description: "Игрок → Игрок - Teacher-класс обучает других игроков"
      subclasses:
        - mentor: "фокус на новичках и базовых навыках"
        - professor: "углублённое обучение и создание учебного контента"
        - trainer: "боевые и технические интенсивы"
      requirements:
        - active_teacher_class: true
        - skill_level_exceeds_student: true
        - student_consent: true
      limits:
        - max_students: "зависит от уровня наставника"
        - one_mentor_per_skill: true
        - high_stats_required: true

    - name: player_to_npc
      description: "Игрок → NPC - игроки-Teacher прокачивают NPC"
      features:
        - high_cost: "высокая стоимость времени и ресурсов"
        - npc_enhancement: "расширение возможностей NPC"
        - story_impact: "влияние на сюжетные ветки"

    - name: npc_to_player
      description: "NPC → Игрок - NPC-наставники обучают игроков"
      requirements:
        - reputation: "требуется репутация"
        - special_quests: "специальные квесты"
        - npc_conditions: "соответствие условиям NPC"
      limits:
        - limited_skill_set: true
        - time_windows: true
        - story_dependencies: true

    - name: npc_to_npc
      description: "NPC → NPC - фоновая симуляция обучения между NPC"
      features:
        - world_simulation: "поддержка живости мира"
        - resource_redistribution: "перераспределение сил"
        - event_triggers: "вызов событий, влияющих на экономику и конфликты"

    - name: academy
      description: "Академии - корпоративные, бандитские и независимые образовательные центры"
      types:
        - corporate: "корпоративные академии"
        - gang: "бандитские академии"
        - independent: "независимые академии"
      features:
        - schedule_management: "управление расписаниями"
        - ratings: "рейтинги"
        - events: "события"
        - educational_hubs: "образовательные хабы городов"

  mentorship_pipeline:
    initiation: |
      - Поиск наставника или ученика
      - Создание предложения наставничества
      - Проверка требований и ограничений
      - Отправка предложения

    contract: |
      - Принятие или отклонение предложения
      - Создание договора наставничества
      - Определение условий договора
      - Фиксация обязанностей сторон
      - Тип оплаты и вознаграждения

    schedule: |
      - Планирование расписания уроков
      - Определение формата обучения
      - Установка времени и места
      - Настройка ресурсов

    execution: |
      - Проведение уроков
      - Отслеживание прогресса
      - Оценка результатов
      - Обновление навыков

    evaluation: |
      - Оценка урока
      - Обновление репутации наставника
      - Начисление наград
      - Решение о продолжении

  learning_formats:
    - name: theoretical
      description: "Теоретическое обучение - ускоряет освоение основ навыка"
      requirements:
        - resources: "минимальные"
        - time: "короткое"
        - interaction: "низкое"

    - name: practical
      description: "Практическое обучение - демонстрация и тренировки"
      requirements:
        - resources: "средние"
        - time: "среднее"
        - interaction: "высокое"

    - name: content_based
      description: "Контентное обучение - использование учебных материалов"
      requirements:
        - resources: "зависит от контента"
        - time: "зависит от контента"
        - interaction: "среднее"

    - name: examination
      description: "Экзаменационное обучение - проверка знаний"
      requirements:
        - resources: "минимальные"
        - time: "короткое"
        - interaction: "низкое"

    - name: group
      description: "Групповое обучение - обучение нескольких учеников"
      requirements:
        - resources: "высокие"
        - time: "длинное"
        - interaction: "высокое"

    - name: vr
      description: "VR-обучение - виртуальные кампусы и симуляции"
      requirements:
        - resources: "очень высокие"
        - time: "зависит от симуляции"
        - interaction: "очень высокое"

  skill_tracks:
    - name: combat
      description: "Боевые навыки"
      categories:
        - weapons
        - tactics
        - survival

    - name: social
      description: "Социальные навыки"
      categories:
        - negotiation
        - leadership
        - networking

    - name: technical
      description: "Технические навыки"
      categories:
        - engineering
        - hacking
        - crafting

    - name: economic
      description: "Экономические навыки"
      categories:
        - trading
        - investment
        - management

  mentor_reputation:
    factors: |
      - Опыт наставника
      - Отзывы учеников
      - Количество успешных выпускников
      - Качество учебного контента
      - Рейтинг академии

    benefits: |
      - Доступ к элитным программам
      - Повышенные вознаграждения
      - Приоритет в рекомендациях
      - Доступ к эксклюзивному контенту

    penalties: |
      - Санкции за жалобы
      - Штрафы за нарушения
      - Снижение репутации
      - Ограничение доступа

  academy_features:
    schedule_management: |
      - Управление расписаниями программ
      - Бронирование времени
      - Автоматизация расписаний

    ratings: |
      - Рейтинги академий
      - Рейтинги программ
      - Рейтинги наставников

    events: |
      - Образовательные события
      - Фестивали наставников
      - Выпускные церемонии

    educational_hubs: |
      - Образовательные хабы городов
      - Виртуальные кампусы
      - Интеграция с миром

  mentorship_chains:
    linear_chains: |
      - Последовательное обучение
      - Передача знаний от наставника к ученику
      - Ученик становится наставником

    network_chains: |
      - Сетевые цепочки обучения
      - Множественные наставники
      - Коллективное обучение

    faction_chains: |
      - Фракционные программы
      - Обучение внутри фракций
      - Влияние на фракции

    academy_chains: |
      - Академические программы
      - Структурированное обучение
      - Сертификация

  mentorship_economy:
    payment_models: |
      - Платные курсы
      - Гранты
      - Очки влияния
      - Ресурсы академий

    monetization: |
      - Создание и продажа учебного контента
      - Комиссии за обучение
      - Подписки на программы
      - Премиум доступ

    taxation: |
      - Налогообложение доходов наставников
