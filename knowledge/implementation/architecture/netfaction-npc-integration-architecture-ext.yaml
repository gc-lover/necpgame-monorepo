        constraints: |
          - UNIQUE(player_id, faction_id)
        indexes:
          - player_id, faction_id
          - faction_id, reputation_level

technical_specification:
  backend_requirements:
    - Расширение gameplay-service-go модулями:
      - net-operations (управление сетевыми операциями)
      - blackwall-operations (координация операций за Blackwall)
      - cyberspace-missions (миссии в киберпространстве)
      - network-intelligence (сетевая разведка)
      - hacking-resources (хакерские ресурсы)
      - netfaction-reputation (репутация сетевых фракций)
    - Расширение world-service-go модулем:
      - information-control (контроль информации)
    - Интеграция с npc-integration-system для базовой функциональности NPC
    - Интеграция с hacking-system для хакерских механик
    - Интеграция с cyberspace-system для киберпространства

  netfaction_npc_specific_requirements:
    - NPC Мамана Брижит (Voodoo Boys):
      - Квесты сетевых операций
      - Операции за Blackwall
      - Миссии в киберпространстве
      - Доступ к хакерским ресурсам
      - Управление информацией

  performance_requirements:
    - Поддержка до 30 активных сетевых операций одновременно
    - Задержка обновления состояния операций: <50 мс
    - Поддержка до 20 активных операций за Blackwall
    - Поддержка до 50 активных миссий в киберпространстве
    - Поддержка до 1000 единиц данных разведки

  scalability_requirements:
    - Горизонтальное масштабирование через пул инстансов
    - Кэширование состояния операций в Redis
    - Асинхронная обработка операций через event bus
    - Batch-обработка обновлений репутации

subtasks:
  - id: net-operation-manager-module
    title: Реализация Net Operation Manager модуля
    description: |
      Управление сетевыми операциями:
      - Создание сетевых операций
      - Координация участников
      - Управление целями операций
    priority: high
    estimated_time: 6-7 дней

  - id: blackwall-operation-coordinator-module
    title: Реализация Blackwall Operation Coordinator модуля
    description: |
      Координация операций за Blackwall:
      - Планирование операций
      - Координация участников
      - Управление рисками
    priority: high
    estimated_time: 7-8 дней

  - id: cyberspace-mission-system-module
    title: Реализация Cyberspace Mission System модуля
    description: |
      Система миссий в киберпространстве:
      - Создание миссий
      - Управление зонами
      - Координация участников
    priority: high
    estimated_time: 6-7 дней

  - id: network-intelligence-system-module
    title: Реализация Network Intelligence System модуля
    description: |
      Система сетевой разведки:
      - Сбор разведывательных данных
      - Управление информацией
      - Анализ данных
    priority: high
    estimated_time: 5-6 дней

  - id: hacking-resource-manager-module
    title: Реализация Hacking Resource Manager модуля
    description: |
      Управление хакерскими ресурсами:
      - Управление доступом к программам
      - Контроль кибердеков и демонов
      - Интеграция с экономикой
    priority: high
    estimated_time: 5-6 дней

  - id: information-control-system-module
    title: Реализация Information Control System модуля
    description: |
      Система контроля информации:
      - Управление доступом
      - Контроль распространения
      - Управление секретностью
    priority: high
    estimated_time: 4-5 дней

  - id: net-faction-reputation-tracker-module
    title: Реализация Net Faction Reputation Tracker модуля
    description: |
      Отслеживание репутации сетевых фракций:
      - Управление репутацией
      - Отслеживание истории
      - Интеграция с доверием
    priority: high
    estimated_time: 4-5 дней

  - id: database-schema-netfaction-integration
    title: Создание схемы БД для интеграции сетевых фракций
    description: |
      Создание таблиц для интеграции сетевых фракций:
      - net_operations
      - blackwall_operations
      - cyberspace_missions
      - network_intelligence_data
      - hacking_resources
      - information_access_control
      - netfaction_reputation
    priority: high
    estimated_time: 3-4 дня

  - id: api-endpoints-netfaction-integration
    title: Реализация REST API endpoints для интеграции сетевых фракций
    description: |
      Создание всех endpoints для интеграции сетевых фракций:
      - Net operation endpoints
      - Blackwall operation endpoints
      - Cyberspace mission endpoints
      - Intelligence endpoints
      - Hacking resource endpoints
      - Information control endpoints
      - Reputation endpoints
    priority: high
    estimated_time: 4-5 дней

  - id: integration-testing-netfaction
    title: Интеграционное тестирование систем сетевых фракций
    description: |
      Тесты интеграции сетевых фракций:
      - Тесты сетевых операций
      - Тесты операций за Blackwall
      - Тесты миссий в киберпространстве
      - Тесты сетевой разведки
      - Тесты хакерских ресурсов
      - Тесты контроля информации
      - Тесты репутации
    priority: high
    estimated_time: 6-7 дней

diagrams:
  component_diagram: |
    ```mermaid
    graph TB
        subgraph "Net Faction NPC Integration System"
            NOM[Net Operation Manager]
            BOC[Blackwall Operation Coordinator]
            CMS[Cyberspace Mission System]
            NIS[Network Intelligence System]
            HRM[Hacking Resource Manager]
            ICS[Information Control System]
            NFRT[Net Faction Reputation Tracker]
        end

        subgraph "NPC Integration System"
            NQM[NPC Quest Manager]
            NRT[NPC Relationship Tracker]
            NDS[NPC Dialogue System]
        end

        subgraph "Game Services"
            HS[Hacking System]
            CS[Cyberspace System]
            QE[Quest Engine]
            WS[World Service]
        end

        subgraph "Database"
            DB[(PostgreSQL<br/>net_operations<br/>blackwall_operations<br/>cyberspace_missions<br/>network_intelligence_data<br/>hacking_resources<br/>information_access_control<br/>netfaction_reputation)]
        end

        subgraph "NPC"
            NPC[Мамана Брижит<br/>Voodoo Boys Leader]
        end

        subgraph "Client"
            CL[UE5 Client]
        end

        CL -->|interact| NPC
        NPC --> NDS
        NDS --> NQM
        NDS --> NOM
        NDS --> BOC
        NDS --> CMS
        NDS --> NIS
        NDS --> HRM
        NOM --> HS
        BOC --> HS
        CMS --> CS
        NIS --> QE
        HRM --> WS
        ICS --> WS
        NFRT --> NRT
        NOM --> DB
        BOC --> DB
        CMS --> DB
        NIS --> DB
        HRM --> DB
        ICS --> DB
        NFRT --> DB
    ```

  blackwall_operation_flow_diagram: |
    ```mermaid
    sequenceDiagram
        participant C as Client
        participant NPC as Мамана Брижит
        participant NDS as NPC Dialogue System
        participant BOC as Blackwall Operation Coordinator
        participant HS as Hacking System
        participant NIS as Network Intelligence System

        C->>NPC: Interact
        NPC->>NDS: Show dialogue tree
        NDS->>C: Display "Blackwall Operation" option
        C->>NDS: Select "Blackwall Operation"
        NDS->>BOC: Request operation
        BOC->>HS: Plan operation
        HS->>BOC: Operation planned
        BOC->>C: Operation available
        C->>BOC: Join operation
        BOC->>HS: Start operation
        HS->>C: Operation in progress
        Note over C,HS: Operation behind Blackwall
        HS->>NIS: Extract data
        NIS->>BOC: Data retrieved
        BOC->>C: Operation completed
    ```

decisions:
  - id: adr-netfaction-npc-integration-architecture
    summary: |
      Выбрана архитектура, расширяющая общую NPC интеграцию для NPC лидеров сетевых фракций
      с фокусом на хакерство и операции за Blackwall.

  - id: adr-blackwall-operations
    summary: |
      Координация операций за Blackwall обеспечивает высокорисковый контент
      с управлением рисками и извлечением данных.

  - id: adr-cyberspace-missions
    summary: |
      Система миссий в киберпространстве обеспечивает разнообразный контент
      в виртуальных зонах с различными типами миссий.

  - id: adr-network-intelligence
    summary: |
      Система сетевой разведки обеспечивает сбор и анализ данных
      с управлением секретностью и контролем доступа.

  - id: adr-hacking-resources
    summary: |
      Управление хакерскими ресурсами обеспечивает доступ к уникальному софту
      и программам с контролем доступа на основе репутации.

validation:
  architecture_complete: true
  components_defined: true
  microservices_identified: true
  api_endpoints_described: true
  technical_specification_ready: true
  subtasks_defined: true

next_steps:
  - Передача задачи агенту API Designer для создания OpenAPI спецификации
  - Детализация схем данных для интеграции сетевых фракций
  - Определение формата операций за Blackwall
  - Создание спецификации системы сетевой разведки

history:
  - version: "1.0.0"
    date: 2025-11-23
    author: Architect Agent
    changes: |
      Создана полная архитектура интеграции NPC лидеров сетевых фракций с игровыми системами:
      - Определены компоненты (Net Operation Manager, Blackwall Operation Coordinator, Cyberspace Mission System, Network Intelligence System, Hacking Resource Manager, Information Control System, Net Faction Reputation Tracker)
      - Описаны API endpoints (высокоуровнево)
      - Спроектированы потоки данных (net operation flow, blackwall operation flow, cyberspace mission flow, intelligence gathering flow)
      - Определена структура БД (7 таблиц)
      - Спроектирована интеграция с игровыми системами (NPC integration, hacking system, cyberspace system, quest engine, world service)
      - Создано техническое задание
      - Разбито на подзадачи (10 подзадач)

