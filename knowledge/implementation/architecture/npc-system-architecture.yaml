metadata:
  id: npc-system-architecture
  title: Архитектура системы основных NPC
  document_type: architecture
  category: systems
  status: approved
  version: "1.0.0"
  last_updated: 2025-11-26T22:00:00Z
  processed_by: architect
  processed_at: 2025-11-23T14:40:00Z
  owners:
    - role: architect
      contact: architect@necp.game
  tags:
    - architecture
    - npc
    - social
    - game-design
    - ui-ux
  related_systems:
    - social-service
    - economy-service
    - quest-service
    - gameplay-service
    - world-service
  related_documents:
    - id: npc-hiring-system-architecture
      relation: extends
    - id: npc-integration-system-architecture
      relation: extends
  github_issue: 407
  visibility: internal
  audience:
    - architect
    - backend
    - game-design
    - ui-ux
    - api-designer

summary:
  problem: |
    Требуется спроектировать архитектуру системы основных NPC, включающую:
    - Типы NPC (Фиксер, Торговец, Тренер, Главарь банды, Директор корпорации и др.)
    - Интерфейсы взаимодействия для каждого типа
    - Функционал, доступный при взаимодействии
    - Интеграцию с квестами, экономикой, репутацией, навыками и фракциями
  goal: |
    Создать архитектурную схему системы основных NPC с определением:
    - Компонентов для управления типами NPC и их функционалом
    - REST, WebSocket и Event Bus контрактов
    - Интерфейсов взаимодействия (диалоги, торговля, обучение, фракции)
    - Интеграций с другими системами
    - Структуры БД для NPC, их типов и взаимодействий
    - Технического задания для реализации
  essence: |
    Система основных NPC обеспечивает взаимодействие игроков с различными типами NPC
    (Фиксер, Торговец, Тренер, Главарь банды, Директор корпорации и др.) через специализированные
    интерфейсы (диалоги, торговля, обучение, фракции) с интеграцией в квесты, экономику,
    репутацию, навыки и фракционную систему.

architecture:
  overview: |
    Система основных NPC состоит из следующих компонентов:
    1. NPC Type Manager - управление типами NPC и их функционалом
    2. NPC Interaction Manager - управление взаимодействиями с NPC
    3. Dialogue System - система диалогов с ветвлением
    4. Trading Interface Manager - управление торговыми интерфейсами
    5. Training Interface Manager - управление интерфейсами обучения
    6. Faction Interface Manager - управление фракционными интерфейсами
    7. NPC Quest Provider - предоставление квестов от NPC
    8. NPC Reputation Tracker - отслеживание репутации с NPC
    9. NPC State Manager - управление состоянием NPC

  includes:
    - npc-system-microservices.yaml
    - npc-system-components.yaml
    - npc-system-integrations.yaml
    - npc-system-database.yaml
    - npc-system-events.yaml
    - npc-system-technical-tasks.yaml
    - npc-system-diagrams.yaml
