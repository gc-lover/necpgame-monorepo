# Issue: #334
metadata:
  id: support-ticket-mechanics
  title: Архитектура системы тикетов поддержки - Механики
  document_type: architecture
  category: systems
  status: draft
  version: "1.1.0"
  last_updated: 2025-11-30T20:35:00Z
  github_issue: 334
  related_documents:
    - id: support-ticket-core
      relation: extends

ticket_categories:
  - name: technical
    description: "Технические проблемы - баги, лаги, краши"
    auto_categorization_keywords: [ "bug", "crash", "lag", "error", "glitch" ]

  - name: account
    description: "Проблемы с аккаунтом - вход, восстановление, безопасность"
    auto_categorization_keywords: [ "login", "password", "account", "security", "hack" ]

  - name: payment
    description: "Проблемы с платежами - оплата, возврат, подписка"
    auto_categorization_keywords: [ "payment", "refund", "subscription", "purchase", "money" ]

  - name: gameplay
    description: "Вопросы по геймплею - механики, баланс, прогресс"
    auto_categorization_keywords: [ "gameplay", "balance", "progress", "quest", "skill" ]

  - name: social
    description: "Социальные вопросы - гильдии, друзья, чат"
    auto_categorization_keywords: [ "guild", "friend", "chat", "social", "party" ]

  - name: report
    description: "Жалобы - читеры, токсичность, нарушение правил"
    auto_categorization_keywords: [ "cheat", "toxic", "report", "abuse", "violation" ]

  - name: suggestion
    description: "Предложения - идеи, фичи, улучшения"
    auto_categorization_keywords: [ "suggestion", "idea", "feature", "improvement", "wish" ]

  - name: other
    description: "Прочее - все остальные вопросы"
    auto_categorization_keywords: [ ]

ticket_priorities:
  - name: low
    description: "Низкий приоритет - не срочные вопросы"
    sla_response_time: "24 hours"
    sla_resolution_time: "7 days"
    auto_assignment_rules:
      - category: suggestion
      - category: other

  - name: medium
    description: "Средний приоритет - стандартные вопросы"
    sla_response_time: "12 hours"
    sla_resolution_time: "3 days"
    auto_assignment_rules:
      - category: gameplay
      - category: social

  - name: high
    description: "Высокий приоритет - важные вопросы"
    sla_response_time: "4 hours"
    sla_resolution_time: "1 day"
    auto_assignment_rules:
      - category: account
      - category: payment

  - name: critical
    description: "Критический приоритет - срочные проблемы"
    sla_response_time: "1 hour"
    sla_resolution_time: "4 hours"
    auto_assignment_rules:
      - category: technical
      - keywords: [ "crash", "hack", "security" ]

ticket_statuses:
  - name: open
    description: "Открыт - ожидает назначения агента"
    next_statuses: [ "assigned", "closed" ]

  - name: assigned
    description: "Назначен - назначен агент, ожидает ответа"
    next_statuses: [ "in_progress", "waiting_for_player", "closed" ]

  - name: in_progress
    description: "В работе - агент работает над тикетом"
    next_statuses: [ "waiting_for_player", "resolved", "closed" ]

  - name: waiting_for_player
    description: "Ожидает ответа игрока - агент ждет ответа"
    next_statuses: [ "in_progress", "resolved", "closed" ]

  - name: resolved
    description: "Решен - проблема решена, ожидает подтверждения"
    next_statuses: [ "closed" ]

  - name: closed
    description: "Закрыт - тикет закрыт"
    next_statuses: [ ]

agent_queues:
  types:
    - name: round_robin
      description: "Круговая очередь - равномерное распределение"
      assignment_strategy: "round_robin"

    - name: least_busy
      description: "Наименее загруженный - по количеству активных тикетов"
      assignment_strategy: "least_busy"

    - name: skill_based
      description: "По навыкам - по категориям и экспертизе"
      assignment_strategy: "skill_based"

    - name: priority_based
      description: "По приоритету - критичные тикеты первыми"
      assignment_strategy: "priority_based"

  rules:
    - max_tickets_per_agent: 10
    - max_critical_tickets_per_agent: 3
    - auto_reassign_timeout: "2 hours"
    - queue_refresh_interval: "5 minutes"

sla_monitoring:
  metrics:
    - first_response_time: "время первого ответа"
    - resolution_time: "время решения"
    - agent_response_time: "время ответа агента"
    - player_response_time: "время ответа игрока"

  thresholds:
    - metric: first_response_time
      warning: "80% от SLA"
      breach: "100% от SLA"

    - metric: resolution_time
      warning: "80% от SLA"
      breach: "100% от SLA"

  actions:
    - warning: "уведомление агента и супервайзера"
    - breach: "эскалация супервайзеру, уведомление менеджмента"

