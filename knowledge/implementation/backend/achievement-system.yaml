metadata:
  id: achievement-system
  title: 'Achievement System — Система достижений'
  document_type: implementation
  category: backend
  status: approved
  version: '1.0.0'
  last_updated: 2025-11-11T00:00:00Z
  concept_approved: true
  concept_reviewed_at: 2025-11-07T05:20:00Z
  owners:
    - role: concept_director
      contact: concept@necp.game
  tags:
    - achievements
    - engagement
    - backend
  topics:
    - event-driven
    - player-motivation
  related_systems:
    - world-service
    - notification-service
    - mail-service
  related_documents:
    - id: progression-skills
      relation: references
    - id: stock-exchange-overview
      relation: references
    - id: mentorship-system
      relation: references
  source: shared/docs/knowledge/implementation/backend/achievement-system.md
  visibility: internal
  audience:
    - backend
    - concept
    - gameplay
  risk_level: high
review:
  chain:
    - role: concept_director
      reviewer: ''
      reviewed_at: ''
      status: approved
  next_actions: []
summary:
  problem: Требуется единая система достижений, мотивирующая игроков и объединяющая события из всех сервисов.
  goal: Описать архитектуру, категории достижений, типы наград и взаимодействие с микросервисами.
  essence: Событийно-ориентированная платформа, отслеживающая прогресс и выдающая награды, титулы и уведомления.
  key_points:
    - world-service потребляет события от боёв, квестов, экономики, социальных действий.
    - Определены категории, типы и примеры достижений с наградами.
    - Прописаны API маршруты, форматы событий и требования к данным.
content:
  sections:
    - id: architecture
      title: 'Микросервисная архитектура'
      body: |
        Achievement-service работает на порту 8086, публикует API `/api/v1/world/achievements/*`, подписывается на события (combat, quest, trade, friend, character) и взаимодействует с notification- и mail-service.
      mechanics_links:
        - implementation/backend/mail-system.yaml
      assets: []
    - id: concept
      title: 'Концепция и цели'
      body: |
        Достижения повышают мотивацию, удержание, открывают возможности для престижа и вознаграждений. Поддерживаются титулы, баффы и внутриигровые ресурсы.
      mechanics_links:
        - mechanics/progression/progression-skills.yaml
      assets: []
    - id: categories
      title: 'Категории достижений'
      body: |
        Восемь направлений (Combat, Exploration, Economic, Social, Quests, Progression, PvP, Special) с примерами и наборами целей, включая прогресс и легендарные этапы.
      mechanics_links:
        - mechanics/economy/stock-exchange/stock-exchange-overview.yaml
      assets: []
    - id: types
      title: 'Типы достижений'
      body: |
        Описаны стандартные, прогрессивные и повторяющиеся достижения: структуры данных, примеры payload и наград.
      mechanics_links: []
      assets: []
    - id: rewards
      title: 'Награды и титулы'
      body: |
        Награды включают валюту, предметы, титулы, байнд на фракционную репутацию, опыт и визуальные элементы. Система поддерживает ежедневные/еженедельные сюрпризы и сезонные таблицы лидеров.
      mechanics_links: []
      assets: []
    - id: data_api
      title: 'Данные и API'
      body: |
        Зафиксированы таблицы `achievement_definitions`, `player_achievement_progress`, `player_titles`, события `achievement.unlocked` и REST-методы `GET/POST /achievements`, `GET /players/{id}/achievements`.
      mechanics_links: []
      assets: []
    - id: analytics
      title: 'Телеметрия и аналитика'
      body: |
        Логируются и анализируются метрики unlock rate, время достижения и корреляции с удержанием. Интеграция с BI и A/B тестами.
      mechanics_links: []
      assets: []
appendix:
  glossary: []
  references: []
implementation:
  needs_task: false
  queue_reference:
    - shared/trackers/queues/concept/queued.yaml
  blockers: []
history:
  - version: '1.0.0'
    date: 2025-11-06
    author: concept_director
    changes: 'Первичное описание системы достижений и взаимодействий.'
  - version: '1.0.1'
    date: 2025-11-11
    author: concept_director
    changes: 'Конвертация в YAML, структурирование категорий и API.'
validation:
  checksum: ''
  schema_version: '1.0'

