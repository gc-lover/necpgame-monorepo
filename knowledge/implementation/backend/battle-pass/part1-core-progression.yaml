metadata:
  id: backend-battle-pass-part1-core
  title: "Battle Pass — Part 1: Core & Progression"
  document_type: implementation
  category: backend
  status: approved
  version: '1.0.1'
  last_updated: 2025-11-07T23:58:00Z
  concept_approved: true
  concept_reviewed_at: 2025-11-07T02:40:00Z
  owners:
    - role: economy_lead
      contact: economy@necp.game
  tags:
    - battle-pass
    - progression
  topics:
    - monetization
    - gameplay-infra
  related_systems:
    - economy-service
    - analytics-service
    - notification-service
  related_documents:
    - id: backend-battle-pass-overview
      relation: references
    - id: backend-battle-pass-part2-rewards
      relation: precedes
  source: shared/docs/knowledge/implementation/backend/battle-pass/part1-core-progression.md
  visibility: internal
  audience:
    - backend
    - economy
  risk_level: high
review:
  chain:
    - role: economy_lead
      reviewer: ''
      reviewed_at: 2025-11-07T23:58:00Z
      status: approved
  next_actions: []
summary:
  problem: "Базовая механика battle pass требовала формализованного описания: прогресс, базы данных, премиум-треки."
  goal: "Документировать ядро battle pass: схемы сезонов, наград и прогресса игроков; логику XP и покупки премиума."
  essence: "Часть 1 описывает таблицы, XP систему и обработку премиум-покупок, включая уведомления и аналитику."
  key_points:
    - SQL схемы `battle_pass_seasons`, `battle_pass_rewards`, `player_battle_pass_progress`.
    - Система XP источников и Java метод `awardXP`.
    - Логика покупки премиума с проверками валюты и аналитикой.
content:
  sections:
    - id: overview
      title: Краткое описание
      body: |
        Battle Pass предоставляет бесплатный и премиальный треки на 100 уровней, поддерживает еженедельные испытания и
        начисляет сезонные награды.
      mechanics_links: []
    - id: database
      title: Схемы базы данных
      body: |
        Подробно описаны таблицы сезонов, наград и прогресса игрока с ограничениями, индексами и полями для премиума.
      mechanics_links: []
    - id: xp_system
      title: Система опыта
      body: |
        Перечислены источники XP и приведён Java код `awardXP`, обрабатывающий уровни, уведомления и события.
      mechanics_links: []
    - id: premium
      title: Покупка премиума
      body: |
        Метод `purchasePremium` проверяет наличие премиум-валюты, списывает её, активирует премиум трек и публикует события.
      mechanics_links: []
appendix:
  glossary: []
  references: []
  decisions: []
implementation:
  needs_task: false
  queue_reference:
    - shared/trackers/queues/concept/queued.yaml
  blockers: []
history:
  - version: '1.0.1'
    date: 2025-11-07
    author: economy_lead
    changes: Добавлены схемы, XP система и логика премиум-покупки.
validation:
  checksum: ''
  schema_version: '1.0'

