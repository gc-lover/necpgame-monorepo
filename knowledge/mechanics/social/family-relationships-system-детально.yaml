metadata:
  id: family-relationships-system-detailed
  title: 'Система семейных отношений с NPC — детальная версия'
  document_type: mechanics
  category: social
  status: approved
  version: '1.0.0'
  last_updated: 2025-11-11T00:00:00Z
  concept_approved: true
  concept_reviewed_at: 2025-11-09T11:21:00Z
  owners:
    - role: concept_director
      contact: concept@necp.game
  tags:
    - relationships
    - family
    - social
  topics:
    - family-dynamics
    - inheritance
  related_systems:
    - social-service
    - world-service
    - economy-service
    - character-service
  related_documents:
    - id: family-relationships-system
      relation: references
    - id: relationships-system
      relation: complements
    - id: npc-relationships-system-detailed
      relation: complements
    - id: mentorship-system-detailed
      relation: relates
    - id: npc-hiring-system-detailed
      relation: relates
  source: shared/docs/knowledge/mechanics/social/family-relationships-system-детально.md
  visibility: internal
  audience:
    - concept
    - systems
    - social-design
    - narrative
  risk_level: high
review:
  chain:
    - role: concept_director
      reviewer: ''
      reviewed_at: 2025-11-09T11:21:00Z
      status: approved
  next_actions: []
summary:
  problem: Требовалось формализовать семейные структуры NPC, эмоции, события и наследование для интеграции с социальными и нарративными системами.
  goal: Описать семейные деревья, события, квесты, экономику наследства и UX взаимодействия игрока с семьями.
  essence: Документ охватывает структуры семьи, эмоции, события, усыновление, наследование и метрики, поддерживая REST/Kafka обмен.
  key_points:
    - Определены семейные роли, атрибуты и расширенные кланы.
    - События охватывают свадьбы, кризисы, конфликты, праздники и квесты.
    - Экономика наследства и метрики интегрированы с economy- и world-service.
content:
  sections:
    - id: structures
      title: 'Структуры и роли'
      body: |
        Семья охватывает ядро, расширение, кланы, опеку и приёмные связи.
        Атрибуты членов включают статус, профессию, фракцию, эмоции и секреты.
      mechanics_links:
        - mechanics/social/family-relationships-system.yaml
        - mechanics/social/relationships-system.yaml
      assets: []
    - id: emotions
      title: 'Эмоции и доверие'
      body: |
        Базовые отношения усилены семейными коэффициентами, поддерживаются привязанность, тревога, гордость, гнев.
        Комбинации эмоций формируют поведение и запросы NPC.
      mechanics_links:
        - mechanics/social/npc-relationships-system-детально.yaml
        - mechanics/social/mentorship-system-детально.yaml
      assets: []
    - id: life_events
      title: 'События и квесты'
      body: |
        Свадьбы, рождения, болезни, конфликты, трагедии и праздники запускают цепочки заданий и влияет на отношения.
        Каждое событие имеет триггеры, последствия, визуальные сигналы и замеры влияния.
      mechanics_links:
        - mechanics/social/player-orders-system-детально.yaml
        - mechanics/social/mentorship-world-impact-детально.yaml
      assets: []
    - id: player_interactions
      title: 'Взаимодействие игрока и усыновление'
      body: |
        Диалоги, помощь, подарки, визиты и медиация расширяют отношения и открывают семейные квесты.
        Усыновление и вступление в семью требуют репутации, ресурсов и запускают новые ветви сюжета.
      mechanics_links:
        - mechanics/social/relationships-system.yaml
        - mechanics/social/mentorship-system.yaml
      assets: []
    - id: inheritance
      title: 'Наследование и ресурсы'
      body: |
        Наследство, завещания, споры и экономика влияют на ресурсы, налоги и фракционные проверки.
        Economy-service обрабатывает FamilyHeritageRequest и споры о наследстве.
      mechanics_links:
        - mechanics/social/npc-hiring-system-детально.yaml
        - mechanics/social/player-orders-economy.yaml
      assets: []
    - id: ux_metrics
      title: 'UX, API и метрики'
      body: |
        Дерево семьи, календарь, журнал и уведомления обеспечивают визуализацию истории и эмоций.
        Приведены REST эндпоинты, Kafka топики и метрики FamilyStabilityIndex, HeritageDisputeRate.
      mechanics_links:
        - mechanics/social/family-relationships-system.yaml
      assets: []
appendix:
  glossary: []
  references:
    - title: 'Family Tree Schema'
      path: schemas/social/family-tree-response.schema.json
    - title: 'Family Heritage Schema'
      path: schemas/economy/family-heritage.schema.json
implementation:
  needs_task: false
  queue_reference:
    - shared/trackers/queues/concept/queued.yaml
  blockers: []
history:
  - version: '1.0.0'
    date: 2025-11-07
    author: concept_director
    changes: 'Подробно описаны семейные структуры, события и наследование.'
  - version: '1.0.1'
    date: 2025-11-11
    author: concept_director
    changes: 'Конвертация в YAML, структурирование эмоций, событий и API.'
validation:
  checksum: ''
  schema_version: '1.0'


