metadata:
  id: relationships-system-detailed
  title: Система отношений и репутации — Детальная версия
  document_type: mechanics
  category: social
  status: approved
  version: '1.0.0'
  last_updated: 2025-11-09T01:28:00Z
  concept_approved: true
  concept_reviewed_at: 2025-11-09
  owners:
    - role: concept_director
      contact: concept@necp.game
  tags:
    - relationships
    - reputation
    - diplomacy
  topics:
    - social_systems
    - trust_management
  related_systems:
    - social-service
    - economy-service
    - world-service
    - gameplay-service
  related_documents:
    - id: player-orders-reputation
      relation: complements
    - id: family-relationships-system-detailed
      relation: complements
  source: shared/docs/knowledge/mechanics/social/relationships-system-детально.md
  visibility: internal
  audience:
    - concept
    - design
    - economy
  risk_level: medium
review:
  chain:
    - role: concept_director
      reviewer: ''
      reviewed_at: 2025-11-09
      status: approved
  next_actions: []
summary:
  problem: Требовалось комплексное описание шкал отношений, доверия и союзов для игроков, кланов и фракций.
  goal: Детализировать уровни репутации, доверительные договоры, союзы и их влияние на экономику и события мира.
  essence: Система объединяет репутацию, доверие и союзы, обеспечивая механики дипломатии, рейтингов и арбитража.
  key_points:
    - Репутация и доверие имеют сегменты с триггерами, эффектами и визуальной обратной связью.
    - Союзы и договоры объединяют игроков, кланы и фракции, влияя на экономику и world-events.
    - REST и Kafka события фиксируют изменения отношений и поддерживают аналитические метрики.
content:
  sections:
    - id: methodology
      title: Методика детализации
      body: |
        Документ фиксирует шкалы отношений, требования к интерфейсам и взаимодействие микросервисов. Логи взаимодействий и арбитраж обеспечивают аудит и санкции.
      mechanics_links:
        - mechanics/social/player-orders-reputation.yaml
      assets: []
    - id: player_relationships
      title: Уровни отношений между игроками
      body: |
        Статусы Friends, Close Allies и Pact определяют совместный доступ к ресурсам, а уровни Enemies и Nemesis инициируют предупреждения и PvP-квесты. Арбитраж позволяет обрабатывать жалобы на нечестное поведение.
      mechanics_links:
        - mechanics/social/player-orders-system-detailed.yaml
      assets: []
    - id: reputation_scale
      title: Репутация с кланами и фракциями
      body: |
        Шкала репутации от Hostile до Ally влияет на цены, доступ к базам и дипломатические статусы. Изменения репутации подсвечиваются в UI и сопровождаются квестами и экономическими последствиями.
      mechanics_links:
        - mechanics/social/family-relationships-system-detailed.yaml
      assets: []
    - id: trust_contracts
      title: Доверие и договоры
      body: |
        Доверие делится на пять уровней, определяя условия доступа к складам, кредитам и совместным базам. Договоры доверия описывают лимиты, долю прибыли и условия выхода, а арбитраж отслеживает нарушения.
      mechanics_links:
        - mechanics/social/player-orders-reputation.yaml
      assets: []
    - id: alliances
      title: Союзы и договоры
      body: |
        Combat, Trade, Clan и Faction союз поддерживают совместные операции, логистику и политические решения. Процесс создания союза включает приглашение, условия, подтверждение и публикацию с последующими штрафами за нарушение.
      mechanics_links:
        - mechanics/social/player-orders-system-detailed.yaml
      assets: []
    - id: ratings
      title: Рейтинги и социальный капитал
      body: |
        Рейтинги Overall, Combat, Trade, Reliability и Social Influence влияют на доступ к миссиям и наградам. В UI используются вкладки, сезонные трофеи и визуальные эффекты.
      mechanics_links:
        - mechanics/social/mentorship-system-detailed.yaml
      assets: []
    - id: history
      title: История взаимодействий и арбитраж
      body: |
        Логи фиксируют контракты, торговлю, боя, жалобы и решения. Фильтры и отзывы позволяют отслеживать репутационные изменения и применять санкции.
      mechanics_links:
        - mechanics/social/player-orders-reputation.yaml
      assets: []
    - id: factions_cities
      title: Влияние на фракции и города
      body: |
        Репутация с фракциями и городами меняет цены, доступ к хабам, безопасность и события. Daily-обновления информируют о войнах и дипломатических изменениях.
      mechanics_links:
        - mechanics/social/family-relationships-system-detailed.yaml
      assets: []
    - id: integrations
      title: Интеграции, API и аналитика
      body: |
        REST API обслуживают запросы к состоянию отношений, договорам доверия и истории. Kafka топики передают изменения репутации, создание договоров и события союзов. Метрики TrustStabilityIndex, ReputationVolatility и AllianceSuccessRate поддерживают аналитику.
      mechanics_links:
        - mechanics/social/player-orders-execution.yaml
      assets: []
appendix:
  glossary: []
  references: []
  decisions: []
implementation:
  needs_task: false
  queue_reference:
    - shared/trackers/queues/concept/queued.yaml
  blockers: []
history:
  - version: '1.0.0'
    date: 2025-11-07
    author: concept_director
    changes: Зафиксированы шкалы отношений, договоры доверия и союзы с интеграцией API и событий.
validation:
  checksum: ''
  schema_version: '1.0'

