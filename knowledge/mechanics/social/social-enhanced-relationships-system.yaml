# Issue: #140875791, #140875264, #140875277, #140875288, #140875312, #140875327, #140875336, #140875345, #140875352
metadata:
  id: mechanics-social-enhanced-relationships-system
  title: "Улучшенная система отношений — NPC, фракции и социальные связи"
  document_type: mechanics
  category: social
  status: approved
  version: "2.0.0"
  last_updated: 2025-12-28T00:00:00Z
  concept_approved: true
  concept_reviewed_at: 2025-12-28T00:00:00Z
  owners:
    - role: game_designer
      contact: design@necp.game
  tags:
    - social
    - relationships
    - npc
    - factions
    - reputation
    - alliances
  topics:
    - social-mechanics
    - relationship-dynamics
    - faction-interactions
    - reputation-systems
  related_systems:
    - social-service
    - relationship-service
    - faction-service
    - quest-service
  related_documents:
    - id: mechanics-social-relationships-system
      relation: extends
    - id: mechanics-faction-system
      relation: extends
  source: shared/docs/knowledge/mechanics/social/social-enhanced-relationships-system.md
  visibility: internal
  audience:
    - game-design
    - programming
    - qa
  risk_level: medium

review:
  chain:
    - role: game_designer
      reviewer: Social Systems Team
      reviewed_at: 2025-12-28T00:00:00Z
      status: approved
  next_actions: [ ]

summary:
  problem: Базовая система отношений не учитывает сложные социальные динамики Night City с множеством NPC и фракций.
  goal: Создать глубокую систему отношений, которая отражает реалистичную социальную сеть с альянсами, конфликтами и личными связями.
  essence: Улучшенная система отношений превращает NPC из статичных персонажей в живую социальную сеть, где действия игрока создают волновой эффект влияния.
  key_points:
    - Многоуровневая репутация (личная, фракционная, региональная)
    - Динамические отношения с эволюцией во времени
    - Социальные сети с эффектами домино
    - Этические выборы влияют на социальный ландшафт
    - Компаньонская система с глубокими связями

content:
  sections:
    - id: relationship-tiers
      title: Уровни отношений и их механика
      body: |
        **Базовые уровни отношений:**
        - **Stranger (Незнакомец):** 0-10% - Начальный контакт, базовые взаимодействия
        - **Contact (Контакт):** 10-25% - Регулярные взаимодействия, простые задания
        - **Associate (Приятель):** 25-50% - Доверительные отношения, средние задания
        - **Ally (Союзник):** 50-75% - Сильная связь, сложные задания, бонусы
        - **Confidant (Доверенное лицо):** 75-90% - Глубокое доверие, эксклюзивный контент
        - **Family/Brother (Семья):** 90-100% - Максимальная лояльность, уникальные возможности

        **Прогрессия отношений:**
        - **Positive Actions:** Выполнение заданий, подарки, защита интересов
        - **Negative Actions:** Предательство, конфликты, игнорирование
        - **Time Decay:** Отношения постепенно ухудшаются без взаимодействия
        - **Event Triggers:** Специальные события усиливают или ослабляют связь

    - id: reputation-types
      title: Типы репутации и их влияние
      body: |
        **Личная репутация (Personal Reputation):**
        - Влияет на индивидуальные отношения с NPC
        - Определяет доступ к личным историям и секретам
        - Бонусы: личные скидки, эксклюзивная информация

        **Фракционная репутация (Faction Reputation):**
        - Влияет на отношения со всей фракцией
        - Определяет доступ к фракционным ресурсам
        - Бонусы: фракционные задания, территориальный доступ

        **Региональная репутация (Regional Reputation):**
        - Влияет на отношения в конкретном районе/городе
        - Определяет социальный статус в сообществе
        - Бонусы: местные привилегии, социальная мобильность

        **Глобальная репутация (Global Reputation):**
        - Влияет на отношения по всему миру
        - Определяет международные возможности
        - Бонусы: глобальные квесты, межрегиональные связи

    - id: relationship-dynamics
      title: Динамика отношений и социальные сети
      body: |
        **Социальные сети (Social Networks):**
        - **Direct Connections:** Прямые отношения с NPC
        - **Indirect Influence:** Действия влияют на связанных NPC
        - **Faction Ripple Effects:** Изменения в фракции влияют на членов
        - **Regional Echoes:** Локальные события влияют на регион

        **Динамическая эволюция:**
        - **Relationship Aging:** Отношения развиваются со временем
        - **Contextual Changes:** Ситуации меняют восприятие
        - **Memory Systems:** NPC помнят прошлые взаимодействия
        - **Emotional States:** NPC имеют настроения и реакции

        **Эффекты домино:**
        - **Ally Benefits:** Союзники одного NPC могут стать союзниками
        - **Enemy Penalties:** Конфликты распространяются по сети
        - **Information Flow:** Новости передаются через социальные связи
        - **Opportunity Chains:** Одна возможность открывает другие

    - id: companion-system
      title: Система компаньонов и глубоких связей
      body: |
        **Типы компаньонов:**
        - **Combat Companion:** Боевой напарник с уникальными способностями
        - **Support Companion:** Помощник с социальными/техническими навыками
        - **Informant Companion:** Источник информации и разведки
        - **Loyal Ally:** Верный союзник с глубокими сюжетными связями

        **Компаньонские механики:**
        - **Loyalty Levels:** От простого напарника до преданного друга
        - **Personal Quests:** Индивидуальные сюжетные линии компаньонов
        - **Relationship Events:** Случайные события укрепляют связь
        - **Betrayal Risks:** Возможность предательства при низкой лояльности

        **Глубокие связи:**
        - **Emotional Bonds:** Романтические/семейные отношения
        - **Shared History:** Совместные приключения формируют легенды
        - **Mutual Growth:** Развитие персонажей влияет друг на друга
        - **Legacy Impact:** Отношения влияют на концовки и наследство

    - id: faction-interactions
      title: Взаимодействие фракций и политические альянсы
      body: |
        **Фракционные отношения:**
        - **Alliance Levels:** От нейтралитета до полного альянса
        - **Territorial Claims:** Конфликты за контроль районов
        - **Resource Sharing:** Экономические связи между фракциями
        - **Joint Operations:** Совместные операции и квесты

        **Политическая динамика:**
        - **Power Shifts:** Изменения влияния фракций со временем
        - **Diplomatic Events:** Переговоры и мирные соглашения
        - **War Declarations:** Объявления войны и перемирия
        - **Neutral Zones:** Территории с особым статусом

        **Игрок как посредник:**
        - **Mediation Quests:** Задания по урегулированию конфликтов
        - **Alliance Broker:** Создание альянсов между фракциями
        - **Peace Negotiations:** Переговоры о прекращении враждебности
        - **Diplomatic Rewards:** Бонусы за успешную дипломатию

    - id: ethical-choices
      title: Этические выборы и их социальные последствия
      body: |
        **Моральный компас:**
        - **Good/Evil Scale:** Основная ось моральных выборов
        - **Lawful/Chaotic Scale:** Отношение к правилам и авторитету
        - **Freedom/Control Scale:** Предпочтение свободы или порядка
        - **Technology/Tradition Scale:** Отношение к прогрессу

        **Социальные последствия:**
        - **Reputation Shifts:** Выборы влияют на репутацию у разных групп
        - **Relationship Changes:** NPC реагируют на моральные решения
        - **Faction Attitudes:** Фракции меняют отношение к игроку
        - **World Impact:** Глобальные изменения в зависимости от выборов

        **Комплексные дилеммы:**
        - **Personal vs Societal:** Личные интересы против общественного блага
        - **Short-term vs Long-term:** Немедленные выгоды против будущих последствий
        - **Means vs Ends:** Этика методов достижения целей
        - **Individual vs Group:** Личные свободы против групповых интересов

    - id: social-events
      title: Социальные события и динамический контент
      body: |
        **Типы социальных событий:**
        - **Personal Events:** Индивидуальные события с NPC
        - **Faction Events:** Групповые события фракций
        - **Regional Events:** События, затрагивающие район/город
        - **Global Events:** Мировые события с глобальным воздействием

        **Динамическая генерация:**
        - **Context-Based:** События основаны на текущих отношениях
        - **Time-Sensitive:** Ограниченные по времени возможности
        - **Chain Reactions:** Одно событие вызывает цепь других
        - **Player-Initiated:** Игрок может запускать социальные события

        **Иммерсивные элементы:**
        - **Natural Conversations:** Органичные диалоги с NPC
        - **Emotional Reactions:** Реалистичные эмоциональные отклики
        - **Memory Integration:** NPC помнят прошлые взаимодействия
        - **Social Gossip:** Новости распространяются по социальной сети

    - id: progression-integration
      title: Интеграция с системой прогрессии
      body: |
        **Социальная прогрессия:**
        - **Social XP:** Опыт за социальные взаимодействия
        - **Relationship Perks:** Навыки и бонусы от отношений
        - **Network Bonuses:** Преимущества от социальной сети
        - **Reputation Milestones:** Достижения за социальный рост

        **Влияние на геймплей:**
        - **Quest Access:** Новые квесты через социальные связи
        - **Resource Access:** Доступ к ресурсам через NPC
        - **Mechanic Unlocks:** Новые механики через фракции
        - **Story Branches:** Альтернативные сюжетные линии

        **Баланс и справедливость:**
        - **Multiple Paths:** Разные способы достижения целей
        - **Consequence Systems:** Последствия за все действия
        - **Recovery Options:** Возможность исправить ошибки
        - **Fair Rewards:** Сбалансированные награды за усилия

    - id: technical-implementation
      title: Техническая реализация и оптимизация
      body: |
        **Архитектура данных:**
        - **Relationship Graph:** Граф связей между NPC и фракциями
        - **Event Queue:** Система очередей для социальных событий
        - **Memory Systems:** Хранение истории взаимодействий
        - **Dynamic State:** Обновление состояний в реальном времени

        **Производительность:**
        - **Efficient Queries:** Оптимизированные запросы к социальным данным
        - **Batch Processing:** Групповая обработка социальных обновлений
        - **Caching Systems:** Кеширование часто используемых данных
        - **Scalable Design:** Архитектура для большого количества NPC

        **Синхронизация:**
        - **State Consistency:** Синхронизация состояний между клиентами
        - **Conflict Resolution:** Разрешение конфликтов в социальных данных
        - **Offline Support:** Работа социальных механик оффлайн
        - **Recovery Systems:** Восстановление после сбоев

references:
  - title: "Advanced Social AI Systems"
    type: internal
    url: "docs/ai/social-ai-advanced.md"
  - title: "Relationship Dynamics Research"
    type: internal
    url: "docs/research/relationship-dynamics.md"
  - title: "Faction Interaction Models"
    type: internal
    url: "docs/mechanics/faction-interaction-models.md"

implementation:
  needs_backend: true
  backend_complexity: high
  frontend_complexity: medium
  qa_requirements: extensive_social_testing
  performance_impact: medium
