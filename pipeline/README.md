# Pipeline

## Назначение
Этот каталог содержит эталонную документацию для организации мультиагентного воркфлоу в Cursor IDE. Материалы демонстрируют, как структурировать цепочку от идеи до релиза бекенда и фронтенда, фиксируя правила, роли, чеклисты и трекеры в отдельных файлах.

## Структура
- `GLOBAL-RULES.yaml` — единые принципы, применимые ко всем агентам.
- `process/` — описание пайплайна, статусов и зависимостей.
- `agents/` — структурированные YAML-инструкции (миссия, workflow, проверки и точки сдачи).
- `checklists/` — обязательные проверки для переходов между стадиями.
- `templates/` — унифицированные формы задач и записей в трекерах.
- `tasks/` — эталонные каталоги для черновиков задач по стадиям.
- `scripts/` — PowerShell-валидации и автоматика для переходов (ключевые `generate-tasks-from-queue.ps1` и `complete-task.ps1` работают поверх `Pipeline.Automation`).
- `../shared/docs/knowledge/` — основное хранилище канона и механик (YAML).
- `../shared/trackers/` — очереди и статусные таблицы в едином формате.
- `../services/openapi|backend|frontend/` — кодовые слои и генераторы.

## Принципы
- **API First** — спецификации создаются и утверждаются до реализации.
- **Docs as Code** — вся информация хранится в Markdown/YAML, версионируется через git.
- **SOLID / DRY / KISS** — инструкции лаконичны, без дублирования, разбиваются на файлы ≤400 строк.
- **Точнойности через чеклисты** — каждый переход между ролями подтверждается чеклистом.
- **Прозрачность статусов** — трекеры обновляются в начале и в конце работы каждого агента.
- **Валидация знаний** — перед передачей концептов выполняй `pipeline/scripts/check-knowledge-schema.ps1` (он же синхронизирует очереди и Activity Log).

## Использование
1. Concept Director проверяет новый материал на соответствие канону (`process/PIPELINE-OVERVIEW.yaml`).
2. Менеджер идей кладёт согласованный документ согласно `process/PIPELINE-OVERVIEW.yaml`.
3. Каждая роль читает свой файл в `agents/`, выполняет обязанности и отмечает чеклист.
4. Перед сдачей обновляются соответствующие YAML-трекеры и очереди; задачи создавай через `generate-tasks-from-queue.ps1`, а передачу на следующую стадию оформляй `complete-task.ps1` (ручное редактирование YAML исключено).
5. DevOps и QA фиксируют готовность, после чего фронтенд и коммуникации получают сигнал к запуску.
6. При каждом переходе по чеклистам выполняй указанные PowerShell-скрипты из `scripts/` — они формализуют валидацию и подтверждают соблюдение правил.
7. Для знаний и шаблонов используй `shared/docs/knowledge/templates/knowledge-entry-template.yaml` и проверяй изменения через `scripts/check-knowledge-schema.ps1`.
8. Генерация кода:
   - Backend: `pwsh -File services/backend/scripts/generate-openapi-layers.ps1 -ApiSpec services/openapi/api/v1/<domain>/<feature>.yaml [-Validate] [-DryRun]`.
   - Frontend: `pwsh -File services/frontend/scripts/generate-api-orval.ps1`.

## Сопровождение
- Ревизии инструкций проводятся еженедельно ответственным за документацию.
- Любое обновление сопровождается записью в `trackers/change-log.yaml`.
- Файлы, приближающиеся к лимиту по строкам, делятся на последовательности с суффиксами `_0001`, `_0002`, … и получают README с описанием структуры.

