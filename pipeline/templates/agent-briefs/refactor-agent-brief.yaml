agent: Refactor Agent
tasks_source:
  description: Архитектурные аудиты и замечания из журналов
locations:
  - "shared/trackers/activity-log.yaml"
  - "shared/trackers/blockers.yaml"
supporting_files:
  - "pipeline/agents/REFACTOR-AGENT-PLAYBOOK.yaml"
work_instructions:
  - "Выполни базовые проверки (структура каталогов, лимиты, безопасность)."
  - "Сформируй технические задачи и план рефакторинга."
  - "Используй `pipeline/scripts/generate-tasks-from-queue.ps1` (с префиксом целевой очереди, например `-Prefix VSN`) для развёртывания карточек технических инициатив в нужных каталогах pipeline/tasks."
  - "Используй `pipeline/scripts/queue-manager.ps1` или `python pipeline/scripts/queue_manager.py` для обновления очередей без ручного редактирования YAML."
  - "Установи pre-commit hook (`pwsh -File pipeline/scripts/install-precommit.ps1`) и проверь его работу на целевых ОС."
  - "Поддерживай GitFlow: контролируй ветки main/develop, обновляй инструкции и проверяй наличие branch protection."
  - "Проверь, что workflow `.github/workflows/ci.yml` содержит актуальные проверки (structure/openapi/backend/frontend/pr-main-validation)."
validation_scripts:
  - "pwsh -File pipeline/scripts/check-architecture-health.ps1 -RootPath C:\\NECPGAME"
  - "pwsh -File pipeline/scripts/check-directory-structure.ps1 -ApiRoot services/openapi/api/v1"
  - "pwsh -File pipeline/scripts/check-file-limits.ps1 -Path <list>"
  - "pwsh -File pipeline/scripts/check-knowledge-schema.ps1 -KnowledgeRoot shared/docs/knowledge"
  - "pwsh -File pipeline/scripts/run-precommit.ps1"
completion_actions:
  - "Обнови Activity Log, Decision Log и соответствующие очереди/трекеры."
  - "Передай задачи ответственным агентам и контролируй выполнение."
  - "Убедись, что `.cursor/rules/*.mdc` отражают актуальную структуру и пути."
  - "Задокументируй выявленные кроссплатформенные изменения и обнови соответствующие инструкции."
  - "Проверь, что workflow `.github/workflows/enforce-pr-merges.yml` и branch protection соответствуют принятым правилам."

