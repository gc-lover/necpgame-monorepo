{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://necpgame.com/schemas/kafka/social-guild-events.json",
  "title": "Social Guild Events",
  "description": "Guild management and social interaction events. Memory-optimized for frequent social operations. Real-time guild state synchronization.",
  "type": "object",
  "allOf": [
    {
      "$ref": "../core/base-event.json"
    },
    {
      "properties": {
        "event_type": {
          "enum": [
            "social.guild.create",
            "social.guild.update",
            "social.guild.disband",
            "social.guild.member.join",
            "social.guild.member.leave",
            "social.guild.member.kick",
            "social.guild.member.promote",
            "social.guild.member.demote",
            "social.guild.territory.claim",
            "social.guild.territory.lose",
            "social.guild.war.declare",
            "social.guild.war.end"
          ]
        },
        "data": {
          "oneOf": [
            {
              "$ref": "#/definitions/GuildCreateData"
            },
            {
              "$ref": "#/definitions/GuildUpdateData"
            },
            {
              "$ref": "#/definitions/GuildDisbandData"
            },
            {
              "$ref": "#/definitions/GuildMemberJoinData"
            },
            {
              "$ref": "#/definitions/GuildMemberLeaveData"
            },
            {
              "$ref": "#/definitions/GuildMemberKickData"
            },
            {
              "$ref": "#/definitions/GuildMemberPromoteData"
            },
            {
              "$ref": "#/definitions/GuildMemberDemoteData"
            },
            {
              "$ref": "#/definitions/GuildTerritoryClaimData"
            },
            {
              "$ref": "#/definitions/GuildTerritoryLoseData"
            },
            {
              "$ref": "#/definitions/GuildWarDeclareData"
            },
            {
              "$ref": "#/definitions/GuildWarEndData"
            }
          ]
        }
      }
    }
  ],
  "definitions": {
    "GuildCreateData": {
      "type": "object",
      "required": [
        "guild_id",
        "name",
        "leader_id"
      ],
      "properties": {
        "guild_id": {
          "type": "string",
          "format": "uuid",
          "description": "Unique guild identifier"
        },
        "name": {
          "type": "string",
          "minLength": 3,
          "maxLength": 50,
          "description": "Guild display name",
          "examples": [
            "Shadow Hunters"
          ]
        },
        "description": {
          "type": "string",
          "maxLength": 500,
          "description": "Guild description",
          "examples": [
            "Elite PvP guild focused on territory control"
          ]
        },
        "leader_id": {
          "type": "string",
          "format": "uuid",
          "description": "Guild leader player ID"
        },
        "initial_members": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "description": "Initial member player IDs",
          "maxItems": 10
        },
        "guild_type": {
          "type": "string",
          "enum": [
            "pvp",
            "pve",
            "trading",
            "social",
            "mixed"
          ],
          "description": "Primary guild focus",
          "default": "mixed"
        },
        "creation_fee": {
          "type": "integer",
          "minimum": 0,
          "description": "Fee paid for guild creation",
          "examples": [
            50000
          ]
        },
        "created_at": {
          "type": "string",
          "format": "date-time",
          "description": "Guild creation timestamp"
        },
        "level": {
          "type": "integer",
          "minimum": 1,
          "default": 1,
          "description": "Initial guild level"
        }
      }
    },
    "GuildUpdateData": {
      "type": "object",
      "required": [
        "guild_id",
        "updated_fields"
      ],
      "properties": {
        "guild_id": {
          "type": "string",
          "format": "uuid",
          "description": "Guild identifier"
        },
        "updated_fields": {
          "type": "object",
          "description": "Fields being updated",
          "properties": {
            "name": {
              "type": "string",
              "minLength": 3,
              "maxLength": 50,
              "description": "New guild name"
            },
            "description": {
              "type": "string",
              "maxLength": 500,
              "description": "New guild description"
            },
            "leader_id": {
              "type": "string",
              "format": "uuid",
              "description": "New guild leader"
            },
            "level": {
              "type": "integer",
              "minimum": 1,
              "description": "New guild level"
            },
            "is_active": {
              "type": "boolean",
              "description": "Guild active status"
            }
          }
        },
        "updated_by": {
          "type": "string",
          "format": "uuid",
          "description": "Player who made the update"
        }
      }
    },
    "GuildDisbandData": {
      "type": "object",
      "required": [
        "guild_id",
        "disband_reason"
      ],
      "properties": {
        "guild_id": {
          "type": "string",
          "format": "uuid",
          "description": "Guild identifier"
        },
        "disband_reason": {
          "type": "string",
          "enum": [
            "voluntary",
            "inactive",
            "leadership_change",
            "system_disband"
          ],
          "description": "Reason for disbanding"
        },
        "disbanded_by": {
          "type": "string",
          "format": "uuid",
          "description": "Player who disbanded the guild"
        },
        "member_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of members at disband time",
          "examples": [
            15
          ]
        },
        "assets_distributed": {
          "type": "integer",
          "minimum": 0,
          "description": "Total guild assets distributed",
          "examples": [
            150000
          ]
        },
        "disbanded_at": {
          "type": "string",
          "format": "date-time",
          "description": "Disband timestamp"
        }
      }
    },
    "GuildMemberJoinData": {
      "type": "object",
      "required": [
        "guild_id",
        "player_id",
        "joined_at"
      ],
      "properties": {
        "guild_id": {
          "type": "string",
          "format": "uuid",
          "description": "Guild identifier"
        },
        "player_id": {
          "type": "string",
          "format": "uuid",
          "description": "New member player ID"
        },
        "invited_by": {
          "type": "string",
          "format": "uuid",
          "description": "Player who invited this member"
        },
        "initial_rank": {
          "type": "string",
          "enum": [
            "recruit",
            "member",
            "officer",
            "leader"
          ],
          "description": "Initial member rank",
          "default": "recruit"
        },
        "joined_at": {
          "type": "string",
          "format": "date-time",
          "description": "Join timestamp"
        },
        "application_text": {
          "type": "string",
          "maxLength": 500,
          "description": "Member's application text if applicable"
        }
      }
    },
    "GuildMemberLeaveData": {
      "type": "object",
      "required": [
        "guild_id",
        "player_id",
        "leave_reason"
      ],
      "properties": {
        "guild_id": {
          "type": "string",
          "format": "uuid",
          "description": "Guild identifier"
        },
        "player_id": {
          "type": "string",
          "format": "uuid",
          "description": "Leaving member player ID"
        },
        "leave_reason": {
          "type": "string",
          "enum": [
            "voluntary",
            "kicked",
            "inactive",
            "banned"
          ],
          "description": "Reason for leaving"
        },
        "kicked_by": {
          "type": "string",
          "format": "uuid",
          "description": "Player who kicked this member (if applicable)"
        },
        "leave_message": {
          "type": "string",
          "maxLength": 200,
          "description": "Optional leave message"
        },
        "left_at": {
          "type": "string",
          "format": "date-time",
          "description": "Leave timestamp"
        }
      }
    },
    "GuildMemberKickData": {
      "type": "object",
      "required": [
        "guild_id",
        "player_id",
        "kicked_by",
        "kick_reason"
      ],
      "properties": {
        "guild_id": {
          "type": "string",
          "format": "uuid",
          "description": "Guild identifier"
        },
        "player_id": {
          "type": "string",
          "format": "uuid",
          "description": "Kicked member player ID"
        },
        "kicked_by": {
          "type": "string",
          "format": "uuid",
          "description": "Player who performed the kick"
        },
        "kick_reason": {
          "type": "string",
          "maxLength": 200,
          "description": "Reason for kicking",
          "examples": [
            "Violation of guild rules"
          ]
        },
        "kicked_at": {
          "type": "string",
          "format": "date-time",
          "description": "Kick timestamp"
        }
      }
    },
    "GuildMemberPromoteData": {
      "type": "object",
      "required": [
        "guild_id",
        "player_id",
        "new_rank",
        "promoted_by"
      ],
      "properties": {
        "guild_id": {
          "type": "string",
          "format": "uuid",
          "description": "Guild identifier"
        },
        "player_id": {
          "type": "string",
          "format": "uuid",
          "description": "Promoted member player ID"
        },
        "old_rank": {
          "type": "string",
          "enum": [
            "recruit",
            "member",
            "officer",
            "leader"
          ],
          "description": "Previous rank"
        },
        "new_rank": {
          "type": "string",
          "enum": [
            "recruit",
            "member",
            "officer",
            "leader"
          ],
          "description": "New rank"
        },
        "promoted_by": {
          "type": "string",
          "format": "uuid",
          "description": "Player who performed the promotion"
        },
        "promotion_reason": {
          "type": "string",
          "maxLength": 200,
          "description": "Reason for promotion"
        },
        "promoted_at": {
          "type": "string",
          "format": "date-time",
          "description": "Promotion timestamp"
        }
      }
    },
    "GuildMemberDemoteData": {
      "type": "object",
      "required": [
        "guild_id",
        "player_id",
        "new_rank",
        "demoted_by"
      ],
      "properties": {
        "guild_id": {
          "type": "string",
          "format": "uuid",
          "description": "Guild identifier"
        },
        "player_id": {
          "type": "string",
          "format": "uuid",
          "description": "Demoted member player ID"
        },
        "old_rank": {
          "type": "string",
          "enum": [
            "recruit",
            "member",
            "officer",
            "leader"
          ],
          "description": "Previous rank"
        },
        "new_rank": {
          "type": "string",
          "enum": [
            "recruit",
            "member",
            "officer",
            "leader"
          ],
          "description": "New rank"
        },
        "demoted_by": {
          "type": "string",
          "format": "uuid",
          "description": "Player who performed the demotion"
        },
        "demotion_reason": {
          "type": "string",
          "maxLength": 200,
          "description": "Reason for demotion"
        },
        "demoted_at": {
          "type": "string",
          "format": "date-time",
          "description": "Demotion timestamp"
        }
      }
    },
    "GuildTerritoryClaimData": {
      "type": "object",
      "required": [
        "guild_id",
        "territory_id",
        "claimed_at"
      ],
      "properties": {
        "guild_id": {
          "type": "string",
          "format": "uuid",
          "description": "Guild identifier"
        },
        "territory_id": {
          "type": "string",
          "format": "uuid",
          "description": "Territory identifier"
        },
        "territory_name": {
          "type": "string",
          "description": "Territory display name",
          "examples": [
            "Night City District 7"
          ]
        },
        "claimed_by": {
          "type": "string",
          "format": "uuid",
          "description": "Player who claimed the territory"
        },
        "claim_method": {
          "type": "string",
          "enum": [
            "combat_victory",
            "purchase",
            "negotiation",
            "system_grant"
          ],
          "description": "Method of claiming territory"
        },
        "previous_owner": {
          "type": "string",
          "format": "uuid",
          "description": "Previous territory owner guild ID"
        },
        "claimed_at": {
          "type": "string",
          "format": "date-time",
          "description": "Claim timestamp"
        },
        "control_points": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of control points in territory",
          "examples": [
            5
          ]
        }
      }
    },
    "GuildTerritoryLoseData": {
      "type": "object",
      "required": [
        "guild_id",
        "territory_id",
        "lost_at",
        "lose_reason"
      ],
      "properties": {
        "guild_id": {
          "type": "string",
          "format": "uuid",
          "description": "Guild identifier"
        },
        "territory_id": {
          "type": "string",
          "format": "uuid",
          "description": "Territory identifier"
        },
        "territory_name": {
          "type": "string",
          "description": "Territory display name"
        },
        "lost_to": {
          "type": "string",
          "format": "uuid",
          "description": "Guild that took the territory"
        },
        "lose_reason": {
          "type": "string",
          "enum": [
            "combat_defeat",
            "abandoned",
            "system_reclaim",
            "timeout"
          ],
          "description": "Reason for losing territory"
        },
        "lost_at": {
          "type": "string",
          "format": "date-time",
          "description": "Loss timestamp"
        },
        "defense_rating": {
          "type": "integer",
          "minimum": 0,
          "description": "Territory defense rating at time of loss",
          "examples": [
            750
          ]
        }
      }
    },
    "GuildWarDeclareData": {
      "type": "object",
      "required": [
        "war_id",
        "attacker_guild_id",
        "defender_guild_id",
        "declared_at"
      ],
      "properties": {
        "war_id": {
          "type": "string",
          "format": "uuid",
          "description": "Unique war identifier"
        },
        "attacker_guild_id": {
          "type": "string",
          "format": "uuid",
          "description": "Attacking guild ID"
        },
        "defender_guild_id": {
          "type": "string",
          "format": "uuid",
          "description": "Defending guild ID"
        },
        "territory_id": {
          "type": "string",
          "format": "uuid",
          "description": "Territory being contested"
        },
        "declared_by": {
          "type": "string",
          "format": "uuid",
          "description": "Player who declared the war"
        },
        "declaration_reason": {
          "type": "string",
          "maxLength": 500,
          "description": "Reason for declaring war"
        },
        "declared_at": {
          "type": "string",
          "format": "date-time",
          "description": "War declaration timestamp"
        },
        "war_type": {
          "type": "string",
          "enum": [
            "territory",
            "revenge",
            "resources",
            "dominance"
          ],
          "description": "Type of war",
          "default": "territory"
        }
      }
    },
    "GuildWarEndData": {
      "type": "object",
      "required": [
        "war_id",
        "winner_guild_id",
        "end_reason",
        "ended_at"
      ],
      "properties": {
        "war_id": {
          "type": "string",
          "format": "uuid",
          "description": "War identifier"
        },
        "winner_guild_id": {
          "type": "string",
          "format": "uuid",
          "description": "Winning guild ID"
        },
        "loser_guild_id": {
          "type": "string",
          "format": "uuid",
          "description": "Losing guild ID"
        },
        "end_reason": {
          "type": "string",
          "enum": [
            "victory",
            "surrender",
            "timeout",
            "mutual_agreement"
          ],
          "description": "Reason for war ending"
        },
        "ended_at": {
          "type": "string",
          "format": "date-time",
          "description": "War end timestamp"
        },
        "duration_days": {
          "type": "integer",
          "minimum": 1,
          "description": "War duration in days",
          "examples": [
            7
          ]
        },
        "casualties": {
          "type": "object",
          "description": "War casualties by guild",
          "properties": {
            "winner_losses": {
              "type": "integer",
              "minimum": 0,
              "description": "Winner guild losses"
            },
            "loser_losses": {
              "type": "integer",
              "minimum": 0,
              "description": "Loser guild losses"
            }
          }
        },
        "territory_transferred": {
          "type": "string",
          "format": "uuid",
          "description": "Territory transferred to winner"
        }
      }
    }
  }
}
