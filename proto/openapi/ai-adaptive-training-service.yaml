openapi: 3.0.3
info:
  title: AI Adaptive Training Service API
  description: 'API для обучения моделей машинного обучения адаптивного AI.


    **Основные возможности:**

    - Отправка данных для обучения моделей

    - Получение статуса моделей

    - Управление обучением

    '
  version: 1.0.0
  contact:
    name: NECPGAME API Support
    email: api@necp.game
servers:
  - url: http://localhost:8090/api/v1/ai
    description: Локальный сервер разработки
  - url: https://api.necp.game/api/v1/ai
    description: Продакшен сервер
tags:
  - name: Training
    description: Обучение моделей
  - name: Models
    description: Управление моделями
paths:
  /training/data:
    post:
      tags:
        - Training
      summary: Отправить данные для обучения
      description: 'Отправляет данные о тактиках и адаптациях для обучения моделей машинного обучения.

        '
      operationId: submitTrainingData
      security:
        - BearerAuth: [ ]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubmitTrainingDataRequest'
            example:
              encounter_id: a1b2c3d4-e5f6-7890-1234-567890abcdef
              tactics_data:
                player_positions: { }
                ability_usage: { }
                attack_patterns: { }
              adaptation_data:
                adaptation_type: focus_weak_player
                effectiveness: 0.85
              timestamp: '2025-12-01T10:00:00Z'
      responses:
        '200':
          description: Данные приняты для обучения
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubmitTrainingDataResponse'
              example:
                training_data_id: j0d1e2f3-h4g5-6789-0123-456789j01234
                status: accepted
                message: Training data submitted
        '400':
          $ref: common.yaml#/components/responses/BadRequest
        '401':
          $ref: common.yaml#/components/responses/Unauthorized
        '500':
          $ref: common.yaml#/components/responses/InternalServerError
  /models/status:
    get:
      tags:
        - Models
      summary: Получить статус моделей
      description: 'Возвращает статус всех моделей машинного обучения AI.

        '
      operationId: getModelsStatus
      security:
        - BearerAuth: [ ]
      responses:
        '200':
          description: Статус моделей
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ModelsStatusResponse'
              example:
                models:
                  - model_id: k1e2f3g4-i5h6-7890-1234-567890k01234
                    model_type: tactics_analyzer
                    version: 1.2.0
                    status: active
                    accuracy: 0.92
                    last_trained: '2025-12-01T09:00:00Z'
                  - model_id: l2f3g4h5-j6i7-8901-2345-678901l01234
                    model_type: adaptation_engine
                    version: 1.1.5
                    status: active
                    accuracy: 0.88
                    last_trained: '2025-12-01T08:00:00Z'
                total: 2
        '401':
          $ref: common.yaml#/components/responses/Unauthorized
        '500':
          $ref: common.yaml#/components/responses/InternalServerError
components:
  securitySchemes:
    BearerAuth:
      $ref: common.yaml#/components/securitySchemes/BearerAuth
  schemas:
    SubmitTrainingDataRequest:
      type: object
      required:
        - encounter_id
        - tactics_data
        - adaptation_data
      properties:
        encounter_id:
          type: string
          format: uuid
          description: ID боя
          example: a1b2c3d4-e5f6-7890-1234-567890abcdef
        timestamp:
          type: string
          format: date-time
          description: Время данных
          example: '2025-12-01T10:00:00Z'
        tactics_data:
          type: object
          description: Данные о тактиках
          additionalProperties: true
          example:
            player_positions: { }
            ability_usage: { }
            attack_patterns: { }
        adaptation_data:
          type: object
          description: Данные об адаптациях
          properties:
            adaptation_type:
              type: string
            effectiveness:
              type: number
              format: float
              minimum: 0.0
              maximum: 1.0
          additionalProperties: true
          example:
            adaptation_type: focus_weak_player
            effectiveness: 0.85
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    SubmitTrainingDataResponse:
      type: object
      required:
        - training_data_id
        - status
      properties:
        training_data_id:
          type: string
          format: uuid
          description: ID данных для обучения
          example: j0d1e2f3-h4g5-6789-0123-456789j01234
        message:
          type: string
          description: Дополнительное сообщение
          example: Training data submitted
        status:
          type: string
          enum:
            - accepted
            - rejected
            - pending
          description: Статус данных
          example: accepted
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ModelStatus:
      type: object
      required:
        - model_id
        - model_type
        - version
        - status
        - accuracy
        - last_trained
      properties:
        model_id:
          type: string
          format: uuid
          description: ID модели
          example: k1e2f3g4-i5h6-7890-1234-567890k01234
        version:
          type: string
          description: Версия модели
          example: 1.2.0
        model_type:
          type: string
          enum:
            - tactics_analyzer
            - adaptation_engine
            - counter_strategy
          description: Тип модели
          example: tactics_analyzer
        status:
          type: string
          enum:
            - active
            - training
            - inactive
          description: Статус модели
          example: active
        last_trained:
          type: string
          format: date-time
          description: Время последнего обучения
          example: '2025-12-01T09:00:00Z'
        accuracy:
          type: number
          format: float
          description: Точность модели (0.0-1.0)
          minimum: 0.0
          maximum: 1.0
          example: 0.92
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ModelsStatusResponse:
      type: object
      required:
        - models
        - total
      properties:
        models:
          type: array
          items:
            $ref: '#/components/schemas/ModelStatus'
          description: Список моделей
        total:
          type: integer
          description: Общее количество моделей
          minimum: 0
          example: 2
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
  responses:
    BadRequest:
      $ref: common.yaml#/components/responses/BadRequest
    Unauthorized:
      $ref: common.yaml#/components/responses/Unauthorized
    InternalServerError:
      $ref: common.yaml#/components/responses/InternalServerError
security:
  - BearerAuth: [ ]
