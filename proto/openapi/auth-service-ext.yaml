        password:
          type: string
          minLength: 8
          description: Пароль (минимум 8 символов)
        username:
          type: string
          minLength: 3
          maxLength: 50
          description: Уникальное имя пользователя
        acceptTerms:
          type: boolean
          description: Согласие с условиями использования

    LoginRequest:
      type: object
      required:
        - login
        - password
      properties:
        login:
          type: string
          description: Email или username
        password:
          type: string
          description: Пароль
        rememberMe:
          type: boolean
          default: false
          description: Запомнить сессию

    RefreshTokenRequest:
      type: object
      required:
        - refreshToken
      properties:
        refreshToken:
          type: string
          description: Refresh токен

    VerifyEmailRequest:
      type: object
      required:
        - token
      properties:
        token:
          type: string
          description: Токен верификации email

    ResendVerificationRequest:
      type: object
      required:
        - email
      properties:
        email:
          type: string
          format: email
          description: Email для повторной отправки

    ForgotPasswordRequest:
      type: object
      required:
        - email
      properties:
        email:
          type: string
          format: email
          description: Email для сброса пароля

    ResetPasswordRequest:
      type: object
      required:
        - token
        - newPassword
      properties:
        token:
          type: string
          description: Токен сброса пароля
        newPassword:
          type: string
          minLength: 8
          description: Новый пароль

    ChangePasswordRequest:
      type: object
      required:
        - currentPassword
        - newPassword
      properties:
        currentPassword:
          type: string
          description: Текущий пароль
        newPassword:
          type: string
          minLength: 8
          description: Новый пароль

    # Ответы
    RegisterResponse:
      type: object
      properties:
        userId:
          type: string
          format: uuid
          description: ID созданного пользователя
        email:
          type: string
          format: email
          description: Email пользователя
        username:
          type: string
          description: Имя пользователя
        verificationRequired:
          type: boolean
          description: Требуется верификация email
        message:
          type: string
          description: Сообщение пользователю

    LoginResponse:
      type: object
      properties:
        accessToken:
          type: string
          description: JWT токен доступа
        refreshToken:
          type: string
          description: Refresh токен
        tokenType:
          type: string
          default: Bearer
          description: Тип токена
        expiresIn:
          type: integer
          description: Время жизни токена в секундах
        user:
          $ref: "#/components/schemas/UserInfo"

    RefreshTokenResponse:
      type: object
      properties:
        accessToken:
          type: string
          description: Новый JWT токен доступа
        refreshToken:
          type: string
          description: Новый refresh токен
        tokenType:
          type: string
          default: Bearer
          description: Тип токена
        expiresIn:
          type: integer
          description: Время жизни токена в секундах

    OAuthCallbackResponse:
      type: object
      properties:
        accessToken:
          type: string
          description: JWT токен доступа
        refreshToken:
          type: string
          description: Refresh токен
        tokenType:
          type: string
          default: Bearer
          description: Тип токена
        expiresIn:
          type: integer
          description: Время жизни токена в секундах
        user:
          $ref: "#/components/schemas/UserInfo"
        isNewUser:
          type: boolean
          description: Был ли создан новый аккаунт

    SuccessResponse:
      type: object
      properties:
        success:
          type: boolean
          default: true
          description: Успешность операции
        message:
          type: string
          description: Сообщение пользователю

    UserInfo:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: ID пользователя
        email:
          type: string
          format: email
          description: Email пользователя
        username:
          type: string
          description: Имя пользователя
        emailVerified:
          type: boolean
          description: Подтвержден ли email
        createdAt:
          type: string
          format: date-time
          description: Дата создания аккаунта
        lastLoginAt:
          type: string
          format: date-time
          description: Последний вход

    UserRolesResponse:
      type: object
      properties:
        roles:
          type: array
          items:
            $ref: "#/components/schemas/Role"
          description: Список ролей пользователя

    UserPermissionsResponse:
      type: object
      properties:
        permissions:
          type: array
          items:
            type: string
          description: Список прав доступа

    Role:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: ID роли
        name:
          type: string
          description: Название роли
        description:
          type: string
          description: Описание роли
        permissions:
          type: array
          items:
            type: string
          description: Права роли

  responses:
    BadRequest:
      description: Неверный запрос
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                description: Описание ошибки
              code:
                type: string
                description: Код ошибки

    Unauthorized:
      description: Не авторизован
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                default: "Unauthorized"
              code:
                type: string
                default: "UNAUTHORIZED"

    Forbidden:
      description: Доступ запрещен
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                default: "Forbidden"
              code:
                type: string
                default: "FORBIDDEN"

    NotFound:
      description: Ресурс не найден
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                default: "Not found"
              code:
                type: string
                default: "NOT_FOUND"

    Conflict:
      description: Конфликт данных
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                default: "Conflict"
              code:
                type: string
                default: "CONFLICT"

    TooManyRequests:
      description: Слишком много запросов
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                default: "Too many requests"
              code:
                type: string
                default: "TOO_MANY_REQUESTS"
              retryAfter:
                type: integer
                description: Время ожидания в секундах

    InternalServerError:
      description: Внутренняя ошибка сервера
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                default: "Internal server error"
              code:
                type: string
                default: "INTERNAL_ERROR"
