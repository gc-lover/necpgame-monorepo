openapi: 3.0.3
components:
  schemas:
    UserAccount:
      description: Complete user account entity with infrastructure domain inheritance
      allOf:
      - $ref: ../common/schemas/infrastructure-entities.yaml#/UserAccountEntity
      - type: object
        properties:
          auth_provider_data:
            type: object
            description: OAuth provider specific data
            properties:
              google_id:
                type: string
                description: Google OAuth user ID
              discord_id:
                type: string
                description: Discord user ID
              steam_id:
                type: string
                description: Steam user ID
          last_password_change:
            type: string
            format: date-time
            description: When password was last changed
          password_reset_tokens:
            type: array
            items:
              type: object
              properties:
                token:
                  type: string
                  description: Reset token hash
                expires_at:
                  type: string
                  format: date-time
                  description: Token expiration
                used:
                  type: boolean
                  description: Whether token was used
    Session:
      description: Complete session entity with infrastructure domain inheritance
      allOf:
      - $ref: ../common/schemas/infrastructure-entities.yaml#/SessionEntity
      - type: object
        properties:
          oauth_provider:
            type: string
            enum:
            - google
            - discord
            - steam
            - email_password
            description: How session was created
          mfa_verified:
            type: boolean
            description: Whether MFA was verified for this session
            example: true
    ApiKey:
      description: Complete API key entity with infrastructure domain inheritance
      allOf:
      - $ref: ../common/schemas/infrastructure-entities.yaml#/ApiKeyEntity
      - type: object
        properties:
          scopes:
            type: array
            items:
              type: string
              enum:
              - read
              - write
              - admin
              - analytics
            description: API key permission scopes
    UserAccountSummary:
      description: Summary user account for authentication responses
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: User account ID
        username:
          type: string
          description: Username
        email:
          type: string
          format: email
          description: Email address
        account_status:
          type: string
          enum:
          - active
          - suspended
          - banned
          - pending_verification
          description: Account status
        email_verified:
          type: boolean
          description: Email verification status
        created_at:
          type: string
          format: date-time
          description: Account creation timestamp
    SessionSummary:
      description: Summary session for session management
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Session ID
        ip_address:
          type: string
          description: Client IP address
        user_agent:
          type: string
          description: Client user agent
        created_at:
          type: string
          format: date-time
          description: Session creation time
        last_activity_at:
          type: string
          format: date-time
          description: Last activity timestamp
        is_active:
          type: boolean
          description: Whether session is active
    LoginRequest:
      description: Request payload for user login
      type: object
      required:
      - identifier
      - password
      properties:
        identifier:
          type: string
          description: Username or email for login
          example: nightrunner2077
        password:
          type: string
          format: password
          minLength: 8
          description: User password
        remember_me:
          type: boolean
          description: Whether to extend session duration
          default: false
        mfa_code:
          type: string
          pattern: ^[0-9]{6}$
          description: 6-digit MFA code if enabled
    RegisterRequest:
      description: Request payload for user registration
      type: object
      required:
      - username
      - email
      - password
      properties:
        username:
          type: string
          minLength: 3
          maxLength: 30
          pattern: ^[a-zA-Z0-9_-]+$
          description: Unique username
          example: nightrunner2077
        email:
          type: string
          format: email
          description: Email address
          example: nightrunner@necpgame.com
        password:
          type: string
          format: password
          minLength: 8
          maxLength: 128
          description: Password (server validates complexity)
          example: MySecureP@ssw0rd123
        preferred_language:
          type: string
          enum:
          - en
          - es
          - zh
          - ja
          - ru
          - de
          - fr
          - pl
          - ko
          - pt
          description: User's preferred language
          default: en
        terms_accepted:
          type: boolean
          description: Whether terms of service were accepted
          example: true
        marketing_consent:
          type: boolean
          description: Consent for marketing communications
          example: false
    VerifyEmailRequest:
      description: Request payload for email verification
      type: object
      required:
      - token
      properties:
        token:
          type: string
          minLength: 32
          description: Email verification token
          example: abc123def456...
    RefreshTokenRequest:
      description: Request payload for token refresh
      type: object
      required:
      - refresh_token
      properties:
        refresh_token:
          type: string
          description: JWT refresh token
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
    ForgotPasswordRequest:
      description: Request payload for password reset initiation
      type: object
      required:
      - email
      properties:
        email:
          type: string
          format: email
          description: Account email address
          example: nightrunner@necpgame.com
    ResetPasswordRequest:
      description: Request payload for password reset completion
      type: object
      required:
      - token
      - new_password
      properties:
        token:
          type: string
          minLength: 32
          description: Password reset token
          example: reset_abc123...
        new_password:
          type: string
          format: password
          minLength: 8
          maxLength: 128
          description: New password
          example: NewSecureP@ssw0rd456
    AuthConfiguration:
      description: Auth service configuration entity
      allOf:
      - $ref: ../common/schemas/infrastructure-entities.yaml#/ConfigurationEntity
      - type: object
        properties:
          auth_settings:
            type: object
            description: Authentication-specific settings
            properties:
              password_min_length:
                type: integer
                minimum: 8
                maximum: 128
                description: Minimum password length
              session_timeout_hours:
                type: integer
                minimum: 1
                maximum: 168
                description: Session timeout in hours
              max_failed_attempts:
                type: integer
                minimum: 3
                maximum: 10
                description: Max failed login attempts before lockout
              lockout_duration_minutes:
                type: integer
                minimum: 5
                maximum: 1440
                description: Account lockout duration
    AuthAuditLog:
      description: Audit trail for authentication operations
      allOf:
      - $ref: ../common/schemas/infrastructure-entities.yaml#/AuditLogEntity
      - type: object
        properties:
          user_id:
            type: string
            format: uuid
            description: Associated user account ID
          operation_type:
            type: string
            enum:
            - login
            - logout
            - register
            - verify_email
            - password_reset
            - session_revoke
            - oauth_login
            description: Type of authentication operation performed
