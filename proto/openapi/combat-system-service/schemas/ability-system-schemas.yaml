# Ability System Schemas - Domain Separation
# Handles combat abilities and special moves management
# Issue: #2231

openapi: 3.0.3
info:
  title: Ability System Schemas
  version: 1.0.0
  description: Domain-separated schemas for combat ability configurations

components:
  schemas:

    AbilityConfigurationsResponse:
      type: object
      required: [abilities, pagination]
      properties:
        abilities:
          type: array
          items:
            $ref: '#/components/schemas/AbilityConfiguration'
        pagination:
          type: object
          properties:
            page:
              type: integer
              minimum: 1
            limit:
              type: integer
              minimum: 1
              maximum: 100
            total_count:
              type: integer
              minimum: 0
            total_pages:
              type: integer
              minimum: 0
            has_next:
              type: boolean
            has_previous:
              type: boolean

    AbilityConfiguration:
      type: object
      required: [id, name, ability_type, power_level, cooldown, resource_cost]
      properties:
        id:
          type: string
          format: uuid
          description: Unique ability identifier
        name:
          type: string
          description: Human-readable ability name
        description:
          type: string
          description: Detailed ability description
        ability_type:
          type: string
          enum: [offensive, defensive, utility, ultimate]
          description: Category of ability
        power_level:
          type: integer
          minimum: 1
          maximum: 10
          description: Relative power level for balancing
        cooldown:
          type: integer
          minimum: 0
          maximum: 300000
          description: Cooldown in milliseconds
        resource_cost:
          type: integer
          minimum: 0
          maximum: 1000
          description: Resource points required to use
        stat_requirements:
          type: object
          properties:
            minimum_level:
              type: integer
              minimum: 1
              maximum: 100
              default: 1
            required_stats:
              type: object
              properties:
                strength:
                  type: integer
                  minimum: 0
                  default: 0
                intelligence:
                  type: integer
                  minimum: 0
                  default: 0
                dexterity:
                  type: integer
                  minimum: 0
                  default: 0
                wisdom:
                  type: integer
                  minimum: 0
                  default: 0
        damage_scaling:
          type: object
          properties:
            base_damage:
              type: integer
              minimum: 0
              maximum: 10000
            damage_type:
              type: string
              enum: [physical, magical, pure]
            scaling_stat:
              type: string
              enum: [strength, intelligence, dexterity]
            scaling_factor:
              type: number
              format: float
              minimum: 0.0
              maximum: 5.0
        effect_modifiers:
          type: array
          items:
            $ref: '#/components/schemas/AbilityEffect'
          description: Status effects applied by ability
        targeting_rules:
          type: object
          properties:
            range:
              type: integer
              minimum: 0
              maximum: 1000
              description: Ability range in game units
            target_type:
              type: string
              enum: [self, single_target, aoe, line, cone]
            max_targets:
              type: integer
              minimum: 1
              maximum: 20
              default: 1
        balance_notes:
          type: string
          description: Game designer's balancing notes
        is_enabled:
          type: boolean
          default: true
          description: Whether ability is currently enabled
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    AbilityEffect:
      type: object
      required: [effect_type, duration]
      properties:
        effect_type:
          type: string
          enum: [damage_over_time, heal_over_time, buff, debuff, stun, silence, root, speed_boost]
        duration:
          type: integer
          minimum: 0
          maximum: 300000
          description: Effect duration in milliseconds
        magnitude:
          type: number
          format: float
          description: Effect strength or magnitude
        tick_rate:
          type: integer
          minimum: 0
          maximum: 60000
          description: How often effect ticks (for DoT/HoT)
        stat_modifier:
          type: string
          enum: [health, damage, defense, speed, critical_chance]
          description: Which stat is modified
        stacks:
          type: integer
          minimum: 1
          maximum: 10
          default: 1
          description: How many times effect can stack

    UpdateAbilityConfigurationRequest:
      type: object
      required: [version]
      properties:
        version:
          type: integer
          minimum: 1
          description: Current version for optimistic locking
        name:
          type: string
        description:
          type: string
        power_level:
          type: integer
          minimum: 1
          maximum: 10
        cooldown:
          type: integer
          minimum: 0
          maximum: 300000
        resource_cost:
          type: integer
          minimum: 0
          maximum: 1000
        stat_requirements:
          type: object
          properties:
            minimum_level:
              type: integer
              minimum: 1
              maximum: 100
            required_stats:
              type: object
              properties:
                strength:
                  type: integer
                  minimum: 0
                intelligence:
                  type: integer
                  minimum: 0
                dexterity:
                  type: integer
                  minimum: 0
                wisdom:
                  type: integer
                  minimum: 0
        damage_scaling:
          type: object
          properties:
            base_damage:
              type: integer
              minimum: 0
              maximum: 10000
            damage_type:
              type: string
              enum: [physical, magical, pure]
            scaling_stat:
              type: string
              enum: [strength, intelligence, dexterity]
            scaling_factor:
              type: number
              format: float
              minimum: 0.0
              maximum: 5.0
        effect_modifiers:
          type: array
          items:
            $ref: '#/components/schemas/AbilityEffect'
        targeting_rules:
          type: object
          properties:
            range:
              type: integer
              minimum: 0
              maximum: 1000
            target_type:
              type: string
              enum: [self, single_target, aoe, line, cone]
            max_targets:
              type: integer
              minimum: 1
              maximum: 20
        balance_notes:
          type: string
        is_enabled:
          type: boolean

    AbilityBalanceUpdate:
      type: object
      required: [ability_id, update_type, new_value]
      properties:
        ability_id:
          type: string
          format: uuid
        update_type:
          type: string
          enum: [power_level, cooldown, resource_cost, damage_scaling, effect_magnitude]
        new_value:
          type: number
          format: float
          description: New value for the balance parameter
        reason:
          type: string
          description: Reason for the balance change

    AbilityBalanceBulkUpdateRequest:
      type: object
      required: [updates]
      properties:
        updates:
          type: array
          items:
            $ref: '#/components/schemas/AbilityBalanceUpdate'
          minItems: 1
          maxItems: 100
          description: List of ability balance updates to apply
        batch_reason:
          type: string
          description: Reason for this batch of balance changes
        apply_immediately:
          type: boolean
          default: false
          description: Whether to apply changes immediately or schedule them

    AbilityBalanceBulkUpdateResponse:
      type: object
      required: [total_updates, successful_updates, failed_updates]
      properties:
        total_updates:
          type: integer
          minimum: 0
        successful_updates:
          type: integer
          minimum: 0
        failed_updates:
          type: integer
          minimum: 0
        errors:
          type: array
          items:
            type: object
            properties:
              ability_id:
                type: string
                format: uuid
              error_message:
                type: string
        applied_at:
          type: string
          format: date-time
          description: When the changes were applied