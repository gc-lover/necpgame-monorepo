# Combat Rules Schemas - Domain Separation
# Handles core combat system rules and mechanics
# Issue: #2231

openapi: 3.0.3
info:
  title: Combat Rules Schemas
  version: 1.0.0
  description: Domain-separated schemas for combat system rules management

components:
  schemas:

    CombatSystemRules:
      type: object
      required: [version, damage_rules, combat_mechanics, balance_parameters]
      properties:
        id:
          type: string
          format: uuid
          description: Unique configuration identifier
        version:
          type: integer
          minimum: 1
          description: Configuration version for optimistic locking
        damage_rules:
          $ref: '#/components/schemas/DamageRules'
        combat_mechanics:
          $ref: '#/components/schemas/CombatMechanics'
        balance_parameters:
          $ref: '#/components/schemas/BalanceParameters'
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        created_by:
          type: string
          description: User who created this configuration

    DamageRules:
      type: object
      required: [base_damage_multiplier, critical_hit_multiplier, armor_reduction_factor]
      properties:
        base_damage_multiplier:
          type: number
          format: float
          minimum: 0.1
          maximum: 5.0
          default: 1.0
          description: Global damage multiplier
        critical_hit_multiplier:
          type: number
          format: float
          minimum: 1.0
          maximum: 3.0
          default: 1.5
          description: Critical hit damage multiplier
        armor_reduction_factor:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.7
          description: How much armor reduces incoming damage
        environmental_modifiers:
          type: object
          properties:
            weather_damage_modifier:
              type: number
              format: float
              description: Weather-based damage modifier
            time_of_day_modifier:
              type: number
              format: float
              description: Time-based damage modifier

    CombatMechanics:
      type: object
      required: [turn_based_enabled, action_points_system, interruption_rules]
      properties:
        turn_based_enabled:
          type: boolean
          default: false
          description: Enable turn-based combat mode
        action_points_system:
          type: object
          properties:
            max_action_points:
              type: integer
              minimum: 1
              maximum: 10
              default: 3
            points_per_turn:
              type: integer
              minimum: 1
              maximum: 5
              default: 3
        interruption_rules:
          type: object
          properties:
            allow_interruptions:
              type: boolean
              default: true
            interruption_penalty:
              type: integer
              minimum: 0
              maximum: 100
              default: 50
              description: Action point penalty for interruptions

    BalanceParameters:
      type: object
      required: [difficulty_scaling, player_advantages, npc_modifiers]
      properties:
        difficulty_scaling:
          type: object
          properties:
            scaling_factor:
              type: number
              format: float
              minimum: 0.1
              maximum: 2.0
              default: 1.0
            level_difference_modifier:
              type: number
              format: float
              description: Damage modifier based on level difference
        player_advantages:
          type: object
          properties:
            first_strike_bonus:
              type: number
              format: float
              description: Damage bonus for first strike
            positional_advantage:
              type: number
              format: float
              description: Damage bonus for high ground
        npc_modifiers:
          type: object
          properties:
            elite_multiplier:
              type: number
              format: float
              default: 1.5
              description: Damage multiplier for elite NPCs
            boss_multiplier:
              type: number
              format: float
              default: 2.0
              description: Damage multiplier for boss NPCs

    UpdateCombatSystemRulesRequest:
      type: object
      required: [version]
      properties:
        version:
          type: integer
          minimum: 1
          description: Current version for optimistic locking
        damage_rules:
          $ref: '#/components/schemas/DamageRules'
        combat_mechanics:
          $ref: '#/components/schemas/CombatMechanics'
        balance_parameters:
          $ref: '#/components/schemas/BalanceParameters'