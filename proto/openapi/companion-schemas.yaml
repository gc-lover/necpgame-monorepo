openapi: 3.0.3
info:
  title: Companion Common Schemas
  description: Общие схемы для системы компаньонов
  version: 1.0.0
components:
  schemas:
    CompanionType:
      type: object
      properties:
        id:
          type: string
          format: uuid
        code:
          type: string
          maxLength: 50
        name:
          type: string
          maxLength: 255
        subcategory:
          type: string
          maxLength: 100
        description:
          type: string
        category:
          type: string
          enum:
            - COMBAT_DRONE
            - UTILITY
            - SOCIAL_PET
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        stats:
          type: object
          additionalProperties: true
        abilities:
          type: array
          items:
            $ref: '#/components/schemas/CompanionAbility'
        cost:
          type: integer
          format: int64
        base_health:
          type: integer
        base_damage:
          type: integer
        base_xp:
          type: integer
        max_level:
          type: integer
          default: 50
        is_active:
          type: boolean
          default: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CompanionAbility:
      type: object
      properties:
        id:
          type: string
          format: uuid
        companion_type_id:
          type: string
          format: uuid
        code:
          type: string
          maxLength: 50
        name:
          type: string
          maxLength: 255
        description:
          type: string
        ability_type:
          type: string
          enum:
            - ACTIVE
            - PASSIVE
        effects:
          type: object
          additionalProperties: true
        cooldown_seconds:
          type: integer
          nullable: true
        is_active:
          type: boolean
          default: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    PlayerCompanion:
      type: object
      properties:
        id:
          type: string
          format: uuid
        player_id:
          type: string
          format: uuid
        companion_type_id:
          type: string
          format: uuid
        name:
          type: string
          maxLength: 255
        summoned_at:
          type: string
          format: date-time
          nullable: true
        purchased_at:
          type: string
          format: date-time
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        equipment:
          type: object
          additionalProperties: true
          nullable: true
        customization:
          type: object
          additionalProperties: true
          nullable: true
        companion_type:
          $ref: '#/components/schemas/CompanionType'
        level:
          type: integer
          minimum: 1
          maximum: 50
          default: 1
        experience:
          type: integer
          minimum: 0
          default: 0
        experience_to_next_level:
          type: integer
          minimum: 0
        health:
          type: integer
        damage:
          type: integer
        is_summoned:
          type: boolean
          default: false
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    PurchaseCompanionRequest:
      type: object
      required:
        - player_id
        - companion_type_id
      properties:
        player_id:
          type: string
          format: uuid
        companion_type_id:
          type: string
          format: uuid
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    SummonCompanionRequest:
      type: object
      required:
        - player_id
      properties:
        player_id:
          type: string
          format: uuid
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    DismissCompanionRequest:
      type: object
      required:
        - player_id
      properties:
        player_id:
          type: string
          format: uuid
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    AddXPRequest:
      type: object
      required:
        - player_id
        - amount
        - source
      properties:
        player_id:
          type: string
          format: uuid
        source:
          type: string
          maxLength: 100
          enum:
            - enemy_killed
            - combat_assistance
            - loot_collected
            - hack_completed
            - craft_completed
        amount:
          type: integer
          minimum: 1
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    UseAbilityRequest:
      type: object
      required:
        - player_id
      properties:
        player_id:
          type: string
          format: uuid
        target_id:
          type: string
          format: uuid
          nullable: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    RenameCompanionRequest:
      type: object
      required:
        - player_id
        - name
      properties:
        player_id:
          type: string
          format: uuid
        name:
          type: string
          minLength: 1
          maxLength: 255
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    EquipCompanionItemRequest:
      type: object
      required:
        - player_id
        - item_id
      properties:
        player_id:
          type: string
          format: uuid
        item_id:
          type: string
          format: uuid
        slot:
          type: string
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CustomizeCompanionRequest:
      type: object
      required:
        - player_id
      properties:
        player_id:
          type: string
          format: uuid
        customization:
          type: object
          additionalProperties: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CompanionAttackRequest:
      type: object
      required:
        - player_id
        - target_id
      properties:
        player_id:
          type: string
          format: uuid
        target_id:
          type: string
          format: uuid
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CompanionDefendRequest:
      type: object
      required:
        - player_id
      properties:
        player_id:
          type: string
          format: uuid
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    AvailableCompanionsResponse:
      type: object
      properties:
        companions:
          type: array
          items:
            $ref: '#/components/schemas/CompanionType'
        total:
          type: integer
        limit:
          type: integer
        offset:
          type: integer
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    OwnedCompanionsResponse:
      type: object
      properties:
        player_id:
          type: string
          format: uuid
        companions:
          type: array
          items:
            $ref: '#/components/schemas/PlayerCompanion'
        total:
          type: integer
        limit:
          type: integer
        offset:
          type: integer
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CompanionProgressionResponse:
      type: object
      properties:
        companion_id:
          type: string
          format: uuid
        level:
          type: integer
        experience:
          type: integer
        experience_to_next_level:
          type: integer
        health:
          type: integer
        damage:
          type: integer
        leveled_up:
          type: boolean
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CompanionAbilitiesResponse:
      type: object
      properties:
        companion_id:
          type: string
          format: uuid
        abilities:
          type: array
          items:
            $ref: '#/components/schemas/CompanionAbility'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    AbilityUsageResponse:
      type: object
      properties:
        ability_id:
          type: string
          format: uuid
        cooldown_until:
          type: string
          format: date-time
          nullable: true
        effects_applied:
          type: object
          additionalProperties: true
        success:
          type: boolean
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CompanionAttackResponse:
      type: object
      properties:
        target_id:
          type: string
          format: uuid
        damage_dealt:
          type: integer
        success:
          type: boolean
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CompanionDefendResponse:
      type: object
      properties:
        defense_duration_seconds:
          type: integer
        success:
          type: boolean
        defense_active:
          type: boolean
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CompanionShopCatalogResponse:
      type: object
      properties:
        companions:
          type: array
          items:
            $ref: '#/components/schemas/CompanionType'
        total:
          type: integer
        limit:
          type: integer
        offset:
          type: integer
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CompanionEvent:
      type: object
      properties:
        id:
          type: string
          format: uuid
        companion_id:
          type: string
          format: uuid
        event_type:
          type: string
          enum:
            - companion:purchased
            - companion:summoned
            - companion:dismissed
            - companion:level-up
            - companion:ability-used
            - companion:customized
        created_at:
          type: string
          format: date-time
        event_data:
          type: object
          additionalProperties: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CompanionEventsResponse:
      type: object
      properties:
        events:
          type: array
          items:
            $ref: '#/components/schemas/CompanionEvent'
        total:
          type: integer
        limit:
          type: integer
        offset:
          type: integer
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
