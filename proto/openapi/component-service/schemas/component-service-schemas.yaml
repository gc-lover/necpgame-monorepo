openapi: 3.0.3
components:
  schemas:
    Error:
      $ref: ../common/schemas/infrastructure-entities.yaml#/ErrorResponse
    CombatWave:
      type: object
      description: Combat wave configuration and state
      properties:
        waveId:
          type: string
          format: uuid
        encounterId:
          type: string
          format: uuid
        waveNumber:
          type: integer
          minimum: 1
        enemyTypes:
          type: array
          items:
            type: object
            properties:
              enemyType:
                type: string
              count:
                type: integer
                minimum: 1
              spawnDelay:
                type: number
                format: float
                description: Delay in seconds before spawning
          description: Enemies in this wave
        modifiers:
          type: array
          items:
            type: string
          description: Wave-specific modifiers
        rewardMultiplier:
          type: number
          format: float
          default: 1.0
        timeLimit:
          type: integer
          description: Time limit in seconds (optional)
      required:
      - waveId
      - encounterId
      - waveNumber
      - enemyTypes
    GameplayAffix:
      type: object
      description: Dynamic gameplay modifier
      properties:
        affixId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        type:
          type: string
          enum:
          - damage
          - defense
          - speed
          - healing
          - resource
          - special
        target:
          type: string
          enum:
          - player
          - enemy
          - environment
          - global
        value:
          oneOf:
          - type: number
          - type: string
          description: Modifier value or reference
        duration:
          type: integer
          description: Duration in seconds (0 = permanent)
        stackable:
          type: boolean
          default: false
        maxStacks:
          type: integer
          minimum: 1
      required:
      - affixId
      - name
      - type
      - target
    CooperativeChallenge:
      type: object
      description: Multiplayer cooperative challenge
      properties:
        challengeId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        participantLimit:
          type: integer
          minimum: 2
          maximum: 50
        objectives:
          type: array
          items:
            type: object
            properties:
              objectiveId:
                type: string
                format: uuid
              type:
                type: string
                enum:
                - kill
                - collect
                - survive
                - achieve
                - coordinate
              target:
                type: string
              count:
                type: integer
              timeLimit:
                type: integer
              description:
                type: string
            required:
            - objectiveId
            - type
            - target
        synchronization:
          type: object
          properties:
            requiresAllParticipants:
              type: boolean
              default: true
            phaseBased:
              type: boolean
              default: false
            realTimeUpdates:
              type: boolean
              default: true
          description: Challenge synchronization requirements
        rewards:
          type: array
          items:
            type: object
            properties:
              type:
                type: string
                enum:
                - experience
                - currency
                - item
                - achievement
              value:
                oneOf:
                - type: integer
                - type: string
              shared:
                type: boolean
                default: false
      required:
      - challengeId
      - name
      - participantLimit
      - objectives
    DifficultyRating:
      type: object
      description: Dynamic difficulty assessment and scaling
      properties:
        ratingId:
          type: string
          format: uuid
        contextId:
          type: string
          format: uuid
          description: Associated encounter/challenge/area ID
        baseDifficulty:
          type: string
          enum:
          - very_easy
          - easy
          - normal
          - hard
          - very_hard
          - impossible
        playerCount:
          type: integer
          minimum: 1
        averageLevel:
          type: integer
          minimum: 1
        performanceMetrics:
          type: object
          properties:
            completionRate:
              type: number
              format: float
              minimum: 0
              maximum: 1
            averageTime:
              type: integer
              description: Average completion time in seconds
            failureRate:
              type: number
              format: float
              minimum: 0
              maximum: 1
          description: Historical performance data
        adjustedDifficulty:
          type: string
          enum:
          - very_easy
          - easy
          - normal
          - hard
          - very_hard
          - impossible
        scalingFactors:
          type: object
          properties:
            enemyHealth:
              type: number
              format: float
            enemyDamage:
              type: number
              format: float
            enemyCount:
              type: number
              format: float
            rewardMultiplier:
              type: number
              format: float
          description: Applied scaling modifiers
      required:
      - ratingId
      - contextId
      - baseDifficulty
    WorldState:
      type: object
      description: Global world state and flags
      properties:
        stateId:
          type: string
          format: uuid
        timestamp:
          type: string
          format: date-time
        flags:
          type: object
          description: Global world flags and variables
          additionalProperties:
            oneOf:
            - type: boolean
            - type: integer
            - type: string
        regions:
          type: object
          description: Regional state data
          additionalProperties:
            type: object
            properties:
              status:
                type: string
                enum:
                - normal
                - alert
                - lockdown
                - event
                - disaster
              activeEvents:
                type: array
                items:
                  type: string
                  format: uuid
              modifiers:
                type: object
                description: Regional modifiers
                additionalProperties:
                  oneOf:
                  - type: number
                  - type: string
                  - type: boolean
        globalEvents:
          type: array
          items:
            type: object
            properties:
              eventId:
                type: string
                format: uuid
              type:
                type: string
              impact:
                type: string
                enum:
                - local
                - regional
                - global
              active:
                type: boolean
              startTime:
                type: string
                format: date-time
          description: Currently active global events
      required:
      - stateId
      - timestamp
      - flags
