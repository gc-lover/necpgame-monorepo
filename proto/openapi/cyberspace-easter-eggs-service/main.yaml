openapi: 3.0.3
info:
  title: Cyberspace Easter Eggs Service API
  description: 'Enterprise-grade API for managing cyberspace easter eggs discovery
    and progression in Cyberpunk 2077 MMOFPS game.


    ## Features

    - Easter egg discovery tracking with performance optimization for 1000+ concurrent
    discoveries

    - Player progress management with memory-efficient JSONB storage

    - Achievement integration with external achievement system

    - Real-time statistics and analytics for player engagement

    - Hint system with configurable difficulty levels

    - Event-driven architecture for achievement unlocks


    ## Performance Characteristics

    - Context timeouts: 30s for content-heavy requests, 5s for achievement calls

    - Memory optimization: GOGC=75% for content-heavy workloads

    - Connection pooling: 25 database connections

    - Struct alignment: 30-50% memory savings

    '
  version: 1.0.0
  contact:
    name: Backend Team
    email: backend@necpgame.com
servers:
- url: http://cyberspace-easter-eggs-service-go:8080
  description: Production server
- url: http://localhost:8080
  description: Local development
paths:
  /health:
    get:
      summary: Health check endpoint
      description: Returns service health status for monitoring
      operationId: healthCheck
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: healthy
                  timestamp:
                    type: string
                    format: date-time
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
  /api/v1/easter-eggs:
    get:
      summary: Get all easter eggs
      description: Retrieve paginated list of all easter eggs with filtering options
      operationId: getEasterEggs
      parameters:
      - name: category
        in: query
        schema:
          type: string
          enum:
          - technology
          - cultural
          - historical
          - humorous
      - name: difficulty
        in: query
        schema:
          type: string
          enum:
          - easy
          - medium
          - hard
          - legendary
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
      - name: offset
        in: query
        schema:
          type: integer
          minimum: 0
          default: 0
      responses:
        '200':
          description: List of easter eggs
          content:
            application/json:
              schema:
                type: object
                properties:
                  easter_eggs:
                    type: array
                    items:
                      $ref: '#/components/schemas/EasterEgg'
                  total:
                    type: integer
                  limit:
                    type: integer
                  offset:
                    type: integer
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
  /api/v1/easter-eggs/{id}:
    get:
      summary: Get easter egg by ID
      description: Retrieve detailed information about a specific easter egg
      operationId: getEasterEgg
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Easter egg details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EasterEgg'
        '404':
          description: Easter egg not found
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
  /api/v1/easter-eggs/category/{category}:
    get:
      summary: Get easter eggs by category
      description: Retrieve easter eggs filtered by category
      operationId: getEasterEggsByCategory
      parameters:
      - name: category
        in: path
        required: true
        schema:
          type: string
          enum:
          - technology
          - cultural
          - historical
          - humorous
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
      - name: offset
        in: query
        schema:
          type: integer
          minimum: 0
          default: 0
      responses:
        '200':
          description: Easter eggs in category
          content:
            application/json:
              schema:
                type: object
                properties:
                  easter_eggs:
                    type: array
                    items:
                      $ref: '#/components/schemas/EasterEgg'
                  total:
                    type: integer
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
  /api/v1/easter-eggs/difficulty/{difficulty}:
    get:
      summary: Get easter eggs by difficulty
      description: Retrieve easter eggs filtered by difficulty level
      operationId: getEasterEggsByDifficulty
      parameters:
      - name: difficulty
        in: path
        required: true
        schema:
          type: string
          enum:
          - easy
          - medium
          - hard
          - legendary
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
      - name: offset
        in: query
        schema:
          type: integer
          minimum: 0
          default: 0
      responses:
        '200':
          description: Easter eggs by difficulty
          content:
            application/json:
              schema:
                type: object
                properties:
                  easter_eggs:
                    type: array
                    items:
                      $ref: '#/components/schemas/EasterEgg'
                  total:
                    type: integer
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
  /api/v1/players/{playerId}/progress:
    get:
      summary: Get player easter egg progress
      description: Retrieve player's progress for all discovered easter eggs
      operationId: getPlayerProgress
      parameters:
      - name: playerId
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Player progress
          content:
            application/json:
              schema:
                type: object
                properties:
                  player_id:
                    type: string
                  discovered_count:
                    type: integer
                  total_easter_eggs:
                    type: integer
                  progress:
                    type: array
                    items:
                      $ref: '#/components/schemas/PlayerEasterEggProgress'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
  /api/v1/players/{playerId}/easter-eggs/{eggId}/discover:
    post:
      summary: Discover easter egg
      description: 'Mark easter egg as discovered for player and unlock associated
        achievements.


        **Performance Notes:**

        - Calls external achievement service with 5s timeout

        - Updates player statistics atomically

        - Triggers event-driven achievement processing

        '
      operationId: discoverEasterEgg
      parameters:
      - name: playerId
        in: path
        required: true
        schema:
          type: string
      - name: eggId
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                discovery_method:
                  type: string
                  enum:
                  - scan
                  - command
                  - puzzle
                  - event
                location_found:
                  type: string
                attempt_data:
                  type: object
                  additionalProperties: true
      responses:
        '200':
          description: Easter egg discovered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Easter egg discovered successfully
                  progress:
                    $ref: '#/components/schemas/PlayerEasterEggProgress'
                  achievement_unlocked:
                    type: boolean
                    description: Whether achievement was unlocked
        '400':
          description: Invalid request
        '404':
          description: Easter egg not found
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
  /api/v1/players/{playerId}/profile:
    get:
      summary: Get player easter egg profile
      description: Retrieve comprehensive player profile with easter egg statistics
      operationId: getPlayerProfile
      parameters:
      - name: playerId
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Player profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerEasterEggProfile'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
  /api/v1/easter-eggs/{id}/hints:
    get:
      summary: Get hints for easter egg
      description: Retrieve available hints for easter egg discovery
      operationId: getHintsForEasterEgg
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      - name: max_level
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 3
          default: 3
      responses:
        '200':
          description: Easter egg hints
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DiscoveryHint'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
  /api/v1/easter-eggs/{id}/attempt:
    post:
      summary: Record discovery attempt
      description: Record player's attempt to discover easter egg for analytics
      operationId: recordDiscoveryAttempt
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                player_id:
                  type: string
                attempt_type:
                  type: string
                  enum:
                  - scan
                  - command
                  - puzzle
                  - event
                success:
                  type: boolean
                response_time:
                  type: integer
                  description: Response time in milliseconds
      responses:
        '201':
          description: Attempt recorded
        '400':
          description: Invalid request
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
  /api/v1/easter-eggs/{id}/stats:
    get:
      summary: Get easter egg statistics
      description: Retrieve discovery statistics for specific easter egg
      operationId: getEasterEggStatistics
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Easter egg statistics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EasterEggStatistics'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
  /api/v1/stats/categories:
    get:
      summary: Get category statistics
      description: Retrieve statistics for all easter egg categories
      operationId: getCategoryStatistics
      responses:
        '200':
          description: Category statistics
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/EasterEggCategoryStats'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
  /api/v1/challenges/active:
    get:
      summary: Get active challenges
      description: Retrieve currently active easter egg challenges
      operationId: getActiveChallenges
      responses:
        '200':
          description: Active challenges
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/EasterEggChallenge'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
  /api/v1/players/{playerId}/challenges/{challengeId}/progress:
    get:
      summary: Get player challenge progress
      description: Retrieve player's progress in specific challenge
      operationId: getPlayerChallengeProgress
      parameters:
      - name: playerId
        in: path
        required: true
        schema:
          type: string
      - name: challengeId
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Challenge progress
          content:
            application/json:
              schema:
                type: object
                properties:
                  challenge_id:
                    type: string
                  progress:
                    type: integer
                  max_progress:
                    type: integer
                  completed:
                    type: boolean
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
components:
  schemas:
    EasterEgg:
      type: object
      properties:
        id:
          type: string
          description: Unique easter egg identifier
        name:
          type: string
          description: Display name
        category:
          type: string
          enum:
          - technology
          - cultural
          - historical
          - humorous
        difficulty:
          type: string
          enum:
          - easy
          - medium
          - hard
          - legendary
        description:
          type: string
        content:
          type: string
          description: Full content/story
        location:
          $ref: '#/components/schemas/EasterEggLocation'
        discovery_method:
          $ref: '#/components/schemas/DiscoveryMethod'
        rewards:
          type: array
          items:
            $ref: '#/components/schemas/EasterEggReward'
        lore_connections:
          type: array
          items:
            type: string
        status:
          type: string
          enum:
          - active
          - disabled
          - maintenance
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    EasterEggLocation:
      type: object
      properties:
        network_type:
          type: string
          description: Type of network (corporate, public, underground, educational)
        specific_areas:
          type: array
          items:
            type: string
          description: Specific areas where egg can be found
        access_level:
          type: string
          enum:
          - public
          - restricted
          - secure
          - fort_knox
    DiscoveryMethod:
      type: object
      properties:
        type:
          type: string
          enum:
          - scanning
          - pattern_following
          - deep_scan
          - puzzle
        description:
          type: string
        requirements:
          type: array
          items:
            type: string
        time_limit:
          type: integer
          description: Time limit in seconds
    EasterEggReward:
      type: object
      properties:
        type:
          type: string
          enum:
          - experience
          - item
          - achievement
          - currency
          - cosmetic
        value:
          type: integer
          description: Numeric value for rewards
        item_name:
          type: string
          description: Display name for items
        rarity:
          type: string
          enum:
          - common
          - rare
          - epic
          - legendary
    PlayerEasterEggProgress:
      type: object
      properties:
        player_id:
          type: string
        easter_egg_id:
          type: string
        status:
          type: string
          enum:
          - undiscovered
          - discovered
          - completed
          - revisited
        discovered_at:
          type: string
          format: date-time
        completed_at:
          type: string
          format: date-time
        rewards_claimed:
          type: array
          items:
            type: string
        hint_level:
          type: integer
          minimum: 0
          maximum: 3
        visit_count:
          type: integer
        last_visited:
          type: string
          format: date-time
    PlayerEasterEggProfile:
      type: object
      properties:
        player_id:
          type: string
        total_discovered:
          type: integer
        total_completed:
          type: integer
        favorite_category:
          type: string
        average_difficulty:
          type: number
        total_hints_used:
          type: integer
        collection_progress:
          type: number
          minimum: 0
          maximum: 100
        achievement_level:
          type: string
          enum:
          - explorer
          - hunter
          - master
          - legend
        last_activity:
          type: string
          format: date-time
    DiscoveryHint:
      type: object
      properties:
        id:
          type: string
        easter_egg_id:
          type: string
        hint_level:
          type: integer
          minimum: 1
          maximum: 3
        hint_text:
          type: string
        hint_type:
          type: string
          enum:
          - direct
          - indirect
          - misleading
        cost:
          type: integer
          minimum: 0
        is_enabled:
          type: boolean
    EasterEggStatistics:
      type: object
      properties:
        easter_egg_id:
          type: string
        total_discoveries:
          type: integer
        unique_players:
          type: integer
        average_discovery_time:
          type: integer
          description: Average time in seconds
        success_rate:
          type: number
          minimum: 0
          maximum: 1
        popular_discovery_method:
          type: string
    EasterEggCategoryStats:
      type: object
      properties:
        category:
          type: string
        total_easter_eggs:
          type: integer
        discovered_count:
          type: integer
        discovery_rate:
          type: number
        average_difficulty:
          type: number
        most_popular_egg:
          type: string
        least_popular_egg:
          type: string
    EasterEggChallenge:
      type: object
      properties:
        id:
          type: string
        title:
          type: string
        description:
          type: string
        easter_eggs:
          type: array
          items:
            type: string
        rewards:
          type: array
          items:
            $ref: '#/components/schemas/EasterEggReward'
        start_time:
          type: string
          format: date-time
        end_time:
          type: string
          format: date-time
        is_active:
          type: boolean
    HealthResponse:
      $ref: ../common-service/schemas/health.yaml#/HealthResponse
    Error:
      $ref: ../common-service/schemas/error.yaml#/Error
    PaginationParams:
      $ref: ../common-service/schemas/pagination.yaml#/PaginationParams
    PaginatedResponse:
      $ref: ../common-service/schemas/pagination.yaml#/PaginatedResponse
  responses:
    OK:
      $ref: ../common-service/responses/success.yaml#/OK
    Created:
      $ref: ../common-service/responses/success.yaml#/Created
    BadRequest:
      $ref: ../common-service/responses/error.yaml#/BadRequest
    Unauthorized:
      $ref: ../common-service/responses/error.yaml#/Unauthorized
    Forbidden:
      $ref: ../common-service/responses/error.yaml#/Forbidden
    NotFound:
      $ref: ../common-service/responses/error.yaml#/NotFound
    Conflict:
      $ref: ../common-service/responses/error.yaml#/Conflict
    InternalServerError:
      $ref: ../common-service/responses/error.yaml#/InternalServerError
    HealthOK:
      $ref: ../common-service/responses/success.yaml#/HealthOK
    HealthBatchSuccess:
      $ref: ../common-service/responses/success.yaml#/HealthBatchSuccess
  securitySchemes:
    BearerAuth:
      $ref: ../common-service/security/security.yaml#/BearerAuth
    ApiKeyAuth:
      $ref: ../common-service/security/security.yaml#/ApiKeyAuth
    ServiceAuth:
      $ref: ../common-service/security/security.yaml#/ServiceAuth
