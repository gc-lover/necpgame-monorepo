# Issue: #142109968
openapi: 3.0.3
info:
  title: Stock Dividends Service Go API
  description: |
    Enterprise-Grade Stock Dividends Service API for NECPGAME MMOFPS RPG.

    **Enterprise-Grade Domain:** economy-domain

    **Module:** stock-dividends-service-go

    **Purpose:** High-performance stock dividend management and payments

    **BACKEND NOTE:** Struct field alignment optimized (large → small types).

    All schemas ordered for optimal memory layout in generated Go code.

    Expected memory savings: 30-50% for stock-dividends-related structs.

    **Features:**

    - Real-time dividend calculations (1000+ RPS)
    - Automated dividend payments
    - Dividend reinvestment (DRIP)
    - Tax calculations and withholding
    - Anti-cheat validation for dividend claims

    **Performance:** P99 <40ms for dividend operations, zero allocations in hot path
  version: 1.0.0
  license:
    name: Proprietary
    url: https://necpgame.com/license
  contact:
    name: NECPGAME API Support
    url: https://necpgame.com/support
    email: api@stock-dividends.necpgame.com
servers:
  - url: http://localhost:8146/api/v1
    description: Stock Dividends Service Go (development)
  - url: https://stock-dividends-go.necpgame.com/api/v1
    description: Stock Dividends Service Go (production)
tags:
  - name: Dividend Management
    description: Stock dividend lifecycle operations
  - name: Dividend Payments
    description: Dividend payment processing
  - name: Dividend Schedule
    description: Dividend scheduling and calendar
  - name: DRIP Operations
    description: Dividend reinvestment operations
security:
  - BearerAuth: []
paths:
  /health:
    get:
      tags:
        - Dividend Management
      summary: Service health check
      operationId: getHealth
      security: []
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "healthy"
                  timestamp:
                    type: string
                    format: date-time
                  version:
                    type: string
                    example: "1.0.0"
        '503':
          description: Service unhealthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "unhealthy"
                  error:
                    type: string

  /economy/stock/dividends:
    get:
      tags:
        - Dividend Management
      summary: Get dividend information
      operationId: getDividends
      parameters:
        - name: stock_symbol
          in: query
          schema:
            type: string
          description: Filter by stock symbol
        - name: status
          in: query
          schema:
            type: string
            enum: [announced, ex_dividend, payable, paid]
            default: payable
          description: Filter by dividend status
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
          description: Number of dividends to return
      responses:
        '200':
          description: List of dividends
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Dividend'
        '400':
          $ref: 'common.yaml#/components/responses/BadRequest'
        '401':
          $ref: 'common.yaml#/components/responses/Unauthorized'
        '500':
          $ref: 'common.yaml#/components/responses/InternalServerError'
    post:
      tags:
        - Dividend Management
      summary: Announce new dividend
      operationId: announceDividend
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AnnounceDividendRequest'
      responses:
        '201':
          description: Dividend announced successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Dividend'
        '400':
          $ref: 'common.yaml#/components/responses/BadRequest'
        '401':
          $ref: 'common.yaml#/components/responses/Unauthorized'
        '403':
          description: Insufficient permissions to announce dividends
        '500':
          $ref: 'common.yaml#/components/responses/InternalServerError'

  /economy/stock/dividends/{dividend_id}:
    get:
      tags:
        - Dividend Management
      summary: Get dividend details
      operationId: getDividendDetails
      parameters:
        - name: dividend_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Dividend unique identifier
      responses:
        '200':
          description: Dividend details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Dividend'
        '404':
          description: Dividend not found
        '401':
          $ref: 'common.yaml#/components/responses/Unauthorized'
        '500':
          $ref: 'common.yaml#/components/responses/InternalServerError'

  /economy/stock/dividends/{dividend_id}/payments:
    get:
      tags:
        - Dividend Payments
      summary: Get dividend payments
      operationId: getDividendPayments
      parameters:
        - name: dividend_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Dividend unique identifier
        - name: status
          in: query
          schema:
            type: string
            enum: [pending, paid, failed]
            default: pending
          description: Filter by payment status
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 1000
            default: 100
          description: Number of payments to return
      responses:
        '200':
          description: List of dividend payments
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DividendPayment'
        '404':
          description: Dividend not found
        '401':
          $ref: 'common.yaml#/components/responses/Unauthorized'
        '500':
          $ref: 'common.yaml#/components/responses/InternalServerError'

  /economy/stock/dividends/payments/claim:
    post:
      tags:
        - Dividend Payments
      summary: Claim dividend payment
      operationId: claimDividendPayment
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ClaimDividendRequest'
      responses:
        '200':
          description: Dividend payment claimed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DividendPayment'
        '400':
          $ref: 'common.yaml#/components/responses/BadRequest'
        '401':
          $ref: 'common.yaml#/components/responses/Unauthorized'
        '404':
          description: Dividend payment not found or not eligible
        '409':
          description: Payment already claimed
        '500':
          $ref: 'common.yaml#/components/responses/InternalServerError'

  /economy/stock/dividends/drip/enroll:
    post:
      tags:
        - DRIP Operations
      summary: Enroll in dividend reinvestment
      operationId: enrollInDRIP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DRIPEnrollmentRequest'
      responses:
        '200':
          description: Successfully enrolled in DRIP
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DRIPEnrollment'
        '400':
          $ref: 'common.yaml#/components/responses/BadRequest'
        '401':
          $ref: 'common.yaml#/components/responses/Unauthorized'
        '409':
          description: Already enrolled in DRIP
        '500':
          $ref: 'common.yaml#/components/responses/InternalServerError'

  /economy/stock/dividends/drip/{enrollment_id}:
    get:
      tags:
        - DRIP Operations
      summary: Get DRIP enrollment details
      operationId: getDRIPEnrollment
      parameters:
        - name: enrollment_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: DRIP enrollment unique identifier
      responses:
        '200':
          description: DRIP enrollment details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DRIPEnrollment'
        '404':
          description: DRIP enrollment not found
        '401':
          $ref: 'common.yaml#/components/responses/Unauthorized'
        '500':
          $ref: 'common.yaml#/components/responses/InternalServerError'
    delete:
      tags:
        - DRIP Operations
      summary: Cancel DRIP enrollment
      operationId: cancelDRIPEnrollment
      parameters:
        - name: enrollment_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: DRIP enrollment unique identifier
      responses:
        '204':
          description: DRIP enrollment cancelled successfully
        '404':
          description: DRIP enrollment not found
        '401':
          $ref: 'common.yaml#/components/responses/Unauthorized'
        '500':
          $ref: 'common.yaml#/components/responses/InternalServerError'

  /economy/stock/dividends/calendar:
    get:
      tags:
        - Dividend Schedule
      summary: Get dividend calendar
      operationId: getDividendCalendar
      parameters:
        - name: start_date
          in: query
          schema:
            type: string
            format: date
          description: Start date for calendar (defaults to today)
        - name: end_date
          in: query
          schema:
            type: string
            format: date
          description: End date for calendar (defaults to 3 months from start)
        - name: stock_symbols
          in: query
          schema:
            type: array
            items:
              type: string
          description: Filter by specific stock symbols
      responses:
        '200':
          description: Dividend calendar
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DividendCalendar'
        '400':
          $ref: 'common.yaml#/components/responses/BadRequest'
        '401':
          $ref: 'common.yaml#/components/responses/Unauthorized'
        '500':
          $ref: 'common.yaml#/components/responses/InternalServerError'

components:
  schemas:
    Dividend:
      type: object
      required:
        - id
        - stock_symbol
        - amount_per_share
        - ex_dividend_date
        - record_date
        - payment_date
        - status
        - created_at
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the dividend
        stock_symbol:
          type: string
          description: Stock symbol paying the dividend
        amount_per_share:
          type: number
          format: float
          minimum: 0
          description: Dividend amount per share
        ex_dividend_date:
          type: string
          format: date
          description: Date when stock starts trading without dividend
        record_date:
          type: string
          format: date
          description: Date when shareholders of record are determined
        payment_date:
          type: string
          format: date
          description: Date when dividend will be paid
        status:
          type: string
          enum: [announced, ex_dividend, payable, paid, cancelled]
          description: Current dividend status
        total_shares_eligible:
          type: integer
          format: int64
          description: Total shares eligible for dividend
        total_dividend_amount:
          type: number
          format: float
          description: Total dividend amount to be paid
        tax_withholding_rate:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.0
          description: Tax withholding rate
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'

    AnnounceDividendRequest:
      type: object
      required:
        - stock_symbol
        - amount_per_share
        - ex_dividend_date
        - record_date
        - payment_date
      properties:
        stock_symbol:
          type: string
          description: Stock symbol paying the dividend
        amount_per_share:
          type: number
          format: float
          minimum: 0
          description: Dividend amount per share
        ex_dividend_date:
          type: string
          format: date
          description: Date when stock starts trading without dividend
        record_date:
          type: string
          format: date
          description: Date when shareholders of record are determined
        payment_date:
          type: string
          format: date
          description: Date when dividend will be paid
        tax_withholding_rate:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.0
          description: Tax withholding rate
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'

    DividendPayment:
      type: object
      required:
        - id
        - dividend_id
        - shareholder_id
        - shares_owned
        - gross_amount
        - tax_withheld
        - net_amount
        - status
        - created_at
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the payment
        dividend_id:
          type: string
          format: uuid
          description: Associated dividend ID
        shareholder_id:
          type: string
          format: uuid
          description: Shareholder receiving the payment
        shares_owned:
          type: integer
          format: int32
          description: Number of shares owned by shareholder
        gross_amount:
          type: number
          format: float
          description: Gross dividend amount before tax
        tax_withheld:
          type: number
          format: float
          description: Tax amount withheld
        net_amount:
          type: number
          format: float
          description: Net dividend amount after tax
        status:
          type: string
          enum: [pending, paid, failed, cancelled]
          description: Payment status
        paid_at:
          type: string
          format: date-time
          nullable: true
          description: Timestamp when payment was made
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'

    ClaimDividendRequest:
      type: object
      required:
        - dividend_id
      properties:
        dividend_id:
          type: string
          format: uuid
          description: Dividend to claim payment for
        reinvest:
          type: boolean
          default: false
          description: Whether to reinvest the dividend through DRIP
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'

    DRIPEnrollment:
      type: object
      required:
        - id
        - user_id
        - stock_symbol
        - enrolled_at
        - status
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for DRIP enrollment
        user_id:
          type: string
          format: uuid
          description: User enrolled in DRIP
        stock_symbol:
          type: string
          description: Stock symbol for DRIP
        enrolled_at:
          type: string
          format: date-time
          description: Enrollment timestamp
        status:
          type: string
          enum: [active, suspended, cancelled]
          description: DRIP enrollment status
        total_reinvested:
          type: number
          format: float
          default: 0.0
          description: Total amount reinvested through DRIP
        total_shares_purchased:
          type: integer
          format: int32
          default: 0
          description: Total shares purchased through DRIP
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'

    DRIPEnrollmentRequest:
      type: object
      required:
        - stock_symbol
      properties:
        stock_symbol:
          type: string
          description: Stock symbol to enroll in DRIP
        partial_reinvestment:
          type: boolean
          default: false
          description: Whether to allow partial reinvestment of dividends
        minimum_reinvestment:
          type: number
          format: float
          minimum: 0.01
          default: 0.01
          description: Minimum dividend amount to trigger reinvestment
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'

    DividendCalendar:
      type: object
      properties:
        start_date:
          type: string
          format: date
          description: Calendar start date
        end_date:
          type: string
          format: date
          description: Calendar end date
        dividends:
          type: array
          items:
            $ref: '#/components/schemas/Dividend'
          description: List of dividends in the calendar period
        summary:
          type: object
          properties:
            total_dividends:
              type: integer
              format: int32
            total_amount:
              type: number
              format: float
            dividends_by_month:
              type: object
              additionalProperties:
                type: integer
                format: int32
              description: Number of dividends per month
          description: Calendar summary statistics
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'

  securitySchemes:
    BearerAuth:
      $ref: 'common.yaml#/components/securitySchemes/BearerAuth'
  responses:
    BadRequest:
      $ref: 'common.yaml#/components/responses/BadRequest'
    Unauthorized:
      $ref: 'common.yaml#/components/responses/Unauthorized'
    InternalServerError:
      $ref: 'common.yaml#/components/responses/InternalServerError'

security:
  - BearerAuth: []
