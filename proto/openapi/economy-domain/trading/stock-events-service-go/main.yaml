# Issue: #142109968
openapi: 3.0.3
info:
  title: Stock Events Service Go API
  description: |
    Enterprise-Grade Stock Events Service API for NECPGAME MMOFPS RPG.

    **Enterprise-Grade Domain:** economy-domain

    **Module:** stock-events-service-go

    **Purpose:** High-performance stock market events management

    **BACKEND NOTE:** Struct field alignment optimized (large → small types).

    All schemas ordered for optimal memory layout in generated Go code.

    Expected memory savings: 30-50% for stock-events-related structs.

    **Features:**

    - Real-time stock event processing (1000+ RPS)
    - Market event triggers and notifications
    - Event-driven trading mechanics
    - Economic impact calculations
    - Anti-cheat validation for trading events

    **Performance:** P99 <50ms for event operations, zero allocations in hot path
  version: 1.0.0
  license:
    name: Proprietary
    url: https://necpgame.com/license
  contact:
    name: NECPGAME API Support
    url: https://necpgame.com/support
    email: api@stock-events.necpgame.com
servers:
  - url: http://localhost:8147/api/v1
    description: Stock Events Service Go (development)
  - url: https://stock-events-go.necpgame.com/api/v1
    description: Stock Events Service Go (production)
tags:
  - name: Stock Events Management
    description: Stock market event lifecycle operations
  - name: Event Processing
    description: Real-time event processing and notifications
  - name: Market Impact
    description: Economic impact calculations and analysis
  - name: Event Analytics
    description: Event statistics and analytics
security:
  - BearerAuth: [ ]
paths:
  /health:
    get:
      tags:
        - Stock Events Management
      summary: Service health check
      operationId: getHealth
      security: [ ]
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "healthy"
                  timestamp:
                    type: string
                    format: date-time
                  version:
                    type: string
                    example: "1.0.0"
        '503':
          description: Service unhealthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "unhealthy"
                  error:
                    type: string

  /economy/stock/events:
    get:
      tags:
        - Stock Events Management
      summary: Get active stock events
      operationId: getActiveStockEvents
      parameters:
        - name: stock_symbol
          in: query
          schema:
            type: string
          description: Filter by specific stock symbol
        - name: event_type
          in: query
          schema:
            type: string
            enum: [ earnings, dividend, split, acquisition, regulatory, market_crash, boom ]
          description: Filter by event type
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
          description: Number of events to return
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Pagination offset
      responses:
        '200':
          description: List of active stock events
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/StockEvent'
        '400':
          $ref: '../../../common-schemas.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../../common-schemas.yaml#/components/responses/Unauthorized'
        '500':
          $ref: '../../../common-schemas.yaml#/components/responses/InternalServerError'
    post:
      tags:
        - Stock Events Management
      summary: Create new stock event
      operationId: createStockEvent
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateStockEventRequest'
      responses:
        '201':
          description: Stock event created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StockEvent'
        '400':
          $ref: '../../../common-schemas.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../../common-schemas.yaml#/components/responses/Unauthorized'
        '500':
          $ref: '../../../common-schemas.yaml#/components/responses/InternalServerError'

  /economy/stock/events/{event_id}:
    get:
      tags:
        - Stock Events Management
      summary: Get stock event details
      operationId: getStockEventDetails
      parameters:
        - name: event_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Stock event unique identifier
      responses:
        '200':
          description: Stock event details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StockEvent'
        '404':
          description: Stock event not found
        '401':
          $ref: '../../../common-schemas.yaml#/components/responses/Unauthorized'
        '500':
          $ref: '../../../common-schemas.yaml#/components/responses/InternalServerError'

  /economy/stock/events/{event_id}/impact:
    get:
      tags:
        - Market Impact
      summary: Calculate market impact of stock event
      operationId: calculateEventImpact
      parameters:
        - name: event_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Stock event unique identifier
      responses:
        '200':
          description: Event impact analysis
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EventImpactAnalysis'
        '404':
          description: Stock event not found
        '401':
          $ref: '../../../common-schemas.yaml#/components/responses/Unauthorized'
        '500':
          $ref: '../../../common-schemas.yaml#/components/responses/InternalServerError'

  /economy/stock/events/analytics:
    get:
      tags:
        - Event Analytics
      summary: Get stock events analytics
      operationId: getStockEventsAnalytics
      parameters:
        - name: timeframe
          in: query
          schema:
            type: string
            enum: [ 1h, 24h, 7d, 30d ]
            default: 24h
          description: Analytics timeframe
        - name: event_type
          in: query
          schema:
            type: string
            enum: [ earnings, dividend, split, acquisition, regulatory, market_crash, boom ]
          description: Filter by event type
      responses:
        '200':
          description: Stock events analytics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StockEventsAnalytics'
        '400':
          $ref: '../../../common-schemas.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../../common-schemas.yaml#/components/responses/Unauthorized'
        '500':
          $ref: '../../../common-schemas.yaml#/components/responses/InternalServerError'

components:
  schemas:
    StockEvent:
      type: object
      required:
        - id
        - stock_symbol
        - event_type
        - title
        - description
        - impact
        - start_time
        - end_time
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the stock event
        stock_symbol:
          type: string
          description: Stock symbol affected by the event
        event_type:
          type: string
          enum: [ earnings, dividend, split, acquisition, regulatory, market_crash, boom ]
          description: Type of stock event
        title:
          type: string
          description: Event title
        description:
          type: string
          description: Detailed event description
        impact:
          $ref: '#/components/schemas/EventImpact'
        start_time:
          type: string
          format: date-time
          description: Event start time
        end_time:
          type: string
          format: date-time
          description: Event end time
        status:
          type: string
          enum: [ upcoming, active, completed, cancelled ]
          default: upcoming
          description: Current event status
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'

    CreateStockEventRequest:
      type: object
      required:
        - stock_symbol
        - event_type
        - title
        - description
        - impact
        - start_time
        - end_time
      properties:
        stock_symbol:
          type: string
          description: Stock symbol affected by the event
        event_type:
          type: string
          enum: [ earnings, dividend, split, acquisition, regulatory, market_crash, boom ]
          description: Type of stock event
        title:
          type: string
          description: Event title
        description:
          type: string
          description: Detailed event description
        impact:
          $ref: '#/components/schemas/EventImpact'
        start_time:
          type: string
          format: date-time
          description: Event start time
        end_time:
          type: string
          format: date-time
          description: Event end time
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'

    EventImpact:
      type: object
      required:
        - price_change_percent
        - volume_multiplier
      properties:
        price_change_percent:
          type: number
          format: float
          minimum: -100.0
          maximum: 1000.0
          description: Expected price change percentage
        volume_multiplier:
          type: number
          format: float
          minimum: 0.1
          maximum: 10.0
          description: Trading volume multiplier
        volatility_increase:
          type: number
          format: float
          minimum: 0.0
          maximum: 5.0
          default: 1.0
          description: Market volatility increase factor
        affected_stocks:
          type: array
          items:
            type: string
          description: List of additionally affected stock symbols
        economic_indicators:
          type: object
          additionalProperties:
            type: number
            format: float
          description: Economic indicators affected by this event
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'

    EventImpactAnalysis:
      type: object
      properties:
        event_id:
          type: string
          format: uuid
        current_impact:
          $ref: '#/components/schemas/EventImpact'
        projected_outcomes:
          type: array
          items:
            $ref: '#/components/schemas/ProjectedOutcome'
        risk_assessment:
          type: string
          enum: [ low, medium, high, extreme ]
        recommendations:
          type: array
          items:
            type: string
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'

    ProjectedOutcome:
      type: object
      properties:
        timeframe_minutes:
          type: integer
          format: int32
          description: Timeframe in minutes
        projected_price:
          type: number
          format: float
          description: Projected stock price
        confidence_level:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          description: Confidence level of projection
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'

    StockEventsAnalytics:
      type: object
      properties:
        total_events:
          type: integer
          format: int32
        events_by_type:
          type: object
          additionalProperties:
            type: integer
            format: int32
          description: Count of events by type
        average_impact:
          $ref: '#/components/schemas/EventImpact'
        top_impacted_stocks:
          type: array
          items:
            type: object
            properties:
              symbol:
                type: string
              impact_score:
                type: number
                format: float
        market_volatility_trend:
          type: array
          items:
            type: object
            properties:
              timestamp:
                type: string
                format: date-time
              volatility_index:
                type: number
                format: float
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'

  securitySchemes:
    BearerAuth:
      $ref: '../../../common-schemas.yaml#/components/securitySchemes/BearerAuth'
  responses:
    BadRequest:
      $ref: '../../../common-schemas.yaml#/components/responses/BadRequest'
    Unauthorized:
      $ref: '../../../common-schemas.yaml#/components/responses/Unauthorized'
    InternalServerError:
      $ref: '../../../common-schemas.yaml#/components/responses/InternalServerError'

