# Issue: #62
# Schemas for Economy Equipment Service API
openapi: 3.0.3

components:
  schemas:
    GenerateEquipmentRequest:
      type: object
      required:
        - item_type
      properties:
        item_type:
          $ref: "#/components/schemas/EquipmentItemType"
        brand_id:
          type: string
          format: uuid
          nullable: true
        rarity:
          $ref: "#/components/schemas/EquipmentRarity"
          nullable: true
        seed:
          type: string
          nullable: true
        source:
          type: string
          enum: [LOOT, CRAFT, PURCHASE, QUEST]
          nullable: true

    GeneratedItem:
      type: object
      required:
        - id
        - seed
        - brand_id
        - item_type
        - rarity
        - stats
        - generated_at
      properties:
        id:
          type: string
          format: uuid
        seed:
          type: string
        brand_id:
          type: string
          format: uuid
        item_type:
          $ref: "#/components/schemas/EquipmentItemType"
        rarity:
          $ref: "#/components/schemas/EquipmentRarity"
        stats:
          type: object
          additionalProperties: true
        modifiers:
          type: array
          items:
            type: string
            format: uuid
        mod_slots:
          type: integer
          minimum: 0
        generated_at:
          type: string
          format: date-time

    EquipmentItemType:
      type: string
      enum: [WEAPON, IMPLANT, ARMOR, ACCESSORY]

    EquipmentRarity:
      type: string
      enum: [COMMON, UNCOMMON, RARE, EPIC, LEGENDARY]

    EquipmentMatrix:
      type: object
      required:
        - id
        - brand_id
        - item_type
        - rarity
        - stat_pools
        - created_at
        - updated_at
        - version
      properties:
        id:
          type: string
          format: uuid
        brand_id:
          type: string
          format: uuid
        item_type:
          $ref: "#/components/schemas/EquipmentItemType"
        rarity:
          $ref: "#/components/schemas/EquipmentRarity"
        stat_pools:
          type: array
          items:
            $ref: "#/components/schemas/StatPool"
        modifiers:
          type: array
          items:
            $ref: "#/components/schemas/Modifier"
        brand_bonuses:
          type: object
          additionalProperties: true
        version:
          type: integer

    StatPool:
      type: object
      required:
        - id
        - name
        - stat_type
        - min_value
        - max_value
        - distribution
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        stat_type:
          $ref: "#/components/schemas/StatType"
        min_value:
          type: number
          format: float
        max_value:
          type: number
          format: float
        distribution:
          $ref: "#/components/schemas/StatDistribution"
        rarity_modifiers:
          type: object
          additionalProperties: true

    StatType:
      type: string
      enum:
        [
          DAMAGE,
          ACCURACY,
          RANGE,
          FIRE_RATE,
          RELOAD_SPEED,
          MAGAZINE_SIZE,
          CRIT_CHANCE,
          CRIT_DAMAGE,
          STABILITY,
          HANDLING,
          DURABILITY,
          ENERGY_COST,
          COOLDOWN,
          EFFECT_DURATION,
        ]

    StatDistribution:
      type: string
      enum: [UNIFORM, NORMAL, EXPONENTIAL]

    Modifier:
      type: object
      required:
        - id
        - name
        - modifier_type
        - value
        - rarity
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        modifier_type:
          $ref: "#/components/schemas/ModifierType"
        value:
          type: number
          format: float
        rarity:
          $ref: "#/components/schemas/EquipmentRarity"
        compatibility:
          type: array
          items:
            type: string
        restrictions:
          type: object
          additionalProperties: true

    ModifierType:
      type: string
      enum:
        [
          DAMAGE_BOOST,
          CRIT_CHANCE,
          ELEMENTAL_DAMAGE,
          STATUS_EFFECT,
          STAT_BOOST,
          REDUCTION,
          MULTIPLIER,
        ]

    Brand:
      type: object
      required:
        - id
        - name
        - description
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        identity:
          type: string
        bonuses:
          type: object
          additionalProperties: true
        faction_exclusives:
          type: array
          items:
            type: string
            format: uuid

    BrandsListResponse:
      type: object
      required:
        - brands
      properties:
        brands:
          type: array
          items:
            $ref: "#/components/schemas/Brand"

    Rarity:
      type: object
      required:
        - name
        - level
      properties:
        name:
          $ref: "#/components/schemas/EquipmentRarity"
        level:
          type: integer
          minimum: 0
        drop_chance:
          type: number
          format: float
        color:
          type: string

    RaritiesListResponse:
      type: object
      required:
        - rarities
      properties:
        rarities:
          type: array
          items:
            $ref: "#/components/schemas/Rarity"

    StatPoolsListResponse:
      type: object
      required:
        - stat_pools
      properties:
        stat_pools:
          type: array
          items:
            $ref: "#/components/schemas/StatPool"

    ValidateBalanceRequest:
      type: object
      required:
        - item_id
      properties:
        item_id:
          type: string
          format: uuid
        league:
          type: string
          nullable: true
        game_mode:
          type: string
          enum: [PVE, PVP, EXTRACT]
          nullable: true

    BalanceValidationResult:
      type: object
      required:
        - valid
        - item_id
      properties:
        valid:
          type: boolean
        item_id:
          type: string
          format: uuid
        issues:
          type: array
          items:
            type: object
            properties:
              type:
                type: string
              message:
                type: string
              severity:
                type: string
                enum: [LOW, MEDIUM, HIGH, CRITICAL]
        ttk_estimate:
          type: number
          format: float
          nullable: true
        cyberpsychosis_risk:
          type: number
          format: float
          nullable: true
        temperature_restrictions:
          type: object
          additionalProperties: true
          nullable: true

    CatalogItem:
      type: object
      required:
        - id
        - name
        - category
        - rarity
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        category:
          type: string
        brand_id:
          type: string
          format: uuid
        brand_name:
          type: string
        rarity:
          $ref: "#/components/schemas/EquipmentRarity"
        stats:
          type: object
          additionalProperties: true
        icon_url:
          type: string
          format: uri
        created_at:
          type: string
          format: date-time

    IconicItem:
      type: object
      required:
        - id
        - name
        - year
        - unlocked
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        year:
          type: integer
          minimum: 2020
          maximum: 2093
        category:
          type: string
        brand_id:
          type: string
          format: uuid
        brand_name:
          type: string
        rarity:
          type: string
          enum: [ICONIC]
        stats:
          type: object
          additionalProperties: true
        unique_ability:
          type: string
        unlock_condition:
          type: string
        unlocked:
          type: boolean
        icon_url:
          type: string
          format: uri
        timeline_position:
          type: integer
        created_at:
          type: string
          format: date-time

    EquipmentAnalytics:
      type: object
      required:
        - period
        - total_items
      properties:
        period:
          type: string
          enum: [day, week, month, year]
        total_items:
          type: integer
        items_by_category:
          type: object
          additionalProperties:
            type: integer
        items_by_rarity:
          type: object
          additionalProperties:
            type: integer
        most_popular_brands:
          type: array
          items:
            type: object
            properties:
              brand_id:
                type: string
                format: uuid
              brand_name:
                type: string
              count:
                type: integer
        generation_stats:
          type: object
          properties:
            total_generated:
              type: integer
            by_source:
              type: object
              additionalProperties:
                type: integer
        iconic_unlocks:
          type: integer

