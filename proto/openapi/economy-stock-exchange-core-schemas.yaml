# Issue: #63
# Schemas for Economy Stock Exchange Core Service API
openapi: 3.0.3

components:
  schemas:
    Stock:
      type: object
      required:
        - id
        - symbol
        - corporation_id
        - current_price
      properties:
        id:
          type: string
          format: uuid
        symbol:
          type: string
        corporation_id:
          type: string
          format: uuid
        corporation_name:
          type: string
        sector:
          type: string
        current_price:
          type: number
          format: float
        change_24h:
          type: number
          format: float
          description: Изменение цены за 24 часа (%)
        volume_24h:
          type: integer
          description: Объем торгов за 24 часа

    StockDetailed:
      type: object
      required:
        - id
        - symbol
        - corporation_id
        - current_price
      properties:
        id:
          type: string
          format: uuid
        symbol:
          type: string
        corporation_id:
          type: string
          format: uuid
        corporation_name:
          type: string
        sector:
          type: string
        current_price:
          type: number
          format: float
        change_24h:
          type: number
          format: float
        change_7d:
          type: number
          format: float
        volume_24h:
          type: integer
        market_cap:
          type: number
          format: float
        shares_outstanding:
          type: integer
        high_24h:
          type: number
          format: float
        low_24h:
          type: number
          format: float
        description:
          type: string

    StockPrice:
      type: object
      required:
        - stock_id
        - price
        - updated_at
      properties:
        stock_id:
          type: string
          format: uuid
        symbol:
          type: string
        price:
          type: number
          format: float
        change_24h:
          type: number
          format: float
        updated_at:
          type: string
          format: date-time

    CreateOrderRequest:
      type: object
      required:
        - stock_id
        - side
        - quantity
        - order_type
      properties:
        stock_id:
          type: string
          format: uuid
        side:
          type: string
          enum: [buy, sell]
        quantity:
          type: integer
          minimum: 1
        order_type:
          type: string
          enum: [market, limit]
        limit_price:
          type: number
          format: float
          description: Цена для limit ордера

    Order:
      type: object
      required:
        - id
        - stock_id
        - side
        - quantity
        - order_type
        - status
        - created_at
      properties:
        id:
          type: string
          format: uuid
        stock_id:
          type: string
          format: uuid
        stock_symbol:
          type: string
        side:
          type: string
          enum: [buy, sell]
        quantity:
          type: integer
        filled_quantity:
          type: integer
        order_type:
          type: string
          enum: [market, limit]
        limit_price:
          type: number
          format: float
          nullable: true
        average_fill_price:
          type: number
          format: float
          nullable: true
        status:
          type: string
          enum: [pending, partially_filled, filled, cancelled]
        created_at:
          type: string
          format: date-time
        executed_at:
          type: string
          format: date-time
          nullable: true

    Portfolio:
      type: object
      required:
        - total_value
        - positions
      properties:
        total_value:
          type: number
          format: float
          description: Общая стоимость портфеля
        total_cost:
          type: number
          format: float
          description: Общая стоимость покупки
        total_profit:
          type: number
          format: float
          description: Общая прибыль/убыток
        positions:
          type: array
          items:
            $ref: "#/components/schemas/PortfolioPosition"

    PortfolioPosition:
      type: object
      required:
        - stock_id
        - quantity
        - average_buy_price
      properties:
        stock_id:
          type: string
          format: uuid
        stock_symbol:
          type: string
        corporation_name:
          type: string
        quantity:
          type: integer
        average_buy_price:
          type: number
          format: float
        current_price:
          type: number
          format: float
        total_cost:
          type: number
          format: float
        current_value:
          type: number
          format: float
        profit:
          type: number
          format: float
        profit_percent:
          type: number
          format: float

    Trade:
      type: object
      required:
        - id
        - stock_id
        - side
        - quantity
        - price
        - executed_at
      properties:
        id:
          type: string
          format: uuid
        stock_id:
          type: string
          format: uuid
        stock_symbol:
          type: string
        side:
          type: string
          enum: [buy, sell]
        quantity:
          type: integer
        price:
          type: number
          format: float
        total_value:
          type: number
          format: float
        commission:
          type: number
          format: float
        executed_at:
          type: string
          format: date-time

