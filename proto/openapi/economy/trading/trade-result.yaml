# Trade Result - Memory Optimized
# Issue: #2260

type: object
description: |
  BACKEND NOTE: Trade execution result (hot path response).

  Fields ordered for struct alignment (large â†’ small types):
  - UUIDs (16 bytes) first
  - Arrays (24 bytes)
  - Integers (8 bytes)
  - Objects (8 bytes pointers)
  - Booleans (1 byte) last

  Expected memory: ~72 bytes/instance.
  Memory savings: 30-40% vs non-aligned structs.
required:
  - trade_id
  - seller_id
  - buyer_id
  - item_id
  - quantity
  - total_price
  - currency_type
  - executed_at
  - success
properties:
  # Large types first (16 bytes - UUID)
  trade_id:
    type: string
    format: uuid
    description: Unique trade transaction ID
    example: "550e8400-e29b-41d4-a716-446655440010"

  seller_id:
    type: string
    format: uuid
    description: Seller participant UUID
    example: "550e8400-e29b-41d4-a716-446655440001"

  buyer_id:
    type: string
    format: uuid
    description: Buyer participant UUID
    example: "550e8400-e29b-41d4-a716-446655440003"

  item_id:
    type: string
    format: uuid
    description: Item instance UUID
    example: "550e8400-e29b-41d4-a716-446655440002"

  listing_id:
    type: string
    format: uuid
    description: Original listing UUID
    example: "550e8400-e29b-41d4-a716-446655440000"

  # Arrays (24 bytes)
  applied_fees:
    type: array
    description: Trading fees applied to transaction
    items:
      type: object
      description: Individual fee
      required:
        - type
        - amount
      properties:
        type:
          type: string
          enum:
            - trading_fee
            - insurance_fee
            - premium_listing_fee
            - cross_shard_fee
          description: Fee type
        amount:
          type: integer
          format: int64
          description: Fee amount
    maxItems: 5

  # Integers (8 bytes)
  quantity:
    type: integer
    format: int32
    description: Quantity traded
    example: 1

  total_price:
    type: integer
    format: int64
    description: Total transaction price
    example: 50000

  executed_at:
    type: integer
    format: int64
    description: Execution timestamp (unix milliseconds)
    example: 1703123456789

  # Objects (8 bytes pointers)
  trade_metadata:
    type: object
    description: Additional trade metadata
    properties:
      trade_type:
        type: string
        enum:
          - instant_buy
          - auction_win
          - best_offer_accept
        description: Type of trade execution
      shard_info:
        type: object
        description: Cross-shard information
        properties:
          seller_shard:
            type: string
            description: Seller's shard
          buyer_shard:
            type: string
            description: Buyer's shard

  # Strings
  currency_type:
    type: string
    enum:
      - eurodollars
      - faction_credits
      - premium_tokens
    description: Currency used
    example: "eurodollars"

  # Booleans (1 byte)
  success:
    type: boolean
    description: Whether trade was successful
    example: true

  used_insurance:
    type: boolean
    description: Whether trade insurance was used
    example: false

  cross_shard_trade:
    type: boolean
    description: Whether this was a cross-shard trade
    example: false
