# Environment Service - OpenAPI Specification

## üìã **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**

Environment Service –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç **enterprise-grade —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –∏–≥—Ä–æ–≤—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏** –¥–ª—è NECPGAME
—ç–∫–æ—Å–∏—Å—Ç–µ–º—ã. –°–µ—Ä–≤–∏—Å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–µ–∑–æ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è, –ø—Ä–æ—Ç–æ–∫–æ–ª—ã —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—é –±–æ–µ–≤—ã—Ö
—Å–∏—Å—Ç–µ–º.

## üéØ **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**

### üåø **–°–µ–∑–æ–Ω–Ω—ã–µ –ò—Å–ø—ã—Ç–∞–Ω–∏—è**

- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∑–æ–Ω–Ω—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏ –∏ –Ω–∞–≥—Ä–∞–¥–∞–º–∏
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
- –í–∞–ª—é—Ç–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ –æ–±–º–µ–Ω –Ω–∞–≥—Ä–∞–¥–∞–º–∏
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —É—á–∞—Å—Ç–∏—è –≤ —Å–µ–∑–æ–Ω–∞—Ö

### ‚è±Ô∏è **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –ò—Å–ø—ã—Ç–∞–Ω–∏—è**

- –°–∫–æ—Ä–æ—Å—Ç–Ω—ã–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è –∏ —Ä–µ–∫–æ—Ä–¥—ã
- –ë–æ–µ–≤—ã–µ –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è
- –†–µ–π—Ç–∏–Ω–≥–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ –ª–∏–¥–µ—Ä–±–æ—Ä–¥—ã
- –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å

### üîÑ **–ü—Ä–æ—Ç–æ–∫–æ–ª—ã –†–µ–∞–ª—å–Ω–æ–≥–æ –í—Ä–µ–º–µ–Ω–∏**

- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –ü—Ä–æ—Ñ–∏–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
- –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏–∫

### ‚öîÔ∏è **–ë–æ–µ–≤—ã–µ –°–∏—Å—Ç–µ–º—ã**

- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –±–æ–µ–≤—ã—Ö —Å–µ—Å—Å–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –±–æ—è
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–≥—Ä–æ–≤—ã—Ö –º–µ—Ö–∞–Ω–∏–∫
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è –±–æ–µ–≤—ã—Ö —Å–∏—Å—Ç–µ–º

## üìÅ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**

```
environment-service/
‚îú‚îÄ‚îÄ main.yaml           # –û—Å–Ω–æ–≤–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îú‚îÄ‚îÄ README.md          # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ docs/
    ‚îî‚îÄ‚îÄ index.html     # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

proto/openapi/common/                   # –û–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
‚îú‚îÄ‚îÄ responses/
‚îÇ   ‚îú‚îÄ‚îÄ error.yaml      # –û–±—â–∏–µ –æ—Ç–≤–µ—Ç—ã –æ—à–∏–±–æ–∫ (400, 401, 403, 404, 409, 500, 429)
‚îÇ   ‚îî‚îÄ‚îÄ success.yaml    # –û–±—â–∏–µ —É—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã (200, 201, health checks)
‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îú‚îÄ‚îÄ common.yaml     # –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ö–µ–º—ã (HealthResponse, Error, Pagination)
‚îÇ   ‚îú‚îÄ‚îÄ error.yaml      # –°—Ö–µ–º–∞ –æ—à–∏–±–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ health.yaml     # –°—Ö–µ–º–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞
‚îÇ   ‚îî‚îÄ‚îÄ pagination.yaml # –°—Ö–µ–º—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ security/
    ‚îî‚îÄ‚îÄ security.yaml   # –°—Ö–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (BearerAuth, ApiKeyAuth)
```

## üîß **API Endpoints**

### Core Operations

- `GET /health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞
- `GET /challenges/seasonal/active` - –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–µ–∑–æ–Ω–Ω—ã–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è
- `GET /trials/time/active` - –ê–∫—Ç–∏–≤–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è
- `GET /realtime/sessions` - –°–µ—Å—Å–∏–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- `GET /combat/sessions/active` - –ê–∫—Ç–∏–≤–Ω—ã–µ –±–æ–µ–≤—ã–µ —Å–µ—Å—Å–∏–∏
- `POST /protocol/optimize` - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞

### Key Features

- **Seasonal Content Management** - –ü–æ–ª–Ω—ã–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Å–µ–∑–æ–Ω–Ω—ã—Ö –∏—Å–ø—ã—Ç–∞–Ω–∏–π
- **Time Trial Coordination** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–Ω—ã–º–∏ –∏—Å–ø—ã—Ç–∞–Ω–∏—è–º–∏
- **Realtime Performance** - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **Combat Session Management** - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –±–æ–µ–≤

## üìä **Performance Targets**

- **P99 Latency:** <25ms –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- **Memory per Instance:** <20KB
- **Concurrent Users:** 100,000+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- **Protocol Throughput:** 100,000+ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å–µ–∫—É–Ω–¥—É
- **Combat Sessions:** 50,000+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±–æ–µ–≤—ã—Ö —Å–µ—Å—Å–∏–π

## üîí **Security & Authentication**

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç enterprise-grade –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é:

- JWT Bearer tokens –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- API Key authentication –¥–ª—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
- Service-to-service authentication –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π

## üèóÔ∏è **Architecture Notes**

### Domain Separation

- **Seasonal Challenges** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –∏ –Ω–∞–≥—Ä–∞–¥–∞–º–∏
- **Time Trials** - –°–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∫–∏
- **Realtime Protocol** - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π
- **Combat Systems** - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –±–æ–µ–≤—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π

### Common Schema Inheritance

–ù–∞—Å–ª–µ–¥—É–µ—Ç –æ—Ç `../common-service/schemas/`:

- `BaseEntity` - –ë–∞–∑–æ–≤—ã–µ –ø–æ–ª—è —Å—É—â–Ω–æ—Å—Ç–µ–π
- `AuditableEntity` - –ê—É–¥–∏—Ç –∏ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- `ErrorResponse` - –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
- `SuccessResponse` - –£—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã

### Backend Optimizations

- **Struct Alignment** - –ü–æ–ª—è —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏ (30-50% —ç–∫–æ–Ω–æ–º–∏–∏)
- **Connection Pooling** - –î–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- **Caching Strategy** - Redis –¥–ª—è —Å–µ—Å—Å–∏–π, in-memory –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- **Async Processing** - –í—Å–µ —Ç—è–∂–µ–ª—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ

## üß™ **Testing & Validation**

### Automated Testing

- Unit tests –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- Integration tests —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
- Performance tests –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π
- Chaos engineering –¥–ª—è —Å–∏—Å—Ç–µ–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

### Validation Commands

```bash
# Redocly linting
npx @redocly/cli lint main.yaml

# Go code generation test
ogen --target /tmp/test --package api --clean main.yaml

# Bundle validation
npx @redocly/cli bundle main.yaml -o bundled.yaml
```

## üìã **Migration Source**

–ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –∏–∑ `world/environment/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:

- `gameplay_seasonal_challenges.yaml`
- `gameplay_time_trials_core.yaml`
- `gameplay_time_trials_weekly.yaml`
- `realtime_protocol.yaml`
- `realtime_sync.yaml`
- `realtime-combat-api-complete.yaml`
- `realtime-combat-api.yaml`
- `realtime-combat-connections.yaml`
- `realtime-combat-monitoring.yaml`
- `realtime-combat-state.yaml`
- `realtime-combat-subscriptions.yaml`

## üîó **Related Services**

- **location-service** - –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏ –∑–æ–Ω—ã
- **world-event-service** - –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –º–∏—Ä–∞
- **combat-service** - –û—Å–Ω–æ–≤–Ω—ã–µ –±–æ–µ–≤—ã–µ –º–µ—Ö–∞–Ω–∏–∫–∏
- **achievement-service** - –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
- **analytics-service** - –ú–µ—Ç—Ä–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

## üìö **Documentation**

- [Environment Service API Reference](./docs/index.html)
- [NECPGAME API Architecture](../../README.md)
- [Performance Enforcement](../../PERFORMANCE_ENFORCEMENT.md)
- [Backend Optimization Checklist](../../BACKEND_OPTIMIZATION_CHECKLIST.md)

---

## üéØ **Domain Purpose**

Environment Service —Å–æ–∑–¥–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é, –∂–∏–≤—É—é –∏–≥—Ä–æ–≤—É—é —Å—Ä–µ–¥—É Night City, –≥–¥–µ –∏–≥—Ä–æ–∫–∏ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ —Å–µ–∑–æ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–∞—Ö,
—Å–æ—Ä–µ–≤–Ω—É—é—Ç—Å—è –≤ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏—Å–ø—ã—Ç–∞–Ω–∏—è—Ö –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç –≤ –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã—Ö –±–æ–µ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è:** MMOFPS RPG –≥–µ–π–º–ø–ª–µ—è —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –º–µ—Ö–∞–Ω–∏–∫–∞–º–∏.
