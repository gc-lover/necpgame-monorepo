openapi: 3.0.3
info:
  title: Guild Bank Service API
  description: Guild banking operations service
  version: 1.0.0
servers:
  - url: http://localhost:8085/api/v1
security:
  - BearerAuth: []
paths:
  /guilds/{guild_id}/bank/balance:
    parameters:
      - name: guild_id
        in: path
        schema:
          type: string
          format: uuid
    get:
      operationId: getGuildBankBalance
      summary: Get bank balance
      responses:
        '200':
          description: Balance info

  /guilds/{guild_id}/bank/deposit:
    post:
      operationId: depositToGuildBank
      summary: Deposit funds
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DepositRequest'
      responses:
        '200':
          description: Deposited

  /guilds/{guild_id}/bank/withdraw:
    post:
      operationId: withdrawFromGuildBank
      summary: Withdraw funds
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WithdrawRequest'
      responses:
        '200':
          description: Withdrawn

  /guilds/{guild_id}/bank/transactions:
    get:
      operationId: getGuildBankTransactions
      summary: Get transactions
      responses:
        '200':
          description: Transactions list

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    DepositRequest:
      type: object
      required: [amounts]
      properties:
        amounts:
          type: array
          items:
            type: object
            properties:
              currency:
                type: string
                enum: [credits, premium_currency, metal, energy]
              amount:
                type: integer
                minimum: 0

    WithdrawRequest:
      type: object
      required: [amounts, reason]
      properties:
        amounts:
          type: array
          items:
            type: object
            properties:
            currency:
              type: string
              enum: [credits, premium_currency, metal, energy]
            amount:
              type: integer
              minimum: 0
        reason:
          type: string
          maxLength: 200

    Transaction:
      type: object
      properties:
        transaction_id:
          type: string
          format: uuid
        type:
          type: string
          enum: [deposit, withdrawal, tax_collection, reward]
        amounts:
          type: array
          items:
            type: object
            properties:
            currency:
              type: string
              enum: [credits, premium_currency, metal, energy]
            amount:
              type: integer
              minimum: 0
        created_at:
          type: string
          format: date-time

    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string