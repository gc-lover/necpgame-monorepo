openapi: 3.0.3
info:
  title: Housing Placement Service API
  description: API для размещения мебели в квартирах
  version: 1.0.0
  contact:
    name: NECPGAME API Support
    email: api@necp.game
servers:
- url: http://localhost:8090/api/v1
  description: Локальный сервер разработки
- url: https://api.necp.game/api/v1
  description: Продакшен сервер
tags:
- name: Furniture Placement
  description: Размещение мебели
paths:
  /world/housing/apartments/{apartment_id}/furniture:
    get:
      tags:
      - Furniture Placement
      summary: Получить размещенную мебель
      operationId: getPlacedFurniture
      security:
      - BearerAuth: []
      parameters:
      - name: apartment_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Размещенная мебель
          content:
            application/json:
              schema:
                type: object
                properties:
                  furniture:
                    type: array
                    items:
                      $ref: '#/components/schemas/PlacedFurniture'
        '401':
          $ref: common.yaml#/components/responses/Unauthorized
        '404':
          $ref: common.yaml#/components/responses/NotFound
        '500':
          $ref: common.yaml#/components/responses/InternalServerError
    post:
      tags:
      - Furniture Placement
      summary: Разместить мебель
      operationId: placeFurniture
      security:
      - BearerAuth: []
      parameters:
      - name: apartment_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PlaceFurnitureRequest'
      responses:
        '201':
          description: Мебель размещена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlacedFurniture'
        '400':
          $ref: common.yaml#/components/responses/BadRequest
        '401':
          $ref: common.yaml#/components/responses/Unauthorized
        '404':
          $ref: common.yaml#/components/responses/NotFound
        '500':
          $ref: common.yaml#/components/responses/InternalServerError
  /world/housing/apartments/{apartment_id}/furniture/{furniture_id}:
    patch:
      tags:
      - Furniture Placement
      summary: Обновить позицию мебели
      operationId: updateFurniturePosition
      security:
      - BearerAuth: []
      parameters:
      - name: apartment_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: furniture_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateFurniturePositionRequest'
      responses:
        '200':
          description: Позиция обновлена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlacedFurniture'
        '400':
          $ref: common.yaml#/components/responses/BadRequest
        '401':
          $ref: common.yaml#/components/responses/Unauthorized
        '404':
          $ref: common.yaml#/components/responses/NotFound
        '500':
          $ref: common.yaml#/components/responses/InternalServerError
    delete:
      tags:
      - Furniture Placement
      summary: Удалить мебель
      operationId: removeFurniture
      security:
      - BearerAuth: []
      parameters:
      - name: apartment_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: furniture_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Мебель удалена
          content:
            application/json:
              schema:
                $ref: common.yaml#/components/schemas/SuccessResponse
        '401':
          $ref: common.yaml#/components/responses/Unauthorized
        '404':
          $ref: common.yaml#/components/responses/NotFound
        '500':
          $ref: common.yaml#/components/responses/InternalServerError
  /world/housing/apartments/{apartment_id}/furniture/{furniture_id}/move:
    post:
      tags:
      - Furniture Placement
      summary: Переместить мебель в квартире
      operationId: moveFurniture
      security:
      - BearerAuth: []
      parameters:
      - name: apartment_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: furniture_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MoveFurnitureRequest'
      responses:
        '200':
          description: Мебель перемещена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlacedFurniture'
        '400':
          $ref: common.yaml#/components/responses/BadRequest
        '401':
          $ref: common.yaml#/components/responses/Unauthorized
        '404':
          $ref: common.yaml#/components/responses/NotFound
        '500':
          $ref: common.yaml#/components/responses/InternalServerError
components:
  securitySchemes:
    BearerAuth:
      $ref: common.yaml#/components/securitySchemes/BearerAuth
  schemas:
    PlacedFurniture:
      type: object
      properties:
        id:
          type: string
          format: uuid
        apartment_id:
          type: string
          format: uuid
        furniture_item_id:
          type: string
        placed_at:
          type: string
          format: date-time
        position_x:
          type: number
          format: float
        position_y:
          type: number
          format: float
        position_z:
          type: number
          format: float
        rotation_yaw:
          type: number
          format: float
        scale:
          type: number
          format: float
          default: 1.0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    PlaceFurnitureRequest:
      type: object
      required:
      - furniture_item_id
      - position_x
      - position_y
      - position_z
      properties:
        furniture_item_id:
          type: string
        position_x:
          type: number
          format: float
        position_y:
          type: number
          format: float
        position_z:
          type: number
          format: float
        rotation_yaw:
          type: number
          format: float
          default: 0.0
        scale:
          type: number
          format: float
          default: 1.0
    UpdateFurniturePositionRequest:
      type: object
      properties:
        position_x:
          type: number
          format: float
        position_y:
          type: number
          format: float
        position_z:
          type: number
          format: float
        rotation_yaw:
          type: number
          format: float
        scale:
          type: number
          format: float
    MoveFurnitureRequest:
      type: object
      required:
      - player_id
      properties:
        player_id:
          type: string
          format: uuid
        position_x:
          type: number
          format: float
        position_y:
          type: number
          format: float
        position_z:
          type: number
          format: float
        rotation_x:
          type: number
          format: float
        rotation_y:
          type: number
          format: float
        rotation_z:
          type: number
          format: float
        scale_x:
          type: number
          format: float
        scale_y:
          type: number
          format: float
        scale_z:
          type: number
          format: float
security:
- BearerAuth: []
