openapi: 3.0.3
components:
  schemas:
    Ability:
      allOf:
      - $ref: ../common/schemas/common.yaml#/BaseEntity
      - properties:
          cooldown:
            description: Cooldown in milliseconds
            example: 30000
            minimum: 0
            type: integer
          description:
            description: Ability description
            example: Temporarily increases movement speed by 300%
            type: string
          mana_cost:
            description: Mana/energy cost
            example: 50
            minimum: 0
            type: integer
          name:
            description: Ability display name
            example: Sandevistan Overdrive
            maxLength: 100
            type: string
          type:
            description: Ability activation type
            enum:
            - passive
            - active
            - toggle
            example: active
            type: string
        required:
        - name
        - type
        - cooldown
        type: object
      - properties:
          anti_cheat_token:
            description: Token for anti-cheat validation
            type: string
          is_unlocked:
            description: Whether ability is unlocked for character
            type: boolean
          synergy_abilities:
            description: Compatible abilities for synergy activation
            example:
            - 123e4567-e89b-12d3-a456-426614174000
            items:
              $ref: ../common/schemas/common.yaml#/components/schemas/UUID
            type: array
          unlock_requirements:
            description: Requirements to unlock this ability
            example:
            - 123e4567-e89b-12d3-a456-426614174001
            items:
              $ref: ../common/schemas/common.yaml#/components/schemas/UUID
            type: array
        type: object
      description: 'BACKEND NOTE: Ability entity with domain inheritance (SOLID/DRY).'
    AbilityCooldownResponse:
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small
        types).'
      properties:
        ability_id:
          description: 'BACKEND NOTE: UUID - 16 bytes, ordered first for struct alignment'
          format: uuid
          type: string
        is_on_cooldown:
          description: Whether ability is currently on cooldown
          type: boolean
        last_used:
          description: Timestamp when ability was last used
          format: int64
          type: integer
        remaining_time:
          description: Remaining cooldown time in milliseconds
          format: int32
          type: integer
        total_cooldown:
          description: Total cooldown duration
          format: int32
          type: integer
      required:
      - ability_id
      - is_on_cooldown
      - remaining_time
      type: object
    AbilityRecommendations:
      description: 'BACKEND NOTE: AI-generated ability recommendations.'
      properties:
        character_id:
          description: Character ID
          format: uuid
          type: string
        generated_at:
          description: Recommendation generation timestamp
          format: date-time
          type: string
        recommendations:
          description: List of ability recommendations
          items:
            description: Individual recommendation
            properties:
              ability_id:
                description: Recommended ability
                format: uuid
                type: string
              confidence:
                description: AI confidence in recommendation
                maximum: 1
                minimum: 0
                type: number
              reasoning:
                description: AI reasoning for recommendation
                type: string
            type: object
          type: array
      type: object
    AbilitySynergiesResponse:
      description: 'BACKEND NOTE: Response optimized for struct alignment.'
      properties:
        ability_id:
          description: Ability for which synergies are being queried
          format: uuid
          type: string
        synergies:
          description: List of possible synergies for this ability
          items:
            description: 'BACKEND NOTE: Fields ordered for struct alignment (large
              → small types).'
            properties:
              bonus_multiplier:
                description: Multiplier for the synergy bonus
                format: float
                type: number
              condition:
                description: Condition for synergy activation
                type: string
              is_active:
                description: 'BACKEND NOTE: bool - 1 byte, ordered last for struct
                  alignment'
                type: boolean
              partner_ability_id:
                description: 'BACKEND NOTE: UUID - 16 bytes, ordered first for struct
                  alignment'
                format: uuid
                type: string
              synergy_type:
                description: Type of synergy effect
                enum:
                - damage_boost
                - cooldown_reduction
                - resource_efficiency
                - critical_chance
                type: string
            required:
            - partner_ability_id
            - synergy_type
            - bonus_multiplier
            type: object
          type: array
        total_synergies:
          description: Total number of synergies available
          format: int32
          type: integer
      required:
      - ability_id
      - synergies
      type: object
    AbilityTrainingData:
      description: 'BACKEND NOTE: AI training data for ability optimization. Large
        object first for struct alignment.'
      properties:
        ability_id:
          description: Ability being used
          format: uuid
          type: string
        character_id:
          description: Character using the ability
          format: uuid
          type: string
        outcome:
          description: Outcome of ability usage
          properties:
            damage_dealt:
              description: Damage dealt with ability
              minimum: 0
              type: integer
            effectiveness:
              description: Ability effectiveness rating
              maximum: 1
              minimum: 0
              type: number
            success:
              description: Whether ability achieved its goal
              type: boolean
          type: object
        timestamp:
          description: Usage timestamp
          format: date-time
          type: string
        usage_context:
          description: Context of ability usage
          properties:
            combat_phase:
              description: Combat phase
              enum:
              - opening
              - mid
              - endgame
              type: string
            enemy_type:
              description: Type of enemy faced
              type: string
            player_health:
              description: Player health percentage
              maximum: 1
              minimum: 0
              type: number
          type: object
      required:
      - character_id
      - ability_id
      - usage_context
      - outcome
      type: object
    ActivateAbilityRequest:
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small
        types). Expected memory savings: 30-50% for activation requests.'
      properties:
        ability_id:
          description: 'BACKEND NOTE: UUID - 16 bytes, ordered first for struct alignment'
          format: uuid
          type: string
        character_id:
          description: Character activating the ability
          format: uuid
          type: string
        client_version:
          description: Client version for compatibility checks
          type: string
        synergy_abilities:
          description: IDs of synergistic abilities activated together
          items:
            format: uuid
            type: string
          maxItems: 5
          type: array
        target_entity_id:
          description: Target entity ID (optional for area abilities)
          format: uuid
          type: string
        target_position:
          description: 'BACKEND NOTE: 3D vector for positioning, optimized for game
            coordinates. Target position for the ability'
          properties:
            x:
              description: X coordinate
              format: float
              type: number
            y:
              description: Y coordinate
              format: float
              type: number
            z:
              description: Z coordinate
              format: float
              type: number
          required:
          - x
          - y
          - z
          type: object
        timestamp:
          description: Client timestamp for anti-cheat validation
          format: int64
          type: integer
        version:
          description: Optimistic locking version for concurrent operations
          example: 1
          type: integer
      required:
      - ability_id
      - character_id
      - target_position
      type: object
    ActivateAbilityResponse:
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small
        types). Expected memory savings: 30-50% for activation responses.'
      properties:
        ability_id:
          description: Activated ability ID
          format: uuid
          type: string
        activation_id:
          description: 'BACKEND NOTE: UUID - 16 bytes, ordered first for struct alignment'
          format: uuid
          type: string
        character_id:
          description: Character ID
          format: uuid
          type: string
        cooldown_end_time:
          description: Timestamp when cooldown ends
          format: int64
          type: integer
        resource_cost:
          description: Resources consumed by the ability
          properties:
            health:
              format: int32
              type: integer
            mana:
              format: int32
              type: integer
            stamina:
              format: int32
              type: integer
          type: object
        success:
          description: 'BACKEND NOTE: bool - 1 byte, ordered last for struct alignment'
          type: boolean
        synergy_bonus:
          description: Damage/resource multiplier from synergies
          format: float
          type: number
        validation_token:
          description: Anti-cheat validation token
          type: string
      required:
      - success
      - activation_id
      - cooldown_end_time
      type: object
    Error:
      $ref: ../common/schemas/infrastructure-entities.yaml#/ErrorResponse
    HealthResponse:
      $ref: ../common/schemas/health.yaml#/HealthResponse
    ListAbilitiesResponse:
      description: 'BACKEND NOTE: Response optimized for struct alignment with large
        arrays first.'
      properties:
        abilities:
          description: 'BACKEND NOTE: Array of ability objects, ordered for optimal
            struct layout'
          items:
            $ref: '#/components/schemas/Ability'
          type: array
        pagination:
          description: Pagination information
          properties:
            has_more:
              type: boolean
            limit:
              format: int32
              type: integer
            offset:
              format: int32
              type: integer
          type: object
        total_count:
          description: Total number of abilities available
          format: int32
          type: integer
      required:
      - abilities
      - total_count
      type: object
    TrainingResponse:
      description: 'BACKEND NOTE: Response for training data submission.'
      properties:
        message:
          description: Processing result message
          type: string
        status:
          description: Training data processing status
          enum:
          - accepted
          - processed
          - rejected
          type: string
        training_data_id:
          description: Unique training data identifier
          format: uuid
          type: string
      type: object
    ValidateAbilityRequest:
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small
        types).'
      properties:
        ability_id:
          description: 'BACKEND NOTE: UUID - 16 bytes, ordered first for struct alignment'
          format: uuid
          type: string
        activation_data:
          description: Activation context data for validation
          properties:
            position:
              description: 'BACKEND NOTE: 3D vector for positioning, optimized for
                game coordinates.'
              properties:
                x:
                  description: X coordinate
                  format: float
                  type: number
                y:
                  description: Y coordinate
                  format: float
                  type: number
                z:
                  description: Z coordinate
                  format: float
                  type: number
              required:
              - x
              - y
              - z
              type: object
            target:
              format: uuid
              type: string
            timestamp:
              format: int64
              type: integer
          type: object
        character_id:
          description: Character ID
          format: uuid
          type: string
        client_hash:
          description: Client-side hash for anti-cheat validation
          type: string
      required:
      - ability_id
      - character_id
      - activation_data
      type: object
    ValidateAbilityResponse:
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small
        types).'
      properties:
        confidence_score:
          description: Confidence score of validation (0-1)
          format: float
          maximum: 1
          minimum: 0
          type: number
        is_valid:
          description: 'BACKEND NOTE: bool - 1 byte, ordered last for struct alignment'
          type: boolean
        validation_token:
          description: 'BACKEND NOTE: String - variable length, ordered first'
          type: string
        violations:
          description: List of validation violations found
          items:
            type: string
          type: array
      required:
      - is_valid
      - validation_token
      type: object
