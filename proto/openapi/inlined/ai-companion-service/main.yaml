components:
  responses:
    BadRequest:
      $ref: ../common-service/responses/error.yaml#/BadRequest
    Conflict:
      $ref: ../common-service/responses/error.yaml#/Conflict
    Created:
      $ref: ../common-service/responses/success.yaml#/Created
    ExampleCreated:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ExampleResponse'
      description: Example created successfully
      headers:
        Cache-Control:
          schema:
            example: no-cache
            type: string
        ETag:
          schema:
            description: Entity tag for caching and optimistic locking
            example: '"example-123-v1"'
            type: string
        Location:
          schema:
            description: URL of the created example
            example: /api/v1/examples/550e8400-e29b-41d4-a716-446655440000
            type: string
    ExampleDeleted:
      description: Example deleted successfully
      headers:
        X-Processing-Time:
          schema:
            description: Processing time in milliseconds
            example: 15
            type: integer
    ExampleListSuccess:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ExampleListResponse'
      description: Examples retrieved successfully
      headers:
        Cache-Control:
          schema:
            example: max-age=300, private
            type: string
        X-Page-Count:
          schema:
            description: Total number of pages
            example: 8
            type: integer
        X-Total-Count:
          schema:
            description: Total number of examples matching criteria
            example: 150
            type: integer
    ExampleRetrieved:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ExampleResponse'
      description: Example retrieved successfully
      headers:
        Cache-Control:
          schema:
            description: Cache control directives
            example: max-age=300, private
            type: string
        ETag:
          schema:
            description: Entity tag for caching
            example: '"example-123-v1"'
            type: string
        Last-Modified:
          schema:
            description: Last modification timestamp
            example: '2025-12-21T10:00:00Z'
            format: date-time
            type: string
        X-Processing-Time:
          schema:
            description: Processing time in milliseconds
            example: 5
            type: integer
    ExampleUpdated:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ExampleResponse'
      description: Example updated successfully
      headers:
        ETag:
          schema:
            description: New entity tag after update
            example: '"example-123-v2"'
            type: string
        Last-Modified:
          schema:
            description: Last modification timestamp
            example: '2025-12-21T10:05:00Z'
            format: date-time
            type: string
        X-Processing-Time:
          schema:
            description: Processing time in milliseconds
            example: 25
            type: integer
    Forbidden:
      $ref: ../common-service/responses/error.yaml#/Forbidden
    HealthBatchSuccess:
      $ref: ../common-service/responses/success.yaml#/HealthBatchSuccess
    HealthOK:
      $ref: ../common-service/responses/success.yaml#/HealthOK
    InternalServerError:
      $ref: ../common-service/responses/error.yaml#/InternalServerError
    NotFound:
      $ref: ../common-service/responses/error.yaml#/NotFound
    OK:
      $ref: ../common-service/responses/success.yaml#/OK
    Unauthorized:
      $ref: ../common-service/responses/error.yaml#/Unauthorized
  schemas:
    CreateExampleRequest:
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small).
        Expected memory savings: 30-50%.'
      properties:
        description:
          description: Example description
          example: A new example following enterprise-grade patterns.
          maxLength: 1000
          type: string
        name:
          description: Desired example name
          example: My New Example
          maxLength: 100
          minLength: 1
          type: string
        priority:
          default: 5
          description: Processing priority
          maximum: 10
          minimum: 1
          type: integer
        tags:
          description: Initial tags
          items:
            maxLength: 50
            type: string
          maxItems: 10
          type: array
      required:
      - name
      - description
      type: object
    Error:
      $ref: ../common-service/schemas/error.yaml#/Error
    Example:
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small).
        Expected memory savings: 30-50%. Hot path optimization required.'
      properties:
        created_at:
          description: Creation timestamp
          example: '2025-12-21T10:00:00Z'
          format: date-time
          type: string
        description:
          description: Detailed description
          example: This is a comprehensive example demonstrating best practices.
          maxLength: 1000
          type: string
        id:
          description: Example unique identifier
          example: 550e8400-e29b-41d4-a716-446655440000
          format: uuid
          type: string
        is_active:
          description: Whether this example is active
          example: true
          type: boolean
        name:
          description: Example display name
          example: Sample Example
          maxLength: 100
          minLength: 1
          type: string
        priority:
          default: 5
          description: Processing priority
          example: 7
          maximum: 10
          minimum: 1
          type: integer
        status:
          default: active
          description: Current status
          enum:
          - active
          - inactive
          - pending
          - archived
          example: active
          type: string
        tags:
          description: Associated tags
          example:
          - demo
          - template
          - best-practice
          items:
            maxLength: 50
            type: string
          maxItems: 10
          type: array
        updated_at:
          description: Last update timestamp
          example: '2025-12-21T10:00:00Z'
          format: date-time
          type: string
      required:
      - id
      - name
      - created_at
      - status
      - is_active
      type: object
    ExampleListResponse:
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small).
        Expected memory savings: 30-50%. Paginated responses optimized for memory
        efficiency.'
      properties:
        examples:
          description: List of examples
          items:
            $ref: '#/components/schemas/Example'
          type: array
        has_more:
          description: Whether there are more results available
          example: true
          type: boolean
        limit:
          description: Items per page
          example: 20
          type: integer
        page:
          description: Current page number
          example: 1
          type: integer
        total_count:
          description: Total number of examples matching criteria
          example: 150
          type: integer
      required:
      - examples
      - total_count
      - has_more
      type: object
    ExampleResponse:
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small).
        Expected memory savings: 30-50%.'
      properties:
        example:
          $ref: '#/components/schemas/Example'
      required:
      - example
      type: object
    HealthResponse:
      $ref: ../common-service/schemas/health.yaml#/HealthResponse
    PaginatedResponse:
      $ref: ../common-service/schemas/pagination.yaml#/PaginatedResponse
    PaginationParams:
      $ref: ../common-service/schemas/pagination.yaml#/PaginationParams
    UpdateExampleRequest:
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small).
        Expected memory savings: 30-50%.'
      properties:
        description:
          description: New description
          maxLength: 1000
          type: string
        is_active:
          description: Update active status
          type: boolean
        name:
          description: New example name
          example: Updated Example Name
          maxLength: 100
          minLength: 1
          type: string
        priority:
          description: New priority
          maximum: 10
          minimum: 1
          type: integer
        status:
          description: New status
          enum:
          - active
          - inactive
          - pending
          - archived
          type: string
        tags:
          description: Replace all tags
          items:
            maxLength: 50
            type: string
          maxItems: 10
          type: array
      type: object
    WebSocketHealthMessage:
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small).
        Expected memory savings: 30-50%.'
      properties:
        health:
          $ref: ../common-service/schemas/health.yaml#/HealthResponse
        message_timestamp:
          description: Timestamp of the health message
          format: date-time
          maxLength: 1000
          type: string
        timestamp:
          format: date-time
          maxLength: 255
          type: string
        type:
          enum:
          - health_update
          - health_alert
          - service_down
          example: health_update
          maxLength: 255
          type: string
      required:
      - type
      - timestamp
      - health
      type: object
  securitySchemes:
    ApiKeyAuth:
      $ref: ../common-service/security/security.yaml#/ApiKeyAuth
    BearerAuth:
      $ref: ../common-service/security/security.yaml#/BearerAuth
    ServiceAuth:
      $ref: ../common-service/security/security.yaml#/ServiceAuth
info:
  contact:
    email: api@necpgame.com
    name: NECPGAME API Support
    url: https://necpgame.com/support
  description: '**Enterprise-Grade AI Companion Management API for NECPGAME**

    This API manages intelligent AI companions, personality systems, learning algorithms,
    adaptive behavior, and human-AI interaction mechanics in the cyberpunk world.

    ## Key Features

    - **Personality Systems**: Dynamic AI personality development and adaptation -
    **Learning Algorithms**: Machine learning for companion behavior optimization
    - **Adaptive Behavior**: Context-aware responses and situational awareness - **Human-AI
    Interaction**: Natural language processing and emotional intelligence - **Memory
    Systems**: Long-term relationship building and knowledge retention - **Performance
    Optimized**: Advanced AI processing with <40ms P99 latency

    ## Domain Purpose

    The AI Companion domain handles intelligent virtual companions in Night City.
    Players interact with sophisticated AI entities that learn, adapt, and form meaningful
    relationships, providing guidance, companionship, and assistance.

    ## Performance Targets

    - P99 Latency: <40ms for AI operations - Memory: <45KB per active AI companion
    - Concurrent users: 20,000+ simultaneous AI interactions - ML inference: <25ms
    per response generation

    '
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  title: AI Companion Service API - Enterprise-Grade Domain Service
  version: 1.0.0
openapi: 3.0.3
paths:
  /examples:
    get:
      description: '**Enterprise-grade listing endpoint**


        Supports complex filtering, sorting, and pagination patterns.

        Optimized for high-throughput scenarios with proper indexing.


        **Performance:** <10ms P95, supports 1000+ concurrent requests

        '
      operationId: listExamples
      parameters:
      - description: Page number for pagination
        in: query
        name: page
        schema:
          default: 1
          minimum: 1
          type: integer
      - description: Number of items per page
        in: query
        name: limit
        schema:
          default: 20
          maximum: 100
          minimum: 1
          type: integer
      - description: Sort field
        in: query
        name: sort_by
        schema:
          default: created_at
          enum:
          - created_at
          - name
          - priority
          type: string
      - description: Sort order
        in: query
        name: sort_order
        schema:
          default: desc
          enum:
          - asc
          - desc
          type: string
      - description: Filter by status
        in: query
        name: filter_status
        schema:
          enum:
          - active
          - inactive
          - pending
          type: string
      responses:
        '200':
          $ref: '#/components/responses/ExampleListSuccess'
        '400':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Invalid request - malformed query parameters
        '422':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Unprocessable entity - validation failed
      summary: List examples with filtering and pagination
      tags:
      - Example Domain
    post:
      description: '**Enterprise-grade creation endpoint**


        Validates business rules, applies security checks, and ensures data consistency.

        Supports optimistic locking for concurrent operations.


        **Performance:** <50ms P95, includes validation and business logic

        '
      operationId: createExample
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateExampleRequest'
        required: true
      responses:
        '201':
          $ref: '#/components/responses/ExampleCreated'
        '400':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Invalid request - malformed or missing data
        '409':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Conflict - example with this identifier already exists
        '422':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Unprocessable entity - business rule validation failed
        '429':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Too many requests - creation rate limit exceeded
          headers:
            Retry-After:
              schema:
                example: 60
                type: integer
      security:
      - BearerAuth: []
      summary: Create new example
      tags:
      - Example Domain
  /examples/{example_id}:
    delete:
      description: '**Enterprise-grade deletion endpoint**


        Supports soft deletes with audit trails and cleanup scheduling.

        Ensures referential integrity and cascading deletes.


        **Performance:** <15ms P95, includes cleanup operations

        '
      operationId: deleteExample
      parameters:
      - description: Example unique identifier
        in: path
        name: example_id
        required: true
        schema:
          format: uuid
          type: string
      responses:
        '204':
          $ref: '#/components/responses/ExampleDeleted'
        '400':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Invalid request - malformed example ID
        '404':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Example not found
        '409':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Conflict - example cannot be deleted (referential integrity)
        '429':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Too many requests - deletion rate limit exceeded
          headers:
            Retry-After:
              schema:
                example: 60
                type: integer
      security:
      - BearerAuth: []
      summary: Delete example
      tags:
      - Example Domain
    get:
      description: '**Enterprise-grade retrieval endpoint**


        Optimized with proper caching strategies and database indexing.

        Supports conditional requests with ETags.


        **Performance:** <5ms P95 with Redis caching

        '
      operationId: getExample
      parameters:
      - description: Example unique identifier
        in: path
        name: example_id
        required: true
        schema:
          format: uuid
          type: string
      - description: Include related data in response
        in: query
        name: include_related
        schema:
          default: false
          type: boolean
      - description: Conditional request - return 304 if ETag matches
        in: header
        name: If-None-Match
        schema:
          type: string
      - description: Conditional request - return 304 if not modified since this time
        in: header
        name: If-Modified-Since
        schema:
          format: date-time
          type: string
      responses:
        '200':
          $ref: '#/components/responses/ExampleRetrieved'
        '304':
          description: Not modified - resource has not changed
          headers:
            Cache-Control:
              schema:
                example: max-age=300, private
                type: string
            ETag:
              schema:
                example: '"example-123-v1"'
                type: string
        '400':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Invalid request - malformed example ID
        '404':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Example not found
        '429':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Too many requests - rate limit exceeded
          headers:
            Retry-After:
              schema:
                example: 30
                type: integer
      summary: Get specific example by ID
      tags:
      - Example Domain
    put:
      description: '**Enterprise-grade update endpoint**


        Supports partial updates, optimistic locking, and audit trails.

        Ensures data consistency with event sourcing patterns.


        **Performance:** <25ms P95, includes validation and conflict resolution

        '
      operationId: updateExample
      parameters:
      - description: Example unique identifier
        in: path
        name: example_id
        required: true
        schema:
          format: uuid
          type: string
      - description: ETag for optimistic locking - prevents concurrent updates
        in: header
        name: If-Match
        schema:
          type: string
      - description: Conditional update - proceed only if not modified since this
          time
        in: header
        name: If-Unmodified-Since
        schema:
          format: date-time
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateExampleRequest'
        required: true
      responses:
        '200':
          $ref: '#/components/responses/ExampleUpdated'
        '400':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Invalid request - malformed data or example ID
        '404':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Example not found
        '409':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Conflict - version conflict (optimistic locking) or precondition
            failed
          headers:
            ETag:
              schema:
                description: Current entity tag
                example: '"example-123-v1"'
                type: string
        '412':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Precondition failed - If-Match or If-Unmodified-Since condition
            not met
          headers:
            ETag:
              schema:
                description: Current entity tag
                example: '"example-123-v1"'
                type: string
        '422':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Unprocessable entity - business rule validation failed
        '429':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Too many requests - update rate limit exceeded
          headers:
            Retry-After:
              schema:
                example: 30
                type: integer
      security:
      - BearerAuth: []
      summary: Update existing example
      tags:
      - Example Domain
  /health:
    get:
      description: '**Enterprise-grade health check endpoint**


        Provides real-time health status of the example domain microservice.

        Critical for service discovery, load balancing, and monitoring.


        **Performance:** <1ms response time, cached for 30 seconds

        '
      operationId: aiCompanionServiceHealthCheck
      parameters:
      - in: header
        name: Accept-Encoding
        schema:
          enum:
          - gzip
          - deflate
          - br
          type: string
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/health.yaml#/HealthResponse
          description: Service is healthy
          headers:
            Cache-Control:
              schema:
                example: max-age=30, s-maxage=60
                type: string
            Content-Encoding:
              schema:
                enum:
                - gzip
                - deflate
                - br
                type: string
            ETag:
              schema:
                example: '"health-v1.0"'
                type: string
        '429':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Too many requests - rate limit exceeded
          headers:
            Retry-After:
              schema:
                example: 60
                type: integer
        '503':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/health.yaml#/HealthResponse
          description: Service is unhealthy
      summary: Example domain health check
      tags:
      - Health Monitoring
  /health/batch:
    post:
      description: '**Performance optimization:** Check multiple domain health in
        single request


        Reduces N HTTP calls to 1 call. Critical for microservice orchestration.

        Eliminates network overhead in health monitoring scenarios.


        **Use case:** Service mesh health checks, Kubernetes readiness probes

        '
      operationId: exampleDomainBatchHealthCheck
      requestBody:
        content:
          application/json:
            schema:
              properties:
                services:
                  description: List of services to check
                  items:
                    enum:
                    - example-domain
                    - system-domain
                    - specialized-domain
                    maxItems: 10
                    type: string
                  type: array
              required:
              - services
              type: object
        required: true
      responses:
        '200':
          $ref: ../common-service/responses/success.yaml#/HealthBatchSuccess
        '400':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Invalid request - malformed service list
        '429':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Too many requests - rate limit exceeded
          headers:
            Retry-After:
              schema:
                description: Seconds to wait before retrying
                example: 60
                type: integer
      summary: Batch health check for multiple domain services
      tags:
      - Health Monitoring
  /health/ws:
    get:
      description: '**Performance optimization:** Real-time health updates without
        polling


        Eliminates periodic HTTP requests, reduces server load by ~90%.

        Perfect for dashboard monitoring and alerting systems.


        **Protocol:** WebSocket with JSON payloads

        **Heartbeat:** 30 second intervals

        **Reconnection:** Automatic with exponential backoff

        '
      operationId: exampleDomainHealthWebSocket
      parameters:
      - description: Services to monitor (optional, monitors all if not specified)
        in: query
        name: services
        schema:
          items:
            enum:
            - example-domain
            - system-domain
            - specialized-domain
            type: string
          type: array
      responses:
        '101':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebSocketHealthMessage'
          description: WebSocket connection established successfully
          headers:
            Connection:
              schema:
                example: Upgrade
                type: string
            Sec-WebSocket-Accept:
              schema:
                description: WebSocket handshake acceptance key
                type: string
            Upgrade:
              schema:
                example: websocket
                type: string
        '200':
          content:
            application/json:
              schema:
                properties:
                  supported_protocols:
                    example:
                    - health-monitoring-v1
                    items:
                      type: string
                    type: array
                  websocket_url:
                    example: ws://localhost:8080/api/v1/example-domain/health/ws
                    type: string
                type: object
          description: WebSocket upgrade information returned
        '400':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Invalid request - malformed service parameters
        '401':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Unauthorized - authentication required for WebSocket
        '429':
          content:
            application/json:
              schema:
                $ref: ../common-service/schemas/error.yaml#/Error
          description: Too many requests - WebSocket connection limit exceeded
          headers:
            Retry-After:
              schema:
                example: 30
                type: integer
      summary: Real-time health monitoring WebSocket
      tags:
      - Health Monitoring
security:
- BearerAuth: []
servers:
- description: Production server
  url: https://api.necpgame.com/v1/ai-companion
- description: Staging server
  url: https://staging-api.necpgame.com/v1/ai-companion
- description: Local development server
  url: http://localhost:8080/api/v1/ai-companion
tags:
- description: Core AI companion and personality operations
  name: AI Companion
- description: System health and performance monitoring
  name: Health Monitoring
