in: query
schema:
  type: string
  description: Filter by queue name
- name: status
  in: query
  schema:
    type: string
    enum: [ active, paused, error ]
responses:
  '200':
    description: Consumers retrieved successfully
    content:
      application/json:
        schema:
          $ref: '#/schemas/responses.yaml#/ListConsumersResponse'
  '401':
    description: Unauthorized
    content:
      application/json:
        schema:
          $ref: '#/components/schemas/Error'
  '500':
    $ref: '#/components/responses/InternalError'

/mq/consumers/{consumerId}:
  delete:
    tags:
      - Consumers
    summary: Unregister a message consumer
    operationId: unregisterConsumer
    security:
      - BearerAuth: [ ]
    parameters:
      - name: consumerId
        in: path
        required: true
        schema:
          type: string
    responses:
      '204':
        description: Consumer unregistered successfully
      '401':
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Error'
      '404':
        description: Consumer not found
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Error'
      '500':
        $ref: '#/components/responses/InternalError'

  put:
    tags:
      - Consumers
    summary: Update consumer configuration
    operationId: updateConsumer
    security:
      - BearerAuth: [ ]
    parameters:
      - name: consumerId
        in: path
        required: true
        schema:
          type: string
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/schemas/requests.yaml#/UpdateConsumerRequest'
    responses:
      '200':
        description: Consumer updated successfully
        content:
          application/json:
            schema:
              $ref: '#/schemas/responses.yaml#/UpdateConsumerResponse'
      '400':
        $ref: '#/components/responses/BadRequest'
      '401':
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Error'
      '404':
        description: Consumer not found
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Error'
      '500':
        $ref: '#/components/responses/InternalError'

/mq/events:
  post:
    tags:
      - Events
    summary: Publish an event to multiple subscribers
    operationId: publishEvent
    security:
      - BearerAuth: [ ]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/schemas/requests.yaml#/PublishEventRequest'
    responses:
      '202':
        description: Event published successfully
        content:
          application/json:
            schema:
              $ref: '#/schemas/responses.yaml#/PublishEventResponse'
      '400':
        $ref: '#/components/responses/BadRequest'
      '401':
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Error'
      '500':
        $ref: '#/components/responses/InternalError'

/mq/exchanges:
  post:
    tags:
      - Exchanges
    summary: Create a message exchange
    operationId: createExchange
    security:
      - BearerAuth: [ ]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/schemas/requests.yaml#/CreateExchangeRequest'
    responses:
      '201':
        description: Exchange created successfully
        content:
          application/json:
            schema:
              $ref: '#/schemas/responses.yaml#/CreateExchangeResponse'
      '400':
        $ref: '#/components/responses/BadRequest'
      '401':
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Error'
      '409':
        description: Exchange already exists
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Error'
      '500':
        $ref: '#/components/responses/InternalError'

  get:
    tags:
      - Exchanges
    summary: List all exchanges
    operationId: listExchanges
    security:
      - BearerAuth: [ ]
    responses:
      '200':
        description: Exchanges retrieved successfully
        content:
          application/json:
            schema:
              $ref: '#/schemas/responses.yaml#/ListExchangesResponse'
      '401':
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Error'
      '500':
        $ref: '#/components/responses/InternalError'

/mq/bindings:
  post:
    tags:
      - Exchanges
    summary: Create a queue binding to an exchange
    operationId: createBinding
    security:
      - BearerAuth: [ ]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/schemas/requests.yaml#/CreateBindingRequest'
    responses:
      '201':
        description: Binding created successfully
        content:
          application/json:
            schema:
              $ref: '#/schemas/responses.yaml#/CreateBindingResponse'
      '400':
        $ref: '#/components/responses/BadRequest'
      '401':
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Error'
      '404':
        description: Exchange or queue not found
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Error'
      '409':
        description: Binding already exists
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Error'
      '500':
        $ref: '#/components/responses/InternalError'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    InternalError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

  schemas:
    Error:
      type: object
      properties:
        code:
          type: integer
          format: int32
        message:
          type: string
      required:
        - code
        - message

    # Request/Response schemas
    CreateQueueRequest:
      $ref: './schemas/requests.yaml#/CreateQueueRequest'

    CreateQueueResponse:
      $ref: './schemas/responses.yaml#/CreateQueueResponse'

    UpdateQueueRequest:
      $ref: './schemas/requests.yaml#/UpdateQueueRequest'

    UpdateQueueResponse:
      $ref: './schemas/responses.yaml#/UpdateQueueResponse'

    ListQueuesResponse:
      $ref: './schemas/responses.yaml#/ListQueuesResponse'

    GetQueueResponse:
      $ref: './schemas/responses.yaml#/GetQueueResponse'

    PublishMessageRequest:
      $ref: './schemas/requests.yaml#/PublishMessageRequest'

    PublishMessageResponse:
      $ref: './schemas/responses.yaml#/PublishMessageResponse'

    PublishBatchRequest:
      $ref: './schemas/requests.yaml#/PublishBatchRequest'

    PublishBatchResponse:
      $ref: './schemas/responses.yaml#/PublishBatchResponse'

    ConsumeMessagesRequest:
      $ref: './schemas/requests.yaml#/ConsumeMessagesRequest'

    ConsumeMessagesResponse:
      $ref: './schemas/responses.yaml#/ConsumeMessagesResponse'

    RegisterConsumerRequest:
      $ref: './schemas/requests.yaml#/RegisterConsumerRequest'

    RegisterConsumerResponse:
      $ref: './schemas/responses.yaml#/RegisterConsumerResponse'

    UpdateConsumerRequest:
      $ref: './schemas/requests.yaml#/UpdateConsumerRequest'

    UpdateConsumerResponse:
      $ref: './schemas/responses.yaml#/UpdateConsumerResponse'

    ListConsumersResponse:
      $ref: './schemas/responses.yaml#/ListConsumersResponse'

    PublishEventRequest:
      $ref: './schemas/requests.yaml#/PublishEventRequest'

    PublishEventResponse:
      $ref: './schemas/responses.yaml#/PublishEventResponse'

    CreateExchangeRequest:
      $ref: './schemas/requests.yaml#/CreateExchangeRequest'

    CreateExchangeResponse:
      $ref: './schemas/responses.yaml#/CreateExchangeResponse'

    ListExchangesResponse:
      $ref: './schemas/responses.yaml#/ListExchangesResponse'

    CreateBindingRequest:
      $ref: './schemas/requests.yaml#/CreateBindingRequest'

    CreateBindingResponse:
      $ref: './schemas/responses.yaml#/CreateBindingResponse'
