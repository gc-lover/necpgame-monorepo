openapi: 3.0.3
components:
  schemas:
    ChatMessage:
      type: object
      properties:
        message_id:
          type: string
          format: uuid
        message_type:
          type: string
          enum:
          - CHAT
          - SYSTEM
          - COMBAT
          - QUEST
          - SOCIAL
          - ADMIN
        sender_id:
          type: string
          format: uuid
        sender_name:
          type: string
        recipient_id:
          type: string
          format: uuid
        recipient_type:
          type: string
          enum:
          - USER
          - CHANNEL
          - GROUP
          - ALL
        channel:
          type: string
        content:
          type: string
        content_type:
          type: string
          enum:
          - TEXT
          - JSON
          - BINARY
          default: TEXT
        priority:
          type: string
          enum:
          - LOW
          - NORMAL
          - HIGH
          - URGENT
          default: NORMAL
        metadata:
          type: object
          additionalProperties: true
        timestamp:
          type: integer
          format: int64
        ttl:
          type: integer
          description: Time to live in seconds
      required:
      - message_id
      - message_type
      - sender_id
      - content
      - timestamp
    Channel:
      type: object
      properties:
        channel_id:
          type: string
          format: uuid
        channel_type:
          type: string
          enum:
          - PUBLIC
          - PRIVATE
          - GROUP
          - SYSTEM
        name:
          type: string
        description:
          type: string
        owner_id:
          type: string
          format: uuid
        member_count:
          type: integer
          minimum: 0
        max_members:
          type: integer
          minimum: 1
        is_temporary:
          type: boolean
          default: false
        created_at:
          type: integer
          format: int64
        settings:
          type: object
          additionalProperties: true
      required:
      - channel_id
      - channel_type
      - name
      - owner_id
    MessageListResponse:
      allOf:
      - $ref: ../common/schemas/pagination.yaml#/PaginatedResponse
      - type: object
        properties:
          items:
            type: array
            items:
              $ref: '#/components/schemas/ChatMessage'
    SendMessageRequest:
      type: object
      required:
      - channel_id
      - channel_type
      - content
      properties:
        channel_id:
          type: string
          format: uuid
        recipient_id:
          type: string
          format: uuid
          nullable: true
        content:
          type: string
          maxLength: 500
        channel_type:
          type: string
          enum:
          - GLOBAL
          - TRADE
          - NEWBIE
          - LOCAL
          - PARTY
          - RAID
          - GUILD
          - GUILD_OFFICER
          - WHISPER
          - SYSTEM
          - COMBAT_LOG
          - RP_EMOTE
    CreateChannelRequest:
      type: object
      required:
      - name
      - channel_type
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 50
        description:
          type: string
          maxLength: 200
        channel_type:
          type: string
          enum:
          - PUBLIC
          - PRIVATE
          - GROUP
          - SYSTEM
        max_members:
          type: integer
          minimum: 2
          maximum: 1000
        is_temporary:
          type: boolean
          default: false
    ChannelListResponse:
      type: object
      properties:
        channels:
          type: array
          items:
            $ref: '#/components/schemas/Channel'
        total_count:
          type: integer
    EnqueueMessageRequest:
      type: object
      required:
      - queue_name
      - payload
      properties:
        queue_name:
          type: string
          description: Name of the queue
        payload:
          type: string
          description: Message payload (JSON string)
        headers:
          type: object
          additionalProperties:
            type: string
            schema:
              type: string
              example: '"additionalproperties-value"'
              description: additionalProperties header value
          description: Optional message headers
        ttl:
          type: integer
          format: int64
          description: Time-to-live in milliseconds
        priority:
          type: integer
          minimum: 0
          maximum: 255
          default: 0
          description: Message priority (higher values = higher priority)
    EnqueueMessageResponse:
      type: object
      properties:
        message_id:
          type: string
          description: Unique message identifier
        queued_at:
          type: integer
          format: int64
          description: Unix timestamp when message was queued
    DequeueMessageResponse:
      type: object
      properties:
        messages:
          type: array
          items:
            $ref: '#/components/schemas/QueueMessage'
        count:
          type: integer
          description: Number of messages returned
    QueueMessage:
      type: object
      properties:
        id:
          type: string
          description: Unique message identifier
        queue_name:
          type: string
          description: Queue name
        payload:
          type: string
          description: Message payload
        status:
          type: string
          enum:
          - queued
          - processing
          - acknowledged
          - failed
          - expired
        headers:
          type: object
          additionalProperties:
            type: string
            schema:
              type: string
              example: '"additionalproperties-value"'
              description: additionalProperties header value
        ttl:
          type: integer
          format: int64
          description: Time-to-live in milliseconds
        created_at:
          type: integer
          format: int64
          description: Creation timestamp
        priority:
          type: integer
        retry_count:
          type: integer
        max_retries:
          type: integer
    AcknowledgeMessageRequest:
      type: object
      required:
      - success
      properties:
        success:
          type: boolean
          description: Whether message processing was successful
        error:
          type: string
          description: Error message if processing failed
    AcknowledgeMessageResponse:
      type: object
      properties:
        message_id:
          type: string
        acknowledged:
          type: boolean
    CreateQueueRequest:
      type: object
      required:
      - name
      properties:
        name:
          type: string
          description: Queue name
        priority:
          type: boolean
          description: Whether this is a priority queue
          default: false
        persistent:
          type: boolean
          description: Whether queue persists across restarts
          default: true
        message_ttl:
          type: integer
          format: int64
          description: Default message TTL in milliseconds
        max_size:
          type: integer
          description: Maximum queue size
          default: 10000
    CreateQueueResponse:
      type: object
      properties:
        name:
          type: string
        created_at:
          type: integer
          format: int64
    BaseEvent:
      type: object
      required:
      - event_id
      - event_type
      - timestamp
      - source
      properties:
        event_id:
          type: string
          format: uuid
          description: Unique event identifier
        correlation_id:
          type: string
          format: uuid
          description: Correlation ID for event tracing
        player_id:
          type: string
          format: uuid
          description: Player associated with the event
        event_type:
          type: string
          description: Event type identifier
        source:
          type: string
          description: Service or component that generated the event
        timestamp:
          type: string
          format: date-time
          description: Event timestamp
    PublishEventRequest:
      type: object
      required:
      - event
      - topic
      properties:
        event:
          $ref: '#/components/schemas/BaseEvent'
        topic:
          type: string
          description: Kafka topic to publish to
    PublishEventResponse:
      type: object
      properties:
        event_id:
          type: string
          format: uuid
        topic:
          type: string
        published_at:
          type: string
          format: date-time
        partition:
          type: integer
        offset:
          type: integer
    EventTopicsResponse:
      type: object
      properties:
        topics:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              partitions:
                type: integer
              description:
                type: string
    Notification:
      type: object
      properties:
        notification_id:
          type: string
          format: uuid
        user_id:
          type: string
          format: uuid
        type:
          type: string
          enum:
          - system
          - social
          - game
          - achievement
        title:
          type: string
        message:
          type: string
        data:
          type: object
          additionalProperties: true
        read:
          type: boolean
          default: false
        created_at:
          type: string
          format: date-time
      required:
      - notification_id
      - user_id
      - type
      - title
      - message
    NotificationListResponse:
      type: object
      properties:
        notifications:
          type: array
          items:
            $ref: '#/components/schemas/Notification'
        total_count:
          type: integer
        unread_count:
          type: integer
    SendNotificationRequest:
      type: object
      required:
      - user_id
      - type
      - title
      - message
      properties:
        user_id:
          type: string
          format: uuid
        type:
          type: string
          enum:
          - system
          - social
          - game
          - achievement
        title:
          type: string
          maxLength: 100
        message:
          type: string
          maxLength: 500
        data:
          type: object
          additionalProperties: true
    WebSocketHealthMessage:
      type: object
      required:
      - type
      - timestamp
      - health
      properties:
        type:
          type: string
          enum:
          - health_update
          - service_down
          - service_up
        timestamp:
          type: string
          format: date-time
        health:
          $ref: ../common/schemas/health.yaml#/HealthResponse
        service_name:
          type: string
          description: Name of the service that changed status
