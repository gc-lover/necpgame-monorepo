openapi: 3.0.3
info:
  title: NPC System Common Schemas
  description: Общие схемы для системы NPC
  version: 1.0.0
servers:
- url: http://localhost:8084/api/v1
  description: Локальный сервер разработки
- url: https://api.necp.game/api/v1
  description: Продакшен сервер
paths: {}
components:
  schemas:
    NPCType:
      type: object
      required:
      - id
      - name
      - display_name
      properties:
        id:
          type: string
          format: uuid
          description: Уникальный идентификатор типа NPC
          example: 550e8400-e29b-41d4-a716-446655440000
        name:
          type: string
          description: Внутреннее имя типа
          example: fixer
        display_name:
          type: string
          description: Отображаемое имя типа
          example: Фиксер
        description:
          type: string
          description: Описание типа NPC
          example: Посредник, организатор контрактов и заданий
        functionality:
          type: object
          description: Функционал типа NPC
          additionalProperties: true
        default_interfaces:
          type: array
          items:
            type: string
          description: Интерфейсы по умолчанию для типа
          example:
          - dialogue
          - quests
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    NPC:
      type: object
      required:
      - id
      - npc_type_id
      - name
      - location_id
      - state
      properties:
        id:
          type: string
          format: uuid
          description: Уникальный идентификатор NPC
          example: 550e8400-e29b-41d4-a716-446655440001
        npc_type_id:
          type: string
          format: uuid
          description: Идентификатор типа NPC
          example: 550e8400-e29b-41d4-a716-446655440000
        location_id:
          type: string
          format: uuid
          description: Идентификатор локации
          example: 550e8400-e29b-41d4-a716-446655440002
        faction_id:
          type: string
          format: uuid
          nullable: true
          description: Идентификатор фракции
        name:
          type: string
          description: Имя NPC
          example: Декстер ДеШон
        state:
          type: string
          enum:
          - AVAILABLE
          - BUSY
          - UNAVAILABLE
          description: Состояние NPC
          example: AVAILABLE
        created_at:
          type: string
          format: date-time
          description: Время создания
          example: '2025-11-29T10:00:00Z'
        updated_at:
          type: string
          format: date-time
          description: Время обновления
          example: '2025-11-29T10:00:00Z'
        metadata:
          type: object
          description: Дополнительные метаданные
          additionalProperties: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    DialogueNode:
      type: object
      required:
      - id
      - text
      properties:
        id:
          type: string
          description: Идентификатор узла диалога
          example: node_1
        text:
          type: string
          description: Текст диалога
          example: Привет, чувак. Что нужно?
        conditions:
          type: object
          description: Условия доступности узла
          additionalProperties: true
        choices:
          type: array
          items:
            $ref: '#/components/schemas/DialogueChoice'
          description: Варианты ответов
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    DialogueChoice:
      type: object
      required:
      - id
      - text
      - next_node_id
      properties:
        quest_trigger:
          type: string
          format: uuid
          nullable: true
          description: Идентификатор квеста для триггера
        id:
          type: string
          description: Идентификатор выбора
          example: choice_1
        text:
          type: string
          description: Текст выбора
          example: Есть работа?
        next_node_id:
          type: string
          description: Идентификатор следующего узла
          example: node_2
        reputation_effect:
          type: integer
          description: Влияние на репутацию
          example: 5
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Dialogue:
      type: object
      required:
      - id
      - npc_id
      - dialogue_tree
      properties:
        id:
          type: string
          format: uuid
          description: Уникальный идентификатор диалога
          example: 550e8400-e29b-41d4-a716-446655440003
        npc_id:
          type: string
          format: uuid
          description: Идентификатор NPC
          example: 550e8400-e29b-41d4-a716-446655440001
        dialogue_tree:
          type: object
          description: Дерево диалога
          additionalProperties:
            $ref: '#/components/schemas/DialogueNode'
        conditions:
          type: object
          description: Условия доступности диалога
          additionalProperties: true
        reputation_requirements:
          type: object
          description: Требования к репутации
          additionalProperties: true
        quest_triggers:
          type: object
          description: Триггеры квестов
          additionalProperties: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    DialogueProgress:
      type: object
      required:
      - id
      - player_id
      - npc_id
      - dialogue_id
      - current_node
      properties:
        id:
          type: string
          format: uuid
          description: Уникальный идентификатор прогресса
          example: 550e8400-e29b-41d4-a716-446655440004
        player_id:
          type: string
          format: uuid
          description: Идентификатор игрока
          example: 550e8400-e29b-41d4-a716-446655440005
        npc_id:
          type: string
          format: uuid
          description: Идентификатор NPC
          example: 550e8400-e29b-41d4-a716-446655440001
        dialogue_id:
          type: string
          format: uuid
          description: Идентификатор диалога
          example: 550e8400-e29b-41d4-a716-446655440003
        current_node:
          type: string
          description: Текущий узел диалога
          example: node_1
        choices_made:
          type: object
          description: Сделанные выборы
          additionalProperties: true
        visited_nodes:
          type: array
          items:
            type: string
          description: Посещенные узлы
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    NPCReputation:
      type: object
      required:
      - id
      - player_id
      - npc_id
      - reputation_value
      - reputation_level
      properties:
        id:
          type: string
          format: uuid
          description: Уникальный идентификатор репутации
          example: 550e8400-e29b-41d4-a716-446655440006
        player_id:
          type: string
          format: uuid
          description: Идентификатор игрока
          example: 550e8400-e29b-41d4-a716-446655440005
        npc_id:
          type: string
          format: uuid
          description: Идентификатор NPC
          example: 550e8400-e29b-41d4-a716-446655440001
        reputation_level:
          type: string
          enum:
          - HOSTILE
          - NEUTRAL
          - FRIENDLY
          - TRUSTED
          description: Уровень репутации
          example: FRIENDLY
        last_interaction:
          type: string
          format: date-time
          description: Время последнего взаимодействия
          example: '2025-11-29T10:00:00Z'
        reputation_value:
          type: integer
          description: Значение репутации
          example: 50
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    NPCInteraction:
      type: object
      required:
      - id
      - player_id
      - npc_id
      - interaction_type
      - timestamp
      properties:
        id:
          type: string
          format: uuid
          description: Уникальный идентификатор взаимодействия
          example: 550e8400-e29b-41d4-a716-446655440007
        player_id:
          type: string
          format: uuid
          description: Идентификатор игрока
          example: 550e8400-e29b-41d4-a716-446655440005
        npc_id:
          type: string
          format: uuid
          description: Идентификатор NPC
          example: 550e8400-e29b-41d4-a716-446655440001
        interaction_type:
          type: string
          description: Тип взаимодействия
          example: dialogue
        timestamp:
          type: string
          format: date-time
          description: Временная метка
          example: '2025-11-29T10:00:00Z'
        interaction_data:
          type: object
          description: Данные взаимодействия
          additionalProperties: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    DialogueResponseRequest:
      type: object
      required:
      - choice_id
      properties:
        choice_id:
          type: string
          description: Идентификатор выбранного варианта ответа
          example: choice_1
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    InteractionRequest:
      type: object
      required:
      - interaction_type
      properties:
        interaction_type:
          type: string
          enum:
          - dialogue
          - trade
          - training
          - quest
          description: Тип взаимодействия
          example: dialogue
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'




