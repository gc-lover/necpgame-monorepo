openapi: 3.0.3
info:
  title: Referral Domain API - Enterprise-Grade
  description: '**Enterprise-Grade Referral Domain API for NECPGAME**

    This domain provides comprehensive referral system functionality including code
    generation, registration tracking, milestone rewards, and leaderboard management.

    ## Key Features

    - **Code Management**: Generate and validate unique referral codes - **Registration
    Tracking**: Track referrals and their progression - **Milestone System**: Multi-level
    rewards based on referral achievements - **Leaderboard**: Competitive ranking
    system for referrers - **Reward Distribution**: Automated reward claiming and
    distribution - **Analytics**: Comprehensive referral system analytics

    ## Domain Purpose

    The Referral Domain handles all aspects of player-to-player referrals, enabling
    viral growth through incentivized player acquisition and engagement.

    ## Performance Targets

    - P99 Latency: <100ms for hot paths (code validation, registration) - Memory:
    <50KB per player instance - Concurrent users: 10,000+ simultaneous connections
    - Data consistency: ACID for critical operations, Eventual for analytics

    '
  version: 1.0.0
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  contact:
    name: NECPGAME API Support
    url: https://necpgame.com/support
    email: api@necpgame.com
servers:
- url: http://localhost:8080/api/v1
  description: Development server
- url: https://api.necpgame.com/api/v1
  description: Production server
security:
- BearerAuth: []
tags:
- name: Referral Codes
  description: Referral code generation and management
- name: Referral Registration
  description: Registration and referral tracking
- name: Referral Statistics
  description: Referral statistics and analytics
- name: Referral Milestones
  description: Milestone management and rewards
- name: Referral Leaderboard
  description: Leaderboard and ranking
- name: Referral Rewards
  description: Reward distribution and claiming
- name: System
  description: System health and monitoring
paths:
  /health:
    $ref: ./paths/health.yaml#/paths/~1health
  /health/batch:
    $ref: ./paths/health-batch.yaml#/paths/~1health~1batch
  /health/ws:
    $ref: ./paths/health-ws.yaml#/paths/~1health~1ws
  /api/v1/referral/code/{characterId}:
    $ref: ./paths/api-v1-referral-code-{characterId}.yaml#/paths/~1api~1v1~1referral~1code~1{characterId}
  /api/v1/referral/code/generate:
    $ref: ./paths/api-v1-referral-code-generate.yaml#/paths/~1api~1v1~1referral~1code~1generate
  /api/v1/referral/code/validate:
    $ref: ./paths/api-v1-referral-code-validate.yaml#/paths/~1api~1v1~1referral~1code~1validate
  /api/v1/referral/register:
    $ref: ./paths/api-v1-referral-register.yaml#/paths/~1api~1v1~1referral~1register
  /api/v1/referral/{characterId}/referrals:
    $ref: ./paths/api-v1-referral-{characterId}-referrals.yaml#/paths/~1api~1v1~1referral~1{characterId}~1referrals
  /api/v1/referral/{characterId}/stats:
    $ref: ./paths/api-v1-referral-{characterId}-stats.yaml#/paths/~1api~1v1~1referral~1{characterId}~1stats
  /api/v1/referral/{characterId}/milestones:
    $ref: ./paths/api-v1-referral-{characterId}-milestones.yaml#/paths/~1api~1v1~1referral~1{characterId}~1milestones
  /api/v1/referral/{characterId}/milestones/{milestoneId}/claim:
    $ref: ./paths/api-v1-referral-{characterId}-milestones-{milestoneId}-claim.yaml#/paths/~1api~1v1~1referral~1{characterId}~1milestones~1{milestoneId}~1claim
  /api/v1/referral/leaderboard:
    $ref: ./paths/api-v1-referral-leaderboard.yaml#/paths/~1api~1v1~1referral~1leaderboard
  /api/v1/referral/leaderboard/{characterId}:
    $ref: ./paths/api-v1-referral-leaderboard-{characterId}.yaml#/paths/~1api~1v1~1referral~1leaderboard~1{characterId}
  /api/v1/referral/rewards/{characterId}:
    $ref: ./paths/api-v1-referral-rewards-{characterId}.yaml#/paths/~1api~1v1~1referral~1rewards~1{characterId}
  /api/v1/referral/rewards/{rewardId}/claim:
    $ref: ./paths/api-v1-referral-rewards-{rewardId}-claim.yaml#/paths/~1api~1v1~1referral~1rewards~1{rewardId}~1claim
components:
  schemas:
    HealthResponse:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/HealthResponse
    Error:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/Error
    WebSocketHealthMessage:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/WebSocketHealthMessage
    ReferralCodeResponse:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/ReferralCodeResponse
    GenerateCodeRequest:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/GenerateCodeRequest
    ValidateCodeRequest:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/ValidateCodeRequest
    ValidateCodeResponse:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/ValidateCodeResponse
    ReferralRegistrationRequest:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/ReferralRegistrationRequest
    ReferralRegistrationResponse:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/ReferralRegistrationResponse
    ReferralListResponse:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/ReferralListResponse
    ReferralInfo:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/ReferralInfo
    ReferralStatsResponse:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/ReferralStatsResponse
    MilestoneListResponse:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/MilestoneListResponse
    MilestoneInfo:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/MilestoneInfo
    RewardClaimResponse:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/RewardClaimResponse
    LeaderboardResponse:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/LeaderboardResponse
    LeaderboardEntry:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/LeaderboardEntry
    LeaderboardPositionResponse:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/LeaderboardPositionResponse
    RewardListResponse:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/RewardListResponse
    RewardInfo:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/RewardInfo
    PaginationParams:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/PaginationParams
    PaginatedResponse:
      $ref: ./schemas/referral-service-schemas.yaml#/components/schemas/PaginatedResponse
  responses:
    OK:
      $ref: ./schemas/referral-service-responses.yaml#/components/responses/OK
    Created:
      $ref: ./schemas/referral-service-responses.yaml#/components/responses/Created
    BadRequest:
      $ref: ./schemas/referral-service-responses.yaml#/components/responses/BadRequest
    Unauthorized:
      $ref: ./schemas/referral-service-responses.yaml#/components/responses/Unauthorized
    Forbidden:
      $ref: ./schemas/referral-service-responses.yaml#/components/responses/Forbidden
    NotFound:
      $ref: ./schemas/referral-service-responses.yaml#/components/responses/NotFound
    Conflict:
      $ref: ./schemas/referral-service-responses.yaml#/components/responses/Conflict
    InternalServerError:
      $ref: ./schemas/referral-service-responses.yaml#/components/responses/InternalServerError
    HealthOK:
      $ref: ./schemas/referral-service-responses.yaml#/components/responses/HealthOK
    HealthBatchSuccess:
      $ref: ./schemas/referral-service-responses.yaml#/components/responses/HealthBatchSuccess
  securitySchemes:
    BearerAuth:
      $ref: ../common/security/security.yaml#/BearerAuth
    ApiKeyAuth:
      $ref: ../common/security/security.yaml#/ApiKeyAuth
    ServiceAuth:
      $ref: ../common/security/security.yaml#/ServiceAuth
