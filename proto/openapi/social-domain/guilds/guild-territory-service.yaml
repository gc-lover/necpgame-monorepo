openapi: 3.0.3
info:
  title: Guild Territory Service API
  description: Guild territory and property management service
  version: 1.0.0
servers:
- url: http://localhost:8087/api/v1
security:
- BearerAuth: []
paths:
  /territories:
    get:
      operationId: listTerritories
      summary: List territories
      responses:
        '200':
          description: Territories list
  /territories/{territory_id}:
    parameters:
    - name: territory_id
      in: path
      schema:
        type: string
        format: uuid
    get:
      operationId: getTerritory
      summary: Get territory
      responses:
        '200':
          description: Territory info
  /territories/{territory_id}/claim:
    parameters:
    - name: territory_id
      in: path
      required: true
      schema:
        type: string
        format: uuid
    post:
      operationId: claimTerritory
      summary: Claim territory
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ClaimTerritoryRequest'
      responses:
        '202':
          description: Claim started
        '200':
          description: Territory claimed
    delete:
      operationId: abandonTerritory
      summary: Abandon territory
      responses:
        '200':
          description: Territory abandoned
  /claim-processes/{process_id}:
    parameters:
    - name: process_id
      in: path
      schema:
        type: string
        format: uuid
    get:
      operationId: getClaimProcess
      summary: Get claim process
      responses:
        '200':
          description: Process status
  /guilds/{guild_id}/territories:
    parameters:
    - name: guild_id
      in: path
      schema:
        type: string
        format: uuid
    get:
      operationId: getGuildTerritories
      summary: Get guild territories
      responses:
        '200':
          description: Guild territories
  /properties:
    get:
      operationId: listProperties
      summary: List properties
      responses:
        '200':
          description: Properties list
    post:
      operationId: createProperty
      summary: Create property
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreatePropertyRequest'
      responses:
        '201':
          description: Property created
  /properties/{property_id}:
    parameters:
    - name: property_id
      in: path
      schema:
        type: string
        format: uuid
    get:
      operationId: getProperty
      summary: Get property
      responses:
        '200':
          description: Property info
    put:
      operationId: updateProperty
      summary: Update property
      responses:
        '200':
          description: Property updated
    delete:
      operationId: deleteProperty
      summary: Delete property
      responses:
        '204':
          description: Property deleted
  /territories/{territory_id}/bonuses:
    parameters:
    - name: territory_id
      in: path
      required: true
      schema:
        type: string
        format: uuid
    get:
      operationId: getTerritoryBonuses
      summary: Get territory bonuses
      responses:
        '200':
          description: Territory bonuses
  /guilds/{guild_id}/territory-bonuses:
    parameters:
    - name: guild_id
      in: path
      required: true
      schema:
        type: string
        format: uuid
    get:
      operationId: getGuildTerritoryBonuses
      summary: Get guild territory bonuses
      responses:
        '200':
          description: Guild bonuses
  /territories/ws:
    get:
      operationId: territoryWebSocket
      summary: Territory WebSocket
      responses:
        '101':
          description: WebSocket connection
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    ClaimTerritoryRequest:
      type: object
      required:
      - guild_id
      properties:
        guild_id:
          type: string
          format: uuid
        priority:
          type: string
          enum:
          - low
          - medium
          - high
          - critical
          default: medium
        resources_allocated:
          type: object
          properties:
            personnel:
              type: integer
              minimum: 1
              maximum: 100
    CreatePropertyRequest:
      type: object
      required:
      - territory_id
      - type
      - name
      properties:
        territory_id:
          type: string
          format: uuid
        type:
          type: string
          enum:
          - building
          - facility
          - outpost
          - stronghold
          - warehouse
        name:
          type: string
          maxLength: 50
        description:
          type: string
          maxLength: 200
        level:
          type: integer
          minimum: 1
          maximum: 10
          default: 1
    Territory:
      type: object
      properties:
        territory_id:
          type: string
          format: uuid
        name:
          type: string
        type:
          type: string
          enum:
          - resource
          - strategic
          - commercial
          - residential
          - industrial
        status:
          type: string
          enum:
          - neutral
          - claimed
          - contested
          - controlled
        controlling_guild:
          $ref: '#/components/schemas/GuildSummary'
        bonuses:
          type: object
        created_at:
          type: string
          format: date-time
    Property:
      type: object
      properties:
        property_id:
          type: string
          format: uuid
        territory_id:
          type: string
          format: uuid
        type:
          type: string
          enum:
          - building
          - facility
          - outpost
          - stronghold
          - warehouse
        name:
          type: string
        level:
          type: integer
        owner_guild:
          $ref: '#/components/schemas/GuildSummary'
    GuildSummary:
      type: object
      required:
      - guild_id
      - name
      - tag
      properties:
        guild_id:
          type: string
          format: uuid
        name:
          type: string
        tag:
          type: string
    TerritoryBonuses:
      type: object
      properties:
        economic_bonuses:
          type: object
          properties:
            resource_generation:
              type: object
            tax_income:
              type: number
            trade_efficiency:
              type: number
        strategic_bonuses:
          type: object
          properties:
            defense_bonus:
              type: number
            movement_speed:
              type: number
            detection_range:
              type: number
    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
