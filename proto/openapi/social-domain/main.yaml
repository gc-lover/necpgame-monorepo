# Issue: #140946814
openapi: 3.0.3
info:
  title: Social Domain - Enterprise-Grade API
  description: |
    **Enterprise-Grade Social Domain** for NECPGAME MMOFPS RPG.

    **Domain Purpose:** Complete social interaction ecosystem
    **Architecture:** Modular microservices with event-driven communication

    **Core Modules:**
    - **Chat** - Real-time messaging and channels
    - **Guilds** - Guild management and warfare
    - **Parties** - Temporary player groups
    - **Relationships** - NPC and player relationships
    - **Orders** - Player commission system
    - **Mentorship** - Learning and teaching system
    - **Reputation** - Social standing and benefits
    - **Notifications** - Event notifications
    - **Voice Lobby** - Voice chat integration

    **Performance Targets:**
    - Hot paths: 1000+ RPS, P99 <20ms
    - Event throughput: 5000+ events/sec
    - Memory: <50MB per service instance
    - Cache hit rate: >95%
  version: 1.0.0
  contact:
    name: NECPGAME API Support
    url: https://necpgame.com/support
    email: api@social.necpgame.com
servers:
- url: http://localhost:8084/api/v1
  description: Development server
- url: https://api.necpgame.com/api/v1
  description: Production server
security:
- BearerAuth: []
tags:
- name: Social
  description: Social domain endpoints
paths:
  /api/v1/social-domain/health:
    get:
      summary: social domain domain health check
      operationId: social-domainHealthCheck
      tags:
      - Social domain
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
          headers:
            Cache-Control:
              schema:
                type: string
                example: max-age=300, s-maxage=600
            ETag:
              schema:
                type: string
                example: '"-api-v1-social-domain-health-v1.0"'
            Content-Encoding:
              schema:
                type: string
                enum:
                - gzip
                - deflate
                - br
  /api/v1/social-domain/health/batch:
    post:
      summary: Batch health check for multiple domains
      operationId: batchHealthCheck
      tags:
      - System
      description: 'Performance optimization: Check multiple domain health in single
        request'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - domains
              properties:
                domains:
                  type: array
                  items:
                    type: string
                  maxItems: 10
      responses:
        '200':
          description: Batch health results
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/HealthResponse'
                  total_time_ms:
                    type: integer
                    description: Total processing time
  /api/v1/social-domain/health/ws:
    get:
      summary: Real-time health monitoring WebSocket
      operationId: healthWebSocket
      tags:
      - System
          description: Real-time health updates without polling
      responses:
        '101':
          description: WebSocket connection established

  # Guilds module endpoints
  /guilds/{guild_id}:
    $ref: './guilds/main.yaml#/paths/~1guilds~1{guild_id}'
  /guilds/{guild_id}/members:
    $ref: './guilds/main.yaml#/paths/~1guilds~1{guild_id}~1members'
  /guilds/{guild_id}/members/{player_id}:
    $ref: './guilds/main.yaml#/paths/~1guilds~1{guild_id}~1members~1{player_id}'
  /guilds/{guild_id}/territories:
    $ref: './guilds/main.yaml#/paths/~1guilds~1{guild_id}~1territories'

  # Additional module references for future expansion
  # /chat: $ref: './chat/main.yaml'
  # /parties: $ref: './parties/main.yaml'
  # /orders: $ref: './orders/main.yaml'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    # Include schemas from modules
    # Guilds module schemas
    Guild:
      $ref: './guilds/main.yaml#/components/schemas/Guild'
    CreateGuildRequest:
      $ref: './guilds/main.yaml#/components/schemas/CreateGuildRequest'
    UpdateGuildRequest:
      $ref: './guilds/main.yaml#/components/schemas/UpdateGuildRequest'
    GuildResponse:
      $ref: './guilds/main.yaml#/components/schemas/GuildResponse'
    GuildsListResponse:
      $ref: './guilds/main.yaml#/components/schemas/GuildsListResponse'
    GuildMember:
      $ref: './guilds/main.yaml#/components/schemas/GuildMember'
    GuildMembersResponse:
      $ref: './guilds/main.yaml#/components/schemas/GuildMembersResponse'
    Territory:
      $ref: './guilds/main.yaml#/components/schemas/Territory'

    # Common domain schemas defined here
    HealthResponse:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
          maxLength: 255
        status:
          type: string
          example: healthy
          maxLength: 255
        domain:
          type: string
          example: social-domain
          maxLength: 255
    Error:
      type: object
      properties:
        message:
          type: string
          example: Internal server error
          maxLength: 1000
        timestamp:
          type: string
          format: date-time
          maxLength: 255
        code:
          type: integer
          example: 500
          format: int32
          minimum: 100
          maximum: 599
        domain:
          type: string
          example: social-domain
          maxLength: 255
    WebSocketHealthMessage:
      type: object
      required:
      - type
      - message_timestamp
      - health
      properties:
        type:
          type: string
          enum:
          - health_update
          - health_alert
          - service_down
        message_timestamp:
          type: string
          format: date-time
          description: Timestamp of the health message
        health:
          $ref: '#/components/schemas/HealthResponse'
