# Notification Service Schemas
# Issue: #1847

# Основные сущности
Notification:
  type: object
  description: Уведомление с полной информацией
  properties:
    id:
      type: string
      format: uuid
      description: Уникальный идентификатор уведомления
    type:
      $ref: "#/NotificationType"
    priority:
      $ref: "../../common.yaml#/components/schemas/NotificationPriority"
    title:
      type: string
      maxLength: 200
      description: Заголовок уведомления
    content:
      type: string
      maxLength: 2000
      description: Основной текст уведомления
    icon:
      type: string
      maxLength: 100
      description: Идентификатор иконки
    color:
      type: string
      maxLength: 20
      description: Цветовая схема (hex или название)
    sound:
      type: string
      maxLength: 100
      description: Идентификатор звукового эффекта
    metadata:
      type: object
      description: Дополнительные данные в JSON формате
      additionalProperties: true
    actions:
      type: array
      items:
        $ref: "#/NotificationAction"
      maxItems: 3
    sender_id:
      type: string
      format: uuid
      description: ID отправителя (игрок/NPC/система)
    sender_name:
      type: string
      maxLength: 100
      description: Имя отправителя
    created_at:
      type: string
      format: date-time
      description: Время создания
    expires_at:
      type: string
      format: date-time
      description: Время истечения (опционально)
    read_at:
      type: string
      format: date-time
      description: Время прочтения (null если не прочитано)
  required:
    - id
    - type
    - priority
    - title
    - content
    - created_at

NotificationType:
  type: string
  enum: [ QUEST, MESSAGE, ACHIEVEMENT, SYSTEM ]
  description: Тип уведомления

NotificationAction:
  type: object
  description: Действие, доступное в уведомлении
  properties:
    id:
      type: string
      maxLength: 50
      description: Идентификатор действия
    label:
      type: string
      maxLength: 50
      description: Текст кнопки
    type:
      type: string
      enum: [ link, dismiss, accept, decline ]
      description: Тип действия
    data:
      type: object
      description: Дополнительные данные для действия
      additionalProperties: true
  required:
    - id
    - label
    - type

NotificationSettings:
  type: object
  description: Настройки уведомлений пользователя
  properties:
    player_id:
      type: string
      format: uuid
      description: ID игрока
    enabled:
      type: boolean
      default: true
      description: Включены ли уведомления глобально
    volume:
      type: integer
      minimum: 0
      maximum: 100
      default: 70
      description: Громкость звуков (0-100%)
    max_concurrent:
      type: integer
      minimum: 1
      maximum: 5
      default: 3
      description: Максимум одновременных уведомлений
    auto_close_seconds:
      type: integer
      minimum: 0
      maximum: 60
      default: 8
      description: Автозакрытие через N секунд (0 = выключено)
    position:
      $ref: "#/NotificationPosition"
    type_settings:
      type: object
      properties:
        QUEST:
          $ref: "#/TypeSettings"
        MESSAGE:
          $ref: "#/TypeSettings"
        ACHIEVEMENT:
          $ref: "#/TypeSettings"
        SYSTEM:
          $ref: "#/TypeSettings"
    priority_settings:
      type: object
      properties:
        LOW:
          $ref: "#/PrioritySettings"
        MEDIUM:
          $ref: "#/PrioritySettings"
        HIGH:
          $ref: "#/PrioritySettings"
        CRITICAL:
          $ref: "#/PrioritySettings"
    visual_preset:
      $ref: "#/VisualPreset"
    accessibility:
      $ref: "#/AccessibilitySettings"
  required:
    - player_id

NotificationPosition:
  type: string
  enum: [ top-right, top-left, bottom-right, bottom-left, center ]
  default: top-right
  description: Позиция уведомлений на экране

TypeSettings:
  type: object
  properties:
    enabled:
      type: boolean
      default: true
    sound_enabled:
      type: boolean
      default: true
    visual_effects:
      type: boolean
      default: true
    auto_close:
      type: boolean
      default: true
  required:
    - enabled

PrioritySettings:
  type: object
  properties:
    enabled:
      type: boolean
      default: true
    enhanced_effects:
      type: boolean
      default: false
  required:
    - enabled

VisualPreset:
  type: string
  enum: [ arasaka, militech, zetatech, street, nomad, custom ]
  default: custom
  description: Визуальный пресет в стиле корпораций

AccessibilitySettings:
  type: object
  properties:
    high_contrast:
      type: boolean
      default: false
      description: Высокий контраст для слабовидящих
    large_text:
      type: boolean
      default: false
      description: Увеличенный размер текста
    reduced_motion:
      type: boolean
      default: false
      description: Уменьшенные анимации
    screen_reader:
      type: boolean
      default: false
      description: Поддержка скрин-ридеров

# Запросы
UpdateNotificationRequest:
  type: object
  properties:
    title:
      type: string
      maxLength: 200
    content:
      type: string
      maxLength: 2000
    priority:
      $ref: "../../common.yaml#/components/schemas/NotificationPriority"
    metadata:
      type: object
      additionalProperties: true

SendNotificationRequest:
  type: object
  description: Запрос на отправку уведомления
  properties:
    type:
      $ref: "#/NotificationType"
    priority:
      $ref: "../../common.yaml#/components/schemas/NotificationPriority"
    title:
      type: string
      maxLength: 200
    content:
      type: string
      maxLength: 2000
    target_player_ids:
      type: array
      items:
        type: string
        format: uuid
      minItems: 1
      maxItems: 100
      description: Список ID игроков-получателей
    icon:
      type: string
      maxLength: 100
    color:
      type: string
      maxLength: 20
    sound:
      type: string
      maxLength: 100
    metadata:
      type: object
      additionalProperties: true
    actions:
      type: array
      items:
        $ref: "#/NotificationAction"
      maxItems: 3
    expires_in_seconds:
      type: integer
      minimum: 30
      maximum: 86400
      description: Время жизни уведомления в секундах
  required:
    - type
    - priority
    - title
    - content
    - target_player_ids

# Ответы
NotificationListResponse:
  type: object
  properties:
    items:
      type: array
      items:
        $ref: "#/Notification"
    pagination:
      $ref: "../../common.yaml#/components/schemas/PaginationResponse"
  required:
    - items
    - pagination
