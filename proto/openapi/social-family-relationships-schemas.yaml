# Issue: #302
components:
  schemas:
    FamilyTree:
      type: object
      required:
        - family_id
        - core_family
      properties:
        family_id:
          type: string
          format: uuid
        core_family:
          type: object
          properties:
            parents:
              type: array
              items:
                $ref: '#/components/schemas/FamilyMember'
            children:
              type: array
              items:
                $ref: '#/components/schemas/FamilyMember'
            spouses:
              type: array
              items:
                $ref: '#/components/schemas/FamilyMember'
        extended_relatives:
          type: array
          items:
            $ref: '#/components/schemas/FamilyMember'
        clans:
          type: array
          items:
            $ref: '#/components/schemas/FamilyClan'
        guardianships:
          type: array
          items:
            $ref: '#/components/schemas/Guardianship'

    FamilyMember:
      type: object
      required:
        - character_id
        - role
        - status
      properties:
        character_id:
          type: string
          format: uuid
        name:
          type: string
        role:
          type: string
          enum: [parent, child, spouse, guardian, clan_member, extended_relative]
        status:
          type: string
          enum: [alive, deceased, missing, unknown]
        profession:
          type: string
        faction:
          type: string
        emotions:
          type: object
          properties:
            attachment:
              type: number
              format: float
              minimum: -1
              maximum: 1
            anxiety:
              type: number
              format: float
              minimum: -1
              maximum: 1
            pride:
              type: number
              format: float
              minimum: -1
              maximum: 1
            anger:
              type: number
              format: float
              minimum: -1
              maximum: 1
        secrets:
          type: array
          items:
            type: string
        relationship_level:
          type: number
          format: float
          minimum: -1
          maximum: 1

    UpdateFamilyTreeRequest:
      type: object
      required:
        - family_id
        - updates
      properties:
        family_id:
          type: string
          format: uuid
        updates:
          type: array
          items:
            type: object
            properties:
              action:
                type: string
                enum: [add_member, remove_member, update_role, update_status]
              character_id:
                type: string
                format: uuid
              role:
                type: string
                enum: [parent, child, spouse, guardian, clan_member, extended_relative]
              status:
                type: string
                enum: [alive, deceased, missing, unknown]

    FamilyEvent:
      type: object
      required:
        - event_id
        - family_id
        - event_type
        - timestamp
      properties:
        event_id:
          type: string
          format: uuid
        family_id:
          type: string
          format: uuid
        event_type:
          type: string
          enum: [wedding, birth, illness, conflict, tragedy, celebration]
        title:
          type: string
        description:
          type: string
        timestamp:
          type: string
          format: date-time
        participants:
          type: array
          items:
            type: string
            format: uuid
        consequences:
          type: object
          properties:
            relationship_changes:
              type: object
            reputation_changes:
              type: object
            world_impact:
              type: object
        quest_id:
          type: string
          format: uuid
          description: Связанный квест (если есть)

    CreateFamilyEventRequest:
      type: object
      required:
        - event_type
        - title
        - timestamp
      properties:
        event_type:
          type: string
          enum: [wedding, birth, illness, conflict, tragedy, celebration]
        title:
          type: string
        description:
          type: string
        timestamp:
          type: string
          format: date-time
        participants:
          type: array
          items:
            type: string
            format: uuid
        trigger_quest:
          type: boolean
          default: false

    FamilyHistoryEntry:
      type: object
      required:
        - entry_id
        - timestamp
        - entry_type
      properties:
        entry_id:
          type: string
          format: uuid
        timestamp:
          type: string
          format: date-time
        entry_type:
          type: string
          enum: [event, relationship_change, inheritance, adoption, clan_alliance, world_impact]
        description:
          type: string
        details:
          type: object

    FamilyInheritance:
      type: object
      required:
        - family_id
      properties:
        family_id:
          type: string
          format: uuid
        wills:
          type: array
          items:
            $ref: '#/components/schemas/Will'
        active_claims:
          type: array
          items:
            $ref: '#/components/schemas/InheritanceClaim'
        disputes:
          type: array
          items:
            $ref: '#/components/schemas/InheritanceDispute'

    Will:
      type: object
      required:
        - will_id
        - testator_id
      properties:
        will_id:
          type: string
          format: uuid
        testator_id:
          type: string
          format: uuid
        beneficiaries:
          type: array
          items:
            type: object
            properties:
              character_id:
                type: string
              share:
                type: number
                format: float
                minimum: 0
                maximum: 1
        assets:
          type: object
          properties:
            property:
              type: array
              items:
                type: string
            companies:
              type: array
              items:
                type: string
            caches:
              type: array
              items:
                type: string
        created_at:
          type: string
          format: date-time

    CalculateInheritanceRequest:
      type: object
      required:
        - testator_id
        - beneficiary_id
      properties:
        testator_id:
          type: string
          format: uuid
        beneficiary_id:
          type: string
          format: uuid
        include_taxes:
          type: boolean
          default: true

    InheritanceCalculation:
      type: object
      required:
        - testator_id
        - beneficiary_id
        - total_value
      properties:
        testator_id:
          type: string
          format: uuid
        beneficiary_id:
          type: string
          format: uuid
        total_value:
          type: number
          format: float
        assets:
          type: object
          properties:
            property:
              type: number
              format: float
            companies:
              type: number
              format: float
            caches:
              type: number
              format: float
        taxes:
          type: number
          format: float
        net_value:
          type: number
          format: float

    ClaimInheritanceRequest:
      type: object
      required:
        - testator_id
        - beneficiary_id
      properties:
        testator_id:
          type: string
          format: uuid
        beneficiary_id:
          type: string
          format: uuid
        will_id:
          type: string
          format: uuid

    InheritanceClaim:
      type: object
      required:
        - claim_id
        - testator_id
        - beneficiary_id
        - status
      properties:
        claim_id:
          type: string
          format: uuid
        testator_id:
          type: string
          format: uuid
        beneficiary_id:
          type: string
          format: uuid
        status:
          type: string
          enum: [pending, approved, rejected, disputed]
        claimed_value:
          type: number
          format: float
        created_at:
          type: string
          format: date-time

    InheritanceDispute:
      type: object
      required:
        - dispute_id
        - claim_id
        - status
      properties:
        dispute_id:
          type: string
          format: uuid
        claim_id:
          type: string
          format: uuid
        disputing_parties:
          type: array
          items:
            type: string
            format: uuid
        status:
          type: string
          enum: [open, resolved, escalated]
        created_at:
          type: string
          format: date-time

    AdoptionRequest:
      type: object
      required:
        - player_id
        - family_id
        - adoption_type
      properties:
        player_id:
          type: string
          format: uuid
        family_id:
          type: string
          format: uuid
        adoption_type:
          type: string
          enum: [adoption, membership]
        target_member_id:
          type: string
          format: uuid
          description: Член семьи, который инициирует усыновление

    AdoptionProcess:
      type: object
      required:
        - process_id
        - player_id
        - family_id
        - status
      properties:
        process_id:
          type: string
          format: uuid
        player_id:
          type: string
          format: uuid
        family_id:
          type: string
          format: uuid
        status:
          type: string
          enum: [pending_approval, approved, rejected, completed]
        requirements:
          type: object
          properties:
            reputation_check:
              type: boolean
            faction_approval:
              type: boolean
            quest_completion:
              type: boolean
        created_at:
          type: string
          format: date-time

    FamilyClan:
      type: object
      required:
        - clan_id
        - name
      properties:
        clan_id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        alliance_strength:
          type: number
          format: float
          minimum: 0
          maximum: 1
        members:
          type: array
          items:
            type: string
            format: uuid

    Guardianship:
      type: object
      required:
        - guardianship_id
        - guardian_id
        - ward_id
      properties:
        guardianship_id:
          type: string
          format: uuid
        guardian_id:
          type: string
          format: uuid
        ward_id:
          type: string
          format: uuid
        status:
          type: string
          enum: [active, terminated, pending]
        responsibilities:
          type: array
          items:
            type: string
        created_at:
          type: string
          format: date-time

    FamilyWorldImpact:
      type: object
      required:
        - family_id
      properties:
        family_id:
          type: string
          format: uuid
        faction_influence:
          type: object
          properties:
            faction_id:
              type: string
              format: uuid
            influence_level:
              type: number
              format: float
              minimum: -1
              maximum: 1
        diplomacy_impact:
          type: object
          properties:
            relationships:
              type: object
            alliances:
              type: array
              items:
                type: string
        public_opinion:
          type: number
          format: float
          minimum: -1
          maximum: 1
        city_events:
          type: array
          items:
            type: object
            properties:
              event_id:
                type: string
                format: uuid
              impact:
                type: string
                enum: [positive, negative, neutral]




