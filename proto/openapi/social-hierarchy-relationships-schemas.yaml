openapi: 3.0.3
info:
  title: Social Hierarchy Relationships Service - Schemas
  description: Общие схемы данных для управления связями между уровнями иерархии коопераций
  version: 1.0.0
  license:
    name: Proprietary
servers:
- url: http://localhost:8084/api/v1
  description: Social Service (локальная разработка)
- url: https://api.necp.game/api/v1
  description: Production API
paths: {}
components:
  schemas:
    HierarchyLevel:
      type: string
      enum:
      - player
      - group
      - clan
      - corporation
      - politics
      - continent
      - planet
      description: Уровень иерархии коопераций
    HierarchyRelationship:
      type: object
      required:
      - id
      - from_level
      - from_entity_id
      - to_level
      - to_entity_id
      - relationship_type
      - status
      properties:
        id:
          type: string
          format: uuid
          description: ID связи
        from_entity_id:
          type: string
          format: uuid
          description: ID сущности источника
        to_entity_id:
          type: string
          format: uuid
          description: ID сущности цели
        relationship_type:
          type: string
          enum:
          - member
          - owner
          - parent
          - child
          - alliance
          - conflict
          description: Тип связи
        status:
          type: string
          enum:
          - active
          - pending
          - suspended
          - terminated
          description: Статус связи
        created_at:
          type: string
          format: date-time
          description: Дата создания
        updated_at:
          type: string
          format: date-time
          description: Дата обновления
        metadata:
          type: object
          additionalProperties: true
          description: Дополнительные метаданные связи
        from_level:
          $ref: '#/components/schemas/HierarchyLevel'
          description: Уровень источника связи
        to_level:
          $ref: '#/components/schemas/HierarchyLevel'
          description: Уровень цели связи
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CreateHierarchyRelationshipRequest:
      type: object
      required:
      - from_level
      - from_entity_id
      - to_level
      - to_entity_id
      - relationship_type
      properties:
        from_entity_id:
          type: string
          format: uuid
        to_entity_id:
          type: string
          format: uuid
        relationship_type:
          type: string
          enum:
          - member
          - owner
          - parent
          - child
          - alliance
          - conflict
        metadata:
          type: object
          additionalProperties: true
        from_level:
          $ref: '#/components/schemas/HierarchyLevel'
        to_level:
          $ref: '#/components/schemas/HierarchyLevel'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    UpdateHierarchyRelationshipRequest:
      type: object
      properties:
        status:
          type: string
          enum:
          - active
          - pending
          - suspended
          - terminated
        metadata:
          type: object
          additionalProperties: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    PromoteHierarchyRelationshipRequest:
      type: object
      required:
      - new_level
      - new_entity_id
      properties:
        new_entity_id:
          type: string
          format: uuid
          description: ID новой сущности на новом уровне
        reason:
          type: string
          description: Причина повышения уровня
        new_level:
          $ref: '#/components/schemas/HierarchyLevel'
          description: Новый уровень иерархии
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    HierarchyRelationshipListResponse:
      type: object
      required:
      - relationships
      properties:
        relationships:
          type: array
          items:
            $ref: '#/components/schemas/HierarchyRelationship'
        total:
          type: integer
          format: int64
          description: Общее количество связей
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    HierarchyRelationshipValidationResult:
      type: object
      required:
      - valid
      properties:
        errors:
          type: array
          items:
            type: string
          description: Список ошибок валидации
        warnings:
          type: array
          items:
            type: string
          description: Список предупреждений
        valid:
          type: boolean
          description: Результат валидации
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
