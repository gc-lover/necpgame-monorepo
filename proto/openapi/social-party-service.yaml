openapi: 3.0.3
info:
  title: Social Party Service API
  description: API для системы групп (Party): создание, управление участниками, распределение лута, синхронизация квестов
  version: 1.0.0
  contact:
    name: NECPGAME API Support
    email: api@necp.game

servers:
  - url: http://localhost:8084/api/v1
    description: Локальный сервер разработки
  - url: https://api.necp.game/api/v1
    description: Продакшен сервер

tags:
  - name: Party
    description: Система групп

paths:
  /social/party:
    post:
      tags: [Party]
      summary: Создать группу
      operationId: createParty
      security: [BearerAuth: []]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: 'social-party-schemas.yaml#/components/schemas/CreatePartyRequest' }
      responses:
        '201':
          description: Группа создана
          content:
            application/json:
              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/Party' } }
        '400': { $ref: 'social-party-responses.yaml#/components/responses/BadRequest' }
        '500': { $ref: 'social-party-responses.yaml#/components/responses/InternalServerError' }
    get:
      tags: [Party]
      summary: Получить информацию о группе
      operationId: getParty
      security: [BearerAuth: []]
      parameters:
        - name: character_id
          in: query
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Информация о группе
          content:
            application/json:
              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/Party' } }
        '404': { $ref: 'social-party-responses.yaml#/components/responses/NotFound' }

  /social/party/{partyId}:
    get:
      tags: [Party]
      summary: Получить группу по ID
      operationId: getPartyById
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
      responses:
        '200':
          description: Информация о группе
          content:
            application/json:
              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/Party' }
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'

    delete:
      tags: [Party]
      summary: Распустить группу
      operationId: disbandParty
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
      responses:
        '200':
          description: Группа распущена
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: string, example: disbanded }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'
 }  /social/party/{partyId}/invite:
    post:
      tags: [Party]
      summary: Пригласить игрока в группу
      operationId: inviteToParty
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: 'social-party-schemas.yaml#/components/schemas/InviteToPartyRequest' }
      responses:
        '200':
          description: Приглашение отправлено
          content:
            application/json: }              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/Party' }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'
 }  /social/party/{partyId}/join:
    post:
      tags: [Party]
      summary: Присоединиться к группе
      operationId: joinParty
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
      responses:
        '200':
          description: Присоединился к группе
          content:
            application/json:
              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/Party' }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'
 }  /social/party/{partyId}/leave:
    post:
      tags: [Party]
      summary: Покинуть группу
      operationId: leaveParty
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
      responses:
        '200':
          description: Покинул группу
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: string, example: left }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'
 }  /social/party/{partyId}/kick:
    post:
      tags: [Party]
      summary: Исключить игрока из группы
      operationId: kickFromParty
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
        - name: character_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Игрок исключен
          content:
            application/json:
              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/Party' }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'
 }  /social/party/{partyId}/transfer-leadership:
    post:
      tags: [Party]
      summary: Передать лидерство
      operationId: transferLeadership
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
        - name: character_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Лидерство передано
          content:
            application/json:
              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/Party' }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'
 }  /social/party/player/{accountId}:
    get:
      tags: [Party]
      summary: Получить группу игрока
      operationId: getPlayerParty
      security: [BearerAuth: []]
      parameters: [{ name: accountId, in: path, required: true, schema: { type: string, format: uuid } }]
      responses:
        '200':
          description: Группа игрока
          content:
            application/json:
              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/Party' }
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'
 }  /social/party/{partyId}/leader:
    put:
      tags: [Party]
      summary: Сменить лидера группы
      operationId: transferLeadership
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: 'social-party-schemas.yaml#/components/schemas/TransferLeadershipRequest' }
      responses:
        '200':
          description: Лидер изменён
          content:
            application/json: }              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/Party' }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'
 }  /social/party/invitations/{invitationId}/accept:
    post:
      tags: [Party]
      summary: Принять приглашение в группу
      operationId: acceptPartyInvitation
      security: [BearerAuth: []]
      parameters: [{ name: invitationId, in: path, required: true, schema: { type: string, format: uuid } }]
      responses:
        '200':
          description: Приглашение принято
          content:
            application/json:
              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/Party' }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'
 }  /social/party/invitations/{invitationId}/decline:
    post:
      tags: [Party]
      summary: Отклонить приглашение в группу
      operationId: declinePartyInvitation
      security: [BearerAuth: []]
      parameters: [{ name: invitationId, in: path, required: true, schema: { type: string, format: uuid } }]
      responses:
        '200':
          description: Приглашение отклонено
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: declined
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'
 }  /social/party/invitations/player/{accountId}:
    get:
      tags: [Party]
      summary: Получить приглашения игрока
      operationId: getPlayerInvitations
      security: [BearerAuth: []]
      parameters: [{ name: accountId, in: path, required: true, schema: { type: string, format: uuid } }]
      responses:
        '200':
          description: Приглашения игрока
          content:
            application/json:
              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/PartyInvitationsResponse' }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest' } }  /social/party/{partyId}/members:
    post:
      tags: [Party]
      summary: Добавить участника в группу
      operationId: addPartyMember
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: 'social-party-schemas.yaml#/components/schemas/AddPartyMemberRequest' }
      responses:
        '200':
          description: Участник добавлен
          content:
            application/json: }              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/Party' }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'
 }  /social/party/{partyId}/members/{accountId}:
    delete:
      tags: [Party]
      summary: Удалить участника из группы
      operationId: removePartyMember
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
        - name: accountId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Участник удалён
          content:
            application/json:
              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/Party' }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'

    put:
      tags: [Party]
      summary: Изменить роль участника
      operationId: changePartyMemberRole
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
        - name: accountId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: 'social-party-schemas.yaml#/components/schemas/ChangeMemberRoleRequest' }
      responses:
        '200':
          description: Роль изменена
          content:
            application/json: }              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/Party' }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'
 }  /social/party/{partyId}/loot-mode:
    get:
      tags: [Party]
      summary: Получить текущий режим распределения лута
      operationId: getLootMode
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
      responses:
        '200':
          description: Режим распределения лута
          content:
            application/json:
              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/LootModeResponse' }
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'

    put:
      tags: [Party]
      summary: Изменить режим распределения лута
      operationId: changeLootMode
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: 'social-party-schemas.yaml#/components/schemas/ChangeLootModeRequest' }
      responses:
        '200':
          description: Режим изменен
          content:
            application/json: }              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/Party' }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'
 }  /social/party/{partyId}/loot/distribute:
    post:
      tags: [Party]
      summary: Распределить лут между участниками группы
      operationId: distributeLoot
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: 'social-party-schemas.yaml#/components/schemas/DistributeLootRequest' }
      responses:
        '200':
          description: Лут распределён
          content:
            application/json:
              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/LootDistributionResult' }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound' } }  /social/party/{partyId}/loot/roll:
    post:
      tags: [Party]
      summary: Бросок кубика для лута
      operationId: rollForLoot
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: 'social-party-schemas.yaml#/components/schemas/RollForLootRequest' }
      responses:
        '200':
          description: Результат броска
          content:
            application/json:
              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/RollResult' }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound' } }  /social/party/{partyId}/quests:
    get:
      tags: [Party]
      summary: Получить задания группы
      operationId: getPartyQuests
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
      responses:
        '200':
          description: Задания группы
          content:
            application/json:
              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/PartyQuestsResponse' }
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound' } }  /social/party/{partyId}/quests/{questId}/sync:
    post:
      tags: [Party]
      summary: Синхронизировать прогресс задания группы
      operationId: syncPartyQuest
      security: [BearerAuth: []]
      parameters: [{ name: partyId, in: path, required: true, schema: { type: string, format: uuid } }]
        - name: questId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Прогресс синхронизирован
          content:
            application/json:
              schema: { $ref: 'social-party-schemas.yaml#/components/schemas/QuestSyncResult' }
        '400':
          $ref: 'social-party-responses.yaml#/components/responses/BadRequest'
        '404':
          $ref: 'social-party-responses.yaml#/components/responses/NotFound'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
 }  schemas: }    Party: { $ref: 'social-party-schemas.yaml#/components/schemas/Party' }
    PartyMember: { $ref: 'social-party-schemas.yaml#/components/schemas/PartyMember' }
    CreatePartyRequest: { $ref: 'social-party-schemas.yaml#/components/schemas/CreatePartyRequest' }
    InviteToPartyRequest: { $ref: 'social-party-schemas.yaml#/components/schemas/InviteToPartyRequest' }
    TransferLeadershipRequest: { $ref: 'social-party-schemas.yaml#/components/schemas/TransferLeadershipRequest' }
    PartyInvitationsResponse: { $ref: 'social-party-schemas.yaml#/components/schemas/PartyInvitationsResponse' }
    PartyInvitation: { $ref: 'social-party-schemas.yaml#/components/schemas/PartyInvitation' }
    AddPartyMemberRequest: { $ref: 'social-party-schemas.yaml#/components/schemas/AddPartyMemberRequest' }
    ChangeMemberRoleRequest: { $ref: 'social-party-schemas.yaml#/components/schemas/ChangeMemberRoleRequest' }
    LootModeResponse: { $ref: 'social-party-schemas.yaml#/components/schemas/LootModeResponse' }
    ChangeLootModeRequest: { $ref: 'social-party-schemas.yaml#/components/schemas/ChangeLootModeRequest' }
    DistributeLootRequest: { $ref: 'social-party-schemas.yaml#/components/schemas/DistributeLootRequest' }
    LootDistributionResult: { $ref: 'social-party-schemas.yaml#/components/schemas/LootDistributionResult' }
    RollForLootRequest: { $ref: 'social-party-schemas.yaml#/components/schemas/RollForLootRequest' }
    RollResult: { $ref: 'social-party-schemas.yaml#/components/schemas/RollResult' }
    PartyQuestsResponse: { $ref: 'social-party-schemas.yaml#/components/schemas/PartyQuestsResponse' }
    PartyQuest: { $ref: 'social-party-schemas.yaml#/components/schemas/PartyQuest' }
    QuestSyncResult: { $ref: 'social-party-schemas.yaml#/components/schemas/QuestSyncResult' }
    Error: { $ref: 'social-party-schemas.yaml#/components/schemas/Error' }


security: [BearerAuth: []]





