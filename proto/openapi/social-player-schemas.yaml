openapi: 3.0.3
info:
  title: Social Player Schemas
  description: Схемы данных для игровой социальной системы (отношения, заказы, найм NPC) в MMOFPS RPG
  version: 1.0.0
components:
  schemas:
    Relationship:
      type: object
      properties:
        id:
          type: string
          format: uuid
        player_id:
          type: string
          format: uuid
        target_id:
          type: string
          format: uuid
          description: ID другого игрока или NPC
        target_type:
          type: string
          enum: [player, npc]
        relationship_type:
          type: string
          enum: [friend, rival, ally, mentor, apprentice, romantic, business]
        level:
          type: integer
          minimum: 1
          maximum: 10
          description: Уровень отношений (1-10)
        trust_level:
          type: number
          minimum: 0
          maximum: 1
          description: Уровень доверия (0-1)
        reputation:
          type: integer
          minimum: -100
          maximum: 100
          description: Репутация (-100 до +100)
        last_interaction:
          type: string
          format: date-time
        created_at:
          type: string
          format: date-time
      description: "BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%."

    RelationshipUpdate:
      type: object
      required:
        - target_id
        - change_type
      properties:
        target_id:
          type: string
          format: uuid
        change_type:
          type: string
          enum:
            [
              increase_trust,
              decrease_trust,
              change_relationship_type,
              add_reputation,
              remove_reputation,
            ]
        value:
          type: number
          description: Значение изменения (положительное или отрицательное)
        reason:
          type: string
          minLength: 1
          maxLength: 500
      description: "BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%."

    PlayerOrder:
      type: object
      properties:
        id:
          type: string
          format: uuid
        client_id:
          type: string
          format: uuid
          description: ID заказчика
        contractor_id:
          type: string
          format: uuid
          description: ID исполнителя (может быть null для открытых заказов)
        order_type:
          type: string
          enum:
            [
              assassination,
              protection,
              delivery,
              investigation,
              bounty,
              escort,
              sabotage,
              recovery,
            ]
        title:
          type: string
          minLength: 5
          maxLength: 100
        description:
          type: string
          minLength: 10
          maxLength: 2000
        difficulty:
          type: string
          enum: [easy, medium, hard, deadly]
        reward:
          $ref: "#/components/schemas/Reward"
        requirements:
          type: array
          items:
            $ref: "#/components/schemas/OrderRequirement"
        location:
          type: string
          description: Локация выполнения
        time_limit:
          type: integer
          description: Время на выполнение в часах
        status:
          type: string
          enum:
            [open, accepted, in_progress, completed, failed, cancelled, expired]
        created_at:
          type: string
          format: date-time
        accepted_at:
          type: string
          format: date-time
        deadline:
          type: string
          format: date-time
        completed_at:
          type: string
          format: date-time
      description: "BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%."

    OrderRequirement:
      type: object
      required:
        - type
      properties:
        type:
          type: string
          enum:
            [
              skill_level,
              reputation,
              relationship_level,
              item_possession,
              faction_membership,
            ]
        skill_name:
          type: string
          description: Название навыка (для skill_level)
        min_level:
          type: integer
          minimum: 1
        faction_name:
          type: string
          description: Название фракции (для faction_membership)
        item_id:
          type: string
          format: uuid
          description: ID требуемого предмета
      description: "BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%."

    Reward:
      type: object
      properties:
        currency_rewards:
          type: object
          additionalProperties:
            type: integer
          description: Валютные награды (тип валюты -> количество)
        item_rewards:
          type: array
          items:
            $ref: "#/components/schemas/ItemReward"
        reputation_rewards:
          type: object
          additionalProperties:
            type: integer
          description: Изменения репутации (фракция -> изменение)
        relationship_rewards:
          type: array
          items:
            $ref: "#/components/schemas/RelationshipReward"
      description: "BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%."

    ItemReward:
      type: object
      required:
        - item_id
        - quantity
      properties:
        item_id:
          type: string
          format: uuid
        quantity:
          type: integer
          minimum: 1
        condition:
          type: number
          minimum: 0
          maximum: 1
      description: "BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%."

    RelationshipReward:
      type: object
      required:
        - target_id
        - change
      properties:
        target_id:
          type: string
          format: uuid
        change:
          type: integer
          description: Изменение уровня отношений
      description: "BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%."

    NPCHire:
      type: object
      properties:
        id:
          type: string
          format: uuid
        player_id:
          type: string
          format: uuid
        npc_id:
          type: string
          format: uuid
        npc_type:
          type: string
          enum: [mercenary, fixer, informant, bodyguard, hacker, medic, driver]
        hire_duration:
          type: integer
          description: Длительность найма в часах
        cost_per_hour:
          $ref: "#/components/schemas/Price"
        total_cost:
          $ref: "#/components/schemas/Price"
        skills:
          type: array
          items:
            type: string
          description: Навыки NPC
        loyalty_level:
          type: integer
          minimum: 1
          maximum: 10
        status:
          type: string
          enum: [active, completed, terminated]
        hired_at:
          type: string
          format: date-time
        expires_at:
          type: string
          format: date-time
      description: "BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%."

    Price:
      type: object
      required:
        - currency
        - amount
      properties:
        currency:
          type: string
          enum: [eurodollar, bitcoin, corporate_script, street_cred]
        amount:
          type: integer
          minimum: 0
        bonus_percentage:
          type: number
          minimum: 0
          maximum: 100
          description: Бонусный процент от базовой цены
      description: "BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%."

    CreateOrderRequest:
      type: object
      required:
        - order_type
        - title
        - description
        - difficulty
        - reward
      properties:
        order_type:
          type: string
          enum:
            [
              assassination,
              protection,
              delivery,
              investigation,
              bounty,
              escort,
              sabotage,
              recovery,
            ]
        title:
          type: string
          minLength: 5
          maxLength: 100
        description:
          type: string
          minLength: 10
          maxLength: 2000
        difficulty:
          type: string
          enum: [easy, medium, hard, deadly]
        reward:
          $ref: "#/components/schemas/Reward"
        requirements:
          type: array
          items:
            $ref: "#/components/schemas/OrderRequirement"
        location:
          type: string
        time_limit:
          type: integer
          minimum: 1
          maximum: 168
          default: 24
      description: "BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%."

    HireNPCRequest:
      type: object
      required:
        - npc_id
        - hire_duration
      properties:
        npc_id:
          type: string
          format: uuid
        hire_duration:
          type: integer
          minimum: 1
          maximum: 168
          description: Длительность найма в часах
        special_instructions:
          type: string
          maxLength: 500
      description: "BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%."

    OrderFilter:
      type: object
      properties:
        order_type:
          type: string
          enum:
            [
              assassination,
              protection,
              delivery,
              investigation,
              bounty,
              escort,
              sabotage,
              recovery,
            ]
        difficulty:
          type: string
          enum: [easy, medium, hard, deadly]
        min_reward:
          type: integer
          minimum: 0
        max_reward:
          type: integer
          minimum: 0
        currency:
          type: string
          enum: [eurodollar, bitcoin, corporate_script, street_cred]
        location:
          type: string
        status:
          type: string
          enum:
            [open, accepted, in_progress, completed, failed, cancelled, expired]
        created_after:
          type: string
          format: date-time
        created_before:
          type: string
          format: date-time
      description: "BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%."

    NPCFilter:
      type: object
      properties:
        npc_type:
          type: string
          enum: [mercenary, fixer, informant, bodyguard, hacker, medic, driver]
        min_loyalty:
          type: integer
          minimum: 1
          maximum: 10
        max_cost_per_hour:
          type: integer
          minimum: 0
        currency:
          type: string
          enum: [eurodollar, bitcoin, corporate_script, street_cred]
        required_skill:
          type: string
        available_only:
          type: boolean
          default: true
      description: "BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%."
