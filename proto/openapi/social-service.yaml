openapi: 3.0.3
info:
  title: Social Service API
  description: API для социальных функций: уведомления, друзья, чат, почта
  version: 1.0.0
  contact:
    name: NECPGAME API Support
    email: api@necp.game

servers:
  - url: http://localhost:8084/api/v1
    description: Локальный сервер разработки
  - url: https://api.necp.game/api/v1
    description: Продакшен сервер

tags:
  - name: Notifications
    description: Управление уведомлениями
  - name: Friends
    description: Система друзей
  - name: Chat
    description: Текстовый чат
  - name: Mail
    description: Почтовая система
  - name: Party
    description: Система групп

paths:
  /social/notifications:
    post:
      tags:
        - Notifications
      summary: Создать уведомление
      operationId: createNotification
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateNotificationRequest'
      responses:
        '201':
          description: Уведомление создано
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Notification'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

    get:
      tags:
        - Notifications
      summary: Получить список уведомлений
      operationId: getNotifications
      parameters:
        - name: account_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: Список уведомлений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationListResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /social/notifications/{id}:
    get:
      tags:
        - Notifications
      summary: Получить уведомление
      operationId: getNotification
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Уведомление
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Notification'
        '404':
          $ref: '#/components/responses/NotFound'

    put:
      tags:
        - Notifications
      summary: Обновить статус уведомления
      operationId: updateNotificationStatus
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateNotificationStatusRequest'
      responses:
        '200':
          description: Статус обновлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Notification'
        '404':
          $ref: '#/components/responses/NotFound'

    delete:
      tags:
        - Notifications
      summary: Удалить уведомление
      operationId: deleteNotification
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Уведомление удалено
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
        '404':
          $ref: '#/components/responses/NotFound'

  /social/notifications/preferences:
    get:
      tags:
        - Notifications
      summary: Получить настройки уведомлений
      operationId: getNotificationPreferences
      parameters:
        - name: account_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Настройки уведомлений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationPreferences'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

    put:
      tags:
        - Notifications
      summary: Обновить настройки уведомлений
      operationId: updateNotificationPreferences
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateNotificationPreferencesRequest'
      responses:
        '200':
          description: Настройки обновлены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationPreferences'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/notifications/batch/read:
    post:
      tags:
        - Notifications
      summary: Отметить несколько уведомлений как прочитанные
      operationId: markNotificationsAsRead
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BatchReadRequest'
      responses:
        '200':
          description: Уведомления отмечены как прочитанные
          content:
            application/json:
              schema:
                type: object
                properties:
                  updated:
                    type: integer
                    description: Количество обновленных уведомлений
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/friends/requests:
    post:
      tags:
        - Friends
      summary: Отправить запрос на дружбу
      operationId: sendFriendRequest
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FriendRequest'
      responses:
        '201':
          description: Запрос отправлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Friendship'
        '400':
          $ref: '#/components/responses/BadRequest'
        '409':
          description: Запрос уже существует
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /social/friends/requests/{id}/accept:
    post:
      tags:
        - Friends
      summary: Принять запрос на дружбу
      operationId: acceptFriendRequest
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Запрос принят
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Friendship'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/friends/requests/{id}/reject:
    post:
      tags:
        - Friends
      summary: Отклонить запрос на дружбу
      operationId: rejectFriendRequest
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Запрос отклонен
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
        '404':
          $ref: '#/components/responses/NotFound'

  /social/friends:
    get:
      tags:
        - Friends
      summary: Получить список друзей
      operationId: getFriends
      parameters:
        - name: character_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Список друзей
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FriendListResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /social/friends/{id}:
    delete:
      tags:
        - Friends
      summary: Удалить друга
      operationId: removeFriend
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Друг удален
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
        '404':
          $ref: '#/components/responses/NotFound'

  /social/friends/{id}/block:
    post:
      tags:
        - Friends
      summary: Заблокировать друга
      operationId: blockFriend
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Друг заблокирован
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Friendship'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/friends/{id}:
    get:
      tags:
        - Friends
      summary: Получить информацию о друге
      operationId: getFriend
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Информация о друге
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Friendship'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/friends/online:
    get:
      tags:
        - Friends
      summary: Получить список онлайн друзей
      operationId: getOnlineFriends
      responses:
        '200':
          description: Список онлайн друзей
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FriendListResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/friends/count:
    get:
      tags:
        - Friends
      summary: Получить количество друзей
      operationId: getFriendsCount
      responses:
        '200':
          description: Количество друзей
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FriendsCountResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/friends/requests/incoming:
    get:
      tags:
        - Friends
      summary: Получить входящие запросы на дружбу
      operationId: getIncomingFriendRequests
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: Входящие запросы
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FriendRequestsResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/friends/requests/outgoing:
    get:
      tags:
        - Friends
      summary: Получить исходящие запросы на дружбу
      operationId: getOutgoingFriendRequests
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: Исходящие запросы
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FriendRequestsResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/friends/requests/{id}:
    delete:
      tags:
        - Friends
      summary: Отменить запрос на дружбу
      operationId: cancelFriendRequest
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Запрос отменён
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: cancelled
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/friends/blocks:
    get:
      tags:
        - Friends
      summary: Получить список заблокированных игроков
      operationId: getBlockedPlayers
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: Список заблокированных
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BlockedPlayersResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'

    post:
      tags:
        - Friends
      summary: Заблокировать игрока
      operationId: blockPlayer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BlockPlayerRequest'
      responses:
        '200':
          description: Игрок заблокирован
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BlockedPlayer'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/friends/blocks/{blockedId}:
    delete:
      tags:
        - Friends
      summary: Разблокировать игрока
      operationId: unblockPlayer
      parameters:
        - name: blockedId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Игрок разблокирован
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: unblocked
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/friends/blocks/check/{playerId}:
    get:
      tags:
        - Friends
      summary: Проверить, заблокирован ли игрок
      operationId: checkBlockStatus
      parameters:
        - name: playerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Статус блокировки
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BlockStatusResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/friends/{friendId}/status:
    get:
      tags:
        - Friends
      summary: Получить онлайн-статус друга
      operationId: getFriendStatus
      parameters:
        - name: friendId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Статус друга
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FriendStatusResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/friends/status/batch:
    get:
      tags:
        - Friends
      summary: Получить статусы нескольких друзей
      operationId: getFriendsStatusBatch
      parameters:
        - name: friend_ids
          in: query
          required: true
          schema:
            type: array
            items:
              type: string
              format: uuid
      responses:
        '200':
          description: Статусы друзей
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FriendsStatusBatchResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/friends/recent:
    get:
      tags:
        - Friends
      summary: Получить последние контакты
      operationId: getRecentContacts
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: Последние контакты
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RecentContactsResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/friends/recent/{playerId}:
    post:
      tags:
        - Friends
      summary: Добавить игрока в последние контакты
      operationId: addToRecentContacts
      parameters:
        - name: playerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Игрок добавлен в контакты
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: added
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/chat/channels:
    get:
      tags:
        - Chat
      summary: Получить список каналов
      operationId: getChannels
      parameters:
        - name: type
          in: query
          schema:
            $ref: '#/components/schemas/ChannelType'
      responses:
        '200':
          description: Список каналов
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChannelListResponse'

  /social/chat/channels/{channel_id}:
    get:
      tags:
        - Chat
      summary: Получить канал
      operationId: getChannel
      security:
        - BearerAuth: []
      parameters:
        - name: channel_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Канал
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatChannel'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/chat/messages:
    post:
      tags:
        - Chat
      summary: Создать сообщение
      operationId: createMessage
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateMessageRequest'
      responses:
        '201':
          description: Сообщение создано
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatMessage'
        '400':
          $ref: '#/components/responses/BadRequest'

  /social/chat/messages/{channel_id}:
    get:
      tags:
        - Chat
      summary: Получить сообщения канала
      operationId: getMessages
      security:
        - BearerAuth: []
      parameters:
        - name: channel_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: Список сообщений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageListResponse'

  /social/chat/channels/{channel_id}/join:
    post:
      tags:
        - Chat
      summary: Присоединиться к каналу
      operationId: joinChatChannel
      security:
        - BearerAuth: []
      parameters:
        - name: channel_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/JoinChannelRequest'
      responses:
        '200':
          description: Успешное присоединение к каналу
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatChannel'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/chat/channels/{channel_id}/leave:
    post:
      tags:
        - Chat
      summary: Покинуть канал
      operationId: leaveChatChannel
      security:
        - BearerAuth: []
      parameters:
        - name: channel_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LeaveChannelRequest'
      responses:
        '200':
          description: Успешный выход из канала
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/chat/channels/{channel_id}/members:
    get:
      tags:
        - Chat
      summary: Получить участников канала
      operationId: getChannelMembers
      security:
        - BearerAuth: []
      parameters:
        - name: channel_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: Список участников канала
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChannelMembersResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/chat/messages/send:
    post:
      tags:
        - Chat
      summary: Отправить сообщение
      operationId: sendChatMessage
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SendMessageRequest'
      responses:
        '200':
          description: Сообщение отправлено
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatMessage'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/chat/messages/process:
    post:
      tags:
        - Chat
      summary: Обработать сообщение
      operationId: processChatMessage
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProcessMessageRequest'
      responses:
        '200':
          description: Сообщение обработано
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProcessedMessageResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/chat/report:
    post:
      tags:
        - Chat
      summary: Пожаловаться на сообщение
      operationId: reportChatMessage
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReportMessageRequest'
      responses:
        '200':
          description: Жалоба отправлена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReportResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/chat/ban:
    post:
      tags:
        - Chat
      summary: Выдать бан игроку
      operationId: banChatUser
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BanUserRequest'
      responses:
        '200':
          description: Бан выдан
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BanResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/chat/bans:
    get:
      tags:
        - Chat
      summary: Получить список банов
      operationId: getChatBans
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: query
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: Список банов
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BanListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/chat/bans/{ban_id}:
    delete:
      tags:
        - Chat
      summary: Снять бан
      operationId: revokeChatBan
      security:
        - BearerAuth: []
      parameters:
        - name: ban_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RevokeBanRequest'
      responses:
        '200':
          description: Бан снят
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RevokeBanResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/chat/commands/execute:
    post:
      tags:
        - Chat
      summary: Выполнить команду чата
      operationId: executeChatCommand
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExecuteCommandRequest'
      responses:
        '200':
          description: Команда выполнена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommandResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/chat/history/{channel_type}:
    get:
      tags:
        - Chat
      summary: Получить историю канала
      operationId: getChatHistory
      security:
        - BearerAuth: []
      parameters:
        - name: channel_type
          in: path
          required: true
          schema:
            type: string
            enum:
              - GLOBAL
              - TRADE
              - NEWBIE
              - LOCAL
              - PARTY
              - RAID
              - GUILD
              - GUILD_OFFICER
              - WHISPER
              - SYSTEM
              - COMBAT_LOG
              - RP_EMOTE
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: since
          in: query
          schema:
            type: string
            format: date-time
      responses:
        '200':
          description: История канала
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatHistoryResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/chat/history/search:
    get:
      tags:
        - Chat
      summary: Поиск по истории чата
      operationId: searchChatHistory
      security:
        - BearerAuth: []
      parameters:
        - name: query
          in: query
          required: true
          schema:
            type: string
        - name: channel_type
          in: query
          schema:
            type: string
            enum:
              - GLOBAL
              - TRADE
              - NEWBIE
              - LOCAL
              - PARTY
              - RAID
              - GUILD
              - GUILD_OFFICER
              - WHISPER
              - SYSTEM
              - COMBAT_LOG
              - RP_EMOTE
        - name: sender_id
          in: query
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: Результаты поиска
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatSearchResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/chat/format:
    post:
      tags:
        - Chat
      summary: Форматировать сообщение
      operationId: formatChatMessage
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FormatMessageRequest'
      responses:
        '200':
          description: Отформатированное сообщение
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FormattedMessageResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/chat/events:
    get:
      tags:
        - Chat
      summary: Получить события чата
      operationId: getChatEvents
      security:
        - BearerAuth: []
      parameters:
        - name: event_type
          in: query
          schema:
            type: string
            enum:
              - chat:message-sent
              - chat:message-received
              - chat:channel-joined
              - chat:channel-left
              - chat:user-banned
        - name: channel_id
          in: query
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: События чата
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatEventsResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/mail:
    post:
      tags:
        - Mail
      summary: Отправить письмо
      operationId: sendMail
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateMailRequest'
      responses:
        '201':
          description: Письмо отправлено
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MailMessage'
        '400':
          $ref: '#/components/responses/BadRequest'

    get:
      tags:
        - Mail
      summary: Получить список писем
      operationId: getMails
      parameters:
        - name: recipient_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: Список писем
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MailListResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /social/mail/{id}:
    get:
      tags:
        - Mail
      summary: Получить письмо
      operationId: getMail
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Письмо
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MailMessage'
        '404':
          $ref: '#/components/responses/NotFound'

    delete:
      tags:
        - Mail
      summary: Удалить письмо
      operationId: deleteMail
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Письмо удалено
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
        '404':
          $ref: '#/components/responses/NotFound'

  /social/mail/{id}/read:
    put:
      tags:
        - Mail
      summary: Отметить письмо как прочитанное
      operationId: markMailAsRead
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Письмо отмечено как прочитанное
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
        '404':
          $ref: '#/components/responses/NotFound'

  /social/mail/{id}/claim:
    post:
      tags:
        - Mail
      summary: Получить вложения из письма
      operationId: claimAttachment
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Вложения получены
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClaimAttachmentResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/mail/unread-count:
    get:
      tags:
        - Mail
      summary: Получить количество непрочитанных писем
      operationId: getUnreadMailCount
      responses:
        '200':
          description: Количество непрочитанных писем
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnreadMailCountResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/mail/{id}/attachments:
    get:
      tags:
        - Mail
      summary: Получить список вложений письма
      operationId: getMailAttachments
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Список вложений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MailAttachmentsResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/mail/{id}/cod/pay:
    post:
      tags:
        - Mail
      summary: Оплатить COD письмо
      operationId: payMailCOD
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: COD оплачен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClaimAttachmentResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/mail/{id}/cod/decline:
    post:
      tags:
        - Mail
      summary: Отказаться от COD письма
      operationId: declineMailCOD
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Отказ от COD выполнен
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: declined
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/mail/expiring:
    get:
      tags:
        - Mail
      summary: Получить истекающие письма
      operationId: getExpiringMails
      parameters:
        - name: days
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 30
            default: 3
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: Истекающие письма
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MailListResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/mail/{id}/extend:
    post:
      tags:
        - Mail
      summary: Продлить срок действия письма
      operationId: extendMailExpiration
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExtendMailRequest'
      responses:
        '200':
          description: Срок продлён
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MailMessage'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/mail/system/send:
    post:
      tags:
        - Mail
      summary: Отправить системное письмо
      operationId: sendSystemMail
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SendSystemMailRequest'
      responses:
        '200':
          description: Системное письмо отправлено
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MailMessage'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/mail/system/broadcast:
    post:
      tags:
        - Mail
      summary: Массовая рассылка системных писем
      operationId: broadcastSystemMail
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BroadcastSystemMailRequest'
      responses:
        '200':
          description: Рассылка выполнена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BroadcastResult'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/party:
    post:
      tags:
        - Party
      summary: Создать группу
      operationId: createParty
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreatePartyRequest'
      responses:
        '201':
          description: Группа создана
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Party'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

    get:
      tags:
        - Party
      summary: Получить информацию о группе
      operationId: getParty
      parameters:
        - name: character_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Информация о группе
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Party'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/{partyId}:
    get:
      tags:
        - Party
      summary: Получить группу по ID
      operationId: getPartyById
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Информация о группе
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Party'
        '404':
          $ref: '#/components/responses/NotFound'

    delete:
      tags:
        - Party
      summary: Распустить группу
      operationId: disbandParty
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Группа распущена
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: disbanded
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/{partyId}/invite:
    post:
      tags:
        - Party
      summary: Пригласить игрока в группу
      operationId: inviteToParty
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InviteToPartyRequest'
      responses:
        '200':
          description: Приглашение отправлено
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Party'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/{partyId}/join:
    post:
      tags:
        - Party
      summary: Присоединиться к группе
      operationId: joinParty
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Присоединился к группе
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Party'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/{partyId}/leave:
    post:
      tags:
        - Party
      summary: Покинуть группу
      operationId: leaveParty
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Покинул группу
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: left
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/{partyId}/kick:
    post:
      tags:
        - Party
      summary: Исключить игрока из группы
      operationId: kickFromParty
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: character_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Игрок исключен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Party'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/{partyId}/transfer-leadership:
    post:
      tags:
        - Party
      summary: Передать лидерство
      operationId: transferLeadership
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: character_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Лидерство передано
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Party'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/{partyId}/loot-mode:
    post:
      tags:
        - Party
      summary: Изменить режим распределения лута
      operationId: changeLootMode
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - loot_mode
              properties:
                loot_mode:
                  type: string
                  enum:
                    - free_for_all
                    - round_robin
                    - need_before_greed
                    - master_looter
      responses:
        '200':
          description: Режим изменен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Party'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/player/{accountId}:
    get:
      tags:
        - Party
      summary: Получить группу игрока
      operationId: getPlayerParty
      parameters:
        - name: accountId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Группа игрока
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Party'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/{partyId}/leader:
    put:
      tags:
        - Party
      summary: Сменить лидера группы
      operationId: transferLeadership
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TransferLeadershipRequest'
      responses:
        '200':
          description: Лидер изменён
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Party'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/invitations/{invitationId}/accept:
    post:
      tags:
        - Party
      summary: Принять приглашение в группу
      operationId: acceptPartyInvitation
      parameters:
        - name: invitationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Приглашение принято
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Party'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/invitations/{invitationId}/decline:
    post:
      tags:
        - Party
      summary: Отклонить приглашение в группу
      operationId: declinePartyInvitation
      parameters:
        - name: invitationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Приглашение отклонено
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: declined
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/invitations/player/{accountId}:
    get:
      tags:
        - Party
      summary: Получить приглашения игрока
      operationId: getPlayerInvitations
      parameters:
        - name: accountId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Приглашения игрока
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PartyInvitationsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /social/party/{partyId}/members:
    post:
      tags:
        - Party
      summary: Добавить участника в группу
      operationId: addPartyMember
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddPartyMemberRequest'
      responses:
        '200':
          description: Участник добавлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Party'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/{partyId}/members/{accountId}:
    delete:
      tags:
        - Party
      summary: Удалить участника из группы
      operationId: removePartyMember
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: accountId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Участник удалён
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Party'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

    put:
      tags:
        - Party
      summary: Изменить роль участника
      operationId: changePartyMemberRole
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: accountId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChangeMemberRoleRequest'
      responses:
        '200':
          description: Роль изменена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Party'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/{partyId}/loot-mode:
    get:
      tags:
        - Party
      summary: Получить текущий режим распределения лута
      operationId: getLootMode
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Режим распределения лута
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LootModeResponse'
        '404':
          $ref: '#/components/responses/NotFound'

    put:
      tags:
        - Party
      summary: Изменить режим распределения лута
      operationId: changeLootMode
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChangeLootModeRequest'
      responses:
        '200':
          description: Режим изменен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Party'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/{partyId}/loot/distribute:
    post:
      tags:
        - Party
      summary: Распределить лут между участниками группы
      operationId: distributeLoot
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DistributeLootRequest'
      responses:
        '200':
          description: Лут распределён
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LootDistributionResult'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/{partyId}/loot/roll:
    post:
      tags:
        - Party
      summary: Бросок кубика для лута
      operationId: rollForLoot
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RollForLootRequest'
      responses:
        '200':
          description: Результат броска
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RollResult'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/{partyId}/quests:
    get:
      tags:
        - Party
      summary: Получить задания группы
      operationId: getPartyQuests
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Задания группы
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PartyQuestsResponse'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/party/{partyId}/quests/{questId}/sync:
    post:
      tags:
        - Party
      summary: Синхронизировать прогресс задания группы
      operationId: syncPartyQuest
      parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: questId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Прогресс синхронизирован
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuestSyncResult'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'

  /social/guilds:
    post:
      tags:
        - Guild
      summary: Создать гильдию
      operationId: createGuild
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGuildRequest'
      responses:
        '200':
          description: Гильдия создана
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Guild'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

    get:
      tags:
        - Guild
      summary: Поиск гильдий
      operationId: searchGuilds
      parameters:
        - name: query
          in: query
          schema:
            type: string
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: Список гильдий
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildListResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}:
    get:
      tags:
        - Guild
      summary: Получить информацию о гильдии
      operationId: getGuild
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Информация о гильдии
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Guild'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

    put:
      tags:
        - Guild
      summary: Обновить информацию о гильдии
      operationId: updateGuild
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateGuildRequest'
      responses:
        '200':
          description: Гильдия обновлена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Guild'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

    delete:
      tags:
        - Guild
      summary: Распустить гильдию
      operationId: disbandGuild
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Гильдия распущена
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: disbanded
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/invite:
    post:
      tags:
        - Guild
      summary: Пригласить игрока в гильдию
      operationId: inviteToGuild
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InviteToGuildRequest'
      responses:
        '200':
          description: Приглашение отправлено
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildInvitation'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/members:
    get:
      tags:
        - Guild
      summary: Получить список участников гильдии
      operationId: getGuildMembers
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: rank
          in: query
          schema:
            type: string
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: Список участников
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildMembersResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

    post:
      tags:
        - Guild
      summary: Добавить участника в гильдию
      operationId: addGuildMember
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddGuildMemberRequest'
      responses:
        '200':
          description: Участник добавлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildMember'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/members/{memberId}:
    delete:
      tags:
        - Guild
      summary: Исключить участника из гильдии
      operationId: removeGuildMember
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: memberId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Участник исключён
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: removed
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/members/{memberId}/rank:
    put:
      tags:
        - Guild
      summary: Назначить ранг участнику
      operationId: setGuildMemberRank
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: memberId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SetGuildMemberRankRequest'
      responses:
        '200':
          description: Ранг назначен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildMember'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/leader:
    put:
      tags:
        - Guild
      summary: Сменить лидера гильдии
      operationId: transferGuildLeadership
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TransferGuildLeadershipRequest'
      responses:
        '200':
          description: Лидер изменён
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Guild'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/leave:
    post:
      tags:
        - Guild
      summary: Выйти из гильдии
      operationId: leaveGuild
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Выход выполнен
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: left
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/ranks:
    get:
      tags:
        - Guild
      summary: Получить список рангов гильдии
      operationId: getGuildRanks
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Список рангов
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildRanksResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

    post:
      tags:
        - Guild
      summary: Создать ранг в гильдии
      operationId: createGuildRank
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGuildRankRequest'
      responses:
        '200':
          description: Ранг создан
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildRank'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/ranks/{rankId}:
    put:
      tags:
        - Guild
      summary: Обновить ранг гильдии
      operationId: updateGuildRank
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: rankId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateGuildRankRequest'
      responses:
        '200':
          description: Ранг обновлён
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildRank'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

    delete:
      tags:
        - Guild
      summary: Удалить ранг гильдии
      operationId: deleteGuildRank
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: rankId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Ранг удалён
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: deleted
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/bank:
    get:
      tags:
        - Guild
      summary: Получить состояние банка гильдии
      operationId: getGuildBank
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Состояние банка
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildBank'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/bank/deposit:
    post:
      tags:
        - Guild
      summary: Внести депозит в банк гильдии
      operationId: depositToGuildBank
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GuildBankDepositRequest'
      responses:
        '200':
          description: Депозит внесён
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildBankTransaction'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/bank/withdraw:
    post:
      tags:
        - Guild
      summary: Снять средства из банка гильдии
      operationId: withdrawFromGuildBank
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GuildBankWithdrawRequest'
      responses:
        '200':
          description: Средства сняты
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildBankTransaction'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/bank/transactions:
    get:
      tags:
        - Guild
      summary: Получить историю транзакций банка гильдии
      operationId: getGuildBankTransactions
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          description: История транзакций
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildBankTransactionsResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/wars:
    get:
      tags:
        - Guild
      summary: Получить список войн гильдии
      operationId: getGuildWars
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          schema:
            type: string
            enum:
              - declared
              - active
              - ended
              - cancelled
      responses:
        '200':
          description: Список войн
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildWarsResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/wars/declare:
    post:
      tags:
        - Guild
      summary: Объявить войну другой гильдии
      operationId: declareGuildWar
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeclareGuildWarRequest'
      responses:
        '200':
          description: Война объявлена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildWar'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/wars/{warId}:
    get:
      tags:
        - Guild
      summary: Получить информацию о войне
      operationId: getGuildWar
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: warId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Информация о войне
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildWar'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/wars/{warId}/end:
    post:
      tags:
        - Guild
      summary: Завершить войну
      operationId: endGuildWar
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: warId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EndGuildWarRequest'
      responses:
        '200':
          description: Война завершена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildWar'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/territories:
    get:
      tags:
        - Guild
      summary: Получить территории гильдии
      operationId: getGuildTerritories
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Территории гильдии
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildTerritoriesResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/territories/{territoryId}/capture:
    post:
      tags:
        - Guild
      summary: Захватить территорию
      operationId: captureTerritory
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: territoryId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Территория захвачена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Territory'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/territories/{territoryId}/resources:
    get:
      tags:
        - Guild
      summary: Получить ресурсы территории
      operationId: getTerritoryResources
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: territoryId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Ресурсы территории
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TerritoryResources'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/progression:
    get:
      tags:
        - Guild
      summary: Получить прогрессию гильдии
      operationId: getGuildProgression
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Прогрессия гильдии
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildProgression'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /social/guilds/{guildId}/perks:
    get:
      tags:
        - Guild
      summary: Получить перки гильдии
      operationId: getGuildPerks
      parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Перки гильдии
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GuildPerksResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    Notification:
      type: object
      properties:
        id:
          type: string
          format: uuid
        account_id:
          type: string
          format: uuid
        type:
          type: string
          enum: [quest, message, achievement, system, friend, guild, trade, combat]
        priority:
          type: string
          enum: [low, medium, high, urgent]
          default: medium
        title:
          type: string
          maxLength: 200
        content:
          type: string
        data:
          type: object
          additionalProperties: true
        status:
          type: string
          enum: [unread, read, archived]
          default: unread
        channels:
          type: array
          items:
            type: string
            enum: [in_game, websocket, email]
          default: [in_game]
        created_at:
          type: string
          format: date-time
        read_at:
          type: string
          format: date-time
          nullable: true
        expires_at:
          type: string
          format: date-time
          nullable: true

    CreateNotificationRequest:
      type: object
      required:
        - account_id
        - type
        - title
        - content
      properties:
        account_id:
          type: string
          format: uuid
        type:
          type: string
          enum: [quest, message, achievement, system, friend, guild, trade, combat]
        priority:
          type: string
          enum: [low, medium, high, critical]
          default: medium
        title:
          type: string
          maxLength: 200
        content:
          type: string
        data:
          type: object
          additionalProperties: true
        channels:
          type: array
          items:
            type: string
            enum: [in_game, websocket, email]
          default: [in_game]
        expires_at:
          type: string
          format: date-time
          nullable: true

    UpdateNotificationStatusRequest:
      type: object
      required:
        - status
      properties:
        status:
          type: string
          enum: [read, archived]

    NotificationListResponse:
      type: object
      properties:
        notifications:
          type: array
          items:
            $ref: '#/components/schemas/Notification'
        total:
          type: integer
        unread:
          type: integer

    NotificationPreferences:
      type: object
      properties:
        account_id:
          type: string
          format: uuid
        quest_enabled:
          type: boolean
          default: true
        message_enabled:
          type: boolean
          default: true
        achievement_enabled:
          type: boolean
          default: true
        system_enabled:
          type: boolean
          default: true
        friend_enabled:
          type: boolean
          default: true
        guild_enabled:
          type: boolean
          default: true
        trade_enabled:
          type: boolean
          default: true
        combat_enabled:
          type: boolean
          default: true
        preferred_channels:
          type: array
          items:
            type: string
            enum:
              - in_game
              - websocket
              - email
          default:
            - in_game
        updated_at:
          type: string
          format: date-time

    UpdateNotificationPreferencesRequest:
      type: object
      required:
        - account_id
      properties:
        account_id:
          type: string
          format: uuid
        quest_enabled:
          type: boolean
        message_enabled:
          type: boolean
        achievement_enabled:
          type: boolean
        system_enabled:
          type: boolean
        friend_enabled:
          type: boolean
        guild_enabled:
          type: boolean
        trade_enabled:
          type: boolean
        combat_enabled:
          type: boolean
        preferred_channels:
          type: array
          items:
            type: string
            enum:
              - in_game
              - websocket
              - email

    BatchReadRequest:
      type: object
      required:
        - account_id
        - notification_ids
      properties:
        account_id:
          type: string
          format: uuid
        notification_ids:
          type: array
          items:
            type: string
            format: uuid
          minItems: 1
          maxItems: 100

    Friendship:
      type: object
      properties:
        id:
          type: string
          format: uuid
        character_a_id:
          type: string
          format: uuid
        character_b_id:
          type: string
          format: uuid
        status:
          type: string
          enum: [pending, accepted, blocked]
        initiator_id:
          type: string
          format: uuid
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    FriendRequest:
      type: object
      required:
        - to_character_id
      properties:
        to_character_id:
          type: string
          format: uuid

    FriendListResponse:
      type: object
      properties:
        friends:
          type: array
          items:
            $ref: '#/components/schemas/Friendship'
        total:
          type: integer

    FriendsCountResponse:
      type: object
      properties:
        count:
          type: integer
        online_count:
          type: integer

    FriendRequestsResponse:
      type: object
      properties:
        requests:
          type: array
          items:
            $ref: '#/components/schemas/FriendRequest'
        total:
          type: integer

    BlockPlayerRequest:
      type: object
      required:
        - player_id
      properties:
        player_id:
          type: string
          format: uuid
        reason:
          type: string
          maxLength: 200

    BlockedPlayer:
      type: object
      properties:
        id:
          type: string
          format: uuid
        player_id:
          type: string
          format: uuid
        blocked_at:
          type: string
          format: date-time
        reason:
          type: string

    BlockedPlayersResponse:
      type: object
      properties:
        blocked_players:
          type: array
          items:
            $ref: '#/components/schemas/BlockedPlayer'
        total:
          type: integer

    BlockStatusResponse:
      type: object
      properties:
        player_id:
          type: string
          format: uuid
        is_blocked:
          type: boolean
        blocked_by_me:
          type: boolean
        i_am_blocked:
          type: boolean

    FriendStatusResponse:
      type: object
      properties:
        friend_id:
          type: string
          format: uuid
        is_online:
          type: boolean
        last_seen:
          type: string
          format: date-time
        current_session_id:
          type: string
          format: uuid
          nullable: true

    FriendsStatusBatchResponse:
      type: object
      properties:
        statuses:
          type: array
          items:
            $ref: '#/components/schemas/FriendStatusResponse'
        total:
          type: integer

    RecentContactsResponse:
      type: object
      properties:
        contacts:
          type: array
          items:
            $ref: '#/components/schemas/RecentContact'
        total:
          type: integer

    RecentContact:
      type: object
      properties:
        player_id:
          type: string
          format: uuid
        last_interaction_at:
          type: string
          format: date-time
        interaction_count:
          type: integer
        is_friend:
          type: boolean
        is_online:
          type: boolean

    ChannelType:
      type: string
      enum: [GLOBAL, TRADE, NEWBIE, LOCAL, PARTY, RAID, GUILD, GUILD_OFFICER, WHISPER, SYSTEM, COMBAT_LOG, RP_EMOTE]

    ChatChannel:
      type: object
      properties:
        id:
          type: string
          format: uuid
        channel_type:
          type: string
          enum:
            - GLOBAL
            - TRADE
            - NEWBIE
            - LOCAL
            - PARTY
            - RAID
            - GUILD
            - GUILD_OFFICER
            - WHISPER
            - SYSTEM
            - COMBAT_LOG
            - RP_EMOTE
        owner_id:
          type: string
          format: uuid
          nullable: true
        name:
          type: string
          maxLength: 100
        description:
          type: string
          nullable: true
        read_permission:
          type: object
          additionalProperties: true
          nullable: true
        write_permission:
          type: object
          additionalProperties: true
          nullable: true
        cooldown_seconds:
          type: integer
          default: 0
        max_message_length:
          type: integer
          default: 500
        is_active:
          type: boolean
          default: true
        created_at:
          type: string
          format: date-time

    ChatMessage:
      type: object
      properties:
        id:
          type: string
          format: uuid
        channel_id:
          type: string
          format: uuid
        channel_type:
          $ref: '#/components/schemas/ChannelType'
        sender_id:
          type: string
          format: uuid
        sender_name:
          type: string
        content:
          type: string
        formatted_text:
          type: string
        message_type:
          type: string
          enum:
            - text
            - system
            - emote
            - command
        is_edited:
          type: boolean
          default: false
        is_deleted:
          type: boolean
          default: false
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    CreateMessageRequest:
      type: object
      required:
        - channel_id
        - channel_type
        - content
      properties:
        channel_id:
          type: string
          format: uuid
        channel_type:
          type: string
          enum:
            - GLOBAL
            - TRADE
            - NEWBIE
            - LOCAL
            - PARTY
            - RAID
            - GUILD
            - GUILD_OFFICER
            - WHISPER
            - SYSTEM
            - COMBAT_LOG
            - RP_EMOTE
        content:
          type: string
          maxLength: 500

    MessageListResponse:
      type: object
      properties:
        messages:
          type: array
          items:
            $ref: '#/components/schemas/ChatMessage'
        total:
          type: integer
        has_more:
          type: boolean

    ChannelListResponse:
      type: object
      properties:
        channels:
          type: array
          items:
            $ref: '#/components/schemas/ChatChannel'
        total:
          type: integer

    JoinChannelRequest:
      type: object
      required:
        - player_id
      properties:
        player_id:
          type: string
          format: uuid

    LeaveChannelRequest:
      type: object
      required:
        - player_id
      properties:
        player_id:
          type: string
          format: uuid

    ChannelMembersResponse:
      type: object
      properties:
        channel_id:
          type: string
          format: uuid
        members:
          type: array
          items:
            type: string
            format: uuid
        total:
          type: integer
        limit:
          type: integer
        offset:
          type: integer

    SendMessageRequest:
      type: object
      required:
        - channel_id
        - channel_type
        - content
      properties:
        channel_id:
          type: string
          format: uuid
        channel_type:
          type: string
          enum:
            - GLOBAL
            - TRADE
            - NEWBIE
            - LOCAL
            - PARTY
            - RAID
            - GUILD
            - GUILD_OFFICER
            - WHISPER
            - SYSTEM
            - COMBAT_LOG
            - RP_EMOTE
        content:
          type: string
          maxLength: 500
        recipient_id:
          type: string
          format: uuid
          nullable: true

    ProcessMessageRequest:
      type: object
      required:
        - message_id
      properties:
        message_id:
          type: string
          format: uuid

    ProcessedMessageResponse:
      type: object
      properties:
        message:
          $ref: '#/components/schemas/ChatMessage'
        moderation_applied:
          type: boolean
        formatting_applied:
          type: boolean

    ReportMessageRequest:
      type: object
      required:
        - message_id
        - reason
      properties:
        message_id:
          type: string
          format: uuid
        reason:
          type: string
          maxLength: 500

    ReportResponse:
      type: object
      properties:
        success:
          type: boolean
        report_id:
          type: string
          format: uuid

    BanUserRequest:
      type: object
      required:
        - player_id
        - reason
        - duration_hours
      properties:
        player_id:
          type: string
          format: uuid
        reason:
          type: string
          maxLength: 500
        duration_hours:
          type: integer
          nullable: true

    BanResponse:
      type: object
      properties:
        success:
          type: boolean
        ban_id:
          type: string
          format: uuid
        expires_at:
          type: string
          format: date-time
          nullable: true

    BanListResponse:
      type: object
      properties:
        bans:
          type: array
          items:
            $ref: '#/components/schemas/ChatBan'
        total:
          type: integer
        limit:
          type: integer
        offset:
          type: integer

    ChatBan:
      type: object
      properties:
        id:
          type: string
          format: uuid
        player_id:
          type: string
          format: uuid
        reason:
          type: string
        duration_hours:
          type: integer
          nullable: true
        expires_at:
          type: string
          format: date-time
          nullable: true
        banned_by:
          type: string
          format: uuid
        created_at:
          type: string
          format: date-time

    RevokeBanRequest:
      type: object
      required:
        - revoked_by
      properties:
        revoked_by:
          type: string
          format: uuid

    RevokeBanResponse:
      type: object
      properties:
        success:
          type: boolean
        ban_id:
          type: string
          format: uuid

    ExecuteCommandRequest:
      type: object
      required:
        - command
      properties:
        command:
          type: string
        args:
          type: array
          items:
            type: string

    CommandResponse:
      type: object
      properties:
        success:
          type: boolean
        command:
          type: string
        result:
          type: string
          nullable: true
        error:
          type: string
          nullable: true

    ChatHistoryResponse:
      type: object
      properties:
        channel_type:
          type: string
        messages:
          type: array
          items:
            $ref: '#/components/schemas/ChatMessage'
        total:
          type: integer
        limit:
          type: integer
        offset:
          type: integer

    ChatSearchResponse:
      type: object
      properties:
        query:
          type: string
        results:
          type: array
          items:
            $ref: '#/components/schemas/ChatMessage'
        total:
          type: integer
        limit:
          type: integer
        offset:
          type: integer

    FormatMessageRequest:
      type: object
      required:
        - content
      properties:
        content:
          type: string
        format_options:
          type: object
          additionalProperties: true
          nullable: true

    FormattedMessageResponse:
      type: object
      properties:
        original:
          type: string
        formatted:
          type: string
        mentions:
          type: array
          items:
            type: string
            format: uuid

    ChatEvent:
      type: object
      properties:
        id:
          type: string
          format: uuid
        event_type:
          type: string
          enum:
            - chat:message-sent
            - chat:message-received
            - chat:channel-joined
            - chat:channel-left
            - chat:user-banned
        channel_id:
          type: string
          format: uuid
          nullable: true
        event_data:
          type: object
          additionalProperties: true
        created_at:
          type: string
          format: date-time

    ChatEventsResponse:
      type: object
      properties:
        events:
          type: array
          items:
            $ref: '#/components/schemas/ChatEvent'
        total:
          type: integer
        limit:
          type: integer
        offset:
          type: integer

    MailMessage:
      type: object
      properties:
        id:
          type: string
          format: uuid
        sender_id:
          type: string
          format: uuid
          nullable: true
        sender_name:
          type: string
        recipient_id:
          type: string
          format: uuid
        type:
          type: string
          enum: [player, system, quest, auction, trade]
        subject:
          type: string
          maxLength: 500
        content:
          type: string
        attachments:
          type: object
          additionalProperties: true
        cod_amount:
          type: integer
          nullable: true
        status:
          type: string
          enum: [unread, read, claimed, expired, returned]
        is_read:
          type: boolean
        is_claimed:
          type: boolean
        sent_at:
          type: string
          format: date-time
        read_at:
          type: string
          format: date-time
          nullable: true
        expires_at:
          type: string
          format: date-time
          nullable: true
        created_at:
          type: string
          format: date-time

    CreateMailRequest:
      type: object
      required:
        - recipient_id
        - subject
        - content
      properties:
        recipient_id:
          type: string
          format: uuid
        subject:
          type: string
          maxLength: 500
        content:
          type: string
        attachments:
          type: object
          additionalProperties: true
        cod_amount:
          type: integer
          nullable: true
        expires_in:
          type: integer
          description: Количество дней до истечения
          nullable: true

    MailListResponse:
      type: object
      properties:
        messages:
          type: array
          items:
            $ref: '#/components/schemas/MailMessage'
        total:
          type: integer
        unread:
          type: integer

    ClaimAttachmentResponse:
      type: object
      properties:
        success:
          type: boolean
        items:
          type: object
          additionalProperties: true
        currency:
          type: object
          additionalProperties:
            type: integer

    UnreadMailCountResponse:
      type: object
      properties:
        unread_count:
          type: integer
        total_count:
          type: integer

    MailAttachmentsResponse:
      type: object
      properties:
        mail_id:
          type: string
          format: uuid
        attachments:
          type: array
          items:
            $ref: '#/components/schemas/MailAttachment'
        has_cod:
          type: boolean
        cod_amount:
          type: integer
          nullable: true

    MailAttachment:
      type: object
      properties:
        id:
          type: string
          format: uuid
        type:
          type: string
          enum:
            - item
            - currency
            - quest_reward
            - achievement_reward
        item_id:
          type: string
          format: uuid
          nullable: true
        quantity:
          type: integer
        currency:
          type: integer
          nullable: true
        claimed:
          type: boolean

    ExtendMailRequest:
      type: object
      required:
        - days
      properties:
        days:
          type: integer
          minimum: 1
          maximum: 30
          description: Количество дней для продления

    SendSystemMailRequest:
      type: object
      required:
        - recipient_id
        - type
        - title
        - content
      properties:
        recipient_id:
          type: string
          format: uuid
        type:
          type: string
          enum:
            - quest_reward
            - achievement_reward
            - event_reward
            - maintenance_notification
        title:
          type: string
        content:
          type: string
        attachments:
          type: array
          items:
            $ref: '#/components/schemas/MailAttachment'
        expires_in_days:
          type: integer
          minimum: 1
          maximum: 30
          default: 30

    BroadcastSystemMailRequest:
      type: object
      required:
        - type
        - title
        - content
      properties:
        type:
          type: string
          enum:
            - quest_reward
            - achievement_reward
            - event_reward
            - maintenance_notification
        title:
          type: string
        content:
          type: string
        attachments:
          type: array
          items:
            $ref: '#/components/schemas/MailAttachment'
        recipient_ids:
          type: array
          items:
            type: string
            format: uuid
        filter_criteria:
          type: object
          properties:
            min_level:
              type: integer
            max_level:
              type: integer
            character_class:
              type: string
        expires_in_days:
          type: integer
          minimum: 1
          maximum: 30
          default: 30

    BroadcastResult:
      type: object
      properties:
        total_sent:
          type: integer
        total_failed:
          type: integer
        failed_recipients:
          type: array
          items:
            type: string
            format: uuid
        broadcast_id:
          type: string
          format: uuid
        sent_at:
          type: string
          format: date-time

    Party:
      type: object
      properties:
        id:
          type: string
          format: uuid
        leader_id:
          type: string
          format: uuid
        members:
          type: array
          items:
            $ref: '#/components/schemas/PartyMember'
        max_size:
          type: integer
          minimum: 2
          maximum: 5
          default: 5
        loot_mode:
          type: string
          enum:
            - free_for_all
            - round_robin
            - need_before_greed
            - master_looter
          default: free_for_all
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    PartyMember:
      type: object
      properties:
        character_id:
          type: string
          format: uuid
        role:
          type: string
          enum:
            - leader
            - member
        joined_at:
          type: string
          format: date-time

    CreatePartyRequest:
      type: object
      properties:
        max_size:
          type: integer
          minimum: 2
          maximum: 5
          default: 5
        loot_mode:
          type: string
          enum:
            - free_for_all
            - round_robin
            - need_before_greed
            - master_looter

    InviteToPartyRequest:
      type: object
      required:
        - character_id
      properties:
        character_id:
          type: string
          format: uuid

    TransferLeadershipRequest:
      type: object
      required:
        - new_leader_id
      properties:
        new_leader_id:
          type: string
          format: uuid

    PartyInvitationsResponse:
      type: object
      properties:
        invitations:
          type: array
          items:
            $ref: '#/components/schemas/PartyInvitation'
        total:
          type: integer

    PartyInvitation:
      type: object
      properties:
        id:
          type: string
          format: uuid
        party_id:
          type: string
          format: uuid
        inviter_id:
          type: string
          format: uuid
        invitee_id:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - pending
            - accepted
            - declined
            - expired
        created_at:
          type: string
          format: date-time
        expires_at:
          type: string
          format: date-time

    AddPartyMemberRequest:
      type: object
      required:
        - account_id
      properties:
        account_id:
          type: string
          format: uuid
        role:
          type: string
          enum:
            - leader
            - member
          default: member

    ChangeMemberRoleRequest:
      type: object
      required:
        - role
      properties:
        role:
          type: string
          enum:
            - leader
            - member

    LootModeResponse:
      type: object
      properties:
        party_id:
          type: string
          format: uuid
        loot_mode:
          type: string
          enum:
            - free_for_all
            - round_robin
            - need_before_greed
            - master_looter

    ChangeLootModeRequest:
      type: object
      required:
        - loot_mode
      properties:
        loot_mode:
          type: string
          enum:
            - free_for_all
            - round_robin
            - need_before_greed
            - master_looter

    DistributeLootRequest:
      type: object
      required:
        - item_id
        - target_account_id
      properties:
        item_id:
          type: string
          format: uuid
        target_account_id:
          type: string
          format: uuid
        quantity:
          type: integer
          minimum: 1
          default: 1

    LootDistributionResult:
      type: object
      properties:
        party_id:
          type: string
          format: uuid
        item_id:
          type: string
          format: uuid
        distributed_to:
          type: string
          format: uuid
        quantity:
          type: integer
        mode:
          type: string
        distributed_at:
          type: string
          format: date-time

    RollForLootRequest:
      type: object
      required:
        - item_id
      properties:
        item_id:
          type: string
          format: uuid
        min_roll:
          type: integer
          minimum: 1
          maximum: 100
          default: 1
        max_roll:
          type: integer
          minimum: 1
          maximum: 100
          default: 100

    RollResult:
      type: object
      properties:
        party_id:
          type: string
          format: uuid
        item_id:
          type: string
          format: uuid
        account_id:
          type: string
          format: uuid
        roll_value:
          type: integer
        winner:
          type: boolean
        rolls:
          type: array
          items:
            type: object
            properties:
              account_id:
                type: string
                format: uuid
              roll_value:
                type: integer

    PartyQuestsResponse:
      type: object
      properties:
        party_id:
          type: string
          format: uuid
        quests:
          type: array
          items:
            $ref: '#/components/schemas/PartyQuest'
        total:
          type: integer

    PartyQuest:
      type: object
      properties:
        quest_id:
          type: string
          format: uuid
        quest_name:
          type: string
        status:
          type: string
          enum:
            - active
            - completed
            - failed
        progress:
          type: integer
        progress_max:
          type: integer
        participants:
          type: array
          items:
            type: string
            format: uuid
        started_at:
          type: string
          format: date-time
        completed_at:
          type: string
          format: date-time
          nullable: true

    QuestSyncResult:
      type: object
      properties:
        party_id:
          type: string
          format: uuid
        quest_id:
          type: string
          format: uuid
        synced:
          type: boolean
        participants_synced:
          type: array
          items:
            type: string
            format: uuid
        synced_at:
          type: string
          format: date-time

    CreateGuildRequest:
      type: object
      required:
        - name
        - tag
      properties:
        name:
          type: string
          minLength: 3
          maxLength: 50
        tag:
          type: string
          minLength: 2
          maxLength: 5
        description:
          type: string
          maxLength: 500
        emblem:
          type: string
          format: uri

    UpdateGuildRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 3
          maxLength: 50
        description:
          type: string
          maxLength: 500
        emblem:
          type: string
          format: uri

    Guild:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        tag:
          type: string
        description:
          type: string
        emblem:
          type: string
          format: uri
        status:
          type: string
          enum:
            - active
            - disbanded
            - suspended
        leader_id:
          type: string
          format: uuid
        member_count:
          type: integer
        max_members:
          type: integer
        level:
          type: integer
        experience:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    GuildListResponse:
      type: object
      properties:
        guilds:
          type: array
          items:
            $ref: '#/components/schemas/Guild'
        total:
          type: integer

    InviteToGuildRequest:
      type: object
      required:
        - account_id
      properties:
        account_id:
          type: string
          format: uuid
        message:
          type: string
          maxLength: 200

    GuildInvitation:
      type: object
      properties:
        id:
          type: string
          format: uuid
        guild_id:
          type: string
          format: uuid
        inviter_id:
          type: string
          format: uuid
        invitee_id:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - pending
            - accepted
            - declined
            - expired
        created_at:
          type: string
          format: date-time
        expires_at:
          type: string
          format: date-time

    AddGuildMemberRequest:
      type: object
      required:
        - account_id
      properties:
        account_id:
          type: string
          format: uuid
        rank_id:
          type: string
          format: uuid

    GuildMember:
      type: object
      properties:
        id:
          type: string
          format: uuid
        guild_id:
          type: string
          format: uuid
        account_id:
          type: string
          format: uuid
        rank_id:
          type: string
          format: uuid
        rank_name:
          type: string
        joined_at:
          type: string
          format: date-time
        last_active_at:
          type: string
          format: date-time

    GuildMembersResponse:
      type: object
      properties:
        members:
          type: array
          items:
            $ref: '#/components/schemas/GuildMember'
        total:
          type: integer

    SetGuildMemberRankRequest:
      type: object
      required:
        - rank_id
      properties:
        rank_id:
          type: string
          format: uuid

    TransferGuildLeadershipRequest:
      type: object
      required:
        - new_leader_id
      properties:
        new_leader_id:
          type: string
          format: uuid

    CreateGuildRankRequest:
      type: object
      required:
        - name
        - permissions
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 50
        permissions:
          type: array
          items:
            type: string
            enum:
              - invite_members
              - kick_members
              - manage_ranks
              - manage_bank
              - declare_war
              - manage_territory
              - view_logs
        order:
          type: integer
          minimum: 0

    UpdateGuildRankRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 50
        permissions:
          type: array
          items:
            type: string
            enum:
              - invite_members
              - kick_members
              - manage_ranks
              - manage_bank
              - declare_war
              - manage_territory
              - view_logs
        order:
          type: integer
          minimum: 0

    GuildRank:
      type: object
      properties:
        id:
          type: string
          format: uuid
        guild_id:
          type: string
          format: uuid
        name:
          type: string
        permissions:
          type: array
          items:
            type: string
        order:
          type: integer
        created_at:
          type: string
          format: date-time

    GuildRanksResponse:
      type: object
      properties:
        ranks:
          type: array
          items:
            $ref: '#/components/schemas/GuildRank'
        total:
          type: integer

    GuildBank:
      type: object
      properties:
        guild_id:
          type: string
          format: uuid
        currency:
          type: integer
          minimum: 0
        items:
          type: array
          items:
            type: object
            properties:
              item_id:
                type: string
                format: uuid
              quantity:
                type: integer
        updated_at:
          type: string
          format: date-time

    GuildBankDepositRequest:
      type: object
      required:
        - currency
      properties:
        currency:
          type: integer
          minimum: 1
        items:
          type: array
          items:
            type: object
            properties:
              item_id:
                type: string
                format: uuid
              quantity:
                type: integer
                minimum: 1

    GuildBankWithdrawRequest:
      type: object
      required:
        - currency
      properties:
        currency:
          type: integer
          minimum: 1
        items:
          type: array
          items:
            type: object
            properties:
              item_id:
                type: string
                format: uuid
              quantity:
                type: integer
                minimum: 1

    GuildBankTransaction:
      type: object
      properties:
        id:
          type: string
          format: uuid
        guild_id:
          type: string
          format: uuid
        account_id:
          type: string
          format: uuid
        type:
          type: string
          enum:
            - deposit
            - withdraw
        currency:
          type: integer
        items:
          type: array
          items:
            type: object
        created_at:
          type: string
          format: date-time

    GuildBankTransactionsResponse:
      type: object
      properties:
        transactions:
          type: array
          items:
            $ref: '#/components/schemas/GuildBankTransaction'
        total:
          type: integer

    DeclareGuildWarRequest:
      type: object
      required:
        - target_guild_id
      properties:
        target_guild_id:
          type: string
          format: uuid
        reason:
          type: string
          maxLength: 500

    EndGuildWarRequest:
      type: object
      required:
        - winner_guild_id
      properties:
        winner_guild_id:
          type: string
          format: uuid
        reason:
          type: string
          maxLength: 500

    GuildWar:
      type: object
      properties:
        id:
          type: string
          format: uuid
        attacker_guild_id:
          type: string
          format: uuid
        defender_guild_id:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - declared
            - active
            - ended
            - cancelled
        winner_guild_id:
          type: string
          format: uuid
          nullable: true
        declared_at:
          type: string
          format: date-time
        started_at:
          type: string
          format: date-time
          nullable: true
        ended_at:
          type: string
          format: date-time
          nullable: true

    GuildWarsResponse:
      type: object
      properties:
        wars:
          type: array
          items:
            $ref: '#/components/schemas/GuildWar'
        total:
          type: integer

    Territory:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        owner_guild_id:
          type: string
          format: uuid
          nullable: true
        captured_at:
          type: string
          format: date-time
          nullable: true
        position:
          type: object
          properties:
            x:
              type: number
            y:
              type: number
            z:
              type: number

    GuildTerritoriesResponse:
      type: object
      properties:
        territories:
          type: array
          items:
            $ref: '#/components/schemas/Territory'
        total:
          type: integer

    TerritoryResources:
      type: object
      properties:
        territory_id:
          type: string
          format: uuid
        resources:
          type: array
          items:
            type: object
            properties:
              resource_type:
                type: string
              quantity:
                type: integer
              generation_rate:
                type: number
        last_updated:
          type: string
          format: date-time

    GuildProgression:
      type: object
      properties:
        guild_id:
          type: string
          format: uuid
        level:
          type: integer
        experience:
          type: integer
        experience_to_next_level:
          type: integer
        max_members:
          type: integer
        unlocked_perks:
          type: array
          items:
            type: string

    GuildPerksResponse:
      type: object
      properties:
        guild_id:
          type: string
          format: uuid
        perks:
          type: array
          items:
            $ref: '#/components/schemas/GuildPerk'
        total:
          type: integer

    GuildPerk:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        level_required:
          type: integer
        unlocked:
          type: boolean
        unlocked_at:
          type: string
          format: date-time
          nullable: true

    Error:
      type: object
      properties:
        error:
          type: string

  responses:
    BadRequest:
      description: Неверный запрос
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    Unauthorized:
      description: Требуется аутентификация
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    NotFound:
      description: Ресурс не найден
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    InternalServerError:
      description: Внутренняя ошибка сервера
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

security:
  - BearerAuth: []

