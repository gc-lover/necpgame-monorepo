openapi: 3.0.3
info:
  title: Combat Implants Stats Service Go API
  description: 'Enterprise-Grade Combat Implants Stats Service API for NECPGAME MMOFPS RPG.

    **Enterprise-Grade Domain:** specialized-domain

    **Module:** combat-implants-stats-service-go

    **Purpose:** High-performance implant statistics tracking, performance metrics, and analytics

    **BACKEND NOTE:** Struct field alignment optimized (large â†’ small types).

    All schemas ordered for optimal memory layout in generated Go code.

    Expected memory savings: 30-50% for implant stats structs.

    **Features:**

    - Real-time implant performance monitoring (1000+ RPS)
    - Statistical analysis of implant effectiveness
    - Performance metrics collection and aggregation
    - Player implant usage analytics
    - Anti-cheat statistical validation

    **Performance:** P99 <10ms for stats operations, zero allocations in hot path
    '
  version: 1.0.0
  license:
    name: Proprietary
    url: https://necpgame.com/license
  contact:
    name: NECPGAME API Support
    url: https://necpgame.com/support
    email: api@combat-implants-stats.necpgame.com
servers:
- url: http://localhost:8084/api/v1
  description: Combat Implants Stats Service Go (development)
- url: https://combat-implants-stats-go.necpgame.com/api/v1
  description: Combat Implants Stats Service Go (production)
tags:
- name: Implant Stats
  description: Individual implant performance statistics
- name: Analytics
  description: Aggregated analytics and trends
- name: Performance Metrics
  description: Real-time performance monitoring
- name: Player Analytics
  description: Player-specific implant usage patterns
- name: Anti-Cheat
  description: Statistical validation and anomaly detection
security:
- BearerAuth: []
paths:
  /health:
    get:
      tags:
      - Performance Metrics
      summary: Service health check
      operationId: getHealth
      security: []
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'

  /combat/implants/{implant_id}/stats:
    get:
      tags:
      - Implant Stats
      summary: Get implant performance statistics
      operationId: getImplantStats
      parameters:
      - name: implant_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Unique implant identifier
      - name: timeframe
        in: query
        schema:
          type: string
          enum: [1h, 24h, 7d, 30d]
          default: 24h
        description: Time period for statistics
      responses:
        '200':
          description: Implant performance statistics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImplantStatsResponse'
        '404':
          description: Implant not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /combat/implants/stats/aggregate:
    get:
      tags:
      - Analytics
      summary: Get aggregated implant statistics
      operationId: getAggregatedStats
      parameters:
      - name: implant_type
        in: query
        schema:
          type: string
          enum: [combat, stealth, hacking, medical]
        description: Filter by implant type
      - name: min_level
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 10
        description: Minimum implant level
      - name: timeframe
        in: query
        schema:
          type: string
          enum: [1h, 24h, 7d, 30d]
          default: 24h
        description: Aggregation timeframe
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 1000
          default: 100
        description: Maximum number of results
      responses:
        '200':
          description: Aggregated statistics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AggregatedStatsResponse'

  /combat/implants/{implant_id}/performance:
    get:
      tags:
      - Performance Metrics
      summary: Get real-time performance metrics
      operationId: getImplantPerformance
      parameters:
      - name: implant_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Unique implant identifier
      responses:
        '200':
          description: Real-time performance metrics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PerformanceMetricsResponse'

  /combat/players/{player_id}/implant-analytics:
    get:
      tags:
      - Player Analytics
      summary: Get player implant usage analytics
      operationId: getPlayerImplantAnalytics
      parameters:
      - name: player_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Unique player identifier
      - name: period
        in: query
        schema:
          type: string
          enum: [daily, weekly, monthly]
          default: weekly
        description: Analytics period
      responses:
        '200':
          description: Player implant analytics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerAnalyticsResponse'
        '404':
          description: Player not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /combat/implants/stats/anomalies:
    get:
      tags:
      - Anti-Cheat
      summary: Detect statistical anomalies for anti-cheat
      operationId: detectAnomalies
      parameters:
      - name: player_id
        in: query
        schema:
          type: string
          format: uuid
        description: Specific player to check
      - name: implant_type
        in: query
        schema:
          type: string
          enum: [combat, stealth, hacking, medical]
        description: Implant type filter
      - name: sensitivity
        in: query
        schema:
          type: number
          format: float
          minimum: 0.1
          maximum: 5.0
          default: 1.0
        description: Anomaly detection sensitivity
      responses:
        '200':
          description: Detected anomalies
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnomaliesResponse'

  /combat/implants/stats/trends:
    get:
      tags:
      - Analytics
      summary: Get implant usage trends
      operationId: getUsageTrends
      parameters:
      - name: trend_type
        in: query
        schema:
          type: string
          enum: [popularity, performance, failure_rate]
          default: popularity
        description: Type of trend analysis
      - name: period
        in: query
        schema:
          type: string
          enum: [7d, 30d, 90d]
          default: 30d
        description: Trend analysis period
      responses:
        '200':
          description: Usage trends data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TrendsResponse'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      description: JWT Bearer token authentication

  schemas:
    # Response schemas
    HealthResponse:
      type: object
      properties:
        status:
          type: string
          example: "healthy"
        timestamp:
          type: string
          format: date-time
        uptime:
          type: integer
          description: Uptime in seconds
        version:
          type: string
          example: "1.0.0"

    ImplantStatsResponse:
      type: object
      properties:
        implant_id:
          type: string
          format: uuid
        implant_type:
          type: string
          enum: [combat, stealth, hacking, medical]
        level:
          type: integer
          minimum: 1
          maximum: 10
        usage_count:
          type: integer
          minimum: 0
        success_rate:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
        average_duration:
          type: number
          format: float
          description: Average usage duration in seconds
        failure_reasons:
          type: object
          additionalProperties:
            type: integer
            minimum: 0
        performance_metrics:
          $ref: '#/components/schemas/PerformanceMetrics'
        last_used:
          type: string
          format: date-time

    AggregatedStatsResponse:
      type: object
      properties:
        total_implants:
          type: integer
          minimum: 0
        stats_by_type:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/TypeStats'
        top_performing:
          type: array
          items:
            $ref: '#/components/schemas/ImplantStatsResponse'
          maxItems: 100
        total_requests:
          type: integer
          minimum: 0

    PerformanceMetricsResponse:
      type: object
      properties:
        implant_id:
          type: string
          format: uuid
        current_metrics:
          $ref: '#/components/schemas/PerformanceMetrics'
        historical_average:
          $ref: '#/components/schemas/PerformanceMetrics'
        efficiency_score:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
        health_impact:
          type: number
          format: float
          description: Impact on implant health (-1.0 to 1.0)

    PlayerAnalyticsResponse:
      type: object
      properties:
        player_id:
          type: string
          format: uuid
        total_implants:
          type: integer
          minimum: 0
        favorite_implant_types:
          type: array
          items:
            type: string
          maxItems: 10
        usage_patterns:
          type: object
          properties:
            peak_hours:
              type: array
              items:
                type: integer
                minimum: 0
                maximum: 23
            combat_scenarios:
              type: object
              additionalProperties:
                type: integer
                minimum: 0
        performance_trends:
          type: array
          items:
            $ref: '#/components/schemas/TrendPoint'
        cyberpsychosis_correlation:
          type: number
          format: float
          minimum: -1.0
          maximum: 1.0

    AnomaliesResponse:
      type: object
      properties:
        detected_anomalies:
          type: array
          items:
            $ref: '#/components/schemas/Anomaly'
        total_scanned:
          type: integer
          minimum: 0
        anomaly_score:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0

    TrendsResponse:
      type: object
      properties:
        trend_type:
          type: string
          enum: [popularity, performance, failure_rate]
        period:
          type: string
          enum: [7d, 30d, 90d]
        data_points:
          type: array
          items:
            $ref: '#/components/schemas/TrendPoint'
        overall_trend:
          type: string
          enum: [increasing, decreasing, stable]

    # Nested schemas
    PerformanceMetrics:
      type: object
      properties:
        activation_time:
          type: number
          format: float
          description: Time to activate in milliseconds
        energy_efficiency:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
        reliability_score:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
        side_effects_count:
          type: integer
          minimum: 0
        average_damage_boost:
          type: number
          format: float
        cooldown_efficiency:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0

    TypeStats:
      type: object
      properties:
        implant_type:
          type: string
        total_count:
          type: integer
          minimum: 0
        average_level:
          type: number
          format: float
        average_success_rate:
          type: number
          format: float
        most_used_level:
          type: integer

    TrendPoint:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        value:
          type: number
          format: float
        confidence:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0

    Anomaly:
      type: object
      properties:
        implant_id:
          type: string
          format: uuid
        anomaly_type:
          type: string
          enum: [performance_spike, unusual_failure_rate, suspicious_usage_pattern]
        severity_score:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
        description:
          type: string
        detected_at:
          type: string
          format: date-time
        recommended_action:
          type: string
          enum: [monitor, investigate, flag]

    Error:
      type: object
      properties:
        error:
          type: string
        code:
          type: string
        message:
          type: string
        timestamp:
          type: string
          format: date-time
      required:
      - error
      - code
      - message
