openapi: 3.0.3
info:
  title: Combat Shooting Service API
  description: 'Enterprise-Grade Combat Shooting Service API for NECPGAME MMOFPS RPG.

    **Enterprise-Grade Domain:** specialized-domain

    **Module:** combat-shooting-service

    **Purpose:** High-performance ballistic calculations, hit validation, and weapon systems management

    **BACKEND NOTE:** Struct field alignment optimized (large → small types).

    All schemas ordered for optimal memory layout in generated Go code.

    Expected memory savings: 30-50% for shooting-related structs.

    **Features:**

    - Real-time ballistic trajectory calculations (1000+ RPS) - Hit validation and damage processing - Weapon accuracy and
    spread simulation - Anti-cheat validation for shooting mechanics - Performance telemetry collection

    **Performance:** P99 <10ms for ballistic calculations, zero allocations in hot path '
  version: 1.0.0
  license:
    name: Proprietary
    url: https://necpgame.com/license
  contact:
    name: NECPGAME API Support
    url: https://necpgame.com/support
    email: api@combat-shooting.necpgame.com
servers:
- url: http://localhost:8085/api/v1
  description: Combat Shooting Service (development)
- url: https://combat-shooting.necpgame.com/api/v1
  description: Combat Shooting Service (production)
tags:
- name: Ballistics
  description: Ballistic trajectory calculations
- name: Hit Validation
  description: Hit validation and damage processing
- name: Weapon Systems
  description: Weapon accuracy and spread simulation
- name: Anti-Cheat
  description: Shooting anti-cheat validation
- name: Telemetry
  description: Performance telemetry collection
security:
- BearerAuth: []
paths:
  /specialized/combat/shooting/calculate-ballistics:
    post:
      tags:
      - Ballistics
      summary: Calculate ballistic trajectory for weapon shot
      operationId: calculateBallistics
      description: 'Calculate complete ballistic trajectory including gravity, wind, and environmental factors.


        **Performance Requirements:**

        - P99 <10ms response time

        - Zero allocations in hot path

        - Supports 1000+ RPS

        '
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BallisticCalculationRequest'
      responses:
        '200':
          description: Ballistic trajectory calculated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BallisticCalculationResult'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /specialized/combat/shooting/validate-hit:
    post:
      tags:
      - Hit Validation
      summary: Validate and process weapon hit
      operationId: validateHit
      description: 'Validate hit legitimacy, calculate damage, and apply anti-cheat measures.


        **Anti-Cheat Features:**

        - Trajectory validation

        - Hit position verification

        - Damage calculation verification

        - Timestamp validation

        '
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HitValidationRequest'
      responses:
        '200':
          description: Hit validated and processed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HitValidationResult'
        '400':
          description: Invalid hit parameters or anti-cheat violation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /specialized/combat/shooting/weapon-stats/{weapon_id}:
    get:
      tags:
      - Weapon Systems
      summary: Get weapon statistics and performance metrics
      operationId: getWeaponStats
      parameters:
      - name: weapon_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Unique weapon identifier
      responses:
        '200':
          description: Weapon statistics retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeaponStats'
        '404':
          description: Weapon not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /specialized/combat/shooting/telemetry/batch:
    post:
      tags:
      - Telemetry
      summary: Submit batch shooting telemetry data
      operationId: submitShootingTelemetry
      description: 'Submit batch of shooting performance data for analytics and optimization.


        **Data Types:**

        - Ballistic calculation times

        - Hit validation results

        - Weapon accuracy metrics

        - Anti-cheat detections

        '
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ShootingTelemetryBatch'
      responses:
        '200':
          description: Telemetry data processed successfully
        '202':
          description: Telemetry data accepted for processing
        '400':
          description: Invalid telemetry data format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    BallisticCalculationRequest:
      type: object
      required:
      - session_id
      - weapon_id
      - shooter_position
      - target_position
      - timestamp
      properties:
        session_id:
          type: string
          format: uuid
          description: Combat session identifier
        weapon_id:
          type: string
          format: uuid
          description: Weapon configuration identifier
        shooter_position:
          $ref: '#/components/schemas/Vector3'
        target_position:
          $ref: '#/components/schemas/Vector3'
        wind_vector:
          $ref: '#/components/schemas/Vector3'
        timestamp:
          type: integer
          format: int64
          description: Client timestamp for anti-cheat validation
        muzzle_velocity:
          type: number
          format: float
          minimum: 0
          maximum: 2000
          description: Weapon muzzle velocity in m/s
        gravity:
          type: number
          format: float
          default: -9.81
          description: Gravitational acceleration
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory: ~64 bytes/instance.'
    BallisticCalculationResult:
      type: object
      required:
      - trajectory_points
      - impact_point
      - travel_time
      - valid
      properties:
        impact_point:
          $ref: '#/components/schemas/Vector3'
        trajectory_points:
          type: array
          maxItems: 100
          items:
            $ref: '#/components/schemas/Vector3'
          description: Ballistic trajectory points
        damage:
          type: integer
          format: int32
          minimum: 0
          maximum: 1000
          description: Calculated base damage
        travel_time:
          type: number
          format: float
          minimum: 0
          description: Projectile travel time in seconds
        valid:
          type: boolean
          description: Trajectory validity flag
        ricochet:
          type: boolean
          description: Ricochet possibility
        penetration:
          type: boolean
          description: Armor penetration capability
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory: ~48 bytes/instance.'
    HitValidationRequest:
      type: object
      required:
      - session_id
      - shooter_id
      - target_id
      - weapon_id
      - hit_position
      - client_timestamp
      - server_timestamp
      properties:
        session_id:
          type: string
          format: uuid
        shooter_id:
          type: string
          format: uuid
        target_id:
          type: string
          format: uuid
        weapon_id:
          type: string
          format: uuid
        hit_type:
          type: string
          enum:
          - headshot
          - bodyshot
          - limb
          - critical
          description: Type of hit location
        hit_position:
          $ref: '#/components/schemas/Vector3'
        hit_vector:
          $ref: '#/components/schemas/Vector3'
          description: Direction vector of the hit
        client_timestamp:
          type: integer
          format: int64
          description: Client-side timestamp
        server_timestamp:
          type: integer
          format: int64
          description: Server timestamp for validation
        damage_claimed:
          type: integer
          format: int32
          minimum: 0
          maximum: 1000
          description: Damage claimed by client
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory: ~88 bytes/instance.'
    HitValidationResult:
      type: object
      required:
      - valid
      - damage_dealt
      - anti_cheat_score
      properties:
        validation_errors:
          type: array
          items:
            type: string
          description: List of validation errors if any
        damage_dealt:
          type: integer
          format: int32
          minimum: 0
          maximum: 1000
          description: Actual damage dealt
        target_health_remaining:
          type: integer
          format: int32
          minimum: 0
          maximum: 10000
          description: Target remaining health
        anti_cheat_score:
          type: number
          format: float
          minimum: 0
          maximum: 1
          description: Anti-cheat validation score (0-1, higher is better)
        valid:
          type: boolean
          description: Hit validation result
        critical_hit:
          type: boolean
          description: Critical hit multiplier applied
        armor_penetration:
          type: boolean
          description: Armor penetration occurred
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory: ~24 bytes/instance.'
    WeaponStats:
      type: object
      required:
      - weapon_id
      - accuracy_rating
      - damage_rating
      - range_rating
      properties:
        weapon_id:
          type: string
          format: uuid
        weapon_name:
          type: string
          maxLength: 100
        magazine_size:
          type: integer
          format: int32
          minimum: 1
          maximum: 1000
        accuracy_rating:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: Weapon accuracy rating (0-100)
        damage_rating:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: Weapon damage rating (0-100)
        range_rating:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: Weapon range rating (0-100)
        fire_rate:
          type: number
          format: float
          minimum: 0
          description: Rounds per minute
        muzzle_velocity:
          type: number
          format: float
          minimum: 0
          description: Muzzle velocity in m/s
        reload_time:
          type: number
          format: float
          minimum: 0
          description: Reload time in seconds
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory: ~56 bytes/instance.'
    ShootingTelemetryBatch:
      type: object
      required:
      - session_id
      - telemetry_data
      properties:
        session_id:
          type: string
          format: uuid
        player_id:
          type: string
          format: uuid
        telemetry_data:
          type: array
          maxItems: 1000
          items:
            $ref: '#/components/schemas/ShootingTelemetryEntry'
          description: Batch of telemetry entries
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory: ~48 bytes/instance.'
    ShootingTelemetryEntry:
      type: object
      required:
      - timestamp
      - metric_type
      properties:
        weapon_id:
          type: string
          format: uuid
        session_id:
          type: string
          format: uuid
        metric_type:
          type: string
          enum:
          - ballistic_calc_time
          - hit_validation_time
          - accuracy_deviation
          - damage_calculation
          - anti_cheat_score
        metadata:
          type: object
          additionalProperties: true
          description: Additional metric metadata
        timestamp:
          type: integer
          format: int64
        metric_value:
          type: number
          format: float
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory: ~40 bytes/instance.'
    Vector3:
      type: object
      required:
      - x
      - y
      - z
      properties:
        x:
          type: number
          format: float
        y:
          type: number
          format: float
        z:
          type: number
          format: float
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory: ~12 bytes/instance.'
    Error:
      type: object
      required:
      - code
      - message
      properties:
        message:
          type: string
          maxLength: 500
        code:
          type: string
          enum:
          - VALIDATION_ERROR
          - RATE_LIMIT_ERROR
          - INTERNAL_ERROR
          - ANTI_CHEAT_VIOLATION
        timestamp:
          type: string
          format: date-time
        details:
          type: object
          additionalProperties: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory: ~32 bytes/instance.'
