openapi: 3.0.3
info:
  title: Combat System API
  version: 1.0.0
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  description: 'Combat System API for MMOFPS RPG.


    This API provides endpoints for managing combat sessions, player actions,

    weapon systems, damage calculations, and real-time combat state synchronization.


    ## Key Features

    - Real-time combat session management

    - Player action validation and processing

    - Weapon and ability systems

    - Damage calculation and effects

    - Anti-cheat validation

    - Performance monitoring


    ## Performance Requirements

    - Action processing: 1000+ RPS with P99 <25ms

    - Session management: 500+ RPS with P99 <50ms

    - Memory optimized with struct alignment

    - Context timeouts on all operations

    '
servers:
  - url: http://localhost:8100
    description: Local development
  - url: https://api.necpgame.com/v1/combat
    description: Production API
tags:
  - name: sessions
    description: Combat session lifecycle management
  - name: actions
    description: Player combat actions and validation
  - name: weapons
    description: Weapon systems and configurations
  - name: abilities
    description: Player abilities and skills
  - name: damage
    description: Damage calculation and effects
  - name: stats
    description: Combat statistics and analytics
security:
  - BearerAuth: [ ]
paths:
  /health:
    get:
      summary: API health check
      operationId: healthCheck
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum:
                      - healthy
                  version:
                    type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
  /api/v1/combat/sessions:
    post:
      summary: Create new combat session
      operationId: createCombatSession
      tags:
        - sessions
      security:
        - BearerAuth: [ ]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCombatSessionRequest'
      responses:
        '201':
          description: Combat session created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatSession'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
    get:
      summary: List combat sessions
      operationId: listCombatSessions
      tags:
        - sessions
      security:
        - BearerAuth: [ ]
      parameters:
        - name: player_id
          in: query
          schema:
            type: string
            format: uuid
          description: Filter by player ID
        - name: status
          in: query
          schema:
            type: string
            enum:
              - active
              - paused
              - completed
              - failed
          description: Filter by session status
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of sessions to return
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Pagination offset
      responses:
        '200':
          description: Combat sessions retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatSessionListResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/sessions/{session_id}:
    get:
      summary: Get combat session details
      operationId: getCombatSession
      tags:
        - sessions
      security:
        - BearerAuth: [ ]
      parameters:
        - name: session_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Combat session ID
      responses:
        '200':
          description: Combat session details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatSession'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
    patch:
      summary: Update combat session
      operationId: updateCombatSession
      tags:
        - sessions
      security:
        - BearerAuth: [ ]
      parameters:
        - name: session_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Combat session ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCombatSessionRequest'
      responses:
        '200':
          description: Combat session updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatSession'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/sessions/{session_id}/actions:
    post:
      summary: Execute combat action
      operationId: executeCombatAction
      tags:
        - actions
      security:
        - BearerAuth: [ ]
      parameters:
        - name: session_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Combat session ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CombatActionRequest'
      responses:
        '200':
          description: Action executed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatActionResult'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/TooManyRequests'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/sessions/{session_id}/state:
    get:
      summary: Get current combat state
      operationId: getCombatState
      tags:
        - sessions
      security:
        - BearerAuth: [ ]
      parameters:
        - name: session_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Combat session ID
      responses:
        '200':
          description: Current combat state
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatState'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/weapons:
    get:
      summary: List available weapons
      operationId: listWeapons
      tags:
        - weapons
      security:
        - BearerAuth: [ ]
      parameters:
        - name: category
          in: query
          schema:
            type: string
            enum:
              - pistol
              - shotgun
              - rifle
              - sniper
              - smg
              - launcher
              - melee
          description: Filter by weapon category
        - name: tier
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 5
          description: Filter by weapon tier
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of weapons to return
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Pagination offset
      responses:
        '200':
          description: Weapons retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeaponListResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/weapons/{weapon_id}:
    get:
      summary: Get weapon details
      operationId: getWeapon
      tags:
        - weapons
      security:
        - BearerAuth: [ ]
      parameters:
        - name: weapon_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Weapon ID
      responses:
        '200':
          description: Weapon details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Weapon'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/abilities:
    get:
      summary: List player abilities
      operationId: listAbilities
      tags:
        - abilities
      security:
        - BearerAuth: [ ]
      parameters:
        - name: player_id
          in: query
          schema:
            type: string
            format: uuid
          description: Filter by player ID
        - name: category
          in: query
          schema:
            type: string
            enum:
              - offensive
              - defensive
              - mobility
              - utility
          description: Filter by ability category
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of abilities to return
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Pagination offset
      responses:
        '200':
          description: Abilities retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AbilityListResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/abilities/{ability_id}/activate:
    post:
      summary: Activate ability
      operationId: activateAbility
      tags:
        - abilities
      security:
        - BearerAuth: [ ]
      parameters:
        - name: ability_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Ability ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AbilityActivationRequest'
      responses:
        '200':
          description: Ability activated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AbilityActivationResult'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/TooManyRequests'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/stats/player/{player_id}:
    get:
      summary: Get player combat statistics
      operationId: getPlayerCombatStats
      tags:
        - stats
      security:
        - BearerAuth: [ ]
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Player ID
        - name: period
          in: query
          schema:
            type: string
            enum:
              - day
              - week
              - month
              - all
            default: all
          description: Time period for statistics
      responses:
        '200':
          description: Player combat statistics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerCombatStats'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            type: object
            required:
              - error
            properties:
              error:
                type: string
                example: Invalid request parameters
    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            type: object
            required:
              - error
            properties:
              error:
                type: string
                example: Authentication required
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            type: object
            required:
              - error
            properties:
              error:
                type: string
                example: Resource not found
    TooManyRequests:
      description: Too many requests
      content:
        application/json:
          schema:
            type: object
            required:
              - error
            properties:
              error:
                type: string
                example: Rate limit exceeded
    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            type: object
            required:
              - error
            properties:
              error:
                type: string
                example: Internal server error
  schemas:
    CombatSession:
      type: object
      required:
        - id
        - player_id
        - status
        - created_at
      properties:
        id:
          type: string
          format: uuid
          description: Combat session unique identifier
        player_id:
          type: string
          format: uuid
          description: Primary player who initiated the session
        zone_id:
          type: string
          format: uuid
          description: Zone where combat takes place
        mission_id:
          type: string
          format: uuid
          description: Associated mission or quest
        description:
          type: string
          description: Session description or mission name
        status:
          type: string
          enum:
            - preparing
            - active
            - paused
            - completed
            - failed
            - terminated
          description: Current session status
        difficulty:
          type: string
          enum:
            - easy
            - normal
            - hard
            - nightmare
          description: Combat difficulty level
        game_mode:
          type: string
          enum:
            - solo
            - coop
            - pvp
            - arena
          description: Combat game mode
        created_at:
          type: string
          format: date-time
        started_at:
          type: string
          format: date-time
        ended_at:
          type: string
          format: date-time
        last_activity:
          type: string
          format: date-time
        rewards:
          $ref: '#/components/schemas/CombatRewards'
        session_config:
          $ref: '#/components/schemas/CombatSessionConfig'
        statistics:
          $ref: '#/components/schemas/CombatStatistics'
        participants:
          type: array
          items:
            $ref: '#/components/schemas/CombatParticipant'
        combat_log:
          type: array
          items:
            $ref: '#/components/schemas/CombatLogEntry'
        max_participants:
          type: integer
          minimum: 1
          maximum: 50
          description: Maximum number of participants
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CombatActionRequest:
      type: object
      required:
        - action_type
        - timestamp
      properties:
        target_id:
          type: string
          format: uuid
          description: Target participant ID
        weapon_id:
          type: string
          format: uuid
          description: Weapon to use
        ability_id:
          type: string
          format: uuid
          description: Ability to activate
        action_type:
          type: string
          enum:
            - move
            - attack
            - ability
            - reload
            - interact
            - surrender
          description: Type of combat action
        timestamp:
          type: string
          format: date-time
          description: Client timestamp
        parameters:
          type: object
          description: Action-specific parameters
        target_position:
          $ref: '#/components/schemas/Vector3'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Vector3:
      type: object
      required:
        - x
        - y
        - z
      properties:
        x:
          type: number
          format: float
          description: X coordinate
        y:
          type: number
          format: float
          description: Y coordinate
        z:
          type: number
          format: float
          description: Z coordinate
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CombatSessionConfig:
      type: object
      properties:
        time_limit:
          type: integer
          minimum: 0
        respawn_enabled:
          type: boolean
          default: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CombatParticipant:
      type: object
      required:
        - id
        - type
        - joined_at
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        type:
          type: string
          enum:
            - player
            - npc
            - enemy
        joined_at:
          type: string
          format: date-time
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CombatLogEntry:
      type: object
      required:
        - timestamp
        - action_type
        - participant_id
      properties:
        participant_id:
          type: string
          format: uuid
        action_type:
          type: string
          enum:
            - damage_dealt
            - damage_taken
            - ability_used
        timestamp:
          type: string
          format: date-time
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CombatRewards:
      type: object
      properties:
        experience:
          type: integer
          minimum: 0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CombatStatistics:
      type: object
      properties:
        duration_seconds:
          type: integer
          minimum: 0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CombatActionResult:
      type: object
      required:
        - success
        - timestamp
      properties:
        action_id:
          type: string
          format: uuid
        timestamp:
          type: string
          format: date-time
        success:
          type: boolean
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CombatState:
      type: object
      required:
        - session_id
        - timestamp
        - participants
      properties:
        session_id:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - preparing
            - active
            - paused
        timestamp:
          type: string
          format: date-time
        participants:
          type: array
          items:
            $ref: '#/components/schemas/CombatParticipant'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CreateCombatSessionRequest:
      type: object
      required:
        - player_id
        - zone_id
      properties:
        player_id:
          type: string
          format: uuid
        zone_id:
          type: string
          format: uuid
        difficulty:
          type: string
          enum:
            - easy
            - normal
            - hard
            - nightmare
          default: normal
        game_mode:
          type: string
          enum:
            - solo
            - coop
            - pvp
            - arena
          default: solo
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    UpdateCombatSessionRequest:
      type: object
      properties:
        status:
          type: string
          enum:
            - active
            - paused
            - terminated
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CombatSessionListResponse:
      type: object
      required:
        - sessions
        - total
      properties:
        sessions:
          type: array
          items:
            $ref: '#/components/schemas/CombatSession'
        total:
          type: integer
          minimum: 0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    WeaponListResponse:
      type: object
      required:
        - weapons
        - total
      properties:
        weapons:
          type: array
          items:
            $ref: '#/components/schemas/Weapon'
        total:
          type: integer
          minimum: 0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Weapon:
      type: object
      required:
        - id
        - name
        - category
        - tier
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        category:
          type: string
          enum:
            - pistol
            - shotgun
            - rifle
            - sniper
            - smg
        tier:
          type: integer
          minimum: 1
          maximum: 5
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    AbilityListResponse:
      type: object
      required:
        - abilities
        - total
      properties:
        abilities:
          type: array
          items:
            $ref: '#/components/schemas/Ability'
        total:
          type: integer
          minimum: 0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Ability:
      type: object
      required:
        - id
        - name
        - category
        - cooldown_ms
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        category:
          type: string
          enum:
            - offensive
            - defensive
            - mobility
            - utility
        cooldown_ms:
          type: integer
          minimum: 100
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    AbilityActivationRequest:
      type: object
      properties:
        target_id:
          type: string
          format: uuid
        target_position:
          $ref: '#/components/schemas/Vector3'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    AbilityActivationResult:
      type: object
      required:
        - success
        - timestamp
      properties:
        timestamp:
          type: string
          format: date-time
        success:
          type: boolean
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    PlayerCombatStats:
      type: object
      required:
        - player_id
        - period
      properties:
        player_id:
          type: string
          format: uuid
        period:
          type: string
          enum:
            - day
            - week
            - month
            - all
        total_kills:
          type: integer
          minimum: 0
        total_deaths:
          type: integer
          minimum: 0
        accuracy_percentage:
          type: number
          format: float
          minimum: 0.0
          maximum: 100.0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
