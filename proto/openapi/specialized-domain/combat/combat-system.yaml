openapi: 3.0.3
info:
  title: Combat System API
  version: 1.0.0
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  description: 'Combat System API for MMOFPS RPG.


    This API provides endpoints for managing combat sessions, player actions,

    weapon systems, damage calculations, and real-time combat state synchronization.


    ## Key Features

    - Real-time combat session management

    - Player action validation and processing

    - Weapon and ability systems

    - Damage calculation and effects

    - Anti-cheat validation

    - Performance monitoring


    ## Performance Requirements

    - Action processing: 1000+ RPS with P99 <25ms

    - Session management: 500+ RPS with P99 <50ms

    - Memory optimized with struct alignment

    - Context timeouts on all operations

    '
servers:
- url: http://localhost:8100
  description: Local development
- url: https://api.necpgame.com/v1/combat
  description: Production API
tags:
- name: sessions
  description: Combat session lifecycle management
- name: actions
  description: Player combat actions and validation
- name: weapons
  description: Weapon systems and configurations
- name: abilities
  description: Player abilities and skills
- name: damage
  description: Damage calculation and effects
- name: stats
  description: Combat statistics and analytics
security:
- BearerAuth: []
paths:
  /health:
    get:
      summary: API health check
      operationId: healthCheck
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum:
                    - healthy
                  version:
                    type: string
        '401':
          $ref: '#/components/responses/Unauthorized'
  /api/v1/combat/sessions:
    post:
      summary: Create new combat session
      operationId: createCombatSession
      tags:
      - sessions
      security:
      - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCombatSessionRequest'
      responses:
        '201':
          description: Combat session created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatSession'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
    get:
      summary: List combat sessions
      operationId: listCombatSessions
      tags:
      - sessions
      security:
      - BearerAuth: []
      parameters:
      - name: player_id
        in: query
        schema:
          type: string
          format: uuid
        description: Filter by player ID
      - name: status
        in: query
        schema:
          type: string
          enum:
          - active
          - paused
          - completed
          - failed
        description: Filter by session status
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
        description: Number of sessions to return
      - name: offset
        in: query
        schema:
          type: integer
          minimum: 0
          default: 0
        description: Pagination offset
      responses:
        '200':
          description: Combat sessions retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatSessionListResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/sessions/{session_id}:
    get:
      summary: Get combat session details
      operationId: getCombatSession
      tags:
      - sessions
      security:
      - BearerAuth: []
      parameters:
      - name: session_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Combat session ID
      responses:
        '200':
          description: Combat session details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatSession'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
    patch:
      summary: Update combat session
      operationId: updateCombatSession
      tags:
      - sessions
      security:
      - BearerAuth: []
      parameters:
      - name: session_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Combat session ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCombatSessionRequest'
      responses:
        '200':
          description: Combat session updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatSession'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/sessions/{session_id}/actions:
    post:
      summary: Execute combat action
      operationId: executeCombatAction
      tags:
      - actions
      security:
      - BearerAuth: []
      parameters:
      - name: session_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Combat session ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CombatActionRequest'
      responses:
        '200':
          description: Action executed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatActionResult'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/TooManyRequests'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/sessions/{session_id}/state:
    get:
      summary: Get current combat state
      operationId: getCombatState
      tags:
      - sessions
      security:
      - BearerAuth: []
      parameters:
      - name: session_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Combat session ID
      responses:
        '200':
          description: Current combat state
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatState'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/weapons:
    get:
      summary: List available weapons
      operationId: listWeapons
      tags:
      - weapons
      security:
      - BearerAuth: []
      parameters:
      - name: category
        in: query
        schema:
          type: string
          enum:
          - pistol
          - shotgun
          - rifle
          - sniper
          - smg
          - launcher
          - melee
        description: Filter by weapon category
      - name: tier
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 5
        description: Filter by weapon tier
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
        description: Number of weapons to return
      - name: offset
        in: query
        schema:
          type: integer
          minimum: 0
          default: 0
        description: Pagination offset
      responses:
        '200':
          description: Weapons retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeaponListResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/weapons/{weapon_id}:
    get:
      summary: Get weapon details
      operationId: getWeapon
      tags:
      - weapons
      security:
      - BearerAuth: []
      parameters:
      - name: weapon_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Weapon ID
      responses:
        '200':
          description: Weapon details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Weapon'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/abilities:
    get:
      summary: List player abilities
      operationId: listAbilities
      tags:
      - abilities
      security:
      - BearerAuth: []
      parameters:
      - name: player_id
        in: query
        schema:
          type: string
          format: uuid
        description: Filter by player ID
      - name: category
        in: query
        schema:
          type: string
          enum:
          - offensive
          - defensive
          - mobility
          - utility
        description: Filter by ability category
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
        description: Number of abilities to return
      - name: offset
        in: query
        schema:
          type: integer
          minimum: 0
          default: 0
        description: Pagination offset
      responses:
        '200':
          description: Abilities retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AbilityListResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/abilities/{ability_id}/activate:
    post:
      summary: Activate ability
      operationId: activateAbility
      tags:
      - abilities
      security:
      - BearerAuth: []
      parameters:
      - name: ability_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Ability ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AbilityActivationRequest'
      responses:
        '200':
          description: Ability activated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AbilityActivationResult'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/TooManyRequests'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/combat/stats/player/{player_id}:
    get:
      summary: Get player combat statistics
      operationId: getPlayerCombatStats
      tags:
      - stats
      security:
      - BearerAuth: []
      parameters:
      - name: player_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Player ID
      - name: period
        in: query
        schema:
          type: string
          enum:
          - day
          - week
          - month
          - all
          default: all
        description: Time period for statistics
      responses:
        '200':
          description: Player combat statistics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerCombatStats'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            type: object
            required:
            - error
            properties:
              error:
                type: string
                example: Invalid request parameters
    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            type: object
            required:
            - error
            properties:
              error:
                type: string
                example: Authentication required
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            type: object
            required:
            - error
            properties:
              error:
                type: string
                example: Resource not found
    TooManyRequests:
      description: Too many requests
      content:
        application/json:
          schema:
            type: object
            required:
            - error
            properties:
              error:
                type: string
                example: Rate limit exceeded
    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            type: object
            required:
            - error
            properties:
              error:
                type: string
                example: Internal server error
  schemas:
    $ref: ./combat-system-schemas.yaml#/components/schemas
