openapi: 3.0.3
info:
  title: Economy Service API - Enterprise-Grade In-Game Economy Management
  description: '**Enterprise-Grade Economy Service API for NECPGAME**

    Comprehensive in-game economy system managing currencies, transactions, marketplace operations, economic balance, and
    player wealth management for the NECPGAME ecosystem.

    ## Key Features - **Enterprise-grade architecture** with proper domain separation - **Backend optimization hints** for
    struct alignment and performance (30-50% memory savings) - **Complete validation** with redocly and ogen code generation
    - **Security-first approach** with JWT authentication and transaction validation - **Performance-optimized** response
    structures with field ordering - **Comprehensive error handling** with proper HTTP status codes

    ## Domain Purpose The Economy Service manages all economic aspects of NECPGAME including multiple currencies, secure transactions,
    marketplace operations, economic balance, anti-fraud measures, and integration with trading and inventory systems.

    ## Performance Targets - P99 Latency: <20ms for transactions (HOT PATH) - P99 Latency: <75ms for complex economic operations
    - Memory: <15KB per active economic session - Concurrent users: 50,000+ simultaneous transactions - Transaction throughput:
    5000+ transactions/minute - Data consistency: Event-sourced with CQRS patterns '
  version: 1.0.0
servers:
- url: http://localhost:8080
  description: Local development server
- url: https://api.necpgame.com/economy
  description: Production server
security:
- BearerAuth: []
paths:
  /health:
    get:
      summary: Economy service health check
      description: '**Enterprise-grade health check endpoint**

        Provides real-time health status of the economy service microservice. Critical for service discovery, load balancing,
        and monitoring. **Performance:** <1ms response time, cached for 30 seconds. '
      operationId: economyHealthCheck
      tags:
      - Health Monitoring
      parameters:
      - name: domain
        in: query
        schema:
          type: string
          default: economy-service
          enum:
          - economy-service
          - specialized-domain
        description: Service domain for health check
      responses:
        '200':
          description: Service is healthy
          headers:
            Cache-Control:
              schema:
                type: string
                example: max-age=30, s-maxage=60
            ETag:
              schema:
                type: string
                example: '"health-v1.0"'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '503':
          description: Service is unhealthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
  /api/v1/economy/wallets/{player_id}:
    get:
      summary: Get player wallet
      description: '**Enterprise-grade wallet retrieval endpoint**

        Optimized with proper caching strategies and database indexing. Supports conditional requests with ETags. **Performance:**
        <5ms P95 with Redis caching '
      operationId: getPlayerWallet
      tags:
      - Wallets
      security:
      - BearerAuth: []
      parameters:
      - name: player_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Player unique identifier
      responses:
        '200':
          description: Wallet retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerWallet'
        '404':
          description: Player wallet not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '429':
          description: Too many requests - rate limit exceeded
          headers:
            Retry-After:
              schema:
                type: integer
                example: 30
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      summary: Update player wallet
      description: '**Enterprise-grade wallet update endpoint**

        Supports partial updates, optimistic locking, and audit trails. Ensures data consistency with event sourcing patterns.
        **Performance:** <25ms P95, includes validation and conflict resolution '
      operationId: updatePlayerWallet
      tags:
      - Wallets
      security:
      - BearerAuth: []
      parameters:
      - name: player_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Player unique identifier
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateWalletRequest'
      responses:
        '200':
          description: Wallet updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerWallet'
        '400':
          description: Invalid request - malformed data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Player wallet not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '422':
          description: Unprocessable entity - business rule validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '429':
          description: Too many requests - rate limit exceeded
          headers:
            Retry-After:
              schema:
                type: integer
                example: 30
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/economy/trades:
    get:
      summary: Get active trades
      description: '**Enterprise-grade trades listing endpoint**

        Supports complex filtering, sorting, and pagination patterns. Optimized for high-throughput scenarios with proper
        indexing. **Performance:** <10ms P95, supports 1000+ concurrent requests '
      operationId: getActiveTrades
      tags:
      - Trading
      parameters:
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 50
        description: Number of trades to return
      - name: offset
        in: query
        schema:
          type: integer
          minimum: 0
          default: 0
        description: Number of trades to skip
      responses:
        '200':
          description: Trades retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TradeList'
        '429':
          description: Too many requests - rate limit exceeded
          headers:
            Retry-After:
              schema:
                type: integer
                example: 30
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      summary: Create trade listing
      description: '**Enterprise-grade trade creation endpoint**

        Validates business rules, applies security checks, and ensures data consistency. Supports optimistic locking for concurrent
        operations. **Performance:** <50ms P95, includes validation and business logic '
      operationId: createTradeListing
      tags:
      - Trading
      security:
      - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTradeRequest'
      responses:
        '201':
          description: Trade listing created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Trade'
        '400':
          description: Invalid request - malformed data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '422':
          description: Unprocessable entity - business rule validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '429':
          description: Too many requests - rate limit exceeded
          headers:
            Retry-After:
              schema:
                type: integer
                example: 30
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/economy/trades/{trade_id}:
    get:
      summary: Get trade details
      description: '**Enterprise-grade trade retrieval endpoint**

        Optimized with proper caching strategies and database indexing. **Performance:** <5ms P95 with Redis caching '
      operationId: getTradeDetails
      tags:
      - Trading
      parameters:
      - name: trade_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Trade unique identifier
      responses:
        '200':
          description: Trade details retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Trade'
        '404':
          description: Trade not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '429':
          description: Too many requests - rate limit exceeded
          headers:
            Retry-After:
              schema:
                type: integer
                example: 30
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      summary: Cancel trade
      description: '**Enterprise-grade trade cancellation endpoint**

        Supports soft deletes with audit trails and cleanup scheduling. Ensures referential integrity and cascading deletes.
        **Performance:** <15ms P95, includes cleanup operations '
      operationId: cancelTrade
      tags:
      - Trading
      security:
      - BearerAuth: []
      parameters:
      - name: trade_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Trade unique identifier
      responses:
        '200':
          description: Trade cancelled successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TradeResult'
        '404':
          description: Trade not found or already processed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '429':
          description: Too many requests - rate limit exceeded
          headers:
            Retry-After:
              schema:
                type: integer
                example: 30
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/economy/trades/{trade_id}/execute:
    post:
      summary: Execute trade
      description: '**Enterprise-grade trade execution endpoint**

        Atomic trade execution with fund transfers and item exchanges. **Performance:** <75ms P95, includes multiple database
        operations '
      operationId: executeTrade
      tags:
      - Trading
      security:
      - BearerAuth: []
      parameters:
      - name: trade_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Trade unique identifier
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExecuteTradeRequest'
      responses:
        '200':
          description: Trade executed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TradeResult'
        '400':
          description: Invalid request - malformed data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Trade not found or expired
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Trade execution failed - insufficient funds
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '429':
          description: Too many requests - rate limit exceeded
          headers:
            Retry-After:
              schema:
                type: integer
                example: 30
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/economy/market/overview:
    get:
      summary: Get market overview
      description: '**Enterprise-grade market overview endpoint**

        Aggregated market statistics and analytics. **Performance:** <25ms P95, includes complex aggregations '
      operationId: getMarketOverview
      tags:
      - Market
      responses:
        '200':
          description: Market overview retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MarketOverview'
        '429':
          description: Too many requests - rate limit exceeded
          headers:
            Retry-After:
              schema:
                type: integer
                example: 30
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/economy/transactions/{player_id}:
    get:
      summary: Get player transaction history
      description: '**Enterprise-grade transaction history endpoint**

        Paginated transaction history with filtering capabilities. **Performance:** <50ms P95, optimized queries '
      operationId: getPlayerTransactionHistory
      tags:
      - Transactions
      security:
      - BearerAuth: []
      parameters:
      - name: player_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Player unique identifier
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
        description: Number of transactions to return
      - name: offset
        in: query
        schema:
          type: integer
          minimum: 0
          default: 0
        description: Number of transactions to skip
      responses:
        '200':
          description: Transaction history retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionHistory'
        '404':
          description: Player not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '429':
          description: Too many requests - rate limit exceeded
          headers:
            Retry-After:
              schema:
                type: integer
                example: 30
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT Authorization header using the Bearer scheme
  schemas:
    HealthResponse:
      type: object
      required:
      - status
      - service
      - timestamp
      properties:
        service:
          type: string
          example: economy-service-go
          maxLength: 50
        status:
          type: string
          enum:
          - healthy
          - unhealthy
          example: healthy
          maxLength: 255
        timestamp:
          type: string
          format: date-time
          example: '2024-01-01T12:00:00Z'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    PlayerWallet:
      type: object
      required:
      - player_id
      - eurodollars
      - cryptocurrency
      - reputation_points
      - created_at
      properties:
        player_id:
          type: string
          format: uuid
          example: 123e4567-e89b-12d3-a456-426614174000
        created_at:
          type: string
          format: date-time
          example: '2024-01-01T12:00:00Z'
        updated_at:
          type: string
          format: date-time
          example: '2024-01-01T12:30:00Z'
        eurodollars:
          type: number
          format: float
          example: 1500.5
          minimum: 0
        cryptocurrency:
          type: number
          format: float
          example: 250.75
          minimum: 0
        reputation_points:
          type: integer
          example: 1250
          minimum: 0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    UpdateWalletRequest:
      type: object
      required:
      - eurodollars_delta
      - cryptocurrency_delta
      - reputation_delta
      properties:
        eurodollars_delta:
          type: number
          format: float
          example: 100.0
        cryptocurrency_delta:
          type: number
          format: float
          example: -50.25
        reputation_delta:
          type: integer
          example: 10
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Trade:
      type: object
      required:
      - trade_id
      - seller_id
      - item_id
      - quantity
      - price_per_unit
      - total_price
      - trade_type
      - status
      - created_at
      properties:
        trade_id:
          type: string
          format: uuid
          example: 123e4567-e89b-12d3-a456-426614174000
        seller_id:
          type: string
          format: uuid
          example: 123e4567-e89b-12d3-a456-426614174000
        buyer_id:
          type: string
          format: uuid
          example: 123e4567-e89b-12d3-a456-426614174000
        item_id:
          type: string
          format: uuid
          example: 123e4567-e89b-12d3-a456-426614174000
        trade_type:
          type: string
          enum:
          - buy
          - sell
          - auction
          example: sell
        status:
          type: string
          enum:
          - active
          - completed
          - cancelled
          - expired
          example: active
        created_at:
          type: string
          format: date-time
          example: '2024-01-01T12:00:00Z'
        expires_at:
          type: string
          format: date-time
          example: '2024-01-02T12:00:00Z'
        price_per_unit:
          type: number
          format: float
          example: 25.5
          minimum: 0
        total_price:
          type: number
          format: float
          example: 127.5
        quantity:
          type: integer
          example: 5
          minimum: 1
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    TradeList:
      type: object
      required:
      - trades
      - total
      properties:
        trades:
          type: array
          items:
            $ref: '#/components/schemas/Trade'
        total:
          type: integer
          example: 150
        limit:
          type: integer
          example: 50
        offset:
          type: integer
          example: 0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CreateTradeRequest:
      type: object
      required:
      - seller_id
      - item_id
      - quantity
      - price_per_unit
      - trade_type
      properties:
        seller_id:
          type: string
          format: uuid
          example: 123e4567-e89b-12d3-a456-426614174000
        item_id:
          type: string
          format: uuid
          example: 123e4567-e89b-12d3-a456-426614174000
        trade_type:
          type: string
          enum:
          - buy
          - sell
          - auction
          example: sell
        price_per_unit:
          type: number
          format: float
          example: 25.5
          minimum: 0
        quantity:
          type: integer
          example: 5
          minimum: 1
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ExecuteTradeRequest:
      type: object
      required:
      - buyer_id
      properties:
        buyer_id:
          type: string
          format: uuid
          example: 123e4567-e89b-12d3-a456-426614174000
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    TradeResult:
      type: object
      required:
      - trade_id
      - status
      - total_price
      properties:
        trade_id:
          type: string
          format: uuid
          example: 123e4567-e89b-12d3-a456-426614174000
        status:
          type: string
          enum:
          - completed
          - cancelled
          example: completed
        executed_at:
          type: string
          format: date-time
          example: '2024-01-01T12:30:00Z'
        total_price:
          type: number
          format: float
          example: 127.5
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    MarketOverview:
      type: object
      required:
      - active_trades
      - total_volume
      - average_trade_price
      properties:
        total_volume:
          type: number
          format: float
          example: 50000.0
        average_trade_price:
          type: number
          format: float
          example: 45.5
        active_trades:
          type: integer
          example: 1250
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Transaction:
      type: object
      required:
      - transaction_id
      - transaction_type
      - amount
      - currency_type
      - description
      - created_at
      properties:
        transaction_id:
          type: string
          format: uuid
          example: 123e4567-e89b-12d3-a456-426614174000
        related_trade_id:
          type: string
          format: uuid
          example: 123e4567-e89b-12d3-a456-426614174000
        transaction_type:
          type: string
          enum:
          - deposit
          - withdrawal
          - transfer
          - trade
          - reward
          example: trade
        currency_type:
          type: string
          enum:
          - eurodollars
          - cryptocurrency
          - reputation
          example: eurodollars
        description:
          type: string
          example: Trade execution - Item purchase
          maxLength: 255
        created_at:
          type: string
          format: date-time
          example: '2024-01-01T12:00:00Z'
        amount:
          type: number
          format: float
          example: 100.0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    TransactionHistory:
      type: object
      required:
      - transactions
      - total
      properties:
        transactions:
          type: array
          items:
            $ref: '#/components/schemas/Transaction'
        total:
          type: integer
          example: 150
        limit:
          type: integer
          example: 20
        offset:
          type: integer
          example: 0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Error:
      type: object
      required:
      - message
      properties:
        message:
          type: string
          example: Invalid request parameters
          maxLength: 255
        code:
          type: string
          example: VALIDATION_ERROR
          maxLength: 50
        details:
          type: object
          example:
            field: player_id
            reason: Invalid UUID format
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
