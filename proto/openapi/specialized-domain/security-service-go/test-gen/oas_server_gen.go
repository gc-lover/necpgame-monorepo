// Code generated by ogen, DO NOT EDIT.

package api

import (
	"context"
)

// Handler handles operations described by OpenAPI v3 specification.
type Handler interface {
	// AuthenticateUser implements authenticateUser operation.
	//
	// **JWT-based user authentication**
	// Authenticates user credentials and returns access/refresh tokens.
	// Includes security monitoring and rate limiting.
	// **Performance:** <20ms average, <50ms P99 **Rate Limit:** 5 attempts per minute per IP.
	//
	// POST /auth/login
	AuthenticateUser(ctx context.Context, req *LoginRequest) (AuthenticateUserRes, error)
	// CheckPermission implements checkPermission operation.
	//
	// **Fine-grained permission validation**
	// Validates if current user has specific permission.
	// Used for API-level authorization decisions.
	// **Performance:** <2ms average, bloom filter lookup.
	//
	// POST /auth/check-permission
	CheckPermission(ctx context.Context, req *CheckPermissionRequest) (CheckPermissionRes, error)
	// GetSecurityThreats implements getSecurityThreats operation.
	//
	// **Security threat monitoring dashboard**
	// Retrieves security threats with filtering and pagination.
	// Requires security.threats.read permission or admin role.
	// **Performance:** <100ms for large result sets.
	//
	// GET /security/threats
	GetSecurityThreats(ctx context.Context, params GetSecurityThreatsParams) (GetSecurityThreatsRes, error)
	// GetUserPermissions implements getUserPermissions operation.
	//
	// **Retrieve user permissions and roles**
	// Returns current user's roles and permissions for authorization.
	// Used by frontend and other services for UI rendering and access control.
	// **Performance:** <5ms average, cached for 5 minutes.
	//
	// GET /auth/permissions
	GetUserPermissions(ctx context.Context) (GetUserPermissionsRes, error)
	// LogoutUser implements logoutUser operation.
	//
	// **Secure user logout**
	// Invalidates access token and clears session data.
	// Logs logout event for audit purposes.
	// **Performance:** <5ms average.
	//
	// POST /auth/logout
	LogoutUser(ctx context.Context) (LogoutUserRes, error)
	// RefreshToken implements refreshToken operation.
	//
	// **JWT token refresh**
	// Exchanges refresh token for new access/refresh token pair.
	// Validates refresh token and generates new tokens.
	// **Performance:** <10ms average.
	//
	// POST /auth/refresh
	RefreshToken(ctx context.Context, req *RefreshTokenRequest) (RefreshTokenRes, error)
	// SecurityHealthCheck implements securityHealthCheck operation.
	//
	// **Enterprise-grade health check endpoint**
	// Provides real-time health status of the security microservice.
	// Critical for service discovery, load balancing, and monitoring.
	// **Performance:** <1ms response time, cached for 30 seconds.
	//
	// GET /health
	SecurityHealthCheck(ctx context.Context) (SecurityHealthCheckRes, error)
	// SecurityReadinessCheck implements securityReadinessCheck operation.
	//
	// **Kubernetes readiness probe endpoint**
	// Verifies that the service is ready to accept traffic.
	// Checks database connectivity and critical dependencies.
	// **Performance:** <5ms response time.
	//
	// GET /ready
	SecurityReadinessCheck(ctx context.Context) (SecurityReadinessCheckRes, error)
	// ValidateGameAction implements validateGameAction operation.
	//
	// **Anti-cheat game action validation**
	// Validates player actions for cheating patterns.
	// Uses ML models and statistical analysis for detection.
	// **Performance:** <50ms P99, batched processing **Rate Limit:** 1000 validations per second per user.
	//
	// POST /anticheat/validate
	ValidateGameAction(ctx context.Context, req *ValidateGameActionRequest) (ValidateGameActionRes, error)
}

// Server implements http server based on OpenAPI v3 specification and
// calls Handler to handle requests.
type Server struct {
	h   Handler
	sec SecurityHandler
	baseServer
}

// NewServer creates new Server.
func NewServer(h Handler, sec SecurityHandler, opts ...ServerOption) (*Server, error) {
	s, err := newServerConfig(opts...).baseServer()
	if err != nil {
		return nil, err
	}
	return &Server{
		h:          h,
		sec:        sec,
		baseServer: s,
	}, nil
}
