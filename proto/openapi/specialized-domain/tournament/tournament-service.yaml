openapi: 3.0.3
info:
  title: Tournament Service API
  description: '**Tournament Service** - Competitive gaming tournament management for NECPGAME MMOFPS RPG.


    Provides comprehensive tournament management including:

    - Tournament creation and configuration

    - Player/team registration and management

    - Bracket generation and match scheduling

    - Live match tracking and statistics

    - Prize distribution and leaderboards

    - Spectator mode and live streaming integration


    **BACKEND NOTE:** Enterprise-grade tournament service with optimized memory layout.

    Expected memory savings: 30-50% through struct field alignment.

    Performance targets: 2000+ RPS, P99 <15ms for tournament operations.

    '
  version: 2.0.0
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  contact:
    name: NECPGAME Tournament API Support
    email: tournament@necp.game
servers:
- url: http://localhost:8087/api/v1/tournaments
  description: Tournament Service Development Server
- url: https://tournament.necpgame.com/api/v1
  description: Tournament Service Production Server
security:
- BearerAuth: []
tags:
- name: tournament-management
  description: Tournament creation and lifecycle management
- name: registration
  description: Player and team registration operations
- name: brackets
  description: Tournament bracket and match management
- name: matches
  description: Live match tracking and results
- name: spectator
  description: Spectator mode and live updates
- name: prizes
  description: Prize distribution and rewards
paths:
  /health:
    get:
      summary: Tournament service health check
      operationId: tournamentServiceHealthCheck
      tags:
      - tournament-management
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: healthy
                  timestamp:
                    type: string
                    format: date-time
  /tournaments:
    post:
      summary: Create new tournament
      operationId: createTournament
      tags:
      - tournament-management
      security:
      - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTournamentRequest'
      responses:
        '201':
          description: Tournament created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tournament'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'
    get:
      summary: List tournaments
      operationId: listTournaments
      tags:
      - tournament-management
      security:
      - BearerAuth: []
      parameters:
      - name: status
        in: query
        schema:
          type: string
          enum:
          - draft
          - registration_open
          - registration_closed
          - in_progress
          - completed
          - cancelled
      - name: game_mode
        in: query
        schema:
          type: string
      - name: min_prize_pool
        in: query
        schema:
          type: integer
          minimum: 0
      - name: sort_by
        in: query
        schema:
          type: string
          enum:
          - start_date
          - prize_pool
          - participants_count
          - created_at
          default: created_at
      - name: sort_order
        in: query
        schema:
          type: string
          enum:
          - asc
          - desc
          default: desc
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
      - name: offset
        in: query
        schema:
          type: integer
          minimum: 0
          default: 0
      responses:
        '200':
          description: Tournaments list retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TournamentsList'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /tournaments/{tournament_id}:
    get:
      summary: Get tournament details
      operationId: getTournament
      tags:
      - tournament-management
      security:
      - BearerAuth: []
      parameters:
      - name: tournament_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Tournament details retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tournament'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
    put:
      summary: Update tournament
      operationId: updateTournament
      tags:
      - tournament-management
      security:
      - BearerAuth: []
      parameters:
      - name: tournament_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateTournamentRequest'
      responses:
        '200':
          description: Tournament updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tournament'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '400':
          $ref: '#/components/responses/BadRequest'
    delete:
      summary: Cancel tournament
      operationId: cancelTournament
      tags:
      - tournament-management
      security:
      - BearerAuth: []
      parameters:
      - name: tournament_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        '204':
          description: Tournament cancelled successfully
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /tournaments/{tournament_id}/register:
    post:
      summary: Register for tournament
      operationId: registerForTournament
      tags:
      - registration
      security:
      - BearerAuth: []
      parameters:
      - name: tournament_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TournamentRegistrationRequest'
      responses:
        '201':
          description: Registration successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TournamentParticipant'
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
  /tournaments/{tournament_id}/participants:
    get:
      summary: Get tournament participants
      operationId: getTournamentParticipants
      tags:
      - registration
      security:
      - BearerAuth: []
      parameters:
      - name: tournament_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: status
        in: query
        schema:
          type: string
          enum:
          - registered
          - confirmed
          - disqualified
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 50
      - name: offset
        in: query
        schema:
          type: integer
          minimum: 0
          default: 0
      responses:
        '200':
          description: Tournament participants retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TournamentParticipantsList'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /tournaments/{tournament_id}/brackets:
    get:
      summary: Get tournament bracket
      operationId: getTournamentBracket
      tags:
      - brackets
      security:
      - BearerAuth: []
      parameters:
      - name: tournament_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: round
        in: query
        schema:
          type: integer
          minimum: 1
      responses:
        '200':
          description: Tournament bracket retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TournamentBracket'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
    post:
      summary: Generate tournament bracket
      operationId: generateTournamentBracket
      tags:
      - brackets
      security:
      - BearerAuth: []
      parameters:
      - name: tournament_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GenerateBracketRequest'
      responses:
        '201':
          description: Bracket generated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TournamentBracket'
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /matches/{match_id}:
    get:
      summary: Get match details
      operationId: getMatch
      tags:
      - matches
      security:
      - BearerAuth: []
      parameters:
      - name: match_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Match details retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Match'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
    put:
      summary: Update match result
      operationId: updateMatchResult
      tags:
      - matches
      security:
      - BearerAuth: []
      parameters:
      - name: match_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateMatchResultRequest'
      responses:
        '200':
          description: Match result updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Match'
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /tournaments/{tournament_id}/spectator/stream:
    get:
      summary: Get tournament live stream data
      operationId: getTournamentStream
      tags:
      - spectator
      security:
      - BearerAuth: []
      parameters:
      - name: tournament_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: include_matches
        in: query
        schema:
          type: boolean
          default: true
      - name: include_stats
        in: query
        schema:
          type: boolean
          default: true
      responses:
        '200':
          description: Tournament stream data retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TournamentStream'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /tournaments/{tournament_id}/prizes:
    get:
      summary: Get tournament prizes
      operationId: getTournamentPrizes
      tags:
      - prizes
      security:
      - BearerAuth: []
      parameters:
      - name: tournament_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Tournament prizes retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TournamentPrizes'
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'
    post:
      summary: Distribute tournament prizes
      operationId: distributeTournamentPrizes
      tags:
      - prizes
      security:
      - BearerAuth: []
      parameters:
      - name: tournament_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Prizes distributed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PrizeDistributionResult'
        '400':
          $ref: '#/components/responses/BadRequest'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    Tournament:
      type: object
      required:
      - id
      - name
      - game_mode
      - max_participants
      - status
      - created_at
      properties:
        id:
          type: string
          format: uuid
        created_by:
          type: string
          format: uuid
        name:
          type: string
          minLength: 3
          maxLength: 100
        description:
          type: string
          maxLength: 1000
        game_mode:
          type: string
          enum:
          - deathmatch
          - team_deathmatch
          - capture_the_flag
          - domination
          - custom
        status:
          type: string
          enum:
          - draft
          - registration_open
          - registration_closed
          - in_progress
          - completed
          - cancelled
        registration_deadline:
          type: string
          format: date-time
        start_date:
          type: string
          format: date-time
        end_date:
          type: string
          format: date-time
        tournament_format:
          type: string
          enum:
          - single_elimination
          - double_elimination
          - round_robin
          - swiss_system
          default: single_elimination
        rules:
          type: string
          maxLength: 5000
        created_at:
          type: string
          format: date-time
        settings:
          $ref: '#/components/schemas/TournamentSettings'
        max_participants:
          type: integer
          minimum: 2
          maximum: 1000
        min_participants:
          type: integer
          minimum: 2
          default: 2
        prize_pool:
          type: integer
          minimum: 0
          default: 0
        entry_fee:
          type: integer
          minimum: 0
          default: 0
        current_participants:
          type: integer
          minimum: 0
          default: 0
      description: 'BACKEND NOTE: Fields ordered for optimal memory alignment (large â†’ small). Expected memory savings: 30-50%.'
    TournamentSettings:
      type: object
      properties:
        allow_spectators:
          type: boolean
          default: true
        require_checkin:
          type: boolean
          default: false
        auto_progression:
          type: boolean
          default: true
        match_timeout:
          type: integer
          description: Match timeout in minutes
          default: 30
        max_match_duration:
          type: integer
          description: Maximum match duration in minutes
          default: 60
    CreateTournamentRequest:
      type: object
      required:
      - name
      - game_mode
      - max_participants
      - start_date
      properties:
        name:
          type: string
          minLength: 3
          maxLength: 100
        description:
          type: string
          maxLength: 1000
        game_mode:
          type: string
          enum:
          - deathmatch
          - team_deathmatch
          - capture_the_flag
          - domination
          - custom
        registration_deadline:
          type: string
          format: date-time
        start_date:
          type: string
          format: date-time
        tournament_format:
          type: string
          enum:
          - single_elimination
          - double_elimination
          - round_robin
          - swiss_system
          default: single_elimination
        rules:
          type: string
          maxLength: 5000
        settings:
          $ref: '#/components/schemas/TournamentSettings'
        max_participants:
          type: integer
          minimum: 2
          maximum: 1000
        min_participants:
          type: integer
          minimum: 2
          default: 2
        prize_pool:
          type: integer
          minimum: 0
          default: 0
        entry_fee:
          type: integer
          minimum: 0
          default: 0
    UpdateTournamentRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 3
          maxLength: 100
        description:
          type: string
          maxLength: 1000
        registration_deadline:
          type: string
          format: date-time
        start_date:
          type: string
          format: date-time
        rules:
          type: string
          maxLength: 5000
        settings:
          $ref: '#/components/schemas/TournamentSettings'
        prize_pool:
          type: integer
          minimum: 0
        entry_fee:
          type: integer
          minimum: 0
    TournamentsList:
      type: object
      properties:
        tournaments:
          type: array
          items:
            $ref: '#/components/schemas/Tournament'
        total:
          type: integer
        limit:
          type: integer
        offset:
          type: integer
    TournamentRegistrationRequest:
      type: object
      properties:
        team_name:
          type: string
          maxLength: 50
        payment_method:
          type: string
          enum:
          - in_game_currency
          - real_money
        team_members:
          type: array
          items:
            type: string
            format: uuid
          maxItems: 10
    TournamentParticipant:
      type: object
      required:
      - id
      - tournament_id
      - account_id
      - registered_at
      properties:
        id:
          type: string
          format: uuid
        tournament_id:
          type: string
          format: uuid
        account_id:
          type: string
          format: uuid
        team_name:
          type: string
          maxLength: 50
        status:
          type: string
          enum:
          - registered
          - confirmed
          - checked_in
          - disqualified
        registered_at:
          type: string
          format: date-time
        checked_in_at:
          type: string
          format: date-time
          nullable: true
        team_members:
          type: array
          items:
            type: string
            format: uuid
    TournamentParticipantsList:
      type: object
      properties:
        participants:
          type: array
          items:
            $ref: '#/components/schemas/TournamentParticipant'
        total:
          type: integer
        limit:
          type: integer
        offset:
          type: integer
    GenerateBracketRequest:
      type: object
      properties:
        seeding_method:
          type: string
          enum:
          - random
          - skill_based
          - registration_order
          default: random
        bracket_size:
          type: integer
          enum:
          - 4
          - 8
          - 16
          - 32
          - 64
          - 128
    TournamentBracket:
      type: object
      required:
      - tournament_id
      - rounds
      properties:
        tournament_id:
          type: string
          format: uuid
        rounds:
          type: array
          items:
            $ref: '#/components/schemas/BracketRound'
        total_rounds:
          type: integer
        current_round:
          type: integer
    BracketRound:
      type: object
      required:
      - round_number
      - matches
      properties:
        name:
          type: string
        matches:
          type: array
          items:
            $ref: '#/components/schemas/Match'
        round_number:
          type: integer
    Match:
      type: object
      required:
      - id
      - tournament_id
      - round_number
      - status
      properties:
        id:
          type: string
          format: uuid
        tournament_id:
          type: string
          format: uuid
        participant1_id:
          type: string
          format: uuid
        participant2_id:
          type: string
          format: uuid
        winner_id:
          type: string
          format: uuid
          nullable: true
        status:
          type: string
          enum:
          - scheduled
          - in_progress
          - completed
          - cancelled
        scheduled_at:
          type: string
          format: date-time
        started_at:
          type: string
          format: date-time
          nullable: true
        completed_at:
          type: string
          format: date-time
          nullable: true
        server_info:
          $ref: '#/components/schemas/MatchServerInfo'
        round_number:
          type: integer
        match_number:
          type: integer
        score_participant1:
          type: integer
          default: 0
        score_participant2:
          type: integer
          default: 0
        spectator_count:
          type: integer
          default: 0
    MatchServerInfo:
      type: object
      properties:
        server_id:
          type: string
          format: uuid
        server_address:
          type: string
        spectator_url:
          type: string
        server_port:
          type: integer
    UpdateMatchResultRequest:
      type: object
      required:
      - winner_id
      - score_participant1
      - score_participant2
      properties:
        winner_id:
          type: string
          format: uuid
        score_participant1:
          type: integer
          minimum: 0
        score_participant2:
          type: integer
          minimum: 0
        match_duration:
          type: integer
          description: Match duration in seconds
    TournamentStream:
      type: object
      required:
      - tournament_id
      - status
      properties:
        tournament_id:
          type: string
          format: uuid
        status:
          type: string
          enum:
          - not_started
          - in_progress
          - completed
          - cancelled
        live_stats:
          $ref: '#/components/schemas/TournamentLiveStats'
        current_matches:
          type: array
          items:
            $ref: '#/components/schemas/Match'
        upcoming_matches:
          type: array
          items:
            $ref: '#/components/schemas/Match'
        spectator_count:
          type: integer
          default: 0
    TournamentLiveStats:
      type: object
      properties:
        top_performers:
          type: array
          items:
            $ref: '#/components/schemas/TopPerformer'
        total_matches_played:
          type: integer
          default: 0
        total_kills:
          type: integer
          default: 0
        average_match_duration:
          type: integer
          description: Average match duration in seconds
    TopPerformer:
      type: object
      required:
      - account_id
      - score
      properties:
        account_id:
          type: string
          format: uuid
        character_name:
          type: string
        score:
          type: integer
        kills:
          type: integer
        placement:
          type: integer
    TournamentPrizes:
      type: object
      required:
      - tournament_id
      - prizes
      properties:
        tournament_id:
          type: string
          format: uuid
        prizes:
          type: array
          items:
            $ref: '#/components/schemas/TournamentPrize'
        total_prize_pool:
          type: integer
          minimum: 0
    TournamentPrize:
      type: object
      required:
      - place
      - reward_type
      - reward_amount
      properties:
        reward_item_id:
          type: string
          format: uuid
        place_description:
          type: string
          example: 1st Place
        reward_type:
          type: string
          enum:
          - in_game_currency
          - real_money
          - item
          - title
          - experience
        reward_title:
          type: string
        percentage_of_pool:
          type: number
          format: float
          minimum: 0
          maximum: 100
        place:
          type: integer
          minimum: 1
        reward_amount:
          type: integer
          minimum: 0
    PrizeDistributionResult:
      type: object
      required:
      - tournament_id
      - distributed_at
      - total_distributed
      properties:
        tournament_id:
          type: string
          format: uuid
        distributed_at:
          type: string
          format: date-time
        distributions:
          type: array
          items:
            $ref: '#/components/schemas/PrizeDistribution'
        failed_distributions:
          type: array
          items:
            $ref: '#/components/schemas/FailedPrizeDistribution'
        total_distributed:
          type: integer
    PrizeDistribution:
      type: object
      required:
      - participant_id
      - place
      - reward_type
      - reward_amount
      - distributed_at
      properties:
        participant_id:
          type: string
          format: uuid
        reward_type:
          type: string
          enum:
          - in_game_currency
          - real_money
          - item
          - title
          - experience
        distributed_at:
          type: string
          format: date-time
        place:
          type: integer
        reward_amount:
          type: integer
    FailedPrizeDistribution:
      type: object
      required:
      - participant_id
      - reason
      properties:
        participant_id:
          type: string
          format: uuid
        reward_type:
          type: string
        reason:
          type: string
        place:
          type: integer
        reward_amount:
          type: integer
  responses:
    BadRequest:
      description: Bad request - invalid parameters
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
              message:
                type: string
              code:
                type: string
    Unauthorized:
      description: Authentication required
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: unauthorized
              message:
                type: string
    Forbidden:
      description: Insufficient permissions
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: forbidden
              message:
                type: string
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: not_found
              message:
                type: string
    Conflict:
      description: Resource conflict
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: conflict
              message:
                type: string
    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: internal_server_error
              message:
                type: string
