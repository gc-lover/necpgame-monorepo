openapi: 3.0.3
info:
  title: Weapon Elemental Effects Service Go API
  description: 'Enterprise-Grade Weapon Elemental Effects Service API for NECPGAME MMOFPS RPG.

    **Enterprise-Grade Domain:** specialized-domain

    **Module:** weapon-elemental-effects-service-go

    **Purpose:** High-performance elemental damage calculations, effect applications, and weapon enhancement management

    **BACKEND NOTE:** Struct field alignment optimized (large â†’ small types).

    All schemas ordered for optimal memory layout in generated Go code.

    Expected memory savings: 30-50% for weapon effects structs.

    **Features:**

    - Real-time elemental damage calculations (1000+ RPS)
    - Complex effect combinations and synergies
    - Environmental effect interactions
    - Elemental resistance calculations
    - Visual effect coordination with gameplay
    - Anti-cheat validation for elemental effects

    **Performance:** P99 <10ms for elemental operations, zero allocations in hot path
    '
  version: 1.0.0
  license:
    name: Proprietary
    url: https://necpgame.com/license
  contact:
    name: NECPGAME API Support
    url: https://necpgame.com/support
    email: api@weapon-elemental-effects.necpgame.com
servers:
- url: http://localhost:8084/api/v1
  description: Weapon Elemental Effects Service Go (development)
- url: https://weapon-elemental-effects-go.necpgame.com/api/v1
  description: Weapon Elemental Effects Service Go (production)
tags:
- name: Elemental Damage
  description: Elemental damage calculations and application
- name: Effect Management
  description: Effect lifecycle and state management
- name: Synergy Calculations
  description: Effect combinations and interactions
- name: Environmental Effects
  description: Environmental elemental interactions
- name: Resistance Management
  description: Elemental resistance calculations
- name: Anti-Cheat
  description: Effect validation and anti-cheat measures
security:
- BearerAuth: []
paths:
  /health:
    get:
      tags:
      - Effect Management
      summary: Service health check
      operationId: getHealth
      security: []
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'

  /effects/damage/calculate:
    post:
      tags:
      - Elemental Damage
      summary: Calculate elemental damage
      operationId: calculateElementalDamage
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DamageCalculationRequest'
      responses:
        '200':
          description: Damage calculation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DamageCalculationResponse'
        '400':
          description: Invalid calculation request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /effects/{target_id}/apply:
    post:
      tags:
      - Effect Management
      summary: Apply elemental effect to target
      operationId: applyElementalEffect
      parameters:
      - name: target_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Target entity identifier
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplyEffectRequest'
      responses:
        '200':
          description: Effect applied successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplyEffectResponse'
        '400':
          description: Effect application failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /effects/{target_id}/active:
    get:
      tags:
      - Effect Management
      summary: Get active effects on target
      operationId: getActiveEffects
      parameters:
      - name: target_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Target entity identifier
      responses:
        '200':
          description: Active effects on target
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ActiveEffectsResponse'

  /effects/{target_id}/remove:
    post:
      tags:
      - Effect Management
      summary: Remove elemental effect from target
      operationId: removeElementalEffect
      parameters:
      - name: target_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Target entity identifier
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RemoveEffectRequest'
      responses:
        '200':
          description: Effect removed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RemoveEffectResponse'
        '404':
          description: Effect not found on target
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /effects/synergy/calculate:
    post:
      tags:
      - Synergy Calculations
      summary: Calculate effect synergy
      operationId: calculateSynergy
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SynergyCalculationRequest'
      responses:
        '200':
          description: Synergy calculation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SynergyCalculationResponse'

  /effects/environmental/{zone_id}/calculate:
    post:
      tags:
      - Environmental Effects
      summary: Calculate environmental effects
      operationId: calculateEnvironmentalEffects
      parameters:
      - name: zone_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Zone identifier
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EnvironmentalCalculationRequest'
      responses:
        '200':
          description: Environmental effects calculated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnvironmentalCalculationResponse'

  /effects/resistance/{target_id}/calculate:
    post:
      tags:
      - Resistance Management
      summary: Calculate elemental resistance
      operationId: calculateResistance
      parameters:
      - name: target_id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Target entity identifier
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ResistanceCalculationRequest'
      responses:
        '200':
          description: Resistance calculation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResistanceCalculationResponse'

  /effects/batch/apply:
    post:
      tags:
      - Effect Management
      summary: Apply effects to multiple targets
      operationId: batchApplyEffects
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BatchApplyRequest'
      responses:
        '200':
          description: Batch effect application completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchApplyResponse'

  /effects/validate:
    post:
      tags:
      - Anti-Cheat
      summary: Validate elemental effects for anti-cheat
      operationId: validateEffects
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ValidationRequest'
      responses:
        '200':
          description: Effects validation completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationResponse'
        '400':
          description: Validation failed - potential cheating detected
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /effects/analytics:
    get:
      tags:
      - Effect Management
      summary: Get effects usage analytics
      operationId: getEffectsAnalytics
      parameters:
      - name: timeframe
        in: query
        schema:
          type: string
          enum: [1h, 24h, 7d, 30d]
          default: 24h
        description: Analytics timeframe
      - name: effect_type
        in: query
        schema:
          type: string
          enum: [fire, ice, electric, poison, acid, radiation, kinetic, explosive]
        description: Filter by effect type
      responses:
        '200':
          description: Effects analytics data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalyticsResponse'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      description: JWT Bearer token authentication

  schemas:
    # Response schemas
    HealthResponse:
      type: object
      properties:
        status:
          type: string
          example: "healthy"
        timestamp:
          type: string
          format: date-time
        uptime:
          type: integer
          description: Uptime in seconds
        version:
          type: string
          example: "1.0.0"

    DamageCalculationResponse:
      type: object
      properties:
        base_damage:
          type: number
          format: float
          minimum: 0.0
        elemental_damage:
          type: number
          format: float
          minimum: 0.0
        total_damage:
          type: number
          format: float
          minimum: 0.0
        damage_type:
          type: string
          enum: [fire, ice, electric, poison, acid, radiation, kinetic, explosive]
        critical_multiplier:
          type: number
          format: float
          minimum: 1.0
        resistance_applied:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
        effects_applied:
          type: array
          items:
            $ref: '#/components/schemas/AppliedEffect'

    ApplyEffectResponse:
      type: object
      properties:
        effect_id:
          type: string
          format: uuid
        target_id:
          type: string
          format: uuid
        effect_type:
          type: string
        applied_at:
          type: string
          format: date-time
        duration_seconds:
          type: number
          format: float
        intensity:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
        visual_effect_id:
          type: string

    ActiveEffectsResponse:
      type: object
      properties:
        target_id:
          type: string
          format: uuid
        active_effects:
          type: array
          items:
            $ref: '#/components/schemas/ActiveEffect'
        effect_count:
          type: integer
          minimum: 0
        total_intensity:
          type: number
          format: float
          minimum: 0.0

    RemoveEffectResponse:
      type: object
      properties:
        effect_id:
          type: string
          format: uuid
        target_id:
          type: string
          format: uuid
        removed_at:
          type: string
          format: date-time
        cleanup_effects:
          type: array
          items:
            type: string

    SynergyCalculationResponse:
      type: object
      properties:
        synergy_score:
          type: number
          format: float
          minimum: 0.0
          maximum: 2.0
        synergy_effects:
          type: array
          items:
            $ref: '#/components/schemas/SynergyEffect'
        amplified_damage:
          type: number
          format: float
          minimum: 0.0
        combined_effects:
          type: array
          items:
            type: string

    EnvironmentalCalculationResponse:
      type: object
      properties:
        zone_id:
          type: string
          format: uuid
        environmental_effects:
          type: array
          items:
            $ref: '#/components/schemas/EnvironmentalEffect'
        effect_modifiers:
          type: object
          additionalProperties:
            type: number
            format: float
        hazard_level:
          type: string
          enum: [safe, moderate, dangerous, lethal]

    ResistanceCalculationResponse:
      type: object
      properties:
        target_id:
          type: string
          format: uuid
        base_resistance:
          type: object
          additionalProperties:
            type: number
            format: float
            minimum: 0.0
            maximum: 1.0
        effective_resistance:
          type: object
          additionalProperties:
            type: number
            format: float
            minimum: 0.0
            maximum: 1.0
        resistance_sources:
          type: array
          items:
            $ref: '#/components/schemas/ResistanceSource'

    BatchApplyResponse:
      type: object
      properties:
        operation_id:
          type: string
          format: uuid
        total_targets:
          type: integer
          minimum: 0
        successful_applications:
          type: integer
          minimum: 0
        failed_applications:
          type: integer
          minimum: 0
        applied_effects:
          type: array
          items:
            $ref: '#/components/schemas/BatchApplicationResult'

    ValidationResponse:
      type: object
      properties:
        validation_passed:
          type: boolean
        target_id:
          type: string
          format: uuid
        effect_id:
          type: string
          format: uuid
        confidence_score:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
        anomalies_detected:
          type: array
          items:
            type: string
        recommended_action:
          type: string
          enum: [allow, monitor, block]

    AnalyticsResponse:
      type: object
      properties:
        timeframe:
          type: string
        effect_usage_stats:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/EffectStats'
        total_applications:
          type: integer
          minimum: 0
        average_damage_boost:
          type: number
          format: float
        most_effective_combinations:
          type: array
          items:
            type: string
          maxItems: 10

    # Request schemas
    DamageCalculationRequest:
      type: object
      properties:
        attacker_id:
          type: string
          format: uuid
        target_id:
          type: string
          format: uuid
        weapon_id:
          type: string
          format: uuid
        base_damage:
          type: number
          format: float
          minimum: 0.0
        elemental_type:
          type: string
          enum: [fire, ice, electric, poison, acid, radiation, kinetic, explosive]
        elemental_power:
          type: number
          format: float
          minimum: 0.0
          maximum: 100.0
        distance:
          type: number
          format: float
          minimum: 0.0
        environmental_factors:
          type: array
          items:
            type: string
        critical_hit:
          type: boolean
          default: false
      required:
      - attacker_id
      - target_id
      - base_damage
      - elemental_type

    ApplyEffectRequest:
      type: object
      properties:
        effect_type:
          type: string
          enum: [fire, ice, electric, poison, acid, radiation, kinetic, explosive]
        intensity:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
        duration_seconds:
          type: number
          format: float
          minimum: 0.1
        source_weapon:
          type: string
          format: uuid
        damage_over_time:
          type: number
          format: float
          minimum: 0.0
        tick_interval:
          type: number
          format: float
          minimum: 0.1
        visual_effect:
          type: string
        client_hash:
          type: string
      required:
      - effect_type
      - intensity
      - duration_seconds

    RemoveEffectRequest:
      type: object
      properties:
        effect_id:
          type: string
          format: uuid
        removal_reason:
          type: string
          enum: [expired, dispelled, overridden, death]
          default: expired
        cleanup_visuals:
          type: boolean
          default: true

    SynergyCalculationRequest:
      type: object
      properties:
        primary_effect:
          type: string
          enum: [fire, ice, electric, poison, acid, radiation, kinetic, explosive]
        secondary_effects:
          type: array
          items:
            type: string
          minItems: 1
          maxItems: 5
        target_resistances:
          type: object
          additionalProperties:
            type: number
            format: float
        environmental_conditions:
          type: array
          items:
            type: string
      required:
      - primary_effect
      - secondary_effects

    EnvironmentalCalculationRequest:
      type: object
      properties:
        weather_conditions:
          type: array
          items:
            type: string
        terrain_type:
          type: string
        time_of_day:
          type: string
          enum: [dawn, day, dusk, night]
        active_effects:
          type: array
          items:
            type: string
      required:
      - weather_conditions
      - terrain_type
      - time_of_day

    ResistanceCalculationRequest:
      type: object
      properties:
        target_armor:
          type: object
          properties:
            type:
              type: string
            level:
              type: integer
            elemental_modifiers:
              type: object
              additionalProperties:
                type: number
                format: float
        active_effects:
          type: array
          items:
            type: string
        environmental_resistance:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0

    BatchApplyRequest:
      type: object
      properties:
        targets:
          type: array
          items:
            type: string
            format: uuid
          minItems: 1
          maxItems: 100
        effect_config:
          $ref: '#/components/schemas/ApplyEffectRequest'
      required:
      - targets
      - effect_config

    ValidationRequest:
      type: object
      properties:
        target_id:
          type: string
          format: uuid
        effect_id:
          type: string
          format: uuid
        reported_damage:
          type: number
          format: float
        client_timestamp:
          type: string
          format: date-time
        server_timestamp:
          type: string
          format: date-time
        client_hash:
          type: string

    # Nested schemas
    AppliedEffect:
      type: object
      properties:
        effect_type:
          type: string
        damage:
          type: number
          format: float
        duration:
          type: number
          format: float
        intensity:
          type: number
          format: float

    ActiveEffect:
      type: object
      properties:
        effect_id:
          type: string
          format: uuid
        effect_type:
          type: string
        intensity:
          type: number
          format: float
        remaining_duration:
          type: number
          format: float
        applied_at:
          type: string
          format: date-time
        source_weapon:
          type: string
          format: uuid

    SynergyEffect:
      type: object
      properties:
        effect_type:
          type: string
        multiplier:
          type: number
          format: float
        description:
          type: string

    EnvironmentalEffect:
      type: object
      properties:
        condition:
          type: string
        effect_type:
          type: string
        intensity_modifier:
          type: number
          format: float
        duration_modifier:
          type: number
          format: float

    ResistanceSource:
      type: object
      properties:
        source_type:
          type: string
          enum: [armor, implant, effect, environmental]
        resistance_value:
          type: number
          format: float
        description:
          type: string

    BatchApplicationResult:
      type: object
      properties:
        target_id:
          type: string
          format: uuid
        success:
          type: boolean
        effect_id:
          type: string
          format: uuid
        error_message:
          type: string

    EffectStats:
      type: object
      properties:
        total_applications:
          type: integer
          minimum: 0
        average_damage:
          type: number
          format: float
        success_rate:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
        average_duration:
          type: number
          format: float

    Error:
      type: object
      properties:
        error:
          type: string
        code:
          type: string
        message:
          type: string
        timestamp:
          type: string
          format: date-time
        target_id:
          type: string
          format: uuid
        effect_id:
          type: string
          format: uuid
      required:
      - error
      - code
      - message
