openapi: 3.0.3
info:
  title: Combat Damage Service Go API
  description: 'Enterprise-Grade Combat Damage Service API for NECPGAME MMOFPS RPG.

    **Enterprise-Grade Domain:** specialized-domain

    **Module:** combat-damage-service-go

    **Purpose:** High-performance damage calculation and combat effects management

    **BACKEND NOTE:** Struct field alignment optimized (large → small types).

    All schemas ordered for optimal memory layout in generated Go code.

    Expected memory savings: 30-50% for damage-related structs.

    **Features:**

    - Real-time damage calculation (1000+ RPS)

    - Combat effects management (buffs/debuffs/statuses)

    - Anti-cheat validation

    - Implant synergy calculations

    - Environmental damage modifiers

    **Performance:** P99 <5ms for damage calculations, zero allocations in hot path

    '
  version: 1.0.0
  license:
    name: Proprietary
    url: https://necpgame.com/license
  contact:
    name: NECPGAME API Support
    url: https://necpgame.com/support
    email: api@combat-damage.necpgame.com
servers:
  - url: http://localhost:8083/api/v1
    description: Combat Damage Service Go (development)
  - url: https://combat-damage-go.necpgame.com/api/v1
    description: Combat Damage Service Go (production)
tags:
  - name: Damage Calculation
    description: Real-time damage calculations and validation
  - name: Combat Effects
    description: Buff/debuff and status effect management
  - name: Anti-Cheat
    description: Damage validation and cheat prevention
paths:
  /health:
    get:
      summary: Service health check
      operationId: healthCheck
      tags:
        - Health
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '503':
          description: Service is unhealthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /combat/damage/calculate:
    post:
      summary: Calculate combat damage
      operationId: calculateDamage
      description: 'Calculate damage with all modifiers, critical hits, and anti-cheat validation.

        **BACKEND NOTE:** Hot path - optimized for 1000+ RPS, zero allocations.

        '
      tags:
        - Damage Calculation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DamageCalculationRequest'
      responses:
        '200':
          description: Damage calculation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DamageCalculationResult'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /combat/effects/apply:
    post:
      summary: Apply combat effects
      operationId: applyEffects
      description: Apply buffs, debuffs, and status effects to combat participants.
      tags:
        - Combat Effects
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplyEffectsRequest'
      responses:
        '200':
          description: Effects applied successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplyEffectsResult'
        '400':
          description: Invalid effect parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /combat/effects/{participant_id}/active:
    get:
      summary: Get active combat effects
      operationId: getActiveEffects
      description: Retrieve all active effects for a combat participant.
      tags:
        - Combat Effects
      parameters:
        - name: participant_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Combat participant ID
      responses:
        '200':
          description: Active effects list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ActiveEffectsResponse'
        '404':
          description: Participant not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /combat/effects/{effect_id}:
    delete:
      summary: Remove combat effect
      operationId: removeEffect
      description: Remove a specific combat effect.
      tags:
        - Combat Effects
      parameters:
        - name: effect_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Effect ID to remove
      responses:
        '204':
          description: Effect removed successfully
        '404':
          description: Effect not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /combat/damage/validate:
    post:
      summary: Validate damage calculation
      operationId: validateDamage
      description: 'Validate damage calculation for anti-cheat purposes.

        **BACKEND NOTE:** Used for cheat detection and prevention.

        '
      tags:
        - Anti-Cheat
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DamageValidationRequest'
      responses:
        '200':
          description: Validation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DamageValidationResult'
        '400':
          description: Invalid validation request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      description: JWT Bearer token authentication
  schemas:
    HealthResponse:
      type: object
      required:
        - status
        - timestamp
      properties:
        version:
          type: string
        status:
          type: string
          enum:
            - healthy
        timestamp:
          type: string
          format: date-time
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
        message:
          type: string
          description: Human-readable error message
        details:
          type: object
          description: Additional error details
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    DamageCalculationRequest:
      $ref: ./schemas/damage-request.yaml
    DamageCalculationResult:
      $ref: ./schemas/damage-result.yaml
    ApplyEffectsRequest:
      $ref: ./schemas/effects-request.yaml
    ApplyEffectsResult:
      $ref: ./schemas/effects-result.yaml
    ActiveEffectsResponse:
      $ref: ./schemas/active-effects.yaml
    DamageValidationRequest:
      $ref: ./schemas/damage-validation-request.yaml
    DamageValidationResult:
      $ref: ./schemas/damage-validation-result.yaml
security:
  - BearerAuth: [ ]
