openapi: 3.0.3
info:
  title: Combat Combos Service API
  description: API for managing combat combos and synergies in the NECPGAME
  version: 1.0.0
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  contact:
    name: Backend Team
    email: backend@necp.game
servers:
- url: http://localhost:8084/api/v1
  description: Development server
- url: https://api.necp.game/combat/combos/v1
  description: Production server
security:
- bearerAuth: []
paths:
  /combat/combos/catalog:
    get:
      summary: Get combo catalog
      operationId: getComboCatalog
      description: Retrieve a paginated list of available combos with optional filtering
      parameters:
      - name: type
        in: query
        schema:
          type: string
          enum:
          - solo
          - team
          - legendary
        description: Filter by combo type
      - name: complexity
        in: query
        schema:
          type: string
          enum:
          - Bronze
          - Silver
          - Gold
          - Platinum
          - Legendary
        description: Filter by complexity level
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 50
        description: Number of items to return
      - name: offset
        in: query
        schema:
          type: integer
          minimum: 0
          default: 0
        description: Number of items to skip
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComboCatalogResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /combat/combos/{comboId}:
    get:
      summary: Get combo details
      operationId: getComboDetails
      description: Retrieve detailed information about a specific combo
      parameters:
      - name: comboId
        in: path
        required: true
        schema:
          type: string
        description: Unique identifier of the combo
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComboDetailResponse'
        '404':
          description: Combo not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /combat/combos/activate:
    post:
      summary: Activate combo
      operationId: activateCombo
      description: Activate a combo for a character
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ActivateComboRequest'
      responses:
        '200':
          description: Combo activated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ActivateComboResponse'
        '400':
          description: Bad request or combo requirements not met
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '503':
          description: Service overloaded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /combat/combos/loadout:
    get:
      summary: Get combo loadout
      operationId: getComboLoadout
      description: Retrieve the current combo loadout for the authenticated character
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComboLoadoutResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      summary: Update combo loadout
      operationId: updateComboLoadout
      description: Update the combo loadout for the authenticated character
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ComboLoadoutRequest'
      responses:
        '200':
          description: Loadout updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComboLoadoutResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /combat/combos/analytics:
    get:
      summary: Get combo analytics
      operationId: getComboAnalytics
      description: Retrieve analytics data for combo usage
      parameters:
      - name: days
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 90
          default: 7
        description: Number of days to look back
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComboAnalyticsResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    ComboType:
      type: string
      enum:
      - solo
      - team
      - legendary
      description: Type of combo
    ComboComplexity:
      type: string
      enum:
      - Bronze
      - Silver
      - Gold
      - Platinum
      - Legendary
      description: Complexity level of the combo
    SynergyType:
      type: string
      enum:
      - ability
      - team
      - equipment
      - implant
      - timing
      description: Type of synergy
    Requirements:
      type: object
      properties:
        required_skills:
          type: array
          items:
            type: string
          description: Required skills
        min_level:
          type: integer
          minimum: 1
          description: Minimum character level required
        min_participants:
          type: integer
          minimum: 1
          description: Minimum number of participants
        max_participants:
          type: integer
          minimum: 1
          description: Maximum number of participants
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Bonuses:
      type: object
      properties:
        effect_bonuses:
          type: object
          additionalProperties:
            type: number
          description: Additional effect bonuses
        special_effects:
          type: array
          items:
            type: string
          description: Special effects triggered
        damage_multiplier:
          type: number
          minimum: 1.0
          description: Damage multiplier applied
        cooldown_reduction:
          type: integer
          minimum: 0
          description: Cooldown reduction in milliseconds
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ComboCatalog:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier of the combo
        name:
          type: string
          description: Display name of the combo
        description:
          type: string
          description: Detailed description
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
        bonuses:
          $ref: '#/components/schemas/Bonuses'
        complexity:
          $ref: '#/components/schemas/ComboComplexity'
        combo_type:
          $ref: '#/components/schemas/ComboType'
        requirements:
          $ref: '#/components/schemas/Requirements'
        sequence:
          type: array
          items:
            type: string
          description: Required sequence of actions
        chain_compatible:
          type: boolean
          description: Whether combo can be chained
        cooldown:
          type: integer
          minimum: 0
          description: Cooldown in milliseconds
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ComboSynergy:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier of the synergy
        combo_id:
          type: string
          description: Associated combo ID
        bonuses:
          $ref: '#/components/schemas/Bonuses'
        requirements:
          $ref: '#/components/schemas/Requirements'
        synergy_type:
          $ref: '#/components/schemas/SynergyType'
        ability_ids:
          type: array
          items:
            type: string
          description: Related ability IDs
        equipment_ids:
          type: array
          items:
            type: string
          description: Related equipment IDs
        implant_ids:
          type: array
          items:
            type: string
          description: Related implant IDs
        team_size:
          type: integer
          minimum: 1
          description: Required team size
        timing_window:
          type: integer
          minimum: 0
          description: Timing window in milliseconds
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ComboCatalogResponse:
      type: object
      properties:
        combos:
          type: array
          items:
            $ref: '#/components/schemas/ComboCatalog'
        total:
          type: integer
          minimum: 0
          description: Total number of combos available
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ComboDetailResponse:
      type: object
      properties:
        combo:
          $ref: '#/components/schemas/ComboCatalog'
        synergies:
          type: array
          items:
            $ref: '#/components/schemas/ComboSynergy'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ActivateComboRequest:
      type: object
      required:
      - combo_id
      - character_id
      properties:
        combo_id:
          type: string
          description: ID of the combo to activate
        character_id:
          type: string
          description: ID of the character activating the combo
        context:
          type: object
          additionalProperties: true
          description: Additional context for activation
        participants:
          type: array
          items:
            type: string
          description: IDs of all participants
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ActivateComboResponse:
      type: object
      properties:
        activation_id:
          type: string
          description: ID of the activation record
        bonuses:
          $ref: '#/components/schemas/Bonuses'
        success:
          type: boolean
          description: Whether activation was successful
        score:
          type: integer
          minimum: 0
          description: Score achieved
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ComboLoadout:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier of the loadout
        character_id:
          type: string
          description: Character this loadout belongs to
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
        preferences:
          type: object
          additionalProperties: true
          description: User preferences
        active_combos:
          type: array
          items:
            type: string
          description: IDs of active combos
        auto_activate:
          type: boolean
          description: Whether to auto-activate combos
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ComboLoadoutRequest:
      type: object
      properties:
        preferences:
          type: object
          additionalProperties: true
          description: User preferences
        active_combos:
          type: array
          items:
            type: string
          description: IDs of active combos
        auto_activate:
          type: boolean
          description: Whether to auto-activate combos
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ComboLoadoutResponse:
      type: object
      properties:
        loadout:
          $ref: '#/components/schemas/ComboLoadout'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ComboAnalyticsResponse:
      type: object
      properties:
        popular_combos:
          type: array
          items:
            $ref: '#/components/schemas/ComboPopularity'
          description: Most popular combos
        scoring_trends:
          type: array
          items:
            $ref: '#/components/schemas/ScoringTrend'
          description: Scoring trends over time
        success_rate:
          type: number
          minimum: 0.0
          maximum: 1.0
          description: Success rate of activations
        total_activations:
          type: integer
          minimum: 0
          description: Total number of activations
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ComboPopularity:
      type: object
      properties:
        combo_id:
          type: string
          description: Combo identifier
        combo_name:
          type: string
          description: Combo display name
        average_score:
          type: number
          description: Average score achieved
        activations:
          type: integer
          minimum: 0
          description: Number of activations
        total_combos:
          type: integer
          minimum: 0
          description: Total number of combos
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ScoringTrend:
      type: object
      properties:
        date:
          type: string
          format: date
          description: Date of the trend data
        average_score:
          type: number
          description: Average score for the date
        total_combos:
          type: integer
          minimum: 0
          description: Total combos executed
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Error:
      type: object
      properties:
        error:
          type: string
          description: Error message
      required:
      - error
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
