openapi: 3.0.3
info:
  title: Combat Acrobatics Combos Service API
  description: 'API для комбо из движения.


    **Основные возможности:**

    - Выполнение комбо из движения

    - Получение доступных комбо

    - Бонусы за комбо (урон, скорость, эффекты)

    '
  version: 1.0.0
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  contact:
    name: NECPGAME API Support
    email: api@necp.game
servers:
  - url: http://localhost:8083/api/v1/gameplay/combat/acrobatics
    description: Локальный сервер разработки
  - url: https://api.necp.game/api/v1/gameplay/combat/acrobatics
    description: Продакшен сервер
tags:
  - name: Movement Combos
    description: Комбо из движения
paths:
  /combo/movement:
    post:
      tags:
        - Movement Combos
      summary: Выполнить комбо из движения
      description: 'Выполняет комбо из движения на основе последовательности действий.

        Применяет бонусы урона, скорости атаки и специальные эффекты.

        '
      operationId: executeMovementCombo
      security:
        - BearerAuth: [ ]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExecuteMovementComboRequest'
            example:
              sequence:
                - wall_run
                - wall_kick
                - air_dash
                - attack
              target_id: bb0e8400-e29b-41d4-a716-446655440000
              attack_type: melee
      responses:
        '200':
          description: Комбо выполнено
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MovementComboResponse'
              example:
                combo_id: aa0e8400-e29b-41d4-a716-446655440000
                chain_id: cc0e8400-e29b-41d4-a716-446655440000
                chain_name: Wall Run → Wall Kick → Air Dash → Attack
                damage_dealt: 390
                damage_boost: 30.0
                attack_speed_boost: 20.0
                special_effects:
                  - stun
                  - knockback
                timestamp: '2025-12-01T10:00:00Z'
        '400':
          $ref: common.yaml#/components/responses/BadRequest
        '401':
          $ref: common.yaml#/components/responses/Unauthorized
        '500':
          $ref: common.yaml#/components/responses/InternalServerError
  /combo/available:
    get:
      tags:
        - Movement Combos
      summary: Получить доступные комбо из движения
      description: 'Возвращает список всех доступных комбо из движения для персонажа

        с информацией о бонусах и требованиях.

        '
      operationId: getAvailableMovementCombos
      security:
        - BearerAuth: [ ]
      parameters:
        - name: movement_type
          in: query
          required: false
          description: Фильтр по первому элементу движения
          schema:
            $ref: combat-acrobatics-schemas.yaml#/components/schemas/MovementType
      responses:
        '200':
          description: Список доступных комбо
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AvailableMovementCombosResponse'
              example:
                combos:
                  - chain_id: cc0e8400-e29b-41d4-a716-446655440000
                    chain_name: Wall Run → Wall Kick → Air Dash → Attack
                    sequence:
                      - wall_run
                      - wall_kick
                      - air_dash
                      - attack
                    damage_boost: 30.0
                    attack_speed_boost: 20.0
                    special_effects:
                      - stun
                      - knockback
                  - chain_id: dd0e8400-e29b-41d4-a716-446655440000
                    chain_name: Slide → Vault → Attack
                    sequence:
                      - slide
                      - vault
                      - attack
                    damage_boost: 25.0
                    attack_speed_boost: 15.0
                    special_effects:
                      - knockback
                total: 4
        '401':
          $ref: common.yaml#/components/responses/Unauthorized
        '500':
          $ref: common.yaml#/components/responses/InternalServerError
components:
  securitySchemes:
    BearerAuth:
      $ref: common.yaml#/components/securitySchemes/BearerAuth
  schemas:
    ExecuteMovementComboRequest:
      type: object
      required:
        - sequence
        - attack_type
      properties:
        target_id:
          type: string
          format: uuid
          description: ID цели атаки
          example: bb0e8400-e29b-41d4-a716-446655440000
        weapon_id:
          type: string
          format: uuid
          description: ID оружия (для стрельбы)
          nullable: true
          example: ee0e8400-e29b-41d4-a716-446655440000
        attack_type:
          $ref: combat-acrobatics-schemas.yaml#/components/schemas/AttackType
        sequence:
          type: array
          description: Последовательность движений для комбо
          items:
            type: string
          minItems: 2
          example:
            - wall_run
            - wall_kick
            - air_dash
            - attack
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    MovementComboResponse:
      type: object
      required:
        - combo_id
        - chain_id
        - chain_name
        - damage_dealt
        - damage_boost
        - attack_speed_boost
        - special_effects
        - timestamp
      properties:
        combo_id:
          type: string
          format: uuid
          example: aa0e8400-e29b-41d4-a716-446655440000
        chain_id:
          type: string
          format: uuid
          example: cc0e8400-e29b-41d4-a716-446655440000
        chain_name:
          type: string
          description: Название цепочки комбо
          example: Wall Run → Wall Kick → Air Dash → Attack
        timestamp:
          type: string
          format: date-time
          example: '2025-12-01T10:00:00Z'
        special_effects:
          type: array
          description: Примененные специальные эффекты
          items:
            $ref: combat-acrobatics-schemas.yaml#/components/schemas/SpecialEffect
          example:
            - stun
            - knockback
        damage_dealt:
          type: integer
          description: Нанесенный урон с учетом бонусов
          minimum: 0
          example: 390
        damage_boost:
          type: number
          format: float
          description: Примененный бонус урона (в процентах)
          example: 30.0
        attack_speed_boost:
          type: number
          format: float
          description: Примененный бонус скорости атаки (в процентах)
          example: 20.0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    AvailableMovementCombosResponse:
      type: object
      required:
        - combos
        - total
      properties:
        combos:
          type: array
          items:
            $ref: combat-acrobatics-schemas.yaml#/components/schemas/MovementComboChain
        total:
          type: integer
          description: Общее количество доступных комбо
          minimum: 0
          example: 4
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
  responses:
    BadRequest:
      $ref: common.yaml#/components/responses/BadRequest
    Unauthorized:
      $ref: common.yaml#/components/responses/Unauthorized
    InternalServerError:
      $ref: common.yaml#/components/responses/InternalServerError
