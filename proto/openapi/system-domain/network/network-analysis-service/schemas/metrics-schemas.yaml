# Performance Metrics schemas
# Real-time performance monitoring and alerting schemas

PerformanceMetrics:
  type: object
  required:
    - collection_period
    - global_metrics
    - regional_metrics
    - alerts
  properties:
    collection_period:
      type: object
      properties:
        start_time:
          type: string
          format: date-time
        end_time:
          type: string
          format: date-time
        duration_seconds:
          type: integer
    global_metrics:
      $ref: '#/components/schemas/GlobalPerformanceMetrics'
    regional_metrics:
      type: array
      items:
        $ref: '#/components/schemas/RegionalPerformanceMetrics'
    alerts:
      type: array
      items:
        $ref: '#/components/schemas/PerformanceAlert'

# BACKEND NOTE: Metrics optimized for high-frequency polling with minimal allocation
GlobalPerformanceMetrics:
  type: object
  required:
    - total_connections
    - average_latency
    - p95_latency
    - p99_latency
    - packet_loss_rate
  properties:
    total_connections:
      type: integer
      description: Total active connections
      example: 15000
    average_latency:
      type: number
      format: float
      description: Global average latency (ms)
      example: 42.5
    p95_latency:
      type: number
      format: float
      description: 95th percentile latency (ms)
      example: 85.0
    p99_latency:
      type: number
      format: float
      description: 99th percentile latency (ms)
      example: 120.0
    packet_loss_rate:
      type: number
      format: float
      description: Global packet loss rate
      example: 0.001

RegionalPerformanceMetrics:
  type: object
  required:
    - region
    - connection_count
    - average_latency
    - packet_loss_rate
  properties:
    region:
      type: string
      description: Geographic region identifier
      example: "us-east-1"
    connection_count:
      type: integer
      description: Connections in this region
      example: 2500
    average_latency:
      type: number
      format: float
      description: Regional average latency (ms)
      example: 38.2
    packet_loss_rate:
      type: number
      format: float
      description: Regional packet loss rate
      example: 0.0008

PerformanceAlert:
  type: object
  required:
    - alert_id
    - severity
    - type
    - description
    - timestamp
  properties:
    alert_id:
      type: string
      description: Unique alert identifier
    severity:
      type: string
      enum: [info, warning, error, critical]
      description: Alert severity level
    type:
      type: string
      enum: [latency_spike, packet_loss, connection_drop, bandwidth_limit]
      description: Type of performance issue
    description:
      type: string
      description: Alert description
    timestamp:
      type: string
      format: date-time
      description: Alert timestamp
