# Security Analysis schemas
# Network security threat detection and mitigation schemas

SecurityThreatAnalysis:
  type: object
  required:
    - analysis_period
    - detected_threats
    - threat_summary
    - mitigation_recommendations
  properties:
    analysis_period:
      type: object
      properties:
        start_time:
          type: string
          format: date-time
        end_time:
          type: string
          format: date-time
    detected_threats:
      type: array
      items:
        $ref: '#/components/schemas/SecurityThreat'
    threat_summary:
      $ref: '#/components/schemas/ThreatSummary'
    mitigation_recommendations:
      type: array
      items:
        $ref: '#/components/schemas/SecurityMitigation'

# BACKEND NOTE: Security schemas optimized for high-security processing with audit logging
SecurityThreat:
  type: object
  required:
    - threat_id
    - threat_type
    - severity
    - detection_time
    - source_ip
    - target_service
    - description
  properties:
    threat_id:
      type: string
      description: Unique threat identifier
    threat_type:
      type: string
      enum: [ddos, anomaly, auth_abuse, exfiltration, malware, intrusion]
      description: Type of security threat
    severity:
      type: string
      enum: [low, medium, high, critical]
      description: Threat severity level
    detection_time:
      type: string
      format: date-time
      description: When threat was detected
    source_ip:
      type: string
      description: Source IP address
    target_service:
      type: string
      description: Affected service
    description:
      type: string
      description: Detailed threat description
    mitigation_status:
      type: string
      enum: [detected, investigating, mitigated, blocked]
      description: Current mitigation status

ThreatSummary:
  type: object
  required:
    - total_threats
    - threats_by_type
    - threats_by_severity
    - active_threats
  properties:
    total_threats:
      type: integer
      description: Total number of threats detected
      example: 47
    threats_by_type:
      type: object
      description: Threats grouped by type
    threats_by_severity:
      type: object
      description: Threats grouped by severity
    active_threats:
      type: integer
      description: Currently active threats
      example: 3

SecurityMitigation:
  type: object
  required:
    - mitigation_type
    - description
    - priority
    - implementation_steps
  properties:
    mitigation_type:
      type: string
      enum: [rate_limiting, ip_blocking, ddos_protection, auth_enhancement, monitoring_upgrade]
      description: Type of security mitigation
    description:
      type: string
      description: Mitigation description
    priority:
      type: string
      enum: [low, medium, high, critical]
      description: Implementation priority
    implementation_steps:
      type: array
      items:
        type: string
      description: Step-by-step implementation guide
