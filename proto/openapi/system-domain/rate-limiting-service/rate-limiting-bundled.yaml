openapi: 3.0.3
info:
  title: System Domain - Rate Limiting and Throttling API
  description: |
    **Enterprise-Grade Rate Limiting and Throttling API** for NECPGAME MMOFPS RPG.

    **Module Purpose:** Comprehensive API protection system with advanced rate limiting, throttling mechanisms, quota management, and abuse prevention for 50+ microservices.

    **Architecture:** High-performance, distributed rate limiting system with Redis clustering, real-time monitoring, adaptive algorithms, and multi-layer protection strategies.

    **Core Features:**
    - Multi-tier rate limiting (user, IP, endpoint, service-level)
    - Advanced throttling algorithms (token bucket, sliding window, leaky bucket)
    - Dynamic quota management with burst allowances
    - Real-time monitoring and analytics
    - Adaptive rate limiting based on traffic patterns
    - Geo-based rate limiting and regional policies
    - Integration with authentication and authorization
    - Automated mitigation for DDoS and abuse patterns

    **Performance Targets:**
    - Rate limit checks: 5000+ per second, P99 <10ms
    - Distributed state synchronization: <50ms propagation
    - Memory per rate limit rule: <2KB (optimized storage)
    - False positive rate: <0.01% for legitimate traffic
    - Throughput: 100k+ requests/sec per service instance

    **BACKEND NOTE:** Redis clustering required for distributed rate limiting. Lua scripts for atomic operations.
    Adaptive algorithms critical for gaming traffic patterns. Integration with service mesh essential.
  version: 1.0.0
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  contact:
    name: NECPGAME Rate Limiting API Support
    url: https://necpgame.com/support
    email: api@rate-limiting.necpgame.com
servers:
  - url: http://localhost:8089/api/v1/system-domain/rate-limiting
    description: Rate Limiting Service Development Server
  - url: https://rate-limiting.necpgame.com/api/v1
    description: Rate Limiting Service Production Server
security:
  - BearerAuth: []
tags:
  - name: Rate Limit Management
    description: Core rate limit CRUD operations and configuration
  - name: Throttling Policies
    description: Throttling algorithm management and policies
  - name: Quota Management
    description: User/service quota allocation and monitoring
  - name: Monitoring & Analytics
    description: Real-time monitoring and traffic analytics
  - name: Abuse Prevention
    description: DDoS protection and abuse detection
  - name: System
    description: Health checks and system operations
paths:
  /health:
    get:
      summary: Rate limiting service health check
      operationId: rateLimitingHealth
      tags:
        - System
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '503':
          description: Service is unhealthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /rate-limits:
    post:
      summary: Create a new rate limit rule
      description: |
        Creates a new rate limit rule for API protection.

        **BACKEND NOTE:** Validates rule configuration, registers with Redis, updates service mesh.
        Rule becomes active immediately with configured parameters.
      operationId: createRateLimit
      tags:
        - Rate Limit Management
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateRateLimitRequest'
      responses:
        '201':
          description: Rate limit rule created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RateLimitRule'
        '400':
          description: Invalid rate limit configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Rate limit rule with this ID already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    get:
      summary: List rate limit rules
      description: Retrieve a paginated list of rate limit rules with optional filtering
      operationId: listRateLimits
      tags:
        - Rate Limit Management
      security:
        - BearerAuth: []
      parameters:
        - name: service_name
          in: query
          schema:
            type: string
          description: Filter by service name
        - name: endpoint
          in: query
          schema:
            type: string
          description: Filter by endpoint pattern
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of items per page
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Number of items to skip
      responses:
        '200':
          description: Rate limit rules retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RateLimitListResponse'
  /rate-limits/{rule_id}:
    get:
      summary: Get rate limit rule details
      description: Retrieve detailed information about a specific rate limit rule
      operationId: getRateLimit
      tags:
        - Rate Limit Management
      security:
        - BearerAuth: []
      parameters:
        - name: rule_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Rate limit rule unique identifier
      responses:
        '200':
          description: Rate limit rule details retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RateLimitRule'
        '404':
          description: Rate limit rule not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      summary: Update rate limit rule configuration
      description: |
        Updates rate limit rule configuration (limits, algorithms, etc.).

        **BACKEND NOTE:** Validates new configuration, applies changes atomically.
        May trigger traffic redistribution if limits are modified.
      operationId: updateRateLimit
      tags:
        - Rate Limit Management
      security:
        - BearerAuth: []
      parameters:
        - name: rule_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Rate limit rule unique identifier
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateRateLimitRequest'
      responses:
        '200':
          description: Rate limit rule updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RateLimitRule'
        '400':
          description: Invalid configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Rate limit rule not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      summary: Delete rate limit rule
      description: |
        Removes a rate limit rule from the system.

        **BACKEND NOTE:** Cleans up Redis state, unregisters from service mesh.
        Use with caution - may expose service to abuse.
      operationId: deleteRateLimit
      tags:
        - Rate Limit Management
      security:
        - BearerAuth: []
      parameters:
        - name: rule_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Rate limit rule unique identifier
      responses:
        '204':
          description: Rate limit rule deleted successfully
        '404':
          description: Rate limit rule not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /quotas/{user_id}:
    get:
      summary: Get user quota information
      description: Retrieve current quota usage and limits for a user
      operationId: getUserQuota
      tags:
        - Quota Management
      security:
        - BearerAuth: []
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: User unique identifier
      responses:
        '200':
          description: User quota information retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserQuota'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      summary: Update user quota limits
      description: |
        Updates quota limits for a specific user.

        **BACKEND NOTE:** Validates new limits, applies changes immediately.
        May trigger notifications if limits are reduced significantly.
      operationId: updateUserQuota
      tags:
        - Quota Management
      security:
        - BearerAuth: []
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: User unique identifier
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateQuotaRequest'
      responses:
        '200':
          description: User quota updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserQuota'
        '400':
          description: Invalid quota configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /monitoring/rate-limits:
    get:
      summary: Get real-time rate limiting statistics
      description: Retrieve current rate limiting statistics and blocked requests
      operationId: getRateLimitStats
      tags:
        - Monitoring & Analytics
      security:
        - BearerAuth: []
      parameters:
        - name: timeframe
          in: query
          schema:
            type: string
            enum:
              - 1m
              - 5m
              - 15m
              - 1h
            default: 5m
          description: Statistics timeframe
        - name: service_name
          in: query
          schema:
            type: string
          description: Filter by service name
      responses:
        '200':
          description: Rate limiting statistics retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RateLimitStats'
        '403':
          description: Not authorized to view statistics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /abuse/report:
    post:
      summary: Report potential abuse
      description: |
        Report suspicious activity for automated analysis and potential blocking.

        **BACKEND NOTE:** Triggers automated analysis, may result in temporary blocks.
        Used by services to report potential DDoS or abuse patterns.
      operationId: reportAbuse
      tags:
        - Abuse Prevention
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AbuseReport'
      responses:
        '201':
          description: Abuse report created and accepted for processing
        '202':
          description: Abuse report accepted for processing
        '400':
          description: Invalid abuse report
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /abuse/blacklist:
    post:
      summary: Add IP/service to blacklist
      description: |
        Manually add IP address or service identifier to blacklist.

        **BACKEND NOTE:** Immediate blocking across all services.
        Administrative override for emergency situations.
      operationId: blacklistEntity
      tags:
        - Abuse Prevention
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BlacklistRequest'
      responses:
        '201':
          description: Entity added to blacklist
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BlacklistEntry'
        '400':
          description: Invalid blacklist request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Entity already blacklisted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    get:
      summary: Get blacklist entries
      description: Retrieve current blacklist entries with optional filtering
      operationId: getBlacklist
      tags:
        - Abuse Prevention
      security:
        - BearerAuth: []
      parameters:
        - name: entity_type
          in: query
          schema:
            type: string
            enum:
              - ip
              - user_id
              - service
          description: Filter by entity type
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of entries per page
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Number of entries to skip
      responses:
        '200':
          description: Blacklist entries retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BlacklistResponse'
  /abuse/blacklist/{entry_id}:
    delete:
      summary: Remove from blacklist
      description: Remove an entity from the blacklist
      operationId: removeFromBlacklist
      tags:
        - Abuse Prevention
      security:
        - BearerAuth: []
      parameters:
        - name: entry_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Blacklist entry unique identifier
      responses:
        '204':
          description: Entity removed from blacklist
        '404':
          description: Blacklist entry not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      description: JWT Bearer token authentication
  schemas:
    HealthResponse:
      type: object
      required:
        - status
        - timestamp
      properties:
        version:
          type: string
          example: 1.0.0
        status:
          type: string
          enum:
            - healthy
          example: healthy
        timestamp:
          type: string
          format: date-time
          example: '2025-12-20T21:43:00Z'
        active_rules:
          type: integer
          description: Number of active rate limit rules
          example: 150
        blocked_requests_last_hour:
          type: integer
          description: Number of blocked requests in the last hour
          example: 2500
        redis_connections:
          type: integer
          description: Number of active Redis connections
          example: 8
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Unique error code
          example: RATE_LIMIT_EXCEEDED
        message:
          type: string
          description: Human-readable error message
          example: Rate limit exceeded. Try again in 60 seconds.
        timestamp:
          type: string
          format: date-time
          description: Error timestamp
          example: '2025-12-20T21:43:00Z'
        details:
          type: object
          description: Additional error details (optional)
        retry_after:
          type: integer
          description: Seconds to wait before retrying (for rate limit errors)
          example: 60
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    RateLimitRule:
      type: object
      required:
        - rule_id
        - service_name
        - endpoint_pattern
        - algorithm
        - limits
        - created_at
        - status
      properties:
        rule_id:
          type: string
          format: uuid
          description: Unique rate limit rule identifier
          example: rl1a2b3c4-d5e6-7890-1234-567890abcdef
        service_name:
          type: string
          description: Name of the protected service
          example: guild-service
        endpoint_pattern:
          type: string
          description: Endpoint pattern to protect (supports wildcards)
          example: /api/v1/guilds/*/members
        description:
          type: string
          maxLength: 500
          description: Optional rule description
          example: Standard rate limit for guild member operations
        algorithm:
          type: string
          enum:
            - token_bucket
            - sliding_window
            - leaky_bucket
            - fixed_window
          description: Rate limiting algorithm
          example: token_bucket
        status:
          type: string
          enum:
            - active
            - inactive
            - paused
          description: Rule status
          example: active
        created_at:
          type: string
          format: date-time
          description: Rule creation timestamp
          example: '2025-12-20T21:43:00Z'
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
          example: '2025-12-20T21:45:00Z'
        limits:
          type: object
          description: Rate limit configuration
          properties:
            requests_per_second:
              type: integer
              minimum: 1
              maximum: 10000
              description: Requests per second limit
              example: 100
            requests_per_minute:
              type: integer
              minimum: 1
              maximum: 100000
              description: Requests per minute limit
              example: 1000
            requests_per_hour:
              type: integer
              minimum: 1
              maximum: 1000000
              description: Requests per hour limit
              example: 10000
            burst_limit:
              type: integer
              minimum: 1
              maximum: 100000
              description: Burst allowance (extra requests allowed)
              example: 200
        scope:
          type: object
          description: Rule scope configuration
          properties:
            user_id:
              type: boolean
              description: Apply per user ID
              example: true
            ip_address:
              type: boolean
              description: Apply per IP address
              example: true
            api_key:
              type: boolean
              description: Apply per API key
              example: false
            region:
              type: string
              enum:
                - global
                - regional
                - local
              description: Geographic scope
              example: regional
        enforcement:
          type: object
          description: Enforcement configuration
          properties:
            block_duration_seconds:
              type: integer
              minimum: 1
              maximum: 3600
              description: How long to block when limit exceeded
              example: 300
            gradual_backoff:
              type: boolean
              description: Use gradual backoff instead of fixed block
              example: true
            notify_on_violation:
              type: boolean
              description: Send notifications when limits exceeded
              example: false
        priority:
          type: integer
          minimum: 0
          maximum: 100
          default: 50
          description: Rule priority (higher values take precedence)
          example: 75
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    RateLimitListResponse:
      type: object
      required:
        - rules
        - total_count
      properties:
        rules:
          type: array
          items:
            $ref: '#/components/schemas/RateLimitRule'
          description: List of rate limit rules
        total_count:
          type: integer
          minimum: 0
          description: Total number of rules
        limit:
          type: integer
          description: Items per page
        offset:
          type: integer
          description: Items skipped
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CreateRateLimitRequest:
      type: object
      required:
        - service_name
        - endpoint_pattern
        - algorithm
        - limits
      properties:
        service_name:
          type: string
          description: Name of the service to protect
          example: guild-service
        endpoint_pattern:
          type: string
          description: Endpoint pattern to protect
          example: /api/v1/guilds/*/members
        description:
          type: string
          maxLength: 500
          description: Optional rule description
        algorithm:
          type: string
          enum:
            - token_bucket
            - sliding_window
            - leaky_bucket
            - fixed_window
          default: token_bucket
          description: Rate limiting algorithm
        limits:
          type: object
          description: Rate limit configuration
          properties:
            requests_per_second:
              type: integer
              minimum: 1
              maximum: 10000
              default: 100
              description: Requests per second limit
            requests_per_minute:
              type: integer
              minimum: 1
              maximum: 100000
              description: Requests per minute limit
            requests_per_hour:
              type: integer
              minimum: 1
              maximum: 1000000
              description: Requests per hour limit
            burst_limit:
              type: integer
              minimum: 1
              maximum: 100000
              default: 200
              description: Burst allowance
        scope:
          type: object
          description: Rule scope configuration
          properties:
            user_id:
              type: boolean
              default: true
              description: Apply per user ID
            ip_address:
              type: boolean
              default: true
              description: Apply per IP address
            api_key:
              type: boolean
              default: false
              description: Apply per API key
            region:
              type: string
              enum:
                - global
                - regional
                - local
              default: regional
              description: Geographic scope
        enforcement:
          type: object
          description: Enforcement configuration
          properties:
            block_duration_seconds:
              type: integer
              minimum: 1
              maximum: 3600
              default: 300
              description: Block duration when limit exceeded
            gradual_backoff:
              type: boolean
              default: true
              description: Use gradual backoff
            notify_on_violation:
              type: boolean
              default: false
              description: Send violation notifications
        priority:
          type: integer
          minimum: 0
          maximum: 100
          default: 50
          description: Rule priority
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    UpdateRateLimitRequest:
      type: object
      properties:
        description:
          type: string
          maxLength: 500
          description: Updated rule description
        algorithm:
          type: string
          enum:
            - token_bucket
            - sliding_window
            - leaky_bucket
            - fixed_window
          description: New rate limiting algorithm
        status:
          type: string
          enum:
            - active
            - inactive
            - paused
          description: New rule status
        limits:
          type: object
          description: Updated rate limit configuration
          properties:
            requests_per_second:
              type: integer
              minimum: 1
              maximum: 10000
              description: New requests per second limit
            requests_per_minute:
              type: integer
              minimum: 1
              maximum: 100000
              description: New requests per minute limit
            requests_per_hour:
              type: integer
              minimum: 1
              maximum: 1000000
              description: New requests per hour limit
            burst_limit:
              type: integer
              minimum: 1
              maximum: 100000
              description: New burst allowance
        scope:
          type: object
          description: Updated scope configuration
          properties:
            user_id:
              type: boolean
              description: Apply per user ID
            ip_address:
              type: boolean
              description: Apply per IP address
            api_key:
              type: boolean
              description: Apply per API key
            region:
              type: string
              enum:
                - global
                - regional
                - local
              description: Geographic scope
        enforcement:
          type: object
          description: Updated enforcement configuration
          properties:
            block_duration_seconds:
              type: integer
              minimum: 1
              maximum: 3600
              description: New block duration
            gradual_backoff:
              type: boolean
              description: Use gradual backoff
            notify_on_violation:
              type: boolean
              description: Send violation notifications
        priority:
          type: integer
          minimum: 0
          maximum: 100
          description: New rule priority
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    UserQuota:
      type: object
      required:
        - user_id
        - quotas
        - usage
        - reset_schedule
        - created_at
      properties:
        user_id:
          type: string
          format: uuid
          description: User unique identifier
          example: u1a2b3c4-d5e6-7890-1234-567890abcdef
        tier:
          type: string
          enum:
            - free
            - bronze
            - silver
            - gold
            - platinum
            - vip
          description: User subscription tier
          example: gold
        created_at:
          type: string
          format: date-time
          description: Quota creation timestamp
          example: '2025-12-20T21:43:00Z'
        quotas:
          type: object
          description: Quota limits per category
          properties:
            requests_per_minute:
              type: integer
              minimum: 1
              maximum: 100000
              description: Maximum requests per minute
              example: 1000
            requests_per_hour:
              type: integer
              minimum: 1
              maximum: 1000000
              description: Maximum requests per hour
              example: 10000
            requests_per_day:
              type: integer
              minimum: 1
              maximum: 10000000
              description: Maximum requests per day
              example: 50000
            concurrent_connections:
              type: integer
              minimum: 1
              maximum: 1000
              description: Maximum concurrent connections
              example: 10
            bandwidth_mb_per_hour:
              type: integer
              minimum: 1
              maximum: 100000
              description: Maximum bandwidth usage (MB per hour)
              example: 1000
        usage:
          type: object
          description: Current usage statistics
          properties:
            requests_this_minute:
              type: integer
              minimum: 0
              description: Requests in current minute
              example: 45
            requests_this_hour:
              type: integer
              minimum: 0
              description: Requests in current hour
              example: 1250
            requests_this_day:
              type: integer
              minimum: 0
              description: Requests in current day
              example: 8500
            concurrent_connections:
              type: integer
              minimum: 0
              description: Current concurrent connections
              example: 3
            bandwidth_used_mb:
              type: number
              format: float
              minimum: 0
              description: Bandwidth used in current hour (MB)
              example: 45.5
        reset_schedule:
          type: object
          description: When quotas reset
          properties:
            minute_reset:
              type: string
              format: date-time
              description: Next minute reset time
              example: '2025-12-20T21:44:00Z'
            hour_reset:
              type: string
              format: date-time
              description: Next hour reset time
              example: '2025-12-20T22:00:00Z'
            day_reset:
              type: string
              format: date-time
              description: Next day reset time
              example: '2025-12-21T00:00:00Z'
        custom_limits:
          type: object
          description: Custom limits beyond standard tiers
          additionalProperties: true
          example:
            special_endpoint_limit: 5000
            priority_support: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    UpdateQuotaRequest:
      type: object
      properties:
        tier:
          type: string
          enum:
            - free
            - bronze
            - silver
            - gold
            - platinum
            - vip
          description: New subscription tier
        quotas:
          type: object
          description: Updated quota limits
          properties:
            requests_per_minute:
              type: integer
              minimum: 1
              maximum: 100000
              description: New requests per minute limit
            requests_per_hour:
              type: integer
              minimum: 1
              maximum: 1000000
              description: New requests per hour limit
            requests_per_day:
              type: integer
              minimum: 1
              maximum: 10000000
              description: New requests per day limit
            concurrent_connections:
              type: integer
              minimum: 1
              maximum: 1000
              description: New concurrent connections limit
            bandwidth_mb_per_hour:
              type: integer
              minimum: 1
              maximum: 100000
              description: New bandwidth limit (MB per hour)
        custom_limits:
          type: object
          description: Updated custom limits
          additionalProperties: true
        reset_usage:
          type: boolean
          default: false
          description: Reset current usage counters
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    RateLimitStats:
      type: object
      required:
        - timeframe
        - total_requests
        - allowed_requests
        - blocked_requests
        - rules_performance
      properties:
        timeframe:
          type: string
          enum:
            - 1m
            - 5m
            - 15m
            - 1h
            - 6h
            - 24h
          description: Statistics timeframe
        geographic_distribution:
          type: object
          description: Request distribution by geographic region
          additionalProperties:
            type: object
            properties:
              total_requests:
                type: integer
                example: 50000
              blocked_requests:
                type: integer
                example: 1000
              top_blocked_endpoints:
                type: array
                items:
                  type: string
                example:
                  - /api/v1/guilds/search
                  - /api/v1/players/online
          example:
            us-east-1:
              total_requests: 75000
              blocked_requests: 1500
              top_blocked_endpoints:
                - /api/v1/combat/join
            eu-west-1:
              total_requests: 45000
              blocked_requests: 800
              top_blocked_endpoints:
                - /api/v1/social/chat
        system_performance:
          type: object
          description: System-wide performance metrics
          properties:
            redis_operations_per_second:
              type: number
              format: float
              description: Redis operations per second
              example: 15000.5
            average_rule_evaluation_time_ms:
              type: number
              format: float
              description: Average time to evaluate rules
              example: 1.8
            memory_usage_mb:
              type: integer
              description: Current memory usage
              example: 512
            cache_hit_rate_percent:
              type: number
              format: float
              minimum: 0
              maximum: 100
              description: Overall cache hit rate
              example: 92.3
            active_connections:
              type: integer
              description: Active connections to rate limiting service
              example: 25
        rules_performance:
          type: array
          items:
            type: object
            properties:
              rule_id:
                type: string
                format: uuid
                description: Rate limit rule ID
                example: rl1a2b3c4-d5e6-7890-1234-567890abcdef
              service_name:
                type: string
                description: Service name
                example: guild-service
              endpoint_pattern:
                type: string
                description: Endpoint pattern
                example: /api/v1/guilds/*/members
              requests_processed:
                type: integer
                minimum: 0
                description: Requests processed by this rule
                example: 25000
              blocked_count:
                type: integer
                minimum: 0
                description: Requests blocked by this rule
                example: 500
              average_response_time_ms:
                type: number
                format: float
                description: Average rule evaluation time
                example: 2.5
              hit_rate_percent:
                type: number
                format: float
                minimum: 0
                maximum: 100
                description: Cache hit rate for this rule
                example: 95.5
          description: Performance statistics per rule
        top_offenders:
          type: array
          items:
            type: object
            properties:
              identifier:
                type: string
                description: User ID, IP, or API key
                example: 192.168.1.100
              identifier_type:
                type: string
                enum:
                  - ip
                  - user_id
                  - api_key
                example: ip
              blocked_requests:
                type: integer
                minimum: 0
                description: Number of blocked requests
                example: 250
              last_blocked_at:
                type: string
                format: date-time
                description: Last blocked request time
                example: '2025-12-20T21:40:00Z'
              block_duration_seconds:
                type: integer
                description: Current block duration
                example: 300
          maxItems: 50
          description: Top entities by blocked requests
        alerts:
          type: array
          items:
            type: object
            properties:
              alert_id:
                type: string
                format: uuid
                description: Unique alert identifier
              severity:
                type: string
                enum:
                  - low
                  - medium
                  - high
                  - critical
                example: high
              message:
                type: string
                description: Alert message
                example: High block rate detected for guild-service
              triggered_at:
                type: string
                format: date-time
                description: When alert was triggered
                example: '2025-12-20T21:35:00Z'
              resolved:
                type: boolean
                description: Whether alert is resolved
                example: false
              affected_services:
                type: array
                items:
                  type: string
                description: Services affected by the alert
                example:
                  - guild-service
                  - social-service
          description: Active alerts and warnings
        total_requests:
          type: integer
          minimum: 0
          description: Total requests processed
          example: 150000
        allowed_requests:
          type: integer
          minimum: 0
          description: Requests allowed through
          example: 145000
        blocked_requests:
          type: integer
          minimum: 0
          description: Requests blocked by rate limits
          example: 5000
        quota_exceeded_requests:
          type: integer
          minimum: 0
          description: Requests blocked by quota limits
          example: 1200
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    AbuseReport:
      type: object
      required:
        - reporter_service
        - suspect_identifier
        - abuse_type
        - evidence
      properties:
        reporter_service:
          type: string
          description: Service reporting the potential abuse
          example: guild-service
        suspect_identifier:
          type: string
          description: Suspected abuser identifier (IP, user ID, etc.)
          example: 192.168.1.100
        identifier_type:
          type: string
          enum:
            - ip
            - user_id
            - api_key
            - session_id
          description: Type of suspect identifier
          example: ip
        abuse_type:
          type: string
          enum:
            - ddos_attempt
            - credential_stuffing
            - scraping
            - api_misuse
            - rate_manipulation
          description: Type of suspected abuse
          example: ddos_attempt
        severity:
          type: string
          enum:
            - low
            - medium
            - high
            - critical
          default: medium
          description: Reported severity level
        evidence:
          type: object
          description: Evidence supporting the abuse report
          properties:
            request_count:
              type: integer
              description: Number of suspicious requests
              example: 1000
            time_window_seconds:
              type: integer
              description: Time window for the suspicious activity
              example: 300
            unusual_patterns:
              type: array
              items:
                type: string
              description: Unusual patterns observed
              example:
                - rapid_endpoint_switching
                - identical_payloads
                - non_human_timing
            affected_endpoints:
              type: array
              items:
                type: string
              description: Endpoints being abused
              example:
                - /api/v1/guilds/search
                - /api/v1/players/online
            user_agents:
              type: array
              items:
                type: string
              description: Suspicious user agents
              example:
                - Bot/1.0
                - SuspiciousClient/2.1
        context:
          type: object
          description: Additional context information
          properties:
            geo_location:
              type: string
              description: Geographic location if known
              example: Unknown
            vpn_detected:
              type: boolean
              description: Whether VPN usage was detected
              example: true
            proxy_detected:
              type: boolean
              description: Whether proxy usage was detected
              example: false
            tor_exit_node:
              type: boolean
              description: Whether Tor exit node was detected
              example: false
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    BlacklistEntry:
      type: object
      required:
        - entry_id
        - entity_identifier
        - entity_type
        - reason
        - created_at
        - expires_at
        - status
      properties:
        entry_id:
          type: string
          format: uuid
          description: Unique blacklist entry identifier
          example: bl1a2b3c4-d5e6-7890-1234-567890abcdef
        entity_identifier:
          type: string
          description: Blacklisted entity identifier
          example: 192.168.1.100
        reason:
          type: string
          description: Reason for blacklisting
          example: Confirmed DDoS attack from this IP address
        reported_by:
          type: string
          description: Who/what reported this entity
          example: security-team
        entity_type:
          type: string
          enum:
            - ip
            - user_id
            - api_key
            - service
            - subnet
          description: Type of blacklisted entity
          example: ip
        severity:
          type: string
          enum:
            - temporary
            - permanent
            - critical
          description: Blacklist severity level
          example: temporary
        status:
          type: string
          enum:
            - active
            - expired
            - removed
          description: Current blacklist status
          example: active
        created_at:
          type: string
          format: date-time
          description: When entry was created
          example: '2025-12-20T21:43:00Z'
        expires_at:
          type: string
          format: date-time
          description: When blacklist expires (null for permanent)
          example: '2025-12-20T22:43:00Z'
        last_hit_at:
          type: string
          format: date-time
          description: Last time this entry blocked a request
          example: '2025-12-20T21:45:30Z'
        hit_count:
          type: integer
          minimum: 0
          description: How many times this entry blocked requests
          example: 150
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    BlacklistResponse:
      type: object
      required:
        - entries
        - total_count
      properties:
        entries:
          type: array
          items:
            $ref: '#/components/schemas/BlacklistEntry'
          description: List of blacklist entries
        total_count:
          type: integer
          minimum: 0
          description: Total number of entries
        active_count:
          type: integer
          minimum: 0
          description: Number of active entries
        expired_count:
          type: integer
          minimum: 0
          description: Number of expired entries
        limit:
          type: integer
          description: Items per page
        offset:
          type: integer
          description: Items skipped
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    BlacklistRequest:
      type: object
      required:
        - entity_identifier
        - entity_type
        - reason
      properties:
        entity_identifier:
          type: string
          description: Entity to blacklist (IP, user ID, etc.)
          example: 192.168.1.100
        reason:
          type: string
          maxLength: 1000
          description: Reason for blacklisting
          example: Confirmed DDoS attack from this IP address
        reported_by:
          type: string
          description: Who/what reported this entity
          example: security-team
        entity_type:
          type: string
          enum:
            - ip
            - user_id
            - api_key
            - service
            - subnet
          description: Type of entity being blacklisted
          example: ip
        severity:
          type: string
          enum:
            - temporary
            - permanent
            - critical
          default: temporary
          description: Blacklist severity level
        duration_seconds:
          type: integer
          minimum: 60
          maximum: 2592000
          default: 3600
          description: How long to blacklist (0 = permanent)
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
