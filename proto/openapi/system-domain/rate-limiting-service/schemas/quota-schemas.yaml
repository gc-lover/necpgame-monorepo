components:
  schemas:
    UserQuota:
      type: object
      required:
        - user_id
        - quotas
        - usage
        - reset_schedule
        - created_at
      properties:
        user_id:
          type: string
          format: uuid
          description: User unique identifier
          example: u1a2b3c4-d5e6-7890-1234-567890abcdef
        tier:
          type: string
          enum:
            - free
            - bronze
            - silver
            - gold
            - platinum
            - vip
          description: User subscription tier
          example: gold
        created_at:
          type: string
          format: date-time
          description: Quota creation timestamp
          example: '2025-12-20T21:43:00Z'
        quotas:
          type: object
          description: Quota limits per category
          properties:
            requests_per_minute:
              type: integer
              minimum: 1
              maximum: 100000
              description: Maximum requests per minute
              example: 1000
            requests_per_hour:
              type: integer
              minimum: 1
              maximum: 1000000
              description: Maximum requests per hour
              example: 10000
            requests_per_day:
              type: integer
              minimum: 1
              maximum: 10000000
              description: Maximum requests per day
              example: 50000
            concurrent_connections:
              type: integer
              minimum: 1
              maximum: 1000
              description: Maximum concurrent connections
              example: 10
            bandwidth_mb_per_hour:
              type: integer
              minimum: 1
              maximum: 100000
              description: Maximum bandwidth usage (MB per hour)
              example: 1000
        usage:
          type: object
          description: Current usage statistics
          properties:
            requests_this_minute:
              type: integer
              minimum: 0
              description: Requests in current minute
              example: 45
            requests_this_hour:
              type: integer
              minimum: 0
              description: Requests in current hour
              example: 1250
            requests_this_day:
              type: integer
              minimum: 0
              description: Requests in current day
              example: 8500
            concurrent_connections:
              type: integer
              minimum: 0
              description: Current concurrent connections
              example: 3
            bandwidth_used_mb:
              type: number
              format: float
              minimum: 0
              description: Bandwidth used in current hour (MB)
              example: 45.5
        reset_schedule:
          type: object
          description: When quotas reset
          properties:
            minute_reset:
              type: string
              format: date-time
              description: Next minute reset time
              example: '2025-12-20T21:44:00Z'
            hour_reset:
              type: string
              format: date-time
              description: Next hour reset time
              example: '2025-12-20T22:00:00Z'
            day_reset:
              type: string
              format: date-time
              description: Next day reset time
              example: '2025-12-21T00:00:00Z'
        custom_limits:
          type: object
          description: Custom limits beyond standard tiers
          additionalProperties: true
          example:
            special_endpoint_limit: 5000
            priority_support: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    UpdateQuotaRequest:
      type: object
      properties:
        tier:
          type: string
          enum:
            - free
            - bronze
            - silver
            - gold
            - platinum
            - vip
          description: New subscription tier
        quotas:
          type: object
          description: Updated quota limits
          properties:
            requests_per_minute:
              type: integer
              minimum: 1
              maximum: 100000
              description: New requests per minute limit
            requests_per_hour:
              type: integer
              minimum: 1
              maximum: 1000000
              description: New requests per hour limit
            requests_per_day:
              type: integer
              minimum: 1
              maximum: 10000000
              description: New requests per day limit
            concurrent_connections:
              type: integer
              minimum: 1
              maximum: 1000
              description: New concurrent connections limit
            bandwidth_mb_per_hour:
              type: integer
              minimum: 1
              maximum: 100000
              description: New bandwidth limit (MB per hour)
        custom_limits:
          type: object
          description: Updated custom limits
          additionalProperties: true
        reset_usage:
          type: boolean
          default: false
          description: Reset current usage counters
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    QuotaExceededResponse:
      type: object
      required:
        - error
        - retry_after
        - quota_info
      properties:
        message:
          type: string
          description: Human-readable error message
          example: API quota exceeded for this minute. Upgrade your plan for higher limits.
        error:
          type: string
          enum:
            - quota_exceeded
          example: quota_exceeded
        quota_info:
          type: object
          description: Current quota status
          properties:
            tier:
              type: string
              enum:
                - free
                - bronze
                - silver
                - gold
                - platinum
                - vip
              example: free
            current_usage:
              type: object
              properties:
                requests_this_minute:
                  type: integer
                  example: 150
                requests_this_hour:
                  type: integer
                  example: 1200
                requests_this_day:
                  type: integer
                  example: 8500
            limits:
              type: object
              properties:
                requests_per_minute:
                  type: integer
                  example: 100
                requests_per_hour:
                  type: integer
                  example: 1000
                requests_per_day:
                  type: integer
                  example: 10000
        upgrade_options:
          type: array
          items:
            type: object
            properties:
              tier:
                type: string
                enum:
                  - bronze
                  - silver
                  - gold
                  - platinum
                  - vip
              requests_per_minute:
                type: integer
              price_per_month:
                type: number
                format: float
          description: Available upgrade options
          example:
            - tier: silver
              requests_per_minute: 500
              price_per_month: 9.99
        retry_after:
          type: integer
          description: Seconds until quota resets
          example: 45
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
