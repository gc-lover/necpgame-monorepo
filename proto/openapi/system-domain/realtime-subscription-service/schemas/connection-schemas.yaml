components:
  schemas:
    ConnectionStats:
      type: object
      required:
      - total_connections
      - active_connections
      - connections_by_status
      - average_uptime_seconds
      properties:
        connections_by_status:
          type: object
          description: Connections grouped by status
          properties:
            connected:
              type: integer
              example: 8500
            connecting:
              type: integer
              example: 25
            disconnecting:
              type: integer
              example: 15
            failed:
              type: integer
              example: 50
        connections_by_platform:
          type: object
          description: Connections grouped by client platform
          additionalProperties:
            type: integer
          example:
            web: 6500
            mobile: 1500
            desktop: 500
        connections_by_region:
          type: object
          description: Connections grouped by geographic region
          additionalProperties:
            type: integer
          example:
            us-east-1: 4200
            eu-west-1: 2800
            ap-south-1: 1500
        heartbeat_stats:
          type: object
          description: Heartbeat monitoring statistics
          properties:
            avg_heartbeat_interval_ms:
              type: integer
              description: Average heartbeat interval
              example: 30000
            missed_heartbeats_percent:
              type: number
              format: float
              minimum: 0
              maximum: 100
              description: Percentage of missed heartbeats
              example: 0.5
            heartbeat_failures_today:
              type: integer
              description: Heartbeat failures in last 24 hours
              example: 150
        bandwidth_stats:
          type: object
          description: Bandwidth usage statistics
          properties:
            total_bytes_sent:
              type: integer
              description: Total bytes sent since start
              example: 5000000000
            total_bytes_received:
              type: integer
              description: Total bytes received since start
              example: 50000000
            avg_bytes_per_connection:
              type: integer
              description: Average bytes per active connection
              example: 512000
            compression_ratio:
              type: number
              format: float
              description: Data compression ratio achieved
              example: 0.75
        error_stats:
          type: object
          description: Connection error statistics
          properties:
            connection_failures_today:
              type: integer
              description: Failed connection attempts today
              example: 250
            protocol_errors_today:
              type: integer
              description: WebSocket protocol errors today
              example: 15
            timeout_errors_today:
              type: integer
              description: Connection timeout errors today
              example: 80
            auth_failures_today:
              type: integer
              description: Authentication failures today
              example: 35
        average_uptime_seconds:
          type: number
          format: float
          description: Average connection uptime in seconds
          example: 1800.5
        reconnection_rate:
          type: number
          format: float
          minimum: 0
          maximum: 1
          description: Rate of successful reconnections (0-1)
          example: 0.95
        total_connections:
          type: integer
          minimum: 0
          description: Total connections handled since service start
          example: 50000
        active_connections:
          type: integer
          minimum: 0
          description: Currently active WebSocket connections
          example: 8500
        peak_connections:
          type: integer
          minimum: 0
          description: Peak concurrent connections
          example: 12000
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ConnectionDetails:
      type: object
      required:
      - connection_id
      - user_id
      - status
      - connected_at
      - last_heartbeat_at
      properties:
        connection_id:
          type: string
          format: uuid
          description: Unique connection identifier
          example: conn1a2b3c4-d5e6-7890-1234-567890abcdef
        user_id:
          type: string
          format: uuid
          description: Associated user identifier
          example: user1a2b3c4-d5e6-7890-1234-567890abcdef
        status:
          type: string
          enum:
          - connected
          - connecting
          - disconnecting
          - failed
          description: Current connection status
          example: connected
        connected_at:
          type: string
          format: date-time
          description: Connection establishment timestamp
          example: '2025-12-20T21:49:00Z'
        last_heartbeat_at:
          type: string
          format: date-time
          description: Last heartbeat timestamp
          example: '2025-12-20T21:49:30Z'
        client_info:
          type: object
          description: Client information
          properties:
            ip_address:
              type: string
              format: ipv4
              description: Client IP address
              example: 192.168.1.100
            user_agent:
              type: string
              description: Client user agent
              example: NECPGAME-Client/1.2.3
            platform:
              type: string
              enum:
              - web
              - mobile
              - desktop
              description: Client platform
              example: web
            region:
              type: string
              description: Geographic region
              example: us-east-1
        performance_metrics:
          type: object
          description: Connection performance metrics
          properties:
            bytes_sent:
              type: integer
              description: Total bytes sent on this connection
              example: 512000
            bytes_received:
              type: integer
              description: Total bytes received on this connection
              example: 5120
            messages_sent:
              type: integer
              description: Total messages sent
              example: 1500
            messages_received:
              type: integer
              description: Total messages received
              example: 15
            avg_latency_ms:
              type: number
              format: float
              description: Average message latency
              example: 45.2
        active_subscriptions:
          type: array
          items:
            type: string
            format: uuid
          description: List of active subscription IDs
          example:
          - sub1a2b3c4-d5e6-7890-1234-567890abcdef
        uptime_seconds:
          type: integer
          description: Connection uptime in seconds
          example: 1800
        subscription_count:
          type: integer
          minimum: 0
          description: Number of active subscriptions on this connection
          example: 5
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ForceDisconnectRequest:
      type: object
      properties:
        reason:
          type: string
          maxLength: 255
          description: Reason for forced disconnect
          example: Administrative maintenance
        send_close_frame:
          type: boolean
          default: true
          description: Whether to send WebSocket close frame
        cleanup_subscriptions:
          type: boolean
          default: true
          description: Whether to cleanup associated subscriptions
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
