openapi: 3.0.3
info:
  title: Combat Acrobatics Vault Service API
  description: 'API для управления Vault (перепрыгивание через препятствия).

    **Основные возможности:**

    - Выполнение Vault

    - Получение доступных препятствий

    '
  version: 1.0.0
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  contact:
    name: NECPGAME API Support
    email: api@necp.game
servers:
  - url: http://localhost:8083/api/v1/gameplay/combat/acrobatics
    description: Локальный сервер разработки
  - url: https://api.necp.game/api/v1/gameplay/combat/acrobatics
    description: Продакшен сервер
tags:
  - name: Vault
    description: Перепрыгивание через препятствия
paths:
  /vault:
    post:
      tags:
        - Vault
      summary: Выполнить Vault
      description: 'Выполняет перепрыгивание через препятствие. Автоматически

        определяет препятствие или использует указанное.

        Сохраняет инерцию движения и разрешает стрельбу.

        '
      operationId: executeVault
      security:
        - BearerAuth: [ ]
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VaultRequest'
      responses:
        '200':
          description: Vault выполнен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VaultResponse'
        '400':
          $ref: ../../../../common-schemas.yaml#/components/responses/BadRequest
        '401':
          $ref: ../../../../common-schemas.yaml#/components/responses/Unauthorized
        '500':
          $ref: ../../../../common-schemas.yaml#/components/responses/InternalServerError
  /vault/obstacles:
    get:
      tags:
        - Vault
      summary: Получить доступные препятствия для Vault
      description: 'Возвращает список доступных препятствий для Vault

        в текущей области персонажа.

        '
      operationId: getVaultObstacles
      security:
        - BearerAuth: [ ]
      parameters:
        - name: radius
          in: query
          required: false
          description: Радиус поиска препятствий
          schema:
            type: number
            format: float
            minimum: 0
            default: 10.0
      responses:
        '200':
          description: Список доступных препятствий
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ObstaclesResponse'
        '401':
          $ref: ../../../../common-schemas.yaml#/components/responses/Unauthorized
        '500':
          $ref: ../../../../common-schemas.yaml#/components/responses/InternalServerError
components:
  securitySchemes:
    BearerAuth:
      $ref: ../../../../common-schemas.yaml#/components/securitySchemes/BearerAuth
  schemas:
    VaultRequest:
      type: object
      properties:
        obstacle_id:
          type: string
          format: uuid
          description: ID препятствия (если не указан, определяется автоматически)
          nullable: true
          example: cc0e8400-e29b-41d4-a716-446655440000
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    VaultResponse:
      type: object
      required:
        - vault_id
        - obstacle_id
        - start_position
        - end_position
        - direction
        - stamina_consumed
        - timestamp
      properties:
        vault_id:
          type: string
          format: uuid
          example: dd0e8400-e29b-41d4-a716-446655440000
        obstacle_id:
          type: string
          format: uuid
          example: cc0e8400-e29b-41d4-a716-446655440000
        timestamp:
          type: string
          format: date-time
          example: '2025-12-01T10:00:00Z'
        direction:
          $ref: combat-acrobatics-basic-schemas.yaml#/components/schemas/Direction3D
        start_position:
          $ref: combat-acrobatics-basic-schemas.yaml#/components/schemas/Position3D
        end_position:
          $ref: combat-acrobatics-basic-schemas.yaml#/components/schemas/Position3D
        stamina_consumed:
          type: integer
          minimum: 0
          example: 5
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ObstaclesResponse:
      type: object
      required:
        - obstacles
        - total
      properties:
        obstacles:
          type: array
          items:
            $ref: '#/components/schemas/Obstacle'
        total:
          type: integer
          minimum: 0
          example: 1
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Obstacle:
      type: object
      required:
        - obstacle_id
        - obstacle_type
        - position
        - dimensions
        - material
        - is_suitable
      properties:
        obstacle_id:
          type: string
          format: uuid
          example: cc0e8400-e29b-41d4-a716-446655440000
        material:
          type: string
          example: metal
        obstacle_type:
          type: string
          enum:
            - barrier
            - fence
            - wall
            - crate
          example: barrier
        dimensions:
          $ref: combat-acrobatics-advanced-schemas.yaml#/components/schemas/Dimensions3D
        position:
          $ref: combat-acrobatics-basic-schemas.yaml#/components/schemas/Position3D
        is_suitable:
          type: boolean
          example: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
  responses:
    BadRequest:
      $ref: ../../../../common-schemas.yaml#/components/responses/BadRequest
    Unauthorized:
      $ref: ../../../../common-schemas.yaml#/components/responses/Unauthorized
    InternalServerError:
      $ref: common.yaml#/components/responses/InternalServerError
