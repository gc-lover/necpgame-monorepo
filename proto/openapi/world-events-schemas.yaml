openapi: 3.0.3
info:
  title: World Events System - Schemas
  description: Схемы данных для системы мировых событий
  version: 1.0.0
components:
  schemas:
    WorldEvent:
      type: object
      required:
      - id
      - title
      - description
      - type
      - scale
      - frequency
      - status
      - created_at
      - updated_at
      properties:
        id:
          type: string
          format: uuid
          description: Уникальный идентификатор события
        title:
          type: string
          description: Название события
          example: Технологический прорыв в киберимплантах
        description:
          type: string
          description: Описание события
          example: Новая технология киберимплантов увеличивает эффективность на 30%
        start_time:
          type: string
          format: date-time
          nullable: true
          description: Время начала события
        end_time:
          type: string
          format: date-time
          nullable: true
          description: Время окончания события
        created_at:
          type: string
          format: date-time
          description: Время создания
        updated_at:
          type: string
          format: date-time
          description: Время последнего обновления
        duration:
          type: string
          format: duration
          nullable: true
          description: Продолжительность события
          example: P7D
        cooldown_duration:
          type: string
          format: duration
          nullable: true
          description: Длительность cooldown после события
          example: P30D
        frequency:
          $ref: '#/components/schemas/WorldEventFrequency'
        scale:
          $ref: '#/components/schemas/WorldEventScale'
        status:
          $ref: '#/components/schemas/WorldEventStatus'
        type:
          $ref: '#/components/schemas/WorldEventType'
        effects:
          type: array
          items:
            $ref: '#/components/schemas/EventEffect'
          description: Эффекты события
        target_regions:
          type: array
          items:
            type: string
          description: Целевые регионы
          example:
          - night-city
          - pacific-northwest
        target_factions:
          type: array
          items:
            type: string
            format: uuid
          description: Целевые фракции
        prerequisites:
          type: array
          items:
            type: string
            format: uuid
          description: Предварительные условия (ID других событий)
        max_concurrent:
          type: integer
          nullable: true
          description: Максимальное количество одновременных событий этого типа
        version:
          type: integer
          description: Версия события
          example: 1
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    WorldEventType:
      type: string
      enum:
      - STORY
      - TECHNOLOGICAL
      - ECONOMIC
      - POLITICAL
      - MILITARY
      - SPORTS
      - ENVIRONMENTAL
      description: Тип мирового события
    WorldEventScale:
      type: string
      enum:
      - GLOBAL
      - REGIONAL
      - CITY
      - LOCAL
      description: Масштаб мирового события
    WorldEventFrequency:
      type: string
      enum:
      - ONE_TIME
      - PERIODIC
      - REGULAR
      description: Частота мирового события
    WorldEventStatus:
      type: string
      enum:
      - PLANNED
      - ANNOUNCED
      - ACTIVE
      - COOLDOWN
      - ARCHIVED
      description: Статус мирового события
    EventEffect:
      type: object
      required:
      - id
      - event_id
      - target_system
      - effect_type
      - is_active
      properties:
        id:
          type: string
          format: uuid
          description: Уникальный идентификатор эффекта
        event_id:
          type: string
          format: uuid
          description: ID события
        effect_type:
          type: string
          description: Тип эффекта
          example: price_modifier
        start_time:
          type: string
          format: date-time
          nullable: true
          description: Время начала эффекта
        end_time:
          type: string
          format: date-time
          nullable: true
          description: Время окончания эффекта
        parameters:
          type: object
          additionalProperties: true
          description: Параметры эффекта
          example:
            resource_type: weapons
            modifier: 0.15
        target_system:
          $ref: '#/components/schemas/EventTargetSystem'
        is_active:
          type: boolean
          description: Активен ли эффект
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    EventTargetSystem:
      type: string
      enum:
      - ECONOMY
      - SOCIAL
      - GAMEPLAY
      - REPUTATION
      - QUEST
      description: Целевая система для эффекта
    CreateWorldEventRequest:
      type: object
      required:
      - title
      - description
      - type
      - scale
      - frequency
      properties:
        title:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
          minLength: 1
          maxLength: 5000
        start_time:
          type: string
          format: date-time
        end_time:
          type: string
          format: date-time
        duration:
          type: string
          format: duration
        cooldown_duration:
          type: string
          format: duration
        frequency:
          $ref: '#/components/schemas/WorldEventFrequency'
        scale:
          $ref: '#/components/schemas/WorldEventScale'
        type:
          $ref: '#/components/schemas/WorldEventType'
        effects:
          type: array
          items:
            type: object
            properties:
              target_system:
                $ref: '#/components/schemas/EventTargetSystem'
              effect_type:
                type: string
              parameters:
                type: object
                additionalProperties: true
        target_regions:
          type: array
          items:
            type: string
        target_factions:
          type: array
          items:
            type: string
            format: uuid
        prerequisites:
          type: array
          items:
            type: string
            format: uuid
        max_concurrent:
          type: integer
          minimum: 1
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    UpdateWorldEventRequest:
      type: object
      properties:
        title:
          type: string
          minLength: 1
          maxLength: 200
        description:
          type: string
          minLength: 1
          maxLength: 5000
        start_time:
          type: string
          format: date-time
        end_time:
          type: string
          format: date-time
        duration:
          type: string
          format: duration
        cooldown_duration:
          type: string
          format: duration
        frequency:
          $ref: '#/components/schemas/WorldEventFrequency'
        scale:
          $ref: '#/components/schemas/WorldEventScale'
        type:
          $ref: '#/components/schemas/WorldEventType'
        effects:
          type: array
          items:
            type: object
        target_regions:
          type: array
          items:
            type: string
        target_factions:
          type: array
          items:
            type: string
            format: uuid
        prerequisites:
          type: array
          items:
            type: string
            format: uuid
        max_concurrent:
          type: integer
          minimum: 1
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    WorldEventsListResponse:
      type: object
      required:
      - events
      - total
      properties:
        events:
          type: array
          items:
            $ref: '#/components/schemas/WorldEvent'
        total:
          type: integer
          description: Общее количество событий
        limit:
          type: integer
        offset:
          type: integer
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    EventSchedule:
      type: object
      required:
      - id
      - event_id
      - scheduled_time
      - trigger_type
      - status
      - created_at
      properties:
        id:
          type: string
          format: uuid
          description: Уникальный идентификатор расписания
        event_id:
          type: string
          format: uuid
          description: ID события
        scheduled_time:
          type: string
          format: date-time
          description: Запланированное время запуска
        created_at:
          type: string
          format: date-time
        trigger_parameters:
          type: object
          additionalProperties: true
          description: Параметры триггера
          example:
            cron_expression: 0 0 * * *
        status:
          $ref: '#/components/schemas/EventScheduleStatus'
        trigger_type:
          $ref: '#/components/schemas/EventTriggerType'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    EventTriggerType:
      type: string
      enum:
      - CRON
      - MANUAL
      - QUEST
      - SIMULATION
      description: Тип триггера для запуска события
    EventScheduleStatus:
      type: string
      enum:
      - SCHEDULED
      - TRIGGERED
      - CANCELLED
      description: Статус расписания события
    ScheduleWorldEventRequest:
      type: object
      required:
      - event_id
      - scheduled_time
      - trigger_type
      properties:
        event_id:
          type: string
          format: uuid
        scheduled_time:
          type: string
          format: date-time
        trigger_parameters:
          type: object
          additionalProperties: true
        trigger_type:
          $ref: '#/components/schemas/EventTriggerType'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    EventSchedulesListResponse:
      type: object
      required:
      - schedules
      - total
      properties:
        schedules:
          type: array
          items:
            $ref: '#/components/schemas/EventSchedule'
        total:
          type: integer
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    WorldEventMetrics:
      type: object
      required:
      - event_id
      - uptime
      properties:
        event_id:
          type: string
          format: uuid
        uptime:
          type: string
          format: duration
          description: Время активности события
        player_count:
          type: integer
          description: Количество игроков, затронутых событием
        engagement_rate:
          type: number
          format: float
          description: Процент вовлеченности игроков
        economic_impact:
          type: number
          format: float
          description: Экономическое влияние
        social_impact:
          type: number
          format: float
          description: Социальное влияние
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    WorldEventEngagement:
      type: object
      required:
      - event_id
      properties:
        event_id:
          type: string
          format: uuid
        average_session_duration:
          type: string
          format: duration
        total_players:
          type: integer
        active_players:
          type: integer
        engagement_rate:
          type: number
          format: float
        participation_rate:
          type: number
          format: float
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    WorldEventImpact:
      type: object
      required:
      - event_id
      properties:
        event_id:
          type: string
          format: uuid
        economy_impact:
          type: object
          properties:
            price_changes:
              type: number
              format: float
            currency_changes:
              type: number
              format: float
            trade_volume:
              type: number
              format: float
        social_impact:
          type: object
          properties:
            reputation_changes:
              type: number
              format: float
            faction_relations_changes:
              type: number
              format: float
        gameplay_impact:
          type: object
          properties:
            ttk_changes:
              type: number
              format: float
            content_availability:
              type: number
              format: float
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    WorldEventAlertsResponse:
      type: object
      required:
      - alerts
      properties:
        alerts:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
                format: uuid
              event_id:
                type: string
                format: uuid
              alert_type:
                type: string
                example: engagement_below_threshold
              message:
                type: string
              severity:
                type: string
                enum:
                - LOW
                - MEDIUM
                - HIGH
                - CRITICAL
              created_at:
                type: string
                format: date-time
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
