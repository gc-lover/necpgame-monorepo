openapi: 3.0.3
info:
  title: AI Combat Calculator Service API
  description: '**AI Combat Calculator Service** - Advanced damage and healing calculation
    systems for NECPGAME MMOFPS RPG.


    ## Domain Purpose

    Provides high-performance, mathematically precise combat calculations including
    damage mitigation,

    healing amplification, critical hit mechanics, elemental interactions, and status
    effect calculations

    for all AI enemy combat interactions.


    ## Performance Targets

    - P99 Latency: <5ms for damage calculations

    - P99 Latency: <10ms for complex combat resolution

    - Memory Footprint: <25MB per zone

    - Calculation Accuracy: 99.999% precision

    - Concurrent Calculations: 10000+ per second supported


    ## Domain Inheritance (SOLID/DRY)

    This service inherits from game-entities.yaml providing:

    - Consistent base entity structure (id, timestamps, version) - НЕ ДУБЛИРУЕМ!

    - Game Domain entities through `allOf` pattern

    - Optimistic locking for concurrent operations (version field)

    - Strict typing with validation rules (min/max, patterns, enums)


    **SOLID/DRY Principle:**

    - ✅ Наследуем базовые поля через `$ref` и `allOf`

    - ✅ Добавляем только уникальные поля сервиса

    - ❌ НЕ дублируем общие поля (id, created_at, updated_at, version)

    - ❌ НЕ переопределяем базовые структуры

    '
  version: 1.0.0
  contact:
    name: NECPGAME AI API Team
    email: ai@necpgame.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
servers:
- url: https://api.necpgame.com/v1/ai-combat-calculator
  description: Production environment
- url: https://staging-api.necpgame.com/v1/ai-combat-calculator
  description: Staging environment
- url: http://localhost:8080/api/v1/ai-combat-calculator
  description: Local development
security:
- BearerAuth: []
tags:
- name: Damage Calculation
  description: Core damage calculation and mitigation systems
- name: Healing Calculation
  description: Healing amplification and restoration calculations
- name: Critical Hit Systems
  description: Critical hit probability and damage multipliers
- name: Elemental Interactions
  description: Elemental damage/resistance calculations
- name: Status Effects
  description: Status effect application and calculations
- name: Combat Resolution
  description: Complete combat interaction resolution
- name: Performance Monitoring
  description: Combat calculation performance metrics
- name: Health Monitoring
  description: Service health and performance monitoring
- name: Administration
  description: Administrative operations
paths:
  /health:
    get:
      operationId: aiCombatCalculatorHealthCheck
      summary: Basic health check
      description: Returns service health status
      tags:
      - Health Monitoring
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                required:
                - status
                - timestamp
                properties:
                  status:
                    type: string
                    enum:
                    - ok
                    - degraded
                    - critical
                    example: ok
                    description: Current health status
                  message:
                    type: string
                    example: Service is healthy
                    description: Human-readable status message
                  timestamp:
                    type: string
                    format: date-time
                    example: '2024-01-15T10:30:00Z'
                    description: Time when health check was performed
                  version:
                    type: string
                    example: 1.0.0
                    description: Service version
                  uptime:
                    type: integer
                    example: 3600
                    description: Service uptime in seconds
                  checks:
                    type: object
                    description: Detailed health checks
                    additionalProperties:
                      type: object
                      properties:
                        status:
                          type: string
                          enum:
                          - ok
                          - degraded
                          - critical
                        message:
                          type: string
                        response_time:
                          type: integer
                          description: Response time in milliseconds
        '503':
          description: Service is unhealthy
          content:
            application/json:
              schema:
                description: Service unavailable - system is under maintenance or
                  overloaded
                headers:
                  Retry-After:
                    schema:
                      type: integer
                      example: 300
                      description: Seconds until service is available again
                content:
                  application/json:
                    schema:
                      type: object
                      required:
                      - code
                      - message
                      properties:
                        code:
                          type: integer
                          minimum: 100
                          maximum: 599
                          example: 400
                        message:
                          type: string
                          example: Bad request
                        details:
                          type: object
                          description: Additional error details
  /health/detailed:
    get:
      operationId: aiCombatCalculatorDetailedHealthCheck
      summary: Detailed health check with calculation metrics
      description: Returns comprehensive health status including combat calculation
        performance metrics
      tags:
      - Health Monitoring
      responses:
        '200':
          description: Detailed health information
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/HealthResponse'
                - type: object
                  properties:
                    dependencies:
                      type: object
                      description: Health status of service dependencies
                      properties:
                        database:
                          $ref: '#/components/schemas/HealthResponse'
                        redis:
                          $ref: '#/components/schemas/HealthResponse'
                        external_services:
                          type: array
                          items:
                            type: object
                            properties:
                              name:
                                type: string
                                example: payment-service
                              status:
                                type: string
                                enum:
                                - ok
                                - degraded
                                - critical
                              response_time:
                                type: integer
                    metrics:
                      type: object
                      description: Service performance metrics
                      properties:
                        active_connections:
                          type: integer
                          example: 150
                        requests_per_second:
                          type: number
                          example: 45.2
                        average_response_time:
                          type: integer
                          example: 25
                        error_rate:
                          type: number
                          example: 0.001
        '503':
          description: Service is unhealthy
          content:
            application/json:
              schema:
                description: Service unavailable - system is under maintenance or
                  overloaded
                headers:
                  Retry-After:
                    schema:
                      type: integer
                      example: 300
                      description: Seconds until service is available again
                content:
                  application/json:
                    schema:
                      type: object
                      required:
                      - code
                      - message
                      properties:
                        code:
                          type: integer
                          minimum: 100
                          maximum: 599
                          example: 400
                        message:
                          type: string
                          example: Bad request
                        details:
                          type: object
                          description: Additional error details
  /damage/calculate:
    post:
      operationId: calculateDamage
      summary: Calculate damage for combat interaction
      description: 'Calculate precise damage for a combat interaction between attacker
        and defender.


        **Performance Notes:**

        - Vectorized calculations for multiple damage types

        - Pre-calculated mitigation tables

        - Memory-pooled calculation contexts

        - P99 latency target: <3ms

        '
      tags:
      - Damage Calculation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DamageCalculationRequest'
      responses:
        '200':
          description: Damage calculation completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DamageCalculationResult'
        '400':
          $ref: '#/components/responses/BadRequest'
  /damage/batch:
    post:
      operationId: calculateBatchDamage
      summary: Calculate damage for multiple combat interactions
      description: 'Calculate damage for multiple combat interactions in a single
        request for performance optimization.


        **Performance Notes:**

        - SIMD vectorized calculations

        - Shared mitigation table lookups

        - Up to 100 interactions per batch

        - P99 latency target: <8ms per interaction

        '
      tags:
      - Damage Calculation
      - Performance Monitoring
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BatchDamageRequest'
      responses:
        '200':
          description: Batch damage calculations completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchDamageResult'
        '400':
          $ref: '#/components/responses/BadRequest'
        '429':
          $ref: '#/components/responses/TooManyRequests'
  /damage/critical:
    post:
      operationId: calculateCriticalHit
      summary: Calculate critical hit damage and probability
      description: 'Calculate critical hit probability, damage multiplier, and special
        effects.


        **Performance Notes:**

        - Pre-calculated probability tables

        - Cached crit multipliers

        - P99 latency target: <2ms

        '
      tags:
      - Critical Hit Systems
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CriticalHitRequest'
      responses:
        '200':
          description: Critical hit calculation completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CriticalHitResult'
        '400':
          $ref: '#/components/responses/BadRequest'
  /healing/calculate:
    post:
      operationId: calculateHealing
      summary: Calculate healing amount and effects
      description: 'Calculate precise healing amount including amplification, over-heal,
        and special effects.


        **Performance Notes:**

        - Optimized healing formulas

        - Cached amplification calculations

        - P99 latency target: <3ms

        '
      tags:
      - Healing Calculation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HealingCalculationRequest'
      responses:
        '200':
          description: Healing calculation completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealingCalculationResult'
        '400':
          $ref: '#/components/responses/BadRequest'
  /healing/over-time:
    post:
      operationId: calculateOverTimeHealing
      summary: Calculate over-time healing effects
      description: 'Calculate healing-over-time (HoT) effects including tick rates,
        duration, and stacking rules.


        **Performance Notes:**

        - Pre-calculated tick schedules

        - Efficient stacking calculations

        - P99 latency target: <5ms

        '
      tags:
      - Healing Calculation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OverTimeHealingRequest'
      responses:
        '200':
          description: Over-time healing calculation completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OverTimeHealingResult'
        '400':
          $ref: '#/components/responses/BadRequest'
  /elemental/interaction:
    post:
      operationId: calculateElementalInteraction
      summary: Calculate elemental damage/resistance interactions
      description: 'Calculate damage modifiers based on elemental interactions (fire
        vs ice, cyber vs bio, etc.).


        **Performance Notes:**

        - Pre-calculated interaction matrix

        - Cached elemental modifiers

        - P99 latency target: <2ms

        '
      tags:
      - Elemental Interactions
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ElementalInteractionRequest'
      responses:
        '200':
          description: Elemental interaction calculated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ElementalInteractionResult'
        '400':
          $ref: '#/components/responses/BadRequest'
  /status-effects/apply:
    post:
      operationId: applyStatusEffect
      summary: Calculate and apply status effect
      description: 'Calculate status effect application including probability, duration,
        and stacking rules.


        **Performance Notes:**

        - Pre-calculated effect probabilities

        - Efficient stacking resolution

        - P99 latency target: <4ms

        '
      tags:
      - Status Effects
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StatusEffectApplicationRequest'
      responses:
        '200':
          description: Status effect application calculated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusEffectApplicationResult'
        '400':
          $ref: '#/components/responses/BadRequest'
  /status-effects/modify:
    post:
      operationId: modifyStatusEffect
      summary: Modify existing status effect
      description: 'Calculate modifications to existing status effects (amplification,
        reduction, dispelling).


        **Performance Notes:**

        - Cached effect modification rules

        - Atomic effect updates

        - P99 latency target: <3ms

        '
      tags:
      - Status Effects
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StatusEffectModificationRequest'
      responses:
        '200':
          description: Status effect modification calculated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusEffectModificationResult'
        '400':
          $ref: '#/components/responses/BadRequest'
  /combat/resolve:
    post:
      operationId: resolveCombatInteraction
      summary: Resolve complete combat interaction
      description: 'Resolve a complete combat interaction including damage, healing,
        status effects, and special mechanics.


        **Performance Notes:**

        - Optimized combat resolution pipeline

        - Cached calculation dependencies

        - P99 latency target: <10ms

        '
      tags:
      - Combat Resolution
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CombatInteractionRequest'
      responses:
        '200':
          description: Combat interaction resolved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatInteractionResult'
        '400':
          $ref: '#/components/responses/BadRequest'
  /combat/batch-resolve:
    post:
      operationId: resolveBatchCombatInteractions
      summary: Resolve multiple combat interactions
      description: 'Resolve multiple combat interactions in batch for high-throughput
        combat scenarios.


        **Performance Notes:**

        - Parallel combat resolution

        - Shared calculation contexts

        - Up to 50 interactions per batch

        - P99 latency target: <15ms per interaction

        '
      tags:
      - Combat Resolution
      - Performance Monitoring
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BatchCombatRequest'
      responses:
        '200':
          description: Batch combat interactions resolved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchCombatResult'
        '400':
          $ref: '#/components/responses/BadRequest'
        '429':
          $ref: '#/components/responses/TooManyRequests'
  /metrics/combat-performance:
    get:
      operationId: getCombatPerformanceMetrics
      summary: Get combat calculation performance metrics
      description: 'Retrieve comprehensive combat calculation performance metrics.


        **Performance Notes:**

        - Aggregated metrics collection

        - Historical data analysis (90 days)

        - Real-time performance monitoring

        - P99 latency target: <25ms

        '
      tags:
      - Performance Monitoring
      parameters:
      - name: start_time
        in: query
        schema:
          type: string
          format: date-time
        description: Metrics collection start time
      - name: end_time
        in: query
        schema:
          type: string
          format: date-time
        description: Metrics collection end time
      - name: calculation_type
        in: query
        schema:
          type: string
          enum:
          - damage
          - healing
          - critical
          - elemental
          - status_effect
          - combat_resolution
        description: Filter by calculation type
      responses:
        '200':
          description: Combat performance metrics retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatPerformanceMetrics'
        '400':
          $ref: '#/components/responses/BadRequest'
components:
  schemas:
    DamageCalculationRequest:
      type: object
      required:
      - attacker
      - defender
      - damage_source
      properties:
        attacker:
          $ref: '#/components/schemas/CombatParticipant'
        defender:
          $ref: '#/components/schemas/CombatParticipant'
        damage_source:
          $ref: '#/components/schemas/DamageSource'
        environmental_factors:
          $ref: '#/components/schemas/EnvironmentalFactors'
        special_modifiers:
          type: array
          items:
            $ref: '#/components/schemas/DamageModifier'
          description: Special damage modifiers
    CombatParticipant:
      type: object
      required:
      - entity_id
      - entity_type
      - stats
      properties:
        entity_id:
          type: string
          format: uuid
          description: Combat participant identifier
          example: f47ac10b-58cc-4372-a567-0e02b2c3d479
        entity_type:
          type: string
          enum:
          - player
          - ai_enemy
          - npc
          - environmental
          description: Type of combat participant
          example: ai_enemy
        stats:
          $ref: '#/components/schemas/CombatStats'
        position:
          $ref: ../common/schemas/game-entities.yaml#/components/schemas/Vector3
        faction:
          type: string
          enum:
          - neutral
          - hostile
          - ally
          - mercenary
          - corporate
          - gang
          description: Combat participant faction
    CombatStats:
      type: object
      required:
      - level
      - attack_power
      - defense_rating
      properties:
        level:
          type: integer
          minimum: 1
          maximum: 100
          description: Combat participant level
          example: 25
        attack_power:
          type: integer
          minimum: 0
          description: Base attack power
          example: 1500
        defense_rating:
          type: integer
          minimum: 0
          description: Defense rating
          example: 1200
        critical_chance:
          type: number
          format: float
          minimum: 0
          maximum: 1
          description: Critical hit chance
          example: 0.15
        critical_multiplier:
          type: number
          format: float
          minimum: 1
          maximum: 5
          description: Critical hit damage multiplier
          example: 2.0
        elemental_resistances:
          type: object
          additionalProperties:
            type: number
            format: float
            minimum: -1
            maximum: 1
          description: Elemental resistance values (-1 to 1)
          example:
            fire: 0.2
            ice: -0.1
            cyber: 0.5
    DamageSource:
      type: object
      required:
      - damage_type
      - base_damage
      properties:
        damage_type:
          type: string
          enum:
          - physical
          - energy
          - elemental
          - cyber
          - bio
          - chemical
          - explosive
          description: Type of damage
          example: physical
        base_damage:
          type: integer
          minimum: 0
          description: Base damage amount
          example: 500
        elemental_type:
          type: string
          enum:
          - fire
          - ice
          - lightning
          - acid
          - poison
          - radiation
          - cyber
          - bio
          description: Elemental damage type (if applicable)
          example: fire
        weapon_type:
          type: string
          enum:
          - pistol
          - rifle
          - shotgun
          - sniper
          - melee
          - grenade
          - ability
          description: Weapon or attack type
          example: rifle
        armor_penetration:
          type: number
          format: float
          minimum: 0
          maximum: 1
          description: Armor penetration percentage
          example: 0.3
        special_properties:
          type: array
          items:
            type: string
          description: Special damage properties
          example:
          - bleeding
          - stun
          - knockback
    EnvironmentalFactors:
      type: object
      properties:
        cover_modifier:
          type: number
          format: float
          minimum: -1
          maximum: 1
          description: Cover damage modifier
          example: 0.3
        range_modifier:
          type: number
          format: float
          minimum: -1
          maximum: 1
          description: Range-based damage modifier
          example: -0.2
        weather_modifier:
          type: number
          format: float
          minimum: -1
          maximum: 1
          description: Weather damage modifier
          example: 0.1
        terrain_modifier:
          type: number
          format: float
          minimum: -1
          maximum: 1
          description: Terrain damage modifier
          example: -0.1
    DamageModifier:
      type: object
      required:
      - modifier_type
      - value
      properties:
        modifier_type:
          type: string
          enum:
          - multiplier
          - additive
          - override
          description: Type of damage modifier
          example: multiplier
        value:
          type: number
          format: float
          description: Modifier value
          example: 1.5
        source:
          type: string
          description: Source of the modifier
          example: ability_boost
        duration_ms:
          type: integer
          minimum: 0
          description: Modifier duration in milliseconds
          example: 10000
    DamageCalculationResult:
      type: object
      required:
      - final_damage
      - damage_breakdown
      - hit_result
      properties:
        final_damage:
          type: integer
          minimum: 0
          description: Final calculated damage
          example: 387
        damage_breakdown:
          $ref: '#/components/schemas/DamageBreakdown'
        hit_result:
          type: string
          enum:
          - hit
          - critical_hit
          - dodge
          - block
          - immune
          description: Result of the attack
          example: hit
        status_effects_applied:
          type: array
          items:
            $ref: '#/components/schemas/StatusEffectApplication'
          description: Status effects applied by this damage
    DamageBreakdown:
      type: object
      required:
      - base_damage
      - mitigation
      - modifiers
      properties:
        base_damage:
          type: integer
          minimum: 0
          description: Base damage before modifiers
          example: 500
        mitigation:
          type: object
          required:
          - armor_reduction
          - resistance_reduction
          properties:
            armor_reduction:
              type: integer
              minimum: 0
              description: Damage reduced by armor
              example: 75
            resistance_reduction:
              type: integer
              minimum: 0
              description: Damage reduced by resistances
              example: 38
        modifiers:
          type: array
          items:
            type: object
            required:
            - name
            - value
            - type
            properties:
              name:
                type: string
                description: Modifier name
                example: critical_multiplier
              value:
                type: number
                format: float
                description: Modifier value
                example: 2.0
              type:
                type: string
                enum:
                - multiplier
                - additive
                description: Modifier type
                example: multiplier
        environmental_modifiers:
          type: object
          additionalProperties:
            type: number
            format: float
          description: Environmental modifier contributions
    BatchDamageRequest:
      type: object
      required:
      - damage_calculations
      properties:
        damage_calculations:
          type: array
          items:
            $ref: '#/components/schemas/DamageCalculationRequest'
          minItems: 1
          maxItems: 100
          description: Batch of damage calculations
    BatchDamageResult:
      type: object
      required:
      - results
      - processing_stats
      properties:
        results:
          type: array
          items:
            $ref: '#/components/schemas/DamageCalculationResult'
          description: Batch damage calculation results
        processing_stats:
          $ref: '#/components/schemas/BatchProcessingStats'
    CriticalHitRequest:
      type: object
      required:
      - attacker_stats
      - defender_stats
      - attack_type
      properties:
        attacker_stats:
          $ref: '#/components/schemas/CombatStats'
        defender_stats:
          $ref: '#/components/schemas/CombatStats'
        attack_type:
          type: string
          enum:
          - melee
          - ranged
          - ability
          - environmental
          description: Type of attack
          example: ranged
        situational_modifiers:
          type: array
          items:
            type: string
          description: Situational modifiers affecting crit chance
          example:
          - backstab
          - weak_spot
    CriticalHitResult:
      type: object
      required:
      - is_critical
      - probability
      - multiplier
      - special_effects
      properties:
        is_critical:
          type: boolean
          description: Whether the attack was critical
          example: true
        probability:
          type: number
          format: float
          minimum: 0
          maximum: 1
          description: Calculated critical hit probability
          example: 0.23
        multiplier:
          type: number
          format: float
          minimum: 1
          description: Critical damage multiplier
          example: 2.5
        special_effects:
          type: array
          items:
            type: string
          description: Special effects triggered by critical hit
          example:
          - bleeding
          - knockback
    HealingCalculationRequest:
      type: object
      required:
      - healer
      - target
      - healing_source
      properties:
        healer:
          $ref: '#/components/schemas/CombatParticipant'
        target:
          $ref: '#/components/schemas/CombatParticipant'
        healing_source:
          $ref: '#/components/schemas/HealingSource'
        current_health_percent:
          type: number
          format: float
          minimum: 0
          maximum: 1
          description: Target's current health percentage
          example: 0.3
    HealingSource:
      type: object
      required:
      - healing_type
      - base_healing
      properties:
        healing_type:
          type: string
          enum:
          - direct
          - over_time
          - ability
          - item
          - environmental
          description: Type of healing
          example: ability
        base_healing:
          type: integer
          minimum: 0
          description: Base healing amount
          example: 300
        amplification_modifiers:
          type: array
          items:
            $ref: '#/components/schemas/HealingModifier'
          description: Healing amplification modifiers
    HealingModifier:
      type: object
      required:
      - modifier_type
      - value
      properties:
        modifier_type:
          type: string
          enum:
          - amplification
          - reduction
          - override
          description: Type of healing modifier
          example: amplification
        value:
          type: number
          format: float
          description: Modifier value
          example: 1.3
        source:
          type: string
          description: Source of the modifier
          example: healing_boost_ability
    HealingCalculationResult:
      type: object
      required:
      - final_healing
      - healing_breakdown
      - over_heal
      properties:
        final_healing:
          type: integer
          minimum: 0
          description: Final calculated healing amount
          example: 234
        healing_breakdown:
          $ref: '#/components/schemas/HealingBreakdown'
        over_heal:
          type: integer
          minimum: 0
          description: Amount of over-healing
          example: 66
        status_effects_applied:
          type: array
          items:
            $ref: '#/components/schemas/StatusEffectApplication'
          description: Status effects applied by healing
    HealingBreakdown:
      type: object
      required:
      - base_healing
      - amplification
      - modifiers
      properties:
        base_healing:
          type: integer
          minimum: 0
          description: Base healing before modifiers
          example: 300
        amplification:
          type: number
          format: float
          minimum: 0
          description: Total healing amplification
          example: 1.3
        modifiers:
          type: array
          items:
            type: object
            required:
            - name
            - value
            - type
            properties:
              name:
                type: string
                description: Modifier name
              value:
                type: number
                format: float
                description: Modifier value
              type:
                type: string
                enum:
                - multiplier
                - additive
    OverTimeHealingRequest:
      type: object
      required:
      - healing_source
      - duration_seconds
      - tick_rate
      properties:
        healing_source:
          $ref: '#/components/schemas/HealingSource'
        duration_seconds:
          type: integer
          minimum: 1
          maximum: 300
          description: Total duration of HoT effect
          example: 15
        tick_rate:
          type: number
          format: float
          minimum: 0.1
          maximum: 10
          description: Ticks per second
          example: 1.0
        max_stacks:
          type: integer
          minimum: 1
          maximum: 10
          description: Maximum number of stacks
          example: 3
    OverTimeHealingResult:
      type: object
      required:
      - total_healing
      - tick_schedule
      - stacking_rules
      properties:
        total_healing:
          type: integer
          minimum: 0
          description: Total healing over effect duration
          example: 1500
        tick_schedule:
          type: array
          items:
            type: object
            required:
            - tick_number
            - healing_amount
            - timestamp_offset
            properties:
              tick_number:
                type: integer
                minimum: 1
                description: Sequential tick number
              healing_amount:
                type: integer
                minimum: 0
                description: Healing amount for this tick
              timestamp_offset:
                type: number
                format: float
                minimum: 0
                description: Time offset from start in seconds
          description: Scheduled healing ticks
        stacking_rules:
          type: object
          required:
          - can_stack
          - stack_refresh
          - max_duration
          properties:
            can_stack:
              type: boolean
              description: Whether effect can stack
            stack_refresh:
              type: boolean
              description: Whether applying refreshes existing stacks
            max_duration:
              type: integer
              minimum: 0
              description: Maximum effect duration
    ElementalInteractionRequest:
      type: object
      required:
      - attacker_element
      - defender_elements
      - damage_type
      properties:
        attacker_element:
          type: string
          enum:
          - fire
          - ice
          - lightning
          - acid
          - poison
          - radiation
          - cyber
          - bio
          - neutral
          description: Attacker's elemental type
          example: fire
        defender_elements:
          type: array
          items:
            type: string
            enum:
            - fire
            - ice
            - lightning
            - acid
            - poison
            - radiation
            - cyber
            - bio
            - neutral
          description: Defender's elemental resistances/types
          example:
          - ice
          - neutral
        damage_type:
          type: string
          enum:
          - physical
          - energy
          - elemental
          description: Base damage type
          example: elemental
        environmental_elements:
          type: array
          items:
            type: string
          description: Environmental elemental influences
    ElementalInteractionResult:
      type: object
      required:
      - damage_multiplier
      - resistance_modifier
      - special_effects
      properties:
        damage_multiplier:
          type: number
          format: float
          minimum: 0
          maximum: 5
          description: Final damage multiplier from elemental interaction
          example: 1.8
        resistance_modifier:
          type: number
          format: float
          minimum: -2
          maximum: 2
          description: Resistance modifier from elemental interaction
          example: -0.3
        special_effects:
          type: array
          items:
            type: string
          description: Special elemental effects triggered
          example:
          - melting
          - superheated
        interaction_breakdown:
          type: object
          additionalProperties:
            type: number
            format: float
          description: Breakdown of elemental interactions
          example:
            fire_vs_ice: 1.5
            fire_vs_water: 0.5
    StatusEffectApplicationRequest:
      type: object
      required:
      - effect_type
      - source
      - target
      - application_chance
      properties:
        effect_type:
          type: string
          enum:
          - poison
          - bleed
          - burn
          - freeze
          - stun
          - slow
          - weaken
          - amplify
          - shield
          description: Type of status effect
          example: poison
        source:
          $ref: '#/components/schemas/CombatParticipant'
        target:
          $ref: '#/components/schemas/CombatParticipant'
        application_chance:
          type: number
          format: float
          minimum: 0
          maximum: 1
          description: Probability of effect application
          example: 0.3
        effect_parameters:
          type: object
          additionalProperties: true
          description: Effect-specific parameters
          example:
            damage_per_tick: 50
            duration_seconds: 10
            tick_rate: 2.0
    StatusEffectApplication:
      type: object
      required:
      - effect_id
      - effect_type
      - duration_seconds
      - applied_by
      properties:
        effect_id:
          type: string
          format: uuid
          description: Unique effect instance identifier
        effect_type:
          type: string
          enum:
          - poison
          - bleed
          - burn
          - freeze
          - stun
          - slow
          - weaken
          - amplify
          - shield
          description: Type of status effect
        duration_seconds:
          type: integer
          minimum: 0
          description: Effect duration in seconds
        applied_by:
          type: string
          format: uuid
          description: Entity that applied the effect
        parameters:
          type: object
          additionalProperties: true
          description: Effect parameters
    StatusEffectApplicationResult:
      type: object
      required:
      - applied
      - effect_instance
      - failure_reason
      properties:
        applied:
          type: boolean
          description: Whether the effect was successfully applied
        effect_instance:
          $ref: '#/components/schemas/StatusEffectApplication'
        failure_reason:
          type: string
          enum:
          - immune
          - resisted
          - already_affected
          - invalid_target
          description: Reason for application failure
    StatusEffectModificationRequest:
      type: object
      required:
      - effect_id
      - modification_type
      properties:
        effect_id:
          type: string
          format: uuid
          description: Effect instance to modify
        modification_type:
          type: string
          enum:
          - amplify
          - reduce
          - dispel
          - refresh
          - stack
          description: Type of modification
        modification_parameters:
          type: object
          additionalProperties: true
          description: Modification-specific parameters
    StatusEffectModificationResult:
      type: object
      required:
      - success
      - modified_effect
      - new_parameters
      properties:
        success:
          type: boolean
          description: Whether modification was successful
        modified_effect:
          $ref: '#/components/schemas/StatusEffectApplication'
        new_parameters:
          type: object
          additionalProperties: true
          description: Updated effect parameters
    CombatInteractionRequest:
      type: object
      required:
      - attacker
      - defender
      - interaction_type
      properties:
        attacker:
          $ref: '#/components/schemas/CombatParticipant'
        defender:
          $ref: '#/components/schemas/CombatParticipant'
        interaction_type:
          type: string
          enum:
          - attack
          - ability
          - environmental
          - special
          description: Type of combat interaction
        attack_data:
          $ref: '#/components/schemas/DamageCalculationRequest'
        healing_data:
          $ref: '#/components/schemas/HealingCalculationRequest'
        status_effects:
          type: array
          items:
            $ref: '#/components/schemas/StatusEffectApplicationRequest'
          description: Status effects to apply
    CombatInteractionResult:
      type: object
      required:
      - interaction_success
      - damage_result
      - healing_result
      - status_effects_applied
      properties:
        interaction_success:
          type: boolean
          description: Whether the combat interaction was successful
        damage_result:
          $ref: '#/components/schemas/DamageCalculationResult'
        healing_result:
          $ref: '#/components/schemas/HealingCalculationResult'
        status_effects_applied:
          type: array
          items:
            $ref: '#/components/schemas/StatusEffectApplicationResult'
          description: Results of status effect applications
    BatchCombatRequest:
      type: object
      required:
      - combat_interactions
      properties:
        combat_interactions:
          type: array
          items:
            $ref: '#/components/schemas/CombatInteractionRequest'
          minItems: 1
          maxItems: 50
          description: Batch of combat interactions
    BatchCombatResult:
      type: object
      required:
      - results
      - processing_stats
      properties:
        results:
          type: array
          items:
            $ref: '#/components/schemas/CombatInteractionResult'
          description: Batch combat interaction results
        processing_stats:
          $ref: '#/components/schemas/BatchProcessingStats'
    CombatPerformanceMetrics:
      type: object
      required:
      - time_range
      - calculation_metrics
      - accuracy_metrics
      properties:
        time_range:
          type: object
          required:
          - start_time
          - end_time
          properties:
            start_time:
              type: string
              format: date-time
            end_time:
              type: string
              format: date-time
        calculation_metrics:
          $ref: '#/components/schemas/CalculationPerformanceMetrics'
        accuracy_metrics:
          $ref: '#/components/schemas/CalculationAccuracyMetrics'
    CalculationPerformanceMetrics:
      type: object
      required:
      - total_calculations
      - average_latency_ms
      - p99_latency_ms
      properties:
        total_calculations:
          type: integer
          minimum: 0
          description: Total calculations performed
          example: 1000000
        average_latency_ms:
          type: number
          format: float
          minimum: 0
          description: Average calculation latency
          example: 3.2
        p99_latency_ms:
          type: number
          format: float
          minimum: 0
          description: P99 calculation latency
          example: 8.5
        calculations_per_second:
          type: integer
          minimum: 0
          description: Calculations per second rate
          example: 8500
    CalculationAccuracyMetrics:
      type: object
      required:
      - precision_errors
      - calculation_errors
      - validation_errors
      properties:
        precision_errors:
          type: integer
          minimum: 0
          description: Number of precision errors
          example: 0
        calculation_errors:
          type: integer
          minimum: 0
          description: Number of calculation errors
          example: 5
        validation_errors:
          type: integer
          minimum: 0
          description: Number of validation errors
          example: 2
        error_rate_percent:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: Overall error rate percentage
          example: 0.0007
    BatchProcessingStats:
      type: object
      required:
      - total_processed
      - average_latency_ms
      - max_latency_ms
      properties:
        total_processed:
          type: integer
          minimum: 0
          description: Total items processed
          example: 50
        average_latency_ms:
          type: number
          format: float
          minimum: 0
          description: Average processing latency
          example: 12.5
        max_latency_ms:
          type: number
          format: float
          minimum: 0
          description: Maximum processing latency
          example: 25.0
        success_rate:
          type: number
          format: float
          minimum: 0
          maximum: 1
          description: Success rate of processing
          example: 0.98
    AdminOperationResponse:
      type: object
      required:
      - operation
      - status
      - affected_entities_count
      properties:
        operation:
          type: string
          description: Admin operation performed
          example: recalibrate_damage_formulas
        status:
          type: string
          enum:
          - success
          - partial_success
          - failed
          description: Operation result status
          example: success
        affected_entities_count:
          type: integer
          minimum: 0
          description: Number of entities affected by operation
          example: 5000
        execution_time_ms:
          type: integer
          minimum: 0
          description: Operation execution time in milliseconds
          example: 2500
    HealthResponse:
      type: object
      required:
      - status
      - timestamp
      properties:
        status:
          type: string
          enum:
          - ok
          - degraded
          - critical
          example: ok
          description: Current health status
        message:
          type: string
          example: Service is healthy
          description: Human-readable status message
        timestamp:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00Z'
          description: Time when health check was performed
        version:
          type: string
          example: 1.0.0
          description: Service version
        uptime:
          type: integer
          example: 3600
          description: Service uptime in seconds
        checks:
          type: object
          description: Detailed health checks
          additionalProperties:
            type: object
            properties:
              status:
                type: string
                enum:
                - ok
                - degraded
                - critical
              message:
                type: string
              response_time:
                type: integer
                description: Response time in milliseconds
    DetailedHealthResponse:
      allOf:
      - $ref: '#/components/schemas/HealthResponse'
      - type: object
        properties:
          dependencies:
            type: object
            description: Health status of service dependencies
            properties:
              database:
                $ref: '#/components/schemas/HealthResponse'
              redis:
                $ref: '#/components/schemas/HealthResponse'
              external_services:
                type: array
                items:
                  type: object
                  properties:
                    name:
                      type: string
                      example: payment-service
                    status:
                      type: string
                      enum:
                      - ok
                      - degraded
                      - critical
                    response_time:
                      type: integer
          metrics:
            type: object
            description: Service performance metrics
            properties:
              active_connections:
                type: integer
                example: 150
              requests_per_second:
                type: number
                example: 45.2
              average_response_time:
                type: integer
                example: 25
              error_rate:
                type: number
                example: 0.001
    HealthBatchRequest:
      type: object
      properties:
        services:
          type: array
          items:
            type: string
            example: database
          description: List of services to check
        timeout:
          type: integer
          minimum: 1
          maximum: 30
          default: 5
          description: Timeout for each health check in seconds
    HealthBatchResponse:
      type: object
      properties:
        overall_status:
          type: string
          enum:
          - ok
          - degraded
          - critical
          example: ok
          description: Overall health status across all checked services
        timestamp:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00Z'
        results:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/HealthResponse'
          description: Health results for each service
    ErrorResponse:
      type: object
      required:
      - code
      - message
      properties:
        code:
          type: integer
          minimum: 100
          maximum: 599
          example: 400
        message:
          type: string
          example: Bad request
        details:
          type: object
          description: Additional error details
    InfrastructureEntity:
      type: object
      required:
      - id
      - created_at
      - updated_at
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for infrastructure entity
          example: f47ac10b-58cc-4372-a567-0e02b2c3d479
        created_at:
          type: string
          format: date-time
          description: Entity creation timestamp
          example: '2024-01-15T10:30:00Z'
        updated_at:
          type: string
          format: date-time
          description: Last modification timestamp
          example: '2024-01-15T14:20:00Z'
        version:
          type: integer
          minimum: 1
          description: Optimistic locking version for concurrent operations
          example: 1
    BaseEntity:
      type: object
      required:
      - id
      - created_at
      - updated_at
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier
          example: f47ac10b-58cc-4372-a567-0e02b2c3d479
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
          example: '2024-01-15T10:30:00Z'
        updated_at:
          type: string
          format: date-time
          description: Last modification timestamp
          example: '2024-01-15T14:20:00Z'
    OptimisticLock:
      type: object
      properties:
        version:
          type: integer
          minimum: 1
          description: Version for optimistic locking
          example: 1
    UserAccountEntity:
      allOf:
      - $ref: '#/components/schemas/InfrastructureEntity'
      - type: object
        required:
        - username
        - email
        - account_status
        - registration_method
        properties:
          username:
            type: string
            minLength: 3
            maxLength: 30
            pattern: ^[a-zA-Z0-9_-]+$
            description: Unique username for login
            example: nightrunner2077
          email:
            type: string
            format: email
            description: Primary email address
            example: nightrunner@necpgame.com
          email_verified:
            type: boolean
            description: Whether email is verified
            example: true
          email_verification_token:
            type: string
            description: Token for email verification
            example: abc123def456
          password_hash:
            type: string
            description: Bcrypt password hash
            example: $2b$10$...
          account_status:
            type: string
            enum:
            - active
            - suspended
            - banned
            - pending_verification
            - deactivated
            description: Account status
            example: active
          registration_method:
            type: string
            enum:
            - email_password
            - google_oauth
            - discord_oauth
            - steam_oauth
            - guest
            description: How user registered
            example: email_password
          registration_ip:
            type: string
            description: IP address used during registration
            example: 192.168.1.100
          last_login_ip:
            type: string
            description: IP address of last login
            example: 10.0.0.50
          last_login_at:
            type: string
            format: date-time
            description: Timestamp of last successful login
            example: '2024-01-15T14:20:00Z'
          login_count:
            type: integer
            minimum: 0
            description: Total number of logins
            example: 147
          failed_login_attempts:
            type: integer
            minimum: 0
            description: Recent failed login attempts
            example: 0
          account_locked_until:
            type: string
            format: date-time
            description: When account lock expires
            example: '2024-01-15T16:00:00Z'
          two_factor_enabled:
            type: boolean
            description: Whether 2FA is enabled
            example: true
          two_factor_secret:
            type: string
            description: TOTP secret for 2FA
            example: JBSWY3DPEHPK3PXP
          recovery_email:
            type: string
            format: email
            description: Backup email for account recovery
            example: backup@necpgame.com
          preferred_language:
            type: string
            enum:
            - en
            - es
            - zh
            - ja
            - ru
            - de
            - fr
            - pl
            - ko
            - pt
            description: User's preferred language
            example: en
    SessionEntity:
      allOf:
      - $ref: '#/components/schemas/InfrastructureEntity'
      - type: object
        required:
        - user_id
        - session_token
        - ip_address
        - user_agent
        - expires_at
        properties:
          user_id:
            type: string
            format: uuid
            description: User this session belongs to
            example: a1b2c3d4-e5f6-7890-abcd-ef1234567890
          session_token:
            type: string
            minLength: 32
            maxLength: 128
            description: Unique session identifier/token
            example: abc123def456ghi789jkl012mno345pqr678stu901vwx
          refresh_token:
            type: string
            minLength: 32
            maxLength: 128
            description: Token for refreshing session
            example: yz234abc567def890ghi123jkl456mno789pqr012stu
          ip_address:
            type: string
            description: Client IP address
            example: 192.168.1.100
          user_agent:
            type: string
            description: Client user agent string
            example: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
          device_fingerprint:
            type: string
            description: Unique device identifier
            example: fp_abcdef1234567890
          location:
            type: string
            description: Approximate location based on IP
            example: New York, US
          expires_at:
            type: string
            format: date-time
            description: When session expires
            example: '2024-01-15T16:20:00Z'
          is_active:
            type: boolean
            description: Whether session is currently active
            example: true
          last_activity_at:
            type: string
            format: date-time
            description: Last user activity in this session
            example: '2024-01-15T15:45:00Z'
          security_level:
            type: string
            enum:
            - standard
            - elevated
            - maximum
            description: Security level of session
            example: standard
          session_metadata:
            type: object
            description: Additional session data
            properties:
              game_version:
                type: string
                description: Client game version
                example: 1.2.3
              platform:
                type: string
                enum:
                - windows
                - macos
                - linux
                - ios
                - android
                - web
                description: Client platform
                example: windows
              vpn_detected:
                type: boolean
                description: Whether VPN usage was detected
                example: false
    AuditLogEntity:
      allOf:
      - $ref: '#/components/schemas/InfrastructureEntity'
      - type: object
        required:
        - event_type
        - actor_id
        - resource_type
        - action
        - severity
        properties:
          event_type:
            type: string
            enum:
            - user_action
            - system_event
            - security_event
            - admin_action
            - api_call
            description: Category of audit event
            example: user_action
          actor_id:
            type: string
            format: uuid
            description: User/system that performed the action
            example: b2c3d4e5-f6g7-8901-bcde-f23456789012
          actor_type:
            type: string
            enum:
            - user
            - system
            - admin
            - api_client
            description: Type of actor
            example: user
          resource_type:
            type: string
            enum:
            - user
            - session
            - character
            - guild
            - item
            - transaction
            - quest
            - chat
            - file
            description: Type of resource affected
            example: character
          resource_id:
            type: string
            format: uuid
            description: Specific resource that was affected
            example: c3d4e5f6-g7h8-9012-cdef-345678901234
          action:
            type: string
            enum:
            - create
            - read
            - update
            - delete
            - login
            - logout
            - ban
            - unban
            - transfer
            - execute
            description: Action performed
            example: update
          old_values:
            type: object
            description: Previous state of modified fields
            example:
              level: 24
              experience: 12000
          new_values:
            type: object
            description: New state of modified fields
            example:
              level: 25
              experience: 12500
          severity:
            type: string
            enum:
            - low
            - medium
            - high
            - critical
            description: Security/impact severity
            example: low
          ip_address:
            type: string
            description: IP address of the actor
            example: 192.168.1.100
          user_agent:
            type: string
            description: User agent of the actor
            example: NECPGAME Client v1.2.3
          location:
            type: string
            description: Approximate location
            example: Night City, NC
          success:
            type: boolean
            description: Whether the action succeeded
            example: true
          error_message:
            type: string
            description: Error message if action failed
            example: Insufficient permissions
          metadata:
            type: object
            description: Additional audit data
            properties:
              request_id:
                type: string
                description: Unique request identifier
                example: req_abc123def456
              session_id:
                type: string
                format: uuid
                description: Associated session ID
                example: d4e5f6g7-h8i9-0123-def0-456789012345
              api_endpoint:
                type: string
                description: API endpoint called
                example: /api/v1/characters/upgrade
              response_time_ms:
                type: integer
                description: API response time
                example: 45
    ApiKeyEntity:
      allOf:
      - $ref: '#/components/schemas/InfrastructureEntity'
      - type: object
        required:
        - owner_id
        - name
        - key_hash
        - permissions
        - status
        properties:
          owner_id:
            type: string
            format: uuid
            description: User or service that owns this API key
            example: e5f6g7h8-i9j0-1234-ef01-567890123456
          name:
            type: string
            minLength: 1
            maxLength: 50
            description: Human-readable name for the key
            example: Mobile App Key
          description:
            type: string
            maxLength: 200
            description: Description of key usage
            example: API key for mobile application authentication
          key_hash:
            type: string
            description: SHA-256 hash of the actual API key
            example: a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3
          key_prefix:
            type: string
            minLength: 8
            maxLength: 8
            description: First 8 characters of API key for identification
            example: ncp_1a2b
          permissions:
            type: array
            items:
              type: string
              enum:
              - read_user
              - write_user
              - read_character
              - write_character
              - read_inventory
              - write_inventory
              - admin
            description: Granted permissions
            example:
            - read_user
            - read_character
            - read_inventory
          status:
            type: string
            enum:
            - active
            - suspended
            - revoked
            - expired
            description: API key status
            example: active
          expires_at:
            type: string
            format: date-time
            description: When key expires (null = never)
            example: '2025-01-15T10:30:00Z'
          last_used_at:
            type: string
            format: date-time
            description: Last time key was used
            example: '2024-01-15T14:20:00Z'
          usage_count:
            type: integer
            minimum: 0
            description: Total API calls made with this key
            example: 15420
          rate_limit:
            type: integer
            minimum: 1
            description: Requests per minute allowed
            example: 60
          allowed_ips:
            type: array
            items:
              type: string
            description: IP addresses allowed to use this key
            example:
            - 192.168.1.0/24
            - 10.0.0.1
          metadata:
            type: object
            description: Additional key metadata
            properties:
              created_by:
                type: string
                format: uuid
                description: User who created this key
                example: f6g7h8i9-j0k1-2345-f012-678901234567
              application:
                type: string
                description: Application using this key
                example: NECPGAME Mobile App
              environment:
                type: string
                enum:
                - development
                - staging
                - production
                description: Environment this key is for
                example: production
    ConfigurationEntity:
      allOf:
      - $ref: '#/components/schemas/InfrastructureEntity'
      - type: object
        required:
        - config_key
        - config_value
        - config_type
        - environment
        properties:
          config_key:
            type: string
            minLength: 1
            maxLength: 100
            pattern: ^[a-zA-Z0-9_\-\.]+$
            description: Configuration key
            example: game.max_players_per_server
          config_value:
            type: string
            description: Configuration value (stored as string)
            example: '1000'
          config_type:
            type: string
            enum:
            - string
            - integer
            - float
            - boolean
            - json
            description: Data type of the value
            example: integer
          environment:
            type: string
            enum:
            - development
            - staging
            - production
            - all
            description: Environment this config applies to
            example: production
          description:
            type: string
            maxLength: 500
            description: Description of what this config controls
            example: Maximum number of players allowed per game server
          default_value:
            type: string
            description: Default value if not set
            example: '500'
          validation_rules:
            type: object
            description: Validation rules for the value
            properties:
              min_value:
                type: number
                description: Minimum allowed value
                example: 1
              max_value:
                type: number
                description: Maximum allowed value
                example: 10000
              allowed_values:
                type: array
                items:
                  type: string
                description: List of allowed values
                example:
                - '100'
                - '500'
                - '1000'
                - '2000'
          is_encrypted:
            type: boolean
            description: Whether value is encrypted
            example: false
          last_modified_by:
            type: string
            format: uuid
            description: User who last modified this config
            example: g7h8i9j0-k1l2-3456-0123-456789012345
          requires_restart:
            type: boolean
            description: Whether server restart is required after change
            example: true
    ServiceHealthEntity:
      allOf:
      - $ref: '#/components/schemas/InfrastructureEntity'
      - type: object
        required:
        - service_name
        - status
        - response_time_ms
        - timestamp
        properties:
          service_name:
            type: string
            minLength: 1
            maxLength: 50
            description: Name of the service being monitored
            example: auth-service
          status:
            type: string
            enum:
            - healthy
            - degraded
            - unhealthy
            - down
            - maintenance
            description: Current health status
            example: healthy
          response_time_ms:
            type: integer
            minimum: 0
            description: Response time in milliseconds
            example: 45
          timestamp:
            type: string
            format: date-time
            description: When this health check was performed
            example: '2024-01-15T15:30:00Z'
          uptime_seconds:
            type: integer
            minimum: 0
            description: Service uptime in seconds
            example: 86400
          memory_usage_mb:
            type: integer
            minimum: 0
            description: Current memory usage in MB
            example: 256
          memory_usage_percent:
            type: number
            minimum: 0
            maximum: 100
            description: Memory usage percentage
            example: 23.5
          cpu_usage_percent:
            type: number
            minimum: 0
            maximum: 100
            description: CPU usage percentage
            example: 15.2
          active_connections:
            type: integer
            minimum: 0
            description: Number of active connections
            example: 1250
          queue_depth:
            type: integer
            minimum: 0
            description: Number of queued requests
            example: 5
          error_rate_percent:
            type: number
            minimum: 0
            maximum: 100
            description: Error rate percentage
            example: 0.1
          version:
            type: string
            description: Service version
            example: 1.2.3
          environment:
            type: string
            enum:
            - development
            - staging
            - production
            description: Deployment environment
            example: production
          checks:
            type: array
            items:
              $ref: '#/components/schemas/HealthCheck'
            description: Detailed health checks
    HealthCheck:
      type: object
      required:
      - check_name
      - status
      - response_time_ms
      properties:
        check_name:
          type: string
          minLength: 1
          maxLength: 50
          description: Name of the health check
          example: database_connection
        status:
          type: string
          enum:
          - pass
          - warn
          - fail
          description: Health check result
          example: pass
        response_time_ms:
          type: integer
          minimum: 0
          description: Check response time
          example: 12
        message:
          type: string
          maxLength: 200
          description: Check result message
          example: Database connection successful
        details:
          type: object
          description: Additional check details
          example:
            connection_pool_size: 10
            active_connections: 3
    NotificationQueueEntity:
      allOf:
      - $ref: '#/components/schemas/InfrastructureEntity'
      - type: object
        required:
        - notification_type
        - recipient_id
        - content
        - priority
        - status
        properties:
          notification_type:
            type: string
            enum:
            - email
            - push
            - in_game
            - sms
            - webhook
            description: Type of notification
            example: email
          recipient_id:
            type: string
            format: uuid
            description: User receiving the notification
            example: a1b2c3d4-e5f6-7890-abcd-ef1234567890
          recipient_contact:
            type: string
            description: Contact info (email, phone, etc.)
            example: user@necpgame.com
          content:
            type: object
            description: Notification content
            required:
            - subject
            - body
            properties:
              subject:
                type: string
                minLength: 1
                maxLength: 100
                description: Notification subject/title
                example: Quest Completed!
              body:
                type: string
                minLength: 1
                maxLength: 2000
                description: Notification body/content
                example: Congratulations! You have completed the 'Corporate Espionage'
                  quest.
              template_id:
                type: string
                description: Template used for notification
                example: quest_completion_v2
          priority:
            type: string
            enum:
            - low
            - normal
            - high
            - critical
            description: Notification priority
            example: normal
          status:
            type: string
            enum:
            - queued
            - processing
            - sent
            - delivered
            - failed
            - cancelled
            description: Delivery status
            example: queued
          scheduled_for:
            type: string
            format: date-time
            description: When to send notification (null = immediate)
            example: '2024-01-15T16:00:00Z'
          sent_at:
            type: string
            format: date-time
            description: When notification was sent
            example: '2024-01-15T15:45:00Z'
          delivered_at:
            type: string
            format: date-time
            description: When notification was delivered
            example: '2024-01-15T15:45:02Z'
          retry_count:
            type: integer
            minimum: 0
            description: Number of delivery attempts
            example: 0
          max_retries:
            type: integer
            minimum: 0
            maximum: 5
            description: Maximum retry attempts
            example: 3
          error_message:
            type: string
            description: Delivery error message
            example: SMTP server timeout
          metadata:
            type: object
            description: Additional notification data
            properties:
              campaign_id:
                type: string
                description: Marketing campaign ID
                example: quest_reminder_2024
              source_service:
                type: string
                description: Service that triggered notification
                example: quest-service
              user_preferences:
                type: object
                description: User's notification preferences
                example:
                  email_enabled: true
                  push_enabled: false
  responses:
    BadRequest:
      description: Bad request - invalid input parameters
      content:
        application/json:
          schema:
            description: Bad request - validation failed or malformed data
            headers:
              Content-Type:
                schema:
                  type: string
                  example: application/json
            content:
              application/json:
                schema:
                  type: object
                  required:
                  - code
                  - message
                  properties:
                    code:
                      type: integer
                      minimum: 100
                      maximum: 599
                      example: 400
                    message:
                      type: string
                      example: Bad request
                    details:
                      type: object
                      description: Additional error details
    Conflict:
      description: Conflict - resource state conflict
      content:
        application/json:
          schema:
            description: Conflict - resource has been modified by another request
    Forbidden:
      description: Forbidden - insufficient permissions
      content:
        application/json:
          schema:
            description: Forbidden - insufficient permissions for this operation
            content:
              application/json:
                schema:
                  type: object
                  required:
                  - code
                  - message
                  properties:
                    code:
                      type: integer
                      minimum: 100
                      maximum: 599
                      example: 400
                    message:
                      type: string
                      example: Bad request
                    details:
                      type: object
                      description: Additional error details
    NotFound:
      description: Not found - resource does not exist
      content:
        application/json:
          schema:
            description: Not found - requested resource does not exist
            content:
              application/json:
                schema:
                  type: object
                  required:
                  - code
                  - message
                  properties:
                    code:
                      type: integer
                      minimum: 100
                      maximum: 599
                      example: 400
                    message:
                      type: string
                      example: Bad request
                    details:
                      type: object
                      description: Additional error details
    TooManyRequests:
      description: Too many requests - rate limit exceeded
      content:
        application/json:
          schema:
            description: Too many requests - rate limit exceeded
            headers:
              Retry-After:
                schema:
                  type: integer
                  example: 60
                  description: Seconds to wait before retrying
              X-RateLimit-Limit:
                schema:
                  type: integer
                  description: Maximum requests per time window
              X-RateLimit-Remaining:
                schema:
                  type: integer
                  description: Remaining requests in current window
              X-RateLimit-Reset:
                schema:
                  type: string
                  format: date-time
                  description: Time when rate limit resets
            content:
              application/json:
                schema:
                  type: object
                  required:
                  - code
                  - message
                  properties:
                    code:
                      type: integer
                      minimum: 100
                      maximum: 599
                      example: 400
                    message:
                      type: string
                      example: Bad request
                    details:
                      type: object
                      description: Additional error details
    ServiceUnavailable:
      description: Service unavailable - system is under maintenance or overloaded
      headers:
        Retry-After:
          schema:
            type: integer
            example: 300
            description: Seconds until service is available again
      content:
        application/json:
          schema:
            $ref: ../schemas/infrastructure-entities.yaml#/components/schemas/ErrorResponse
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT Bearer token authentication
    AdminAuth:
      type: apiKey
      in: header
      name: X-Admin-Token
      description: Administrative access token
