// Code generated by ogen, DO NOT EDIT.

package api

import (
	"context"
)

// Handler handles operations described by OpenAPI v3 specification.
type Handler interface {
	// AuthGetCurrentUser implements authGetCurrentUser operation.
	//
	// **Current user profile endpoint**
	// Returns authenticated user's profile information.
	// Used for client-side user data display and session validation.
	// **Performance:** <5ms P95 with caching.
	//
	// GET /auth/me
	AuthGetCurrentUser(ctx context.Context) (AuthGetCurrentUserRes, error)
	// AuthLogin implements authLogin operation.
	//
	// **Enterprise-grade authentication endpoint**
	// Authenticates user credentials and returns JWT access token.
	// Supports password-based authentication with optional MFA.
	// Implements rate limiting and brute-force protection.
	// **Performance:** <25ms P95, includes password hashing verification
	// **Security:** Argon2id password hashing, JWT tokens with expiration.
	//
	// POST /auth/login
	AuthLogin(ctx context.Context, req *LoginRequest) (AuthLoginRes, error)
	// AuthLogout implements authLogout operation.
	//
	// **Secure logout endpoint**
	// Invalidates current session and refresh tokens.
	// Supports global logout from all devices.
	// **Performance:** <10ms P95.
	//
	// POST /auth/logout
	AuthLogout(ctx context.Context) (AuthLogoutRes, error)
	// AuthRefresh implements authRefresh operation.
	//
	// **Token refresh endpoint**
	// Exchanges refresh token for new access token.
	// Maintains user session without re-authentication.
	// **Performance:** <15ms P95
	// **Security:** Refresh token rotation, short-lived access tokens.
	//
	// POST /auth/refresh
	AuthRefresh(ctx context.Context, req *AuthRefreshReq) (AuthRefreshRes, error)
	// AuthRegister implements authRegister operation.
	//
	// **Enterprise-grade user registration endpoint**
	// Creates new user account with email/password authentication.
	// Includes email verification, password strength validation, and duplicate checking.
	// **Performance:** <100ms P95, includes password hashing and email sending
	// **Security:** Argon2id password hashing, email verification required.
	//
	// POST /auth/register
	AuthRegister(ctx context.Context, req *RegisterRequest) (AuthRegisterRes, error)
	// AuthServiceBatchHealthCheck implements authServiceBatchHealthCheck operation.
	//
	// **Performance optimization:** Check multiple services health in single request
	// Reduces N HTTP calls to 1 call. Critical for orchestration.
	// **Use case:** Service mesh health checks, Kubernetes readiness probes.
	//
	// POST /health/batch
	AuthServiceBatchHealthCheck(ctx context.Context, req *AuthServiceBatchHealthCheckReq) (AuthServiceBatchHealthCheckRes, error)
	// AuthServiceHealthCheck implements authServiceHealthCheck operation.
	//
	// **Enterprise-grade health check endpoint**
	// Provides real-time health status of the authentication microservice.
	// Critical for service discovery, load balancing, and monitoring.
	// **Performance:** <1ms response time, cached for 30 seconds.
	//
	// GET /health
	AuthServiceHealthCheck(ctx context.Context, params AuthServiceHealthCheckParams) (AuthServiceHealthCheckRes, error)
	// AuthServiceHealthWebSocket implements authServiceHealthWebSocket operation.
	//
	// **Performance optimization:** Real-time health updates without polling
	// Eliminates periodic HTTP requests, reduces server load by ~90%.
	// Perfect for dashboard monitoring and alerting systems.
	// **Protocol:** WebSocket with JSON payloads
	// **Heartbeat:** 30 second intervals
	// **Reconnection:** Automatic with exponential backoff.
	//
	// GET /health/ws
	AuthServiceHealthWebSocket(ctx context.Context, params AuthServiceHealthWebSocketParams) (AuthServiceHealthWebSocketRes, error)
	// CleanupSessions implements cleanupSessions operation.
	//
	// **Clean up expired or inactive user sessions**
	// Performs automated cleanup of sessions that have exceeded their lifetime or are in invalid states.
	// Helps maintain database performance and security by removing stale session data.
	// **Performance:** Batch processing with configurable cleanup policies.
	//
	// POST /auth/sessions/cleanup
	CleanupSessions(ctx context.Context, req OptCleanupSessionsRequest) (CleanupSessionsRes, error)
	// GetActiveSessions implements getActiveSessions operation.
	//
	// **Retrieve paginated list of active sessions**
	// Returns currently active sessions with filtering and pagination support. Useful for administrative
	// monitoring and troubleshooting.
	// **Performance:** Indexed queries with pagination optimization.
	//
	// GET /auth/sessions/monitoring/active
	GetActiveSessions(ctx context.Context, params GetActiveSessionsParams) (GetActiveSessionsRes, error)
	// GetCleanupStats implements getCleanupStats operation.
	//
	// **Retrieve session cleanup statistics and metrics**
	// Returns information about recent cleanup operations, success rates, and performance metrics for
	// session management.
	// **Performance:** Cached statistics with configurable refresh intervals.
	//
	// GET /auth/sessions/cleanup/stats
	GetCleanupStats(ctx context.Context) (GetCleanupStatsRes, error)
	// GetOAuthRedirect implements getOAuthRedirect operation.
	//
	// **Get OAuth provider redirect URL for authentication**
	// Returns the authorization URL for the specified OAuth provider. Client should redirect user to
	// this URL to initiate OAuth flow.
	// **Security:** Provider validation and CSRF protection via state parameter **Performance:** <10ms
	// response time, cached provider configs.
	//
	// GET /auth/oauth/{provider}/redirect
	GetOAuthRedirect(ctx context.Context, params GetOAuthRedirectParams) (GetOAuthRedirectRes, error)
	// GetSessionStats implements getSessionStats operation.
	//
	// **Retrieve comprehensive session statistics**
	// Provides detailed metrics about session lifecycle, concurrent users, geographic distribution, and
	// performance indicators.
	// **Performance:** Aggregated statistics with efficient caching.
	//
	// GET /auth/sessions/monitoring/stats
	GetSessionStats(ctx context.Context) (GetSessionStatsRes, error)
	// HandleOAuthCallback implements handleOAuthCallback operation.
	//
	// **Process OAuth provider callback and complete authentication**
	// Handles the OAuth callback from provider, exchanges authorization code for access token,
	// creates/updates user account, and returns JWT tokens.
	// **Security:** State parameter validation, token encryption, secure session creation
	// **Performance:** <100ms for complete OAuth flow including user lookup/creation.
	//
	// GET /auth/oauth/{provider}/callback
	HandleOAuthCallback(ctx context.Context, params HandleOAuthCallbackParams) (HandleOAuthCallbackRes, error)
	// RotateSessionToken implements rotateSessionToken operation.
	//
	// **Generate new token for existing session**
	// Creates a new JWT token pair while maintaining session continuity. Useful for token refresh
	// without full re-authentication.
	// **Security:** Maintains session integrity during token rotation.
	//
	// POST /auth/sessions/security/rotate-token
	RotateSessionToken(ctx context.Context, req *RotateSessionTokenRequest) (RotateSessionTokenRes, error)
	// TerminateSession implements terminateSession operation.
	//
	// **Forcefully terminate a user session**
	// Administrative function to forcibly end a session. Requires elevated permissions. Should be used
	// sparingly and with proper audit logging.
	// **Security:** Restricted to administrators, full audit trail maintained.
	//
	// POST /auth/sessions/admin/terminate
	TerminateSession(ctx context.Context, req *TerminateSessionRequest) (TerminateSessionRes, error)
	// ValidateSessionSecurity implements validateSessionSecurity operation.
	//
	// **Perform security validation on active sessions**
	// Analyzes session security parameters, detects anomalies, and provides recommendations for
	// improving session security posture.
	// **Security:** Comprehensive validation including IP changes, device fingerprints.
	//
	// POST /auth/sessions/security/validate
	ValidateSessionSecurity(ctx context.Context, req *ValidateSessionSecurityRequest) (ValidateSessionSecurityRes, error)
	// NewError creates *ErrRespStatusCode from error returned by handler.
	//
	// Used for common default response.
	NewError(ctx context.Context, err error) *ErrRespStatusCode
}

// Server implements http server based on OpenAPI v3 specification and
// calls Handler to handle requests.
type Server struct {
	h   Handler
	sec SecurityHandler
	baseServer
}

// NewServer creates new Server.
func NewServer(h Handler, sec SecurityHandler, opts ...ServerOption) (*Server, error) {
	s, err := newServerConfig(opts...).baseServer()
	if err != nil {
		return nil, err
	}
	return &Server{
		h:          h,
		sec:        sec,
		baseServer: s,
	}, nil
}
