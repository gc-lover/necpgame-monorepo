// Code generated by ogen, DO NOT EDIT.

package api

import (
	"context"
)

// Handler handles operations described by OpenAPI v3 specification.
type Handler interface {
	// ChangePassword implements changePassword operation.
	//
	// Изменить пароль.
	//
	// POST /auth/password/change
	ChangePassword(ctx context.Context, req *ChangePasswordRequest) (ChangePasswordRes, error)
	// ForgotPassword implements forgotPassword operation.
	//
	// Запросить сброс пароля.
	//
	// POST /auth/password/forgot
	ForgotPassword(ctx context.Context, req *ForgotPasswordRequest) (ForgotPasswordRes, error)
	// GetCurrentUser implements getCurrentUser operation.
	//
	// Получить информацию о текущем пользователе.
	//
	// GET /auth/me
	GetCurrentUser(ctx context.Context) (GetCurrentUserRes, error)
	// GetUserPermissions implements getUserPermissions operation.
	//
	// Получить права доступа пользователя.
	//
	// GET /auth/permissions
	GetUserPermissions(ctx context.Context) (GetUserPermissionsRes, error)
	// GetUserRoles implements getUserRoles operation.
	//
	// Получить список ролей пользователя.
	//
	// GET /auth/roles
	GetUserRoles(ctx context.Context) (GetUserRolesRes, error)
	// Login implements login operation.
	//
	// Войти в систему.
	//
	// POST /auth/login
	Login(ctx context.Context, req *LoginRequest) (LoginRes, error)
	// Logout implements logout operation.
	//
	// Выйти из системы.
	//
	// POST /auth/logout
	Logout(ctx context.Context) (LogoutRes, error)
	// OauthCallback implements oauthCallback operation.
	//
	// OAuth callback.
	//
	// GET /auth/oauth/{provider}/callback
	OauthCallback(ctx context.Context, params OauthCallbackParams) (OauthCallbackRes, error)
	// OauthLogin implements oauthLogin operation.
	//
	// Начать OAuth аутентификацию.
	//
	// GET /auth/oauth/{provider}
	OauthLogin(ctx context.Context, params OauthLoginParams) (OauthLoginRes, error)
	// RefreshToken implements refreshToken operation.
	//
	// Обновить токен доступа.
	//
	// POST /auth/refresh
	RefreshToken(ctx context.Context, req *RefreshTokenRequest) (RefreshTokenRes, error)
	// Register implements register operation.
	//
	// Зарегистрировать новый аккаунт.
	//
	// POST /auth/register
	Register(ctx context.Context, req *RegisterRequest) (RegisterRes, error)
	// ResendVerification implements resendVerification operation.
	//
	// Отправить повторное письмо верификации.
	//
	// POST /auth/resend-verification
	ResendVerification(ctx context.Context, req *ResendVerificationRequest) (ResendVerificationRes, error)
	// ResetPassword implements resetPassword operation.
	//
	// Сбросить пароль.
	//
	// POST /auth/password/reset
	ResetPassword(ctx context.Context, req *ResetPasswordRequest) (ResetPasswordRes, error)
	// VerifyEmail implements verifyEmail operation.
	//
	// Подтвердить email адрес.
	//
	// POST /auth/verify-email
	VerifyEmail(ctx context.Context, req *VerifyEmailRequest) (VerifyEmailRes, error)
}

// Server implements http server based on OpenAPI v3 specification and
// calls Handler to handle requests.
type Server struct {
	h   Handler
	sec SecurityHandler
	baseServer
}

// NewServer creates new Server.
func NewServer(h Handler, sec SecurityHandler, opts ...ServerOption) (*Server, error) {
	s, err := newServerConfig(opts...).baseServer()
	if err != nil {
		return nil, err
	}
	return &Server{
		h:          h,
		sec:        sec,
		baseServer: s,
	}, nil
}
