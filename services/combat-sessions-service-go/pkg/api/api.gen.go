// Package api provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.5.1 DO NOT EDIT.
package api

import (
	"context"
	"fmt"
	"net/http"
	"time"

	"github.com/go-chi/chi/v5"
	"github.com/oapi-codegen/runtime"
	openapi_types "github.com/oapi-codegen/runtime/types"
)

const (
	BearerAuthScopes = "BearerAuth.Scopes"
)

// Defines values for CombatParticipantParticipantType.
const (
	CombatParticipantParticipantTypeEnemy  CombatParticipantParticipantType = "enemy"
	CombatParticipantParticipantTypeNpc    CombatParticipantParticipantType = "npc"
	CombatParticipantParticipantTypePlayer CombatParticipantParticipantType = "player"
)

// Defines values for CombatParticipantStatus.
const (
	Alive    CombatParticipantStatus = "alive"
	Defeated CombatParticipantStatus = "defeated"
	Escaped  CombatParticipantStatus = "escaped"
)

// Defines values for CombatSessionSessionType.
const (
	CombatSessionSessionTypeArena CombatSessionSessionType = "arena"
	CombatSessionSessionTypePve   CombatSessionSessionType = "pve"
	CombatSessionSessionTypePvp   CombatSessionSessionType = "pvp"
	CombatSessionSessionTypeRaid  CombatSessionSessionType = "raid"
)

// Defines values for CombatSessionStatus.
const (
	Active    CombatSessionStatus = "active"
	Cancelled CombatSessionStatus = "cancelled"
	Completed CombatSessionStatus = "completed"
	Created   CombatSessionStatus = "created"
	Paused    CombatSessionStatus = "paused"
)

// Defines values for CombatSessionEndResultResult.
const (
	CombatSessionEndResultResultDefeat  CombatSessionEndResultResult = "defeat"
	CombatSessionEndResultResultDraw    CombatSessionEndResultResult = "draw"
	CombatSessionEndResultResultVictory CombatSessionEndResultResult = "victory"
)

// Defines values for CombatSessionEndResultRewardsRewardType.
const (
	Currency      CombatSessionEndResultRewardsRewardType = "currency"
	Experience    CombatSessionEndResultRewardsRewardType = "experience"
	Loot          CombatSessionEndResultRewardsRewardType = "loot"
	QuestProgress CombatSessionEndResultRewardsRewardType = "quest_progress"
)

// Defines values for CreateCombatSessionRequestSessionType.
const (
	CreateCombatSessionRequestSessionTypeArena CreateCombatSessionRequestSessionType = "arena"
	CreateCombatSessionRequestSessionTypePve   CreateCombatSessionRequestSessionType = "pve"
	CreateCombatSessionRequestSessionTypePvp   CreateCombatSessionRequestSessionType = "pvp"
	CreateCombatSessionRequestSessionTypeRaid  CreateCombatSessionRequestSessionType = "raid"
)

// Defines values for CreateCombatSessionRequestSettingsDifficulty.
const (
	Easy      CreateCombatSessionRequestSettingsDifficulty = "easy"
	Hard      CreateCombatSessionRequestSettingsDifficulty = "hard"
	Nightmare CreateCombatSessionRequestSettingsDifficulty = "nightmare"
	Normal    CreateCombatSessionRequestSettingsDifficulty = "normal"
)

// Defines values for JoinCombatRequestParticipantType.
const (
	JoinCombatRequestParticipantTypeEnemy  JoinCombatRequestParticipantType = "enemy"
	JoinCombatRequestParticipantTypeNpc    JoinCombatRequestParticipantType = "npc"
	JoinCombatRequestParticipantTypePlayer JoinCombatRequestParticipantType = "player"
)

// Defines values for EndCombatSessionJSONBodyResult.
const (
	EndCombatSessionJSONBodyResultDefeat  EndCombatSessionJSONBodyResult = "defeat"
	EndCombatSessionJSONBodyResultDraw    EndCombatSessionJSONBodyResult = "draw"
	EndCombatSessionJSONBodyResultVictory EndCombatSessionJSONBodyResult = "victory"
)

// CombatParticipant defines model for CombatParticipant.
type CombatParticipant struct {
	CreatedAt *time.Time `json:"created_at,omitempty"`

	// Effects Активные эффекты на участнике
	Effects *[]openapi_types.UUID `json:"effects,omitempty"`

	// Health Текущее здоровье
	Health *int `json:"health,omitempty"`

	// Id Уникальный ID участника в бою
	Id *openapi_types.UUID `json:"id,omitempty"`

	// Initiative Инициатива для определения порядка ходов
	Initiative *int `json:"initiative,omitempty"`

	// MaxHealth Максимальное здоровье
	MaxHealth *int `json:"max_health,omitempty"`

	// ParticipantId ID персонажа/NPC из соответствующей системы
	ParticipantId *openapi_types.UUID `json:"participant_id,omitempty"`

	// ParticipantType Тип участника
	ParticipantType *CombatParticipantParticipantType `json:"participant_type,omitempty"`

	// Position Позиция на поле боя (для тактического боя)
	Position *struct {
		X *float32 `json:"x,omitempty"`
		Y *float32 `json:"y,omitempty"`
		Z *float32 `json:"z,omitempty"`
	} `json:"position,omitempty"`

	// SessionId ID боевой сессии
	SessionId *openapi_types.UUID `json:"session_id,omitempty"`

	// Status Статус участника:
	// - `alive` - жив, участвует в бою
	// - `defeated` - повержен
	// - `escaped` - сбежал из боя
	Status *CombatParticipantStatus `json:"status,omitempty"`

	// Team Номер команды (1 или 2)
	Team *int `json:"team,omitempty"`
}

// CombatParticipantParticipantType Тип участника
type CombatParticipantParticipantType string

// CombatParticipantStatus Статус участника:
// - `alive` - жив, участвует в бою
// - `defeated` - повержен
// - `escaped` - сбежал из боя
type CombatParticipantStatus string

// CombatSession defines model for CombatSession.
type CombatSession struct {
	// CreatedAt Время создания
	CreatedAt *time.Time `json:"created_at,omitempty"`

	// CurrentTurn Номер текущего хода
	CurrentTurn *int `json:"current_turn,omitempty"`

	// EndedAt Время завершения
	EndedAt *time.Time `json:"ended_at,omitempty"`

	// Id Уникальный ID сессии
	Id *openapi_types.UUID `json:"id,omitempty"`

	// Participants Список участников боя
	Participants *[]CombatParticipant `json:"participants,omitempty"`

	// SessionType Тип сессии
	SessionType *CombatSessionSessionType `json:"session_type,omitempty"`

	// Settings Настройки боя
	Settings *map[string]interface{} `json:"settings,omitempty"`

	// StartedAt Время запуска
	StartedAt *time.Time `json:"started_at,omitempty"`

	// Status Статус сессии:
	// - `created` - создана, ожидает участников
	// - `active` - идёт бой
	// - `paused` - бой на паузе
	// - `completed` - бой завершён
	// - `cancelled` - бой отменён
	Status *CombatSessionStatus `json:"status,omitempty"`

	// TurnOrder Порядок ходов участников (IDs)
	TurnOrder *[]openapi_types.UUID `json:"turn_order,omitempty"`
}

// CombatSessionSessionType Тип сессии
type CombatSessionSessionType string

// CombatSessionStatus Статус сессии:
// - `created` - создана, ожидает участников
// - `active` - идёт бой
// - `paused` - бой на паузе
// - `completed` - бой завершён
// - `cancelled` - бой отменён
type CombatSessionStatus string

// CombatSessionEndResult defines model for CombatSessionEndResult.
type CombatSessionEndResult struct {
	// CompletedAt Время завершения
	CompletedAt *time.Time `json:"completed_at,omitempty"`

	// Result Результат боя
	Result *CombatSessionEndResultResult `json:"result,omitempty"`

	// Rewards Награды за бой для каждого участника
	Rewards *[]struct {
		// ParticipantId ID участника
		ParticipantId *openapi_types.UUID `json:"participant_id,omitempty"`

		// RewardData Данные награды (зависит от типа)
		RewardData *map[string]interface{} `json:"reward_data,omitempty"`

		// RewardType Тип награды
		RewardType *CombatSessionEndResultRewardsRewardType `json:"reward_type,omitempty"`
	} `json:"rewards,omitempty"`

	// SessionId ID завершённой сессии
	SessionId *openapi_types.UUID `json:"session_id,omitempty"`
}

// CombatSessionEndResultResult Результат боя
type CombatSessionEndResultResult string

// CombatSessionEndResultRewardsRewardType Тип награды
type CombatSessionEndResultRewardsRewardType string

// CreateCombatSessionRequest defines model for CreateCombatSessionRequest.
type CreateCombatSessionRequest struct {
	// SessionType Тип боевой сессии
	SessionType CreateCombatSessionRequestSessionType `json:"session_type"`

	// Settings Настройки боя
	Settings *struct {
		// Difficulty Сложность (только для PvE)
		Difficulty *CreateCombatSessionRequestSettingsDifficulty `json:"difficulty,omitempty"`

		// MaxParticipants Максимальное количество участников
		MaxParticipants *int `json:"max_participants,omitempty"`

		// TurnTimeout Таймаут хода в секундах
		TurnTimeout *int `json:"turn_timeout,omitempty"`
	} `json:"settings,omitempty"`
}

// CreateCombatSessionRequestSessionType Тип боевой сессии
type CreateCombatSessionRequestSessionType string

// CreateCombatSessionRequestSettingsDifficulty Сложность (только для PvE)
type CreateCombatSessionRequestSettingsDifficulty string

// Error defines model for Error.
type Error struct {
	// Code Код ошибки
	Code *string `json:"code"`

	// Details Дополнительные детали ошибки
	Details *map[string]interface{} `json:"details"`

	// Error Тип ошибки
	Error string `json:"error"`

	// Message Сообщение об ошибке
	Message string `json:"message"`
}

// JoinCombatRequest defines model for JoinCombatRequest.
type JoinCombatRequest struct {
	// ParticipantId ID персонажа/NPC
	ParticipantId openapi_types.UUID `json:"participant_id"`

	// ParticipantType Тип участника
	ParticipantType JoinCombatRequestParticipantType `json:"participant_type"`

	// Position Начальная позиция на поле боя
	Position *struct {
		X *float32 `json:"x,omitempty"`
		Y *float32 `json:"y,omitempty"`
		Z *float32 `json:"z,omitempty"`
	} `json:"position,omitempty"`

	// Team Номер команды (1 или 2)
	Team int `json:"team"`
}

// JoinCombatRequestParticipantType Тип участника
type JoinCombatRequestParticipantType string

// SessionId defines model for SessionId.
type SessionId = openapi_types.UUID

// BadRequest defines model for BadRequest.
type BadRequest = Error

// InternalServerError defines model for InternalServerError.
type InternalServerError = Error

// NotFound defines model for NotFound.
type NotFound = Error

// Unauthorized defines model for Unauthorized.
type Unauthorized = Error

// EndCombatSessionJSONBody defines parameters for EndCombatSession.
type EndCombatSessionJSONBody struct {
	// Result Результат боя
	Result EndCombatSessionJSONBodyResult `json:"result"`
}

// EndCombatSessionJSONBodyResult defines parameters for EndCombatSession.
type EndCombatSessionJSONBodyResult string

// LeaveCombatSessionJSONBody defines parameters for LeaveCombatSession.
type LeaveCombatSessionJSONBody struct {
	// ParticipantId ID участника который покидает бой
	ParticipantId openapi_types.UUID `json:"participant_id"`
}

// CreateCombatSessionJSONRequestBody defines body for CreateCombatSession for application/json ContentType.
type CreateCombatSessionJSONRequestBody = CreateCombatSessionRequest

// EndCombatSessionJSONRequestBody defines body for EndCombatSession for application/json ContentType.
type EndCombatSessionJSONRequestBody EndCombatSessionJSONBody

// JoinCombatSessionJSONRequestBody defines body for JoinCombatSession for application/json ContentType.
type JoinCombatSessionJSONRequestBody = JoinCombatRequest

// LeaveCombatSessionJSONRequestBody defines body for LeaveCombatSession for application/json ContentType.
type LeaveCombatSessionJSONRequestBody LeaveCombatSessionJSONBody

// ServerInterface represents all server handlers.
type ServerInterface interface {
	// Создание боевой сессии
	// (POST /api/v1/gameplay/combat/sessions)
	CreateCombatSession(w http.ResponseWriter, r *http.Request)
	// Отмена боевой сессии
	// (DELETE /api/v1/gameplay/combat/sessions/{session_id})
	CancelCombatSession(w http.ResponseWriter, r *http.Request, sessionId SessionId)
	// Получение боевой сессии
	// (GET /api/v1/gameplay/combat/sessions/{session_id})
	GetCombatSession(w http.ResponseWriter, r *http.Request, sessionId SessionId)
	// Завершение боя
	// (POST /api/v1/gameplay/combat/sessions/{session_id}/end)
	EndCombatSession(w http.ResponseWriter, r *http.Request, sessionId SessionId)
	// Присоединение к бою
	// (PUT /api/v1/gameplay/combat/sessions/{session_id}/join)
	JoinCombatSession(w http.ResponseWriter, r *http.Request, sessionId SessionId)
	// Выход из боя
	// (PUT /api/v1/gameplay/combat/sessions/{session_id}/leave)
	LeaveCombatSession(w http.ResponseWriter, r *http.Request, sessionId SessionId)
	// Запуск боя
	// (POST /api/v1/gameplay/combat/sessions/{session_id}/start)
	StartCombatSession(w http.ResponseWriter, r *http.Request, sessionId SessionId)
}

// Unimplemented server implementation that returns http.StatusNotImplemented for each endpoint.

type Unimplemented struct{}

// Создание боевой сессии
// (POST /api/v1/gameplay/combat/sessions)
func (_ Unimplemented) CreateCombatSession(w http.ResponseWriter, r *http.Request) {
	w.WriteHeader(http.StatusNotImplemented)
}

// Отмена боевой сессии
// (DELETE /api/v1/gameplay/combat/sessions/{session_id})
func (_ Unimplemented) CancelCombatSession(w http.ResponseWriter, r *http.Request, sessionId SessionId) {
	w.WriteHeader(http.StatusNotImplemented)
}

// Получение боевой сессии
// (GET /api/v1/gameplay/combat/sessions/{session_id})
func (_ Unimplemented) GetCombatSession(w http.ResponseWriter, r *http.Request, sessionId SessionId) {
	w.WriteHeader(http.StatusNotImplemented)
}

// Завершение боя
// (POST /api/v1/gameplay/combat/sessions/{session_id}/end)
func (_ Unimplemented) EndCombatSession(w http.ResponseWriter, r *http.Request, sessionId SessionId) {
	w.WriteHeader(http.StatusNotImplemented)
}

// Присоединение к бою
// (PUT /api/v1/gameplay/combat/sessions/{session_id}/join)
func (_ Unimplemented) JoinCombatSession(w http.ResponseWriter, r *http.Request, sessionId SessionId) {
	w.WriteHeader(http.StatusNotImplemented)
}

// Выход из боя
// (PUT /api/v1/gameplay/combat/sessions/{session_id}/leave)
func (_ Unimplemented) LeaveCombatSession(w http.ResponseWriter, r *http.Request, sessionId SessionId) {
	w.WriteHeader(http.StatusNotImplemented)
}

// Запуск боя
// (POST /api/v1/gameplay/combat/sessions/{session_id}/start)
func (_ Unimplemented) StartCombatSession(w http.ResponseWriter, r *http.Request, sessionId SessionId) {
	w.WriteHeader(http.StatusNotImplemented)
}

// ServerInterfaceWrapper converts contexts to parameters.
type ServerInterfaceWrapper struct {
	Handler            ServerInterface
	HandlerMiddlewares []MiddlewareFunc
	ErrorHandlerFunc   func(w http.ResponseWriter, r *http.Request, err error)
}

type MiddlewareFunc func(http.Handler) http.Handler

// CreateCombatSession operation middleware
func (siw *ServerInterfaceWrapper) CreateCombatSession(w http.ResponseWriter, r *http.Request) {

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.CreateCombatSession(w, r)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// CancelCombatSession operation middleware
func (siw *ServerInterfaceWrapper) CancelCombatSession(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "session_id" -------------
	var sessionId SessionId

	err = runtime.BindStyledParameterWithOptions("simple", "session_id", chi.URLParam(r, "session_id"), &sessionId, runtime.BindStyledParameterOptions{ParamLocation: runtime.ParamLocationPath, Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "session_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.CancelCombatSession(w, r, sessionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// GetCombatSession operation middleware
func (siw *ServerInterfaceWrapper) GetCombatSession(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "session_id" -------------
	var sessionId SessionId

	err = runtime.BindStyledParameterWithOptions("simple", "session_id", chi.URLParam(r, "session_id"), &sessionId, runtime.BindStyledParameterOptions{ParamLocation: runtime.ParamLocationPath, Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "session_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.GetCombatSession(w, r, sessionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// EndCombatSession operation middleware
func (siw *ServerInterfaceWrapper) EndCombatSession(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "session_id" -------------
	var sessionId SessionId

	err = runtime.BindStyledParameterWithOptions("simple", "session_id", chi.URLParam(r, "session_id"), &sessionId, runtime.BindStyledParameterOptions{ParamLocation: runtime.ParamLocationPath, Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "session_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.EndCombatSession(w, r, sessionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// JoinCombatSession operation middleware
func (siw *ServerInterfaceWrapper) JoinCombatSession(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "session_id" -------------
	var sessionId SessionId

	err = runtime.BindStyledParameterWithOptions("simple", "session_id", chi.URLParam(r, "session_id"), &sessionId, runtime.BindStyledParameterOptions{ParamLocation: runtime.ParamLocationPath, Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "session_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.JoinCombatSession(w, r, sessionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// LeaveCombatSession operation middleware
func (siw *ServerInterfaceWrapper) LeaveCombatSession(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "session_id" -------------
	var sessionId SessionId

	err = runtime.BindStyledParameterWithOptions("simple", "session_id", chi.URLParam(r, "session_id"), &sessionId, runtime.BindStyledParameterOptions{ParamLocation: runtime.ParamLocationPath, Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "session_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.LeaveCombatSession(w, r, sessionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// StartCombatSession operation middleware
func (siw *ServerInterfaceWrapper) StartCombatSession(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "session_id" -------------
	var sessionId SessionId

	err = runtime.BindStyledParameterWithOptions("simple", "session_id", chi.URLParam(r, "session_id"), &sessionId, runtime.BindStyledParameterOptions{ParamLocation: runtime.ParamLocationPath, Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "session_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.StartCombatSession(w, r, sessionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

type UnescapedCookieParamError struct {
	ParamName string
	Err       error
}

func (e *UnescapedCookieParamError) Error() string {
	return fmt.Sprintf("error unescaping cookie parameter '%s'", e.ParamName)
}

func (e *UnescapedCookieParamError) Unwrap() error {
	return e.Err
}

type UnmarshalingParamError struct {
	ParamName string
	Err       error
}

func (e *UnmarshalingParamError) Error() string {
	return fmt.Sprintf("Error unmarshaling parameter %s as JSON: %s", e.ParamName, e.Err.Error())
}

func (e *UnmarshalingParamError) Unwrap() error {
	return e.Err
}

type RequiredParamError struct {
	ParamName string
}

func (e *RequiredParamError) Error() string {
	return fmt.Sprintf("Query argument %s is required, but not found", e.ParamName)
}

type RequiredHeaderError struct {
	ParamName string
	Err       error
}

func (e *RequiredHeaderError) Error() string {
	return fmt.Sprintf("Header parameter %s is required, but not found", e.ParamName)
}

func (e *RequiredHeaderError) Unwrap() error {
	return e.Err
}

type InvalidParamFormatError struct {
	ParamName string
	Err       error
}

func (e *InvalidParamFormatError) Error() string {
	return fmt.Sprintf("Invalid format for parameter %s: %s", e.ParamName, e.Err.Error())
}

func (e *InvalidParamFormatError) Unwrap() error {
	return e.Err
}

type TooManyValuesForParamError struct {
	ParamName string
	Count     int
}

func (e *TooManyValuesForParamError) Error() string {
	return fmt.Sprintf("Expected one value for %s, got %d", e.ParamName, e.Count)
}

// Handler creates http.Handler with routing matching OpenAPI spec.
func Handler(si ServerInterface) http.Handler {
	return HandlerWithOptions(si, ChiServerOptions{})
}

type ChiServerOptions struct {
	BaseURL          string
	BaseRouter       chi.Router
	Middlewares      []MiddlewareFunc
	ErrorHandlerFunc func(w http.ResponseWriter, r *http.Request, err error)
}

// HandlerFromMux creates http.Handler with routing matching OpenAPI spec based on the provided mux.
func HandlerFromMux(si ServerInterface, r chi.Router) http.Handler {
	return HandlerWithOptions(si, ChiServerOptions{
		BaseRouter: r,
	})
}

func HandlerFromMuxWithBaseURL(si ServerInterface, r chi.Router, baseURL string) http.Handler {
	return HandlerWithOptions(si, ChiServerOptions{
		BaseURL:    baseURL,
		BaseRouter: r,
	})
}

// HandlerWithOptions creates http.Handler with additional options
func HandlerWithOptions(si ServerInterface, options ChiServerOptions) http.Handler {
	r := options.BaseRouter

	if r == nil {
		r = chi.NewRouter()
	}
	if options.ErrorHandlerFunc == nil {
		options.ErrorHandlerFunc = func(w http.ResponseWriter, r *http.Request, err error) {
			http.Error(w, err.Error(), http.StatusBadRequest)
		}
	}
	wrapper := ServerInterfaceWrapper{
		Handler:            si,
		HandlerMiddlewares: options.Middlewares,
		ErrorHandlerFunc:   options.ErrorHandlerFunc,
	}

	r.Group(func(r chi.Router) {
		r.Post(options.BaseURL+"/api/v1/gameplay/combat/sessions", wrapper.CreateCombatSession)
	})
	r.Group(func(r chi.Router) {
		r.Delete(options.BaseURL+"/api/v1/gameplay/combat/sessions/{session_id}", wrapper.CancelCombatSession)
	})
	r.Group(func(r chi.Router) {
		r.Get(options.BaseURL+"/api/v1/gameplay/combat/sessions/{session_id}", wrapper.GetCombatSession)
	})
	r.Group(func(r chi.Router) {
		r.Post(options.BaseURL+"/api/v1/gameplay/combat/sessions/{session_id}/end", wrapper.EndCombatSession)
	})
	r.Group(func(r chi.Router) {
		r.Put(options.BaseURL+"/api/v1/gameplay/combat/sessions/{session_id}/join", wrapper.JoinCombatSession)
	})
	r.Group(func(r chi.Router) {
		r.Put(options.BaseURL+"/api/v1/gameplay/combat/sessions/{session_id}/leave", wrapper.LeaveCombatSession)
	})
	r.Group(func(r chi.Router) {
		r.Post(options.BaseURL+"/api/v1/gameplay/combat/sessions/{session_id}/start", wrapper.StartCombatSession)
	})

	return r
}
