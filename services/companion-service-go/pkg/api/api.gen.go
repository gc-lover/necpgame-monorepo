// Package api provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.5.1 DO NOT EDIT.
package api

import (
	"context"
	"fmt"
	"net/http"
	"time"

	"github.com/gorilla/mux"
	"github.com/oapi-codegen/runtime"
	openapi_types "github.com/oapi-codegen/runtime/types"
)

const (
	BearerAuthScopes = "BearerAuth.Scopes"
)

// Defines values for AddXPRequestSource.
const (
	CombatAssistance AddXPRequestSource = "combat_assistance"
	CraftCompleted   AddXPRequestSource = "craft_completed"
	EnemyKilled      AddXPRequestSource = "enemy_killed"
	HackCompleted    AddXPRequestSource = "hack_completed"
	LootCollected    AddXPRequestSource = "loot_collected"
)

// Defines values for CompanionAbilityAbilityType.
const (
	CompanionAbilityAbilityTypeACTIVE  CompanionAbilityAbilityType = "ACTIVE"
	CompanionAbilityAbilityTypePASSIVE CompanionAbilityAbilityType = "PASSIVE"
)

// Defines values for CompanionEventEventType.
const (
	CompanionEventEventTypeCompanionAbilityUsed CompanionEventEventType = "companion:ability-used"
	CompanionEventEventTypeCompanionCustomized  CompanionEventEventType = "companion:customized"
	CompanionEventEventTypeCompanionDismissed   CompanionEventEventType = "companion:dismissed"
	CompanionEventEventTypeCompanionLevelUp     CompanionEventEventType = "companion:level-up"
	CompanionEventEventTypeCompanionPurchased   CompanionEventEventType = "companion:purchased"
	CompanionEventEventTypeCompanionSummoned    CompanionEventEventType = "companion:summoned"
)

// Defines values for CompanionTypeCategory.
const (
	CompanionTypeCategoryCOMBATDRONE CompanionTypeCategory = "COMBAT_DRONE"
	CompanionTypeCategorySOCIALPET   CompanionTypeCategory = "SOCIAL_PET"
	CompanionTypeCategoryUTILITY     CompanionTypeCategory = "UTILITY"
)

// Defines values for GetAvailableCompanionsParamsCategory.
const (
	GetAvailableCompanionsParamsCategoryCOMBATDRONE GetAvailableCompanionsParamsCategory = "COMBAT_DRONE"
	GetAvailableCompanionsParamsCategorySOCIALPET   GetAvailableCompanionsParamsCategory = "SOCIAL_PET"
	GetAvailableCompanionsParamsCategoryUTILITY     GetAvailableCompanionsParamsCategory = "UTILITY"
)

// Defines values for GetCompanionEventsParamsEventType.
const (
	GetCompanionEventsParamsEventTypeCompanionAbilityUsed GetCompanionEventsParamsEventType = "companion:ability-used"
	GetCompanionEventsParamsEventTypeCompanionCustomized  GetCompanionEventsParamsEventType = "companion:customized"
	GetCompanionEventsParamsEventTypeCompanionDismissed   GetCompanionEventsParamsEventType = "companion:dismissed"
	GetCompanionEventsParamsEventTypeCompanionLevelUp     GetCompanionEventsParamsEventType = "companion:level-up"
	GetCompanionEventsParamsEventTypeCompanionPurchased   GetCompanionEventsParamsEventType = "companion:purchased"
	GetCompanionEventsParamsEventTypeCompanionSummoned    GetCompanionEventsParamsEventType = "companion:summoned"
)

// Defines values for GetOwnedCompanionsParamsCategory.
const (
	GetOwnedCompanionsParamsCategoryCOMBATDRONE GetOwnedCompanionsParamsCategory = "COMBAT_DRONE"
	GetOwnedCompanionsParamsCategorySOCIALPET   GetOwnedCompanionsParamsCategory = "SOCIAL_PET"
	GetOwnedCompanionsParamsCategoryUTILITY     GetOwnedCompanionsParamsCategory = "UTILITY"
)

// Defines values for GetCompanionShopCatalogParamsCategory.
const (
	GetCompanionShopCatalogParamsCategoryCOMBATDRONE GetCompanionShopCatalogParamsCategory = "COMBAT_DRONE"
	GetCompanionShopCatalogParamsCategorySOCIALPET   GetCompanionShopCatalogParamsCategory = "SOCIAL_PET"
	GetCompanionShopCatalogParamsCategoryUTILITY     GetCompanionShopCatalogParamsCategory = "UTILITY"
)

// Defines values for GetCompanionAbilitiesParamsAbilityType.
const (
	GetCompanionAbilitiesParamsAbilityTypeACTIVE  GetCompanionAbilitiesParamsAbilityType = "ACTIVE"
	GetCompanionAbilitiesParamsAbilityTypePASSIVE GetCompanionAbilitiesParamsAbilityType = "PASSIVE"
)

// AbilityUsageResponse defines model for AbilityUsageResponse.
type AbilityUsageResponse struct {
	AbilityId      *openapi_types.UUID     `json:"ability_id,omitempty"`
	CooldownUntil  *time.Time              `json:"cooldown_until"`
	EffectsApplied *map[string]interface{} `json:"effects_applied,omitempty"`
	Success        *bool                   `json:"success,omitempty"`
}

// AddXPRequest defines model for AddXPRequest.
type AddXPRequest struct {
	Amount   int                `json:"amount"`
	PlayerId openapi_types.UUID `json:"player_id"`
	Source   AddXPRequestSource `json:"source"`
}

// AddXPRequestSource defines model for AddXPRequest.Source.
type AddXPRequestSource string

// AvailableCompanionsResponse defines model for AvailableCompanionsResponse.
type AvailableCompanionsResponse struct {
	Companions *[]CompanionType `json:"companions,omitempty"`
	Limit      *int             `json:"limit,omitempty"`
	Offset     *int             `json:"offset,omitempty"`
	Total      *int             `json:"total,omitempty"`
}

// CompanionAbilitiesResponse defines model for CompanionAbilitiesResponse.
type CompanionAbilitiesResponse struct {
	Abilities   *[]CompanionAbility `json:"abilities,omitempty"`
	CompanionId *openapi_types.UUID `json:"companion_id,omitempty"`
}

// CompanionAbility defines model for CompanionAbility.
type CompanionAbility struct {
	AbilityType     *CompanionAbilityAbilityType `json:"ability_type,omitempty"`
	Code            *string                      `json:"code,omitempty"`
	CompanionTypeId *openapi_types.UUID          `json:"companion_type_id,omitempty"`
	CooldownSeconds *int                         `json:"cooldown_seconds"`
	Description     *string                      `json:"description,omitempty"`
	Effects         *map[string]interface{}      `json:"effects,omitempty"`
	Id              *openapi_types.UUID          `json:"id,omitempty"`
	IsActive        *bool                        `json:"is_active,omitempty"`
	Name            *string                      `json:"name,omitempty"`
}

// CompanionAbilityAbilityType defines model for CompanionAbility.AbilityType.
type CompanionAbilityAbilityType string

// CompanionAttackRequest defines model for CompanionAttackRequest.
type CompanionAttackRequest struct {
	PlayerId openapi_types.UUID `json:"player_id"`
	TargetId openapi_types.UUID `json:"target_id"`
}

// CompanionAttackResponse defines model for CompanionAttackResponse.
type CompanionAttackResponse struct {
	DamageDealt *int                `json:"damage_dealt,omitempty"`
	Success     *bool               `json:"success,omitempty"`
	TargetId    *openapi_types.UUID `json:"target_id,omitempty"`
}

// CompanionDefendRequest defines model for CompanionDefendRequest.
type CompanionDefendRequest struct {
	PlayerId openapi_types.UUID `json:"player_id"`
}

// CompanionDefendResponse defines model for CompanionDefendResponse.
type CompanionDefendResponse struct {
	DefenseActive          *bool `json:"defense_active,omitempty"`
	DefenseDurationSeconds *int  `json:"defense_duration_seconds,omitempty"`
	Success                *bool `json:"success,omitempty"`
}

// CompanionEvent defines model for CompanionEvent.
type CompanionEvent struct {
	CompanionId *openapi_types.UUID      `json:"companion_id,omitempty"`
	CreatedAt   *time.Time               `json:"created_at,omitempty"`
	EventData   *map[string]interface{}  `json:"event_data,omitempty"`
	EventType   *CompanionEventEventType `json:"event_type,omitempty"`
	Id          *openapi_types.UUID      `json:"id,omitempty"`
}

// CompanionEventEventType defines model for CompanionEvent.EventType.
type CompanionEventEventType string

// CompanionEventsResponse defines model for CompanionEventsResponse.
type CompanionEventsResponse struct {
	Events *[]CompanionEvent `json:"events,omitempty"`
	Limit  *int              `json:"limit,omitempty"`
	Offset *int              `json:"offset,omitempty"`
	Total  *int              `json:"total,omitempty"`
}

// CompanionProgressionResponse defines model for CompanionProgressionResponse.
type CompanionProgressionResponse struct {
	CompanionId           *openapi_types.UUID `json:"companion_id,omitempty"`
	Damage                *int                `json:"damage,omitempty"`
	Experience            *int                `json:"experience,omitempty"`
	ExperienceToNextLevel *int                `json:"experience_to_next_level,omitempty"`
	Health                *int                `json:"health,omitempty"`
	Level                 *int                `json:"level,omitempty"`
	LeveledUp             *bool               `json:"leveled_up,omitempty"`
}

// CompanionShopCatalogResponse defines model for CompanionShopCatalogResponse.
type CompanionShopCatalogResponse struct {
	Companions *[]CompanionType `json:"companions,omitempty"`
	Limit      *int             `json:"limit,omitempty"`
	Offset     *int             `json:"offset,omitempty"`
	Total      *int             `json:"total,omitempty"`
}

// CompanionType defines model for CompanionType.
type CompanionType struct {
	Abilities   *[]CompanionAbility     `json:"abilities,omitempty"`
	BaseDamage  *int                    `json:"base_damage,omitempty"`
	BaseHealth  *int                    `json:"base_health,omitempty"`
	BaseXp      *int                    `json:"base_xp,omitempty"`
	Category    *CompanionTypeCategory  `json:"category,omitempty"`
	Code        *string                 `json:"code,omitempty"`
	Cost        *int64                  `json:"cost,omitempty"`
	CreatedAt   *time.Time              `json:"created_at,omitempty"`
	Description *string                 `json:"description,omitempty"`
	Id          *openapi_types.UUID     `json:"id,omitempty"`
	IsActive    *bool                   `json:"is_active,omitempty"`
	MaxLevel    *int                    `json:"max_level,omitempty"`
	Name        *string                 `json:"name,omitempty"`
	Stats       *map[string]interface{} `json:"stats,omitempty"`
	Subcategory *string                 `json:"subcategory,omitempty"`
	UpdatedAt   *time.Time              `json:"updated_at,omitempty"`
}

// CompanionTypeCategory defines model for CompanionType.Category.
type CompanionTypeCategory string

// CustomizeCompanionRequest defines model for CustomizeCompanionRequest.
type CustomizeCompanionRequest struct {
	Customization *map[string]interface{} `json:"customization,omitempty"`
	PlayerId      openapi_types.UUID      `json:"player_id"`
}

// DismissCompanionRequest defines model for DismissCompanionRequest.
type DismissCompanionRequest struct {
	PlayerId openapi_types.UUID `json:"player_id"`
}

// EquipCompanionItemRequest defines model for EquipCompanionItemRequest.
type EquipCompanionItemRequest struct {
	ItemId   openapi_types.UUID `json:"item_id"`
	PlayerId openapi_types.UUID `json:"player_id"`
	Slot     *string            `json:"slot,omitempty"`
}

// Error defines model for Error.
type Error struct {
	Error *string `json:"error,omitempty"`
}

// OwnedCompanionsResponse defines model for OwnedCompanionsResponse.
type OwnedCompanionsResponse struct {
	Companions *[]PlayerCompanion  `json:"companions,omitempty"`
	Limit      *int                `json:"limit,omitempty"`
	Offset     *int                `json:"offset,omitempty"`
	PlayerId   *openapi_types.UUID `json:"player_id,omitempty"`
	Total      *int                `json:"total,omitempty"`
}

// PlayerCompanion defines model for PlayerCompanion.
type PlayerCompanion struct {
	CompanionType         *CompanionType          `json:"companion_type,omitempty"`
	CompanionTypeId       *openapi_types.UUID     `json:"companion_type_id,omitempty"`
	CreatedAt             *time.Time              `json:"created_at,omitempty"`
	Customization         *map[string]interface{} `json:"customization"`
	Damage                *int                    `json:"damage,omitempty"`
	Equipment             *map[string]interface{} `json:"equipment"`
	Experience            *int                    `json:"experience,omitempty"`
	ExperienceToNextLevel *int                    `json:"experience_to_next_level,omitempty"`
	Health                *int                    `json:"health,omitempty"`
	Id                    *openapi_types.UUID     `json:"id,omitempty"`
	IsSummoned            *bool                   `json:"is_summoned,omitempty"`
	Level                 *int                    `json:"level,omitempty"`
	Name                  *string                 `json:"name,omitempty"`
	PlayerId              *openapi_types.UUID     `json:"player_id,omitempty"`
	PurchasedAt           *time.Time              `json:"purchased_at,omitempty"`
	SummonedAt            *time.Time              `json:"summoned_at"`
	UpdatedAt             *time.Time              `json:"updated_at,omitempty"`
}

// PurchaseCompanionRequest defines model for PurchaseCompanionRequest.
type PurchaseCompanionRequest struct {
	CompanionTypeId openapi_types.UUID `json:"companion_type_id"`
	PlayerId        openapi_types.UUID `json:"player_id"`
}

// RenameCompanionRequest defines model for RenameCompanionRequest.
type RenameCompanionRequest struct {
	Name     string             `json:"name"`
	PlayerId openapi_types.UUID `json:"player_id"`
}

// SummonCompanionRequest defines model for SummonCompanionRequest.
type SummonCompanionRequest struct {
	PlayerId openapi_types.UUID `json:"player_id"`
}

// UseAbilityRequest defines model for UseAbilityRequest.
type UseAbilityRequest struct {
	PlayerId openapi_types.UUID  `json:"player_id"`
	TargetId *openapi_types.UUID `json:"target_id"`
}

// BadRequest defines model for BadRequest.
type BadRequest = Error

// InternalServerError defines model for InternalServerError.
type InternalServerError = Error

// NotFound defines model for NotFound.
type NotFound = Error

// Unauthorized defines model for Unauthorized.
type Unauthorized = Error

// GetAvailableCompanionsParams defines parameters for GetAvailableCompanions.
type GetAvailableCompanionsParams struct {
	Category *GetAvailableCompanionsParamsCategory `form:"category,omitempty" json:"category,omitempty"`
	Limit    *int                                  `form:"limit,omitempty" json:"limit,omitempty"`
	Offset   *int                                  `form:"offset,omitempty" json:"offset,omitempty"`
}

// GetAvailableCompanionsParamsCategory defines parameters for GetAvailableCompanions.
type GetAvailableCompanionsParamsCategory string

// GetCompanionEventsParams defines parameters for GetCompanionEvents.
type GetCompanionEventsParams struct {
	EventType *GetCompanionEventsParamsEventType `form:"event_type,omitempty" json:"event_type,omitempty"`
	Limit     *int                               `form:"limit,omitempty" json:"limit,omitempty"`
	Offset    *int                               `form:"offset,omitempty" json:"offset,omitempty"`
}

// GetCompanionEventsParamsEventType defines parameters for GetCompanionEvents.
type GetCompanionEventsParamsEventType string

// GetOwnedCompanionsParams defines parameters for GetOwnedCompanions.
type GetOwnedCompanionsParams struct {
	Category *GetOwnedCompanionsParamsCategory `form:"category,omitempty" json:"category,omitempty"`
	Limit    *int                              `form:"limit,omitempty" json:"limit,omitempty"`
	Offset   *int                              `form:"offset,omitempty" json:"offset,omitempty"`
}

// GetOwnedCompanionsParamsCategory defines parameters for GetOwnedCompanions.
type GetOwnedCompanionsParamsCategory string

// GetCompanionShopCatalogParams defines parameters for GetCompanionShopCatalog.
type GetCompanionShopCatalogParams struct {
	Category *GetCompanionShopCatalogParamsCategory `form:"category,omitempty" json:"category,omitempty"`
	Limit    *int                                   `form:"limit,omitempty" json:"limit,omitempty"`
	Offset   *int                                   `form:"offset,omitempty" json:"offset,omitempty"`
}

// GetCompanionShopCatalogParamsCategory defines parameters for GetCompanionShopCatalog.
type GetCompanionShopCatalogParamsCategory string

// GetCompanionAbilitiesParams defines parameters for GetCompanionAbilities.
type GetCompanionAbilitiesParams struct {
	AbilityType *GetCompanionAbilitiesParamsAbilityType `form:"ability_type,omitempty" json:"ability_type,omitempty"`
}

// GetCompanionAbilitiesParamsAbilityType defines parameters for GetCompanionAbilities.
type GetCompanionAbilitiesParamsAbilityType string

// PurchaseCompanionJSONRequestBody defines body for PurchaseCompanion for application/json ContentType.
type PurchaseCompanionJSONRequestBody = PurchaseCompanionRequest

// PurchaseCompanionFromShopJSONRequestBody defines body for PurchaseCompanionFromShop for application/json ContentType.
type PurchaseCompanionFromShopJSONRequestBody = PurchaseCompanionRequest

// UseCompanionAbilityJSONRequestBody defines body for UseCompanionAbility for application/json ContentType.
type UseCompanionAbilityJSONRequestBody = UseAbilityRequest

// AddCompanionXPJSONRequestBody defines body for AddCompanionXP for application/json ContentType.
type AddCompanionXPJSONRequestBody = AddXPRequest

// CompanionAttackJSONRequestBody defines body for CompanionAttack for application/json ContentType.
type CompanionAttackJSONRequestBody = CompanionAttackRequest

// CompanionDefendJSONRequestBody defines body for CompanionDefend for application/json ContentType.
type CompanionDefendJSONRequestBody = CompanionDefendRequest

// CustomizeCompanionJSONRequestBody defines body for CustomizeCompanion for application/json ContentType.
type CustomizeCompanionJSONRequestBody = CustomizeCompanionRequest

// DismissCompanionJSONRequestBody defines body for DismissCompanion for application/json ContentType.
type DismissCompanionJSONRequestBody = DismissCompanionRequest

// EquipCompanionItemJSONRequestBody defines body for EquipCompanionItem for application/json ContentType.
type EquipCompanionItemJSONRequestBody = EquipCompanionItemRequest

// RenameCompanionJSONRequestBody defines body for RenameCompanion for application/json ContentType.
type RenameCompanionJSONRequestBody = RenameCompanionRequest

// SummonCompanionJSONRequestBody defines body for SummonCompanion for application/json ContentType.
type SummonCompanionJSONRequestBody = SummonCompanionRequest

// ServerInterface represents all server handlers.
type ServerInterface interface {
	// Получить активного компаньона игрока
	// (GET /gameplay/companions/active/{player_id})
	GetActiveCompanion(w http.ResponseWriter, r *http.Request, playerId openapi_types.UUID)
	// Получить доступные компаньоны
	// (GET /gameplay/companions/available)
	GetAvailableCompanions(w http.ResponseWriter, r *http.Request, params GetAvailableCompanionsParams)
	// Получить события компаньона
	// (GET /gameplay/companions/events/{companion_id})
	GetCompanionEvents(w http.ResponseWriter, r *http.Request, companionId openapi_types.UUID, params GetCompanionEventsParams)
	// Получить компаньонов игрока
	// (GET /gameplay/companions/owned/{player_id})
	GetOwnedCompanions(w http.ResponseWriter, r *http.Request, playerId openapi_types.UUID, params GetOwnedCompanionsParams)
	// Купить компаньона
	// (POST /gameplay/companions/purchase)
	PurchaseCompanion(w http.ResponseWriter, r *http.Request)
	// Получить каталог магазина компаньонов
	// (GET /gameplay/companions/shop/catalog)
	GetCompanionShopCatalog(w http.ResponseWriter, r *http.Request, params GetCompanionShopCatalogParams)
	// Купить компаньона из магазина
	// (POST /gameplay/companions/shop/purchase)
	PurchaseCompanionFromShop(w http.ResponseWriter, r *http.Request)
	// Получить детали компаньона в магазине
	// (GET /gameplay/companions/shop/{companion_id})
	GetCompanionShopDetails(w http.ResponseWriter, r *http.Request, companionId openapi_types.UUID)
	// Получить информацию о компаньоне
	// (GET /gameplay/companions/{companion_id})
	GetCompanion(w http.ResponseWriter, r *http.Request, companionId openapi_types.UUID)
	// Получить способности компаньона
	// (GET /gameplay/companions/{companion_id}/abilities)
	GetCompanionAbilities(w http.ResponseWriter, r *http.Request, companionId openapi_types.UUID, params GetCompanionAbilitiesParams)
	// Использовать способность компаньона
	// (POST /gameplay/companions/{companion_id}/abilities/{ability_id}/use)
	UseCompanionAbility(w http.ResponseWriter, r *http.Request, companionId openapi_types.UUID, abilityId openapi_types.UUID)
	// Добавить опыт компаньону
	// (POST /gameplay/companions/{companion_id}/add-xp)
	AddCompanionXP(w http.ResponseWriter, r *http.Request, companionId openapi_types.UUID)
	// Команда атаки компаньона
	// (POST /gameplay/companions/{companion_id}/combat/attack)
	CompanionAttack(w http.ResponseWriter, r *http.Request, companionId openapi_types.UUID)
	// Команда защиты компаньона
	// (POST /gameplay/companions/{companion_id}/combat/defend)
	CompanionDefend(w http.ResponseWriter, r *http.Request, companionId openapi_types.UUID)
	// Кастомизировать компаньона
	// (POST /gameplay/companions/{companion_id}/customize)
	CustomizeCompanion(w http.ResponseWriter, r *http.Request, companionId openapi_types.UUID)
	// Отозвать компаньона
	// (POST /gameplay/companions/{companion_id}/dismiss)
	DismissCompanion(w http.ResponseWriter, r *http.Request, companionId openapi_types.UUID)
	// Экипировать предмет компаньону
	// (POST /gameplay/companions/{companion_id}/equip)
	EquipCompanionItem(w http.ResponseWriter, r *http.Request, companionId openapi_types.UUID)
	// Получить прогрессию компаньона
	// (GET /gameplay/companions/{companion_id}/progression)
	GetCompanionProgression(w http.ResponseWriter, r *http.Request, companionId openapi_types.UUID)
	// Переименовать компаньона
	// (POST /gameplay/companions/{companion_id}/rename)
	RenameCompanion(w http.ResponseWriter, r *http.Request, companionId openapi_types.UUID)
	// Призвать компаньона
	// (POST /gameplay/companions/{companion_id}/summon)
	SummonCompanion(w http.ResponseWriter, r *http.Request, companionId openapi_types.UUID)
}

// ServerInterfaceWrapper converts contexts to parameters.
type ServerInterfaceWrapper struct {
	Handler            ServerInterface
	HandlerMiddlewares []MiddlewareFunc
	ErrorHandlerFunc   func(w http.ResponseWriter, r *http.Request, err error)
}

type MiddlewareFunc func(http.Handler) http.Handler

// GetActiveCompanion operation middleware
func (siw *ServerInterfaceWrapper) GetActiveCompanion(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "player_id" -------------
	var playerId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "player_id", mux.Vars(r)["player_id"], &playerId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "player_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.GetActiveCompanion(w, r, playerId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// GetAvailableCompanions operation middleware
func (siw *ServerInterfaceWrapper) GetAvailableCompanions(w http.ResponseWriter, r *http.Request) {

	var err error

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	// Parameter object where we will unmarshal all parameters from the context
	var params GetAvailableCompanionsParams

	// ------------- Optional query parameter "category" -------------

	err = runtime.BindQueryParameter("form", true, false, "category", r.URL.Query(), &params.Category)
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "category", Err: err})
		return
	}

	// ------------- Optional query parameter "limit" -------------

	err = runtime.BindQueryParameter("form", true, false, "limit", r.URL.Query(), &params.Limit)
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "limit", Err: err})
		return
	}

	// ------------- Optional query parameter "offset" -------------

	err = runtime.BindQueryParameter("form", true, false, "offset", r.URL.Query(), &params.Offset)
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "offset", Err: err})
		return
	}

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.GetAvailableCompanions(w, r, params)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// GetCompanionEvents operation middleware
func (siw *ServerInterfaceWrapper) GetCompanionEvents(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "companion_id" -------------
	var companionId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "companion_id", mux.Vars(r)["companion_id"], &companionId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "companion_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	// Parameter object where we will unmarshal all parameters from the context
	var params GetCompanionEventsParams

	// ------------- Optional query parameter "event_type" -------------

	err = runtime.BindQueryParameter("form", true, false, "event_type", r.URL.Query(), &params.EventType)
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "event_type", Err: err})
		return
	}

	// ------------- Optional query parameter "limit" -------------

	err = runtime.BindQueryParameter("form", true, false, "limit", r.URL.Query(), &params.Limit)
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "limit", Err: err})
		return
	}

	// ------------- Optional query parameter "offset" -------------

	err = runtime.BindQueryParameter("form", true, false, "offset", r.URL.Query(), &params.Offset)
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "offset", Err: err})
		return
	}

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.GetCompanionEvents(w, r, companionId, params)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// GetOwnedCompanions operation middleware
func (siw *ServerInterfaceWrapper) GetOwnedCompanions(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "player_id" -------------
	var playerId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "player_id", mux.Vars(r)["player_id"], &playerId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "player_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	// Parameter object where we will unmarshal all parameters from the context
	var params GetOwnedCompanionsParams

	// ------------- Optional query parameter "category" -------------

	err = runtime.BindQueryParameter("form", true, false, "category", r.URL.Query(), &params.Category)
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "category", Err: err})
		return
	}

	// ------------- Optional query parameter "limit" -------------

	err = runtime.BindQueryParameter("form", true, false, "limit", r.URL.Query(), &params.Limit)
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "limit", Err: err})
		return
	}

	// ------------- Optional query parameter "offset" -------------

	err = runtime.BindQueryParameter("form", true, false, "offset", r.URL.Query(), &params.Offset)
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "offset", Err: err})
		return
	}

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.GetOwnedCompanions(w, r, playerId, params)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// PurchaseCompanion operation middleware
func (siw *ServerInterfaceWrapper) PurchaseCompanion(w http.ResponseWriter, r *http.Request) {

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.PurchaseCompanion(w, r)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// GetCompanionShopCatalog operation middleware
func (siw *ServerInterfaceWrapper) GetCompanionShopCatalog(w http.ResponseWriter, r *http.Request) {

	var err error

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	// Parameter object where we will unmarshal all parameters from the context
	var params GetCompanionShopCatalogParams

	// ------------- Optional query parameter "category" -------------

	err = runtime.BindQueryParameter("form", true, false, "category", r.URL.Query(), &params.Category)
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "category", Err: err})
		return
	}

	// ------------- Optional query parameter "limit" -------------

	err = runtime.BindQueryParameter("form", true, false, "limit", r.URL.Query(), &params.Limit)
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "limit", Err: err})
		return
	}

	// ------------- Optional query parameter "offset" -------------

	err = runtime.BindQueryParameter("form", true, false, "offset", r.URL.Query(), &params.Offset)
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "offset", Err: err})
		return
	}

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.GetCompanionShopCatalog(w, r, params)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// PurchaseCompanionFromShop operation middleware
func (siw *ServerInterfaceWrapper) PurchaseCompanionFromShop(w http.ResponseWriter, r *http.Request) {

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.PurchaseCompanionFromShop(w, r)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// GetCompanionShopDetails operation middleware
func (siw *ServerInterfaceWrapper) GetCompanionShopDetails(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "companion_id" -------------
	var companionId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "companion_id", mux.Vars(r)["companion_id"], &companionId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "companion_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.GetCompanionShopDetails(w, r, companionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// GetCompanion operation middleware
func (siw *ServerInterfaceWrapper) GetCompanion(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "companion_id" -------------
	var companionId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "companion_id", mux.Vars(r)["companion_id"], &companionId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "companion_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.GetCompanion(w, r, companionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// GetCompanionAbilities operation middleware
func (siw *ServerInterfaceWrapper) GetCompanionAbilities(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "companion_id" -------------
	var companionId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "companion_id", mux.Vars(r)["companion_id"], &companionId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "companion_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	// Parameter object where we will unmarshal all parameters from the context
	var params GetCompanionAbilitiesParams

	// ------------- Optional query parameter "ability_type" -------------

	err = runtime.BindQueryParameter("form", true, false, "ability_type", r.URL.Query(), &params.AbilityType)
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "ability_type", Err: err})
		return
	}

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.GetCompanionAbilities(w, r, companionId, params)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// UseCompanionAbility operation middleware
func (siw *ServerInterfaceWrapper) UseCompanionAbility(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "companion_id" -------------
	var companionId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "companion_id", mux.Vars(r)["companion_id"], &companionId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "companion_id", Err: err})
		return
	}

	// ------------- Path parameter "ability_id" -------------
	var abilityId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "ability_id", mux.Vars(r)["ability_id"], &abilityId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "ability_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.UseCompanionAbility(w, r, companionId, abilityId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// AddCompanionXP operation middleware
func (siw *ServerInterfaceWrapper) AddCompanionXP(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "companion_id" -------------
	var companionId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "companion_id", mux.Vars(r)["companion_id"], &companionId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "companion_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.AddCompanionXP(w, r, companionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// CompanionAttack operation middleware
func (siw *ServerInterfaceWrapper) CompanionAttack(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "companion_id" -------------
	var companionId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "companion_id", mux.Vars(r)["companion_id"], &companionId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "companion_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.CompanionAttack(w, r, companionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// CompanionDefend operation middleware
func (siw *ServerInterfaceWrapper) CompanionDefend(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "companion_id" -------------
	var companionId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "companion_id", mux.Vars(r)["companion_id"], &companionId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "companion_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.CompanionDefend(w, r, companionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// CustomizeCompanion operation middleware
func (siw *ServerInterfaceWrapper) CustomizeCompanion(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "companion_id" -------------
	var companionId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "companion_id", mux.Vars(r)["companion_id"], &companionId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "companion_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.CustomizeCompanion(w, r, companionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// DismissCompanion operation middleware
func (siw *ServerInterfaceWrapper) DismissCompanion(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "companion_id" -------------
	var companionId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "companion_id", mux.Vars(r)["companion_id"], &companionId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "companion_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.DismissCompanion(w, r, companionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// EquipCompanionItem operation middleware
func (siw *ServerInterfaceWrapper) EquipCompanionItem(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "companion_id" -------------
	var companionId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "companion_id", mux.Vars(r)["companion_id"], &companionId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "companion_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.EquipCompanionItem(w, r, companionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// GetCompanionProgression operation middleware
func (siw *ServerInterfaceWrapper) GetCompanionProgression(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "companion_id" -------------
	var companionId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "companion_id", mux.Vars(r)["companion_id"], &companionId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "companion_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.GetCompanionProgression(w, r, companionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// RenameCompanion operation middleware
func (siw *ServerInterfaceWrapper) RenameCompanion(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "companion_id" -------------
	var companionId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "companion_id", mux.Vars(r)["companion_id"], &companionId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "companion_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.RenameCompanion(w, r, companionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

// SummonCompanion operation middleware
func (siw *ServerInterfaceWrapper) SummonCompanion(w http.ResponseWriter, r *http.Request) {

	var err error

	// ------------- Path parameter "companion_id" -------------
	var companionId openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "companion_id", mux.Vars(r)["companion_id"], &companionId, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		siw.ErrorHandlerFunc(w, r, &InvalidParamFormatError{ParamName: "companion_id", Err: err})
		return
	}

	ctx := r.Context()

	ctx = context.WithValue(ctx, BearerAuthScopes, []string{})

	r = r.WithContext(ctx)

	handler := http.Handler(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		siw.Handler.SummonCompanion(w, r, companionId)
	}))

	for _, middleware := range siw.HandlerMiddlewares {
		handler = middleware(handler)
	}

	handler.ServeHTTP(w, r)
}

type UnescapedCookieParamError struct {
	ParamName string
	Err       error
}

func (e *UnescapedCookieParamError) Error() string {
	return fmt.Sprintf("error unescaping cookie parameter '%s'", e.ParamName)
}

func (e *UnescapedCookieParamError) Unwrap() error {
	return e.Err
}

type UnmarshalingParamError struct {
	ParamName string
	Err       error
}

func (e *UnmarshalingParamError) Error() string {
	return fmt.Sprintf("Error unmarshaling parameter %s as JSON: %s", e.ParamName, e.Err.Error())
}

func (e *UnmarshalingParamError) Unwrap() error {
	return e.Err
}

type RequiredParamError struct {
	ParamName string
}

func (e *RequiredParamError) Error() string {
	return fmt.Sprintf("Query argument %s is required, but not found", e.ParamName)
}

type RequiredHeaderError struct {
	ParamName string
	Err       error
}

func (e *RequiredHeaderError) Error() string {
	return fmt.Sprintf("Header parameter %s is required, but not found", e.ParamName)
}

func (e *RequiredHeaderError) Unwrap() error {
	return e.Err
}

type InvalidParamFormatError struct {
	ParamName string
	Err       error
}

func (e *InvalidParamFormatError) Error() string {
	return fmt.Sprintf("Invalid format for parameter %s: %s", e.ParamName, e.Err.Error())
}

func (e *InvalidParamFormatError) Unwrap() error {
	return e.Err
}

type TooManyValuesForParamError struct {
	ParamName string
	Count     int
}

func (e *TooManyValuesForParamError) Error() string {
	return fmt.Sprintf("Expected one value for %s, got %d", e.ParamName, e.Count)
}

// Handler creates http.Handler with routing matching OpenAPI spec.
func Handler(si ServerInterface) http.Handler {
	return HandlerWithOptions(si, GorillaServerOptions{})
}

type GorillaServerOptions struct {
	BaseURL          string
	BaseRouter       *mux.Router
	Middlewares      []MiddlewareFunc
	ErrorHandlerFunc func(w http.ResponseWriter, r *http.Request, err error)
}

// HandlerFromMux creates http.Handler with routing matching OpenAPI spec based on the provided mux.
func HandlerFromMux(si ServerInterface, r *mux.Router) http.Handler {
	return HandlerWithOptions(si, GorillaServerOptions{
		BaseRouter: r,
	})
}

func HandlerFromMuxWithBaseURL(si ServerInterface, r *mux.Router, baseURL string) http.Handler {
	return HandlerWithOptions(si, GorillaServerOptions{
		BaseURL:    baseURL,
		BaseRouter: r,
	})
}

// HandlerWithOptions creates http.Handler with additional options
func HandlerWithOptions(si ServerInterface, options GorillaServerOptions) http.Handler {
	r := options.BaseRouter

	if r == nil {
		r = mux.NewRouter()
	}
	if options.ErrorHandlerFunc == nil {
		options.ErrorHandlerFunc = func(w http.ResponseWriter, r *http.Request, err error) {
			http.Error(w, err.Error(), http.StatusBadRequest)
		}
	}
	wrapper := ServerInterfaceWrapper{
		Handler:            si,
		HandlerMiddlewares: options.Middlewares,
		ErrorHandlerFunc:   options.ErrorHandlerFunc,
	}

	r.HandleFunc(options.BaseURL+"/gameplay/companions/active/{player_id}", wrapper.GetActiveCompanion).Methods("GET")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/available", wrapper.GetAvailableCompanions).Methods("GET")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/events/{companion_id}", wrapper.GetCompanionEvents).Methods("GET")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/owned/{player_id}", wrapper.GetOwnedCompanions).Methods("GET")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/purchase", wrapper.PurchaseCompanion).Methods("POST")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/shop/catalog", wrapper.GetCompanionShopCatalog).Methods("GET")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/shop/purchase", wrapper.PurchaseCompanionFromShop).Methods("POST")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/shop/{companion_id}", wrapper.GetCompanionShopDetails).Methods("GET")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/{companion_id}", wrapper.GetCompanion).Methods("GET")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/{companion_id}/abilities", wrapper.GetCompanionAbilities).Methods("GET")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/{companion_id}/abilities/{ability_id}/use", wrapper.UseCompanionAbility).Methods("POST")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/{companion_id}/add-xp", wrapper.AddCompanionXP).Methods("POST")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/{companion_id}/combat/attack", wrapper.CompanionAttack).Methods("POST")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/{companion_id}/combat/defend", wrapper.CompanionDefend).Methods("POST")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/{companion_id}/customize", wrapper.CustomizeCompanion).Methods("POST")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/{companion_id}/dismiss", wrapper.DismissCompanion).Methods("POST")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/{companion_id}/equip", wrapper.EquipCompanionItem).Methods("POST")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/{companion_id}/progression", wrapper.GetCompanionProgression).Methods("GET")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/{companion_id}/rename", wrapper.RenameCompanion).Methods("POST")

	r.HandleFunc(options.BaseURL+"/gameplay/companions/{companion_id}/summon", wrapper.SummonCompanion).Methods("POST")

	return r
}
