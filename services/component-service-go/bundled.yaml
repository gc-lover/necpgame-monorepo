openapi: 3.0.3
info:
  title: Component Service API - Enterprise-Grade Gameplay Components
  description: '**Enterprise-Grade Gameplay Components API for NECPGAME**

    Component Service manages core gameplay mechanics, world state, difficulty systems,
    cooperative challenges, and dynamic content components. Provides modular gameplay
    systems that power the interactive experience of Night City.

    ## Key Features

    - **Combat Systems**: Wave-based combat mechanics and turn management - **Gameplay
    Affixes**: Dynamic modifiers and enhancement systems - **Cooperative Challenges**:
    Multiplayer challenge coordination - **Difficulty Rating**: Adaptive difficulty
    scaling systems - **World State Management**: Global game world state and flags
    - **Challenge Modes**: Mythic+, restricted modes, and special content

    ## Domain Purpose

    Manages the core interactive components that make gameplay engaging and dynamic.
    From combat waves to world-altering events, these components create the living,
    breathing world of Night City that responds to player actions.

    ## Performance Targets

    - P99 Latency: <25ms for component operations - Memory: <15KB per active component
    session - Concurrent users: 100,000+ simultaneous interactions - State updates:
    50,000+ operations per second

    '
  version: 1.0.0
  contact:
    name: NECPGAME API Support
    url: https://necpgame.com/support
    email: api@necpgame.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
servers:
- url: https://api.necpgame.com/v1/component
  description: Production server
- url: https://staging-api.necpgame.com/v1/component
  description: Staging server
- url: http://localhost:8080/api/v1/component
  description: Local development server
security:
- BearerAuth: []
tags:
- name: Combat Systems
  description: Wave-based combat mechanics and turn management
- name: Gameplay Affixes
  description: Dynamic modifiers and enhancement systems
- name: Cooperative Challenges
  description: Multiplayer challenge coordination
- name: Difficulty Rating
  description: Adaptive difficulty scaling systems
- name: World State
  description: Global game world state and flags
- name: Challenge Modes
  description: Special gameplay modes and content
- name: Health Monitoring
  description: System health and performance monitoring
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: '**JWT Bearer token authentication**

        Required for all authenticated endpoints. Token must be obtained from auth-service
        and included in Authorization header.

        **Format:** `Authorization: Bearer <token>`

        **Token Expiry:** 15 minutes for access tokens, 7 days for refresh tokens '
  schemas:
    Error:
      type: object
      required:
      - code
      - message
      properties:
        code:
          type: integer
          example: 500
          format: int32
          minimum: 100
          maximum: 599
        message:
          type: string
          example: Internal server error
          maxLength: 1000
        details:
          type: object
          description: Additional error details
      description: Standard error response format
    CombatWave:
      type: object
      description: Combat wave configuration and state
      properties:
        waveId:
          type: string
          format: uuid
        encounterId:
          type: string
          format: uuid
        waveNumber:
          type: integer
          minimum: 1
        enemyTypes:
          type: array
          items:
            type: object
            properties:
              enemyType:
                type: string
              count:
                type: integer
                minimum: 1
              spawnDelay:
                type: number
                format: float
                description: Delay in seconds before spawning
          description: Enemies in this wave
        modifiers:
          type: array
          items:
            type: string
          description: Wave-specific modifiers
        rewardMultiplier:
          type: number
          format: float
          default: 1.0
        timeLimit:
          type: integer
          description: Time limit in seconds (optional)
      required:
      - waveId
      - encounterId
      - waveNumber
      - enemyTypes
    GameplayAffix:
      type: object
      description: Dynamic gameplay modifier
      properties:
        affixId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        type:
          type: string
          enum:
          - damage
          - defense
          - speed
          - healing
          - resource
          - special
        target:
          type: string
          enum:
          - player
          - enemy
          - environment
          - global
        value:
          oneOf:
          - type: number
          - type: string
          description: Modifier value or reference
        duration:
          type: integer
          description: Duration in seconds (0 = permanent)
        stackable:
          type: boolean
          default: false
        maxStacks:
          type: integer
          minimum: 1
      required:
      - affixId
      - name
      - type
      - target
    CooperativeChallenge:
      type: object
      description: Multiplayer cooperative challenge
      properties:
        challengeId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        participantLimit:
          type: integer
          minimum: 2
          maximum: 50
        objectives:
          type: array
          items:
            type: object
            properties:
              objectiveId:
                type: string
                format: uuid
              type:
                type: string
                enum:
                - kill
                - collect
                - survive
                - achieve
                - coordinate
              target:
                type: string
              count:
                type: integer
              timeLimit:
                type: integer
              description:
                type: string
            required:
            - objectiveId
            - type
            - target
        synchronization:
          type: object
          properties:
            requiresAllParticipants:
              type: boolean
              default: true
            phaseBased:
              type: boolean
              default: false
            realTimeUpdates:
              type: boolean
              default: true
          description: Challenge synchronization requirements
        rewards:
          type: array
          items:
            type: object
            properties:
              type:
                type: string
                enum:
                - experience
                - currency
                - item
                - achievement
              value:
                oneOf:
                - type: integer
                - type: string
              shared:
                type: boolean
                default: false
      required:
      - challengeId
      - name
      - participantLimit
      - objectives
    DifficultyRating:
      type: object
      description: Dynamic difficulty assessment and scaling
      properties:
        ratingId:
          type: string
          format: uuid
        contextId:
          type: string
          format: uuid
          description: Associated encounter/challenge/area ID
        baseDifficulty:
          type: string
          enum:
          - very_easy
          - easy
          - normal
          - hard
          - very_hard
          - impossible
        playerCount:
          type: integer
          minimum: 1
        averageLevel:
          type: integer
          minimum: 1
        performanceMetrics:
          type: object
          properties:
            completionRate:
              type: number
              format: float
              minimum: 0
              maximum: 1
            averageTime:
              type: integer
              description: Average completion time in seconds
            failureRate:
              type: number
              format: float
              minimum: 0
              maximum: 1
          description: Historical performance data
        adjustedDifficulty:
          type: string
          enum:
          - very_easy
          - easy
          - normal
          - hard
          - very_hard
          - impossible
        scalingFactors:
          type: object
          properties:
            enemyHealth:
              type: number
              format: float
            enemyDamage:
              type: number
              format: float
            enemyCount:
              type: number
              format: float
            rewardMultiplier:
              type: number
              format: float
          description: Applied scaling modifiers
      required:
      - ratingId
      - contextId
      - baseDifficulty
    WorldState:
      type: object
      description: Global world state and flags
      properties:
        stateId:
          type: string
          format: uuid
        timestamp:
          type: string
          format: date-time
        flags:
          type: object
          description: Global world flags and variables
          additionalProperties:
            oneOf:
            - type: boolean
            - type: integer
            - type: string
        regions:
          type: object
          description: Regional state data
          additionalProperties:
            type: object
            properties:
              status:
                type: string
                enum:
                - normal
                - alert
                - lockdown
                - event
                - disaster
              activeEvents:
                type: array
                items:
                  type: string
                  format: uuid
              modifiers:
                type: object
                description: Regional modifiers
                additionalProperties:
                  oneOf:
                  - type: number
                  - type: string
                  - type: boolean
        globalEvents:
          type: array
          items:
            type: object
            properties:
              eventId:
                type: string
                format: uuid
              type:
                type: string
              impact:
                type: string
                enum:
                - local
                - regional
                - global
              active:
                type: boolean
              startTime:
                type: string
                format: date-time
          description: Currently active global events
      required:
      - stateId
      - timestamp
      - flags
paths:
  /health:
    get:
      summary: Component service health check
      description: '**Enterprise-grade health check endpoint**

        Provides real-time health status of the component microservice.

        Critical for service discovery, load balancing, and monitoring.


        **Performance:** <1ms response time, cached for 30 seconds

        '
      operationId: componentHealthCheck
      tags:
      - Health Monitoring
      parameters:
      - name: Accept-Encoding
        in: header
        schema:
          type: string
          enum:
          - gzip
          - deflate
          - br
      responses:
        '200':
          description: Service is healthy
          headers:
            Cache-Control:
              schema:
                type: string
                example: max-age=30, s-maxage=60
            ETag:
              schema:
                type: string
                example: '"health-v1.0"'
            Content-Encoding:
              schema:
                type: string
                enum:
                - gzip
                - deflate
                - br
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum:
                    - healthy
                    example: healthy
                  timestamp:
                    type: string
                    format: date-time
                    example: '2024-01-15T10:30:00Z'
                  version:
                    type: string
                    example: 1.0.0
                  uptime:
                    type: integer
                    description: Uptime in seconds
                    example: 3600
                  memory:
                    type: object
                    properties:
                      used:
                        type: integer
                        description: Memory used in MB
                        example: 128
                      total:
                        type: integer
                        description: Total memory in MB
                        example: 512
                      percentage:
                        type: number
                        format: float
                        example: 25.0
                required:
                - status
                - timestamp
                - version
        '503':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
  /combat/waves:
    get:
      summary: Get combat wave configurations
      description: '**Get available combat wave configurations**

        Returns wave-based combat setups for dynamic encounters.

        **Performance:** <20ms response time, cached for 5 minutes '
      operationId: getCombatWaves
      tags:
      - Combat Systems
      security:
      - BearerAuth: []
      parameters:
      - name: encounter_type
        in: query
        schema:
          type: string
          enum:
          - random
          - story
          - challenge
          - boss
        description: Filter by encounter type
      - name: difficulty
        in: query
        schema:
          type: string
          enum:
          - easy
          - medium
          - hard
          - expert
        description: Filter by difficulty level
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 50
          default: 20
        description: Maximum waves to return
      responses:
        '200':
          description: Combat waves retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/CombatWave'
                  total:
                    type: integer
        '401':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
  /affixes/active:
    get:
      summary: Get active gameplay affixes
      description: '**Get currently active gameplay modifiers**

        Returns dynamic affixes that modify gameplay mechanics.

        **Performance:** <15ms response time, real-time data '
      operationId: getActiveAffixes
      tags:
      - Gameplay Affixes
      security:
      - BearerAuth: []
      parameters:
      - name: context_id
        in: query
        schema:
          type: string
          format: uuid
        description: Context ID (encounter, area, character)
      - name: type
        in: query
        schema:
          type: string
          enum:
          - damage
          - defense
          - speed
          - healing
          - resource
          - special
        description: Filter by affix type
      - name: target
        in: query
        schema:
          type: string
          enum:
          - player
          - enemy
          - environment
          - global
        description: Filter by target type
      responses:
        '200':
          description: Active affixes retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/GameplayAffix'
                  context:
                    type: object
                    description: Context information for applied affixes
        '401':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
  /challenges/cooperative/active:
    get:
      summary: Get active cooperative challenges
      description: '**Get available cooperative multiplayer challenges**

        Returns challenges requiring team coordination and participation.

        **Performance:** <25ms response time, cached for 2 minutes '
      operationId: getActiveCooperativeChallenges
      tags:
      - Cooperative Challenges
      security:
      - BearerAuth: []
      parameters:
      - name: character_id
        in: query
        required: true
        schema:
          type: string
          format: uuid
        description: Character identifier for availability check
      - name: participant_range
        in: query
        schema:
          type: string
          enum:
          - small
          - medium
          - large
          description: Filter by team size (2-4, 5-10, 11+)
      responses:
        '200':
          description: Cooperative challenges retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/CooperativeChallenge'
                  available:
                    type: array
                    items:
                      type: string
                      format: uuid
                    description: Challenge IDs the character can join
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
        '401':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
  /difficulty/rate:
    post:
      summary: Calculate difficulty rating
      description: '**Calculate adaptive difficulty rating**

        Analyzes context and player metrics to determine optimal difficulty scaling.

        **Performance:** <100ms response time for rating calculation '
      operationId: calculateDifficultyRating
      tags:
      - Difficulty Rating
      security:
      - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                contextId:
                  type: string
                  format: uuid
                  description: Context identifier (encounter, area, challenge)
                contextType:
                  type: string
                  enum:
                  - encounter
                  - area
                  - challenge
                  - event
                playerMetrics:
                  type: object
                  properties:
                    count:
                      type: integer
                      minimum: 1
                    averageLevel:
                      type: integer
                      minimum: 1
                    performanceHistory:
                      type: array
                      items:
                        type: object
                        properties:
                          contextId:
                            type: string
                            format: uuid
                          completionTime:
                            type: integer
                            description: Time in seconds
                          success:
                            type: boolean
                          difficulty:
                            type: string
                            enum:
                            - very_easy
                            - easy
                            - normal
                            - hard
                            - very_hard
                            - impossible
                  required:
                  - count
                  - averageLevel
                baseDifficulty:
                  type: string
                  enum:
                  - very_easy
                  - easy
                  - normal
                  - hard
                  - very_hard
                  - impossible
                  description: Requested base difficulty
              required:
              - contextId
              - contextType
              - playerMetrics
      responses:
        '200':
          description: Difficulty rating calculated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/DifficultyRating'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
        '401':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
  /world/state:
    get:
      summary: Get current world state
      description: '**Get global world state and active flags**

        Returns current world state including global flags, regional status, and active
        events affecting gameplay.

        **Performance:** <10ms response time, cached for 30 seconds '
      operationId: getWorldState
      tags:
      - World State
      security:
      - BearerAuth: []
      parameters:
      - name: include_regions
        in: query
        schema:
          type: boolean
          default: true
        description: Include regional state data
      - name: include_events
        in: query
        schema:
          type: boolean
          default: true
        description: Include active global events
      - name: region_filter
        in: query
        schema:
          type: string
          format: uuid
        description: Filter to specific region
      responses:
        '200':
          description: World state retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/WorldState'
        '401':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
  /modes/challenge:
    get:
      summary: Get available challenge modes
      description: '**Get special challenge modes and restricted content**

        Returns Mythic+, restricted modes, and other special gameplay variants.

        **Performance:** <20ms response time, cached for 10 minutes '
      operationId: getChallengeModes
      tags:
      - Challenge Modes
      security:
      - BearerAuth: []
      parameters:
      - name: character_id
        in: query
        required: true
        schema:
          type: string
          format: uuid
        description: Character identifier for availability check
      - name: mode_type
        in: query
        schema:
          type: string
          enum:
          - mythic_plus
          - restricted
          - master_challenge
          - special
        description: Filter by mode type
      - name: unlocked_only
        in: query
        schema:
          type: boolean
          default: true
        description: Only return modes the character can access
      responses:
        '200':
          description: Challenge modes retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        modeId:
                          type: string
                          format: uuid
                        name:
                          type: string
                        description:
                          type: string
                        type:
                          type: string
                          enum:
                          - mythic_plus
                          - restricted
                          - master_challenge
                          - special
                        requirements:
                          type: object
                          description: Access requirements
                        rewards:
                          type: object
                          description: Mode-specific rewards
                        unlocked:
                          type: boolean
                        recommendedLevel:
                          type: integer
                        difficulty:
                          type: string
                          enum:
                          - easy
                          - medium
                          - hard
                          - expert
                          - nightmare
                      required:
                      - modeId
                      - name
                      - type
                      - unlocked
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
        '401':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
