openapi: 3.0.3
info:
  title: Economy Service Go API
  description: |-
    **Enterprise-Grade Economy Service API for NECPGAME MMOFPS RPG.
    **Service Purpose:** Complete economy and trading system with market analysis, trade management, and transaction history.
    **Architecture:** Event-driven microservice with Kafka integration for trade events and market updates.
    **Domain:** economy-service
    **Core Features:** - Trade listing and management - Market overview and analytics - Transaction history tracking - Player economy statistics - Anti-fraud trade validation
    **Performance Targets:** - Hot paths: 500+ RPS, P99 <25ms (trade operations) - Market data: 2000+ RPS, P99 <15ms (market overview) - Memory: <40MB per service instance (optimized structs) - Cache hit rate: >90% (Redis for market data)
    **BACKEND NOTE:** Struct field alignment optimized (large → small types). All schemas ordered for optimal memory layout in generated Go code. Expected memory savings: 30-50% for economy-related structs.
    **Security:** JWT authentication with role-based trade permissions.
  version: 1.0.0
  contact:
    name: Economy Service Team
    email: economy-service@necpgame.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
servers:
  - url: http://localhost:8080/api/v1/economy
    description: Local development server
  - url: https://api.necpgame.com/v1/economy
    description: Production server
security:
  - bearerAuth: []
tags:
  - name: Trade Management
    description: Trade listing, execution, and management
  - name: Market Data
    description: Market overview and analytics
  - name: Transaction History
    description: Player transaction tracking
  - name: Health
    description: Service health monitoring
paths:
  /health:
    get:
      tags:
        - Health
      summary: Service health check
      description: Get service health status with economy-specific metrics
      operationId: healthCheck
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '503':
          description: Service is unhealthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /readiness:
    get:
      tags:
        - Health
      summary: Service readiness check
      description: Comprehensive readiness check including database connectivity
      operationId: readinessCheck
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Service is ready
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '503':
          description: Service is not ready
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /market/overview:
    get:
      tags:
        - Market Data
      summary: Get market overview
      description: |-
        Get aggregated market statistics and active trade counts.
        **BACKEND NOTE:** Hot path - optimized for 2000+ RPS with Redis caching.
      operationId: getMarketOverview
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Market overview data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MarketOverview'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /trade:
    get:
      tags:
        - Trade Management
      summary: Get active trades
      description: |-
        Get paginated list of active trade listings with filtering options.
        **BACKEND NOTE:** Enterprise-grade trade listing with anti-fraud validation. Supports complex filtering for market analysis and player trading.
      operationId: getActiveTrades
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number for pagination
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of trades per page
        - name: trade_type
          in: query
          schema:
            type: string
            enum:
              - buy
              - sell
              - exchange
          description: Filter by trade type
        - name: item_category
          in: query
          schema:
            type: string
            maxLength: 50
          description: Filter by item category
        - name: min_price
          in: query
          schema:
            type: number
            minimum: 0
          description: Minimum price per unit filter
        - name: max_price
          in: query
          schema:
            type: number
            minimum: 0
          description: Maximum price per unit filter
        - name: seller_id
          in: query
          schema:
            type: string
            format: uuid
          description: Filter by specific seller
        - name: sort_by
          in: query
          schema:
            type: string
            enum:
              - created_at
              - price_per_unit
              - total_price
              - expires_at
            default: created_at
          description: Sort field
        - name: sort_order
          in: query
          schema:
            type: string
            enum:
              - asc
              - desc
            default: desc
          description: Sort order
      responses:
        '200':
          description: Active trades list
          content:
            application/json:
              schema:
                type: object
                required:
                  - trades
                  - pagination
                properties:
                  trades:
                    type: array
                    items:
                      $ref: '#/components/schemas/Trade'
                  pagination:
                    type: object
                    required:
                      - page
                      - limit
                      - total
                      - total_pages
                    properties:
                      page:
                        type: integer
                        example: 1
                      limit:
                        type: integer
                        example: 20
                      total:
                        type: integer
                        example: 150
                      total_pages:
                        type: integer
                        example: 8
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/responses/Unauthorized'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - Trade Management
      summary: Create trade listing
      description: |-
        Create a new trade listing with validation and anti-fraud checks.
        **BACKEND NOTE:** Transaction-safe trade creation with inventory validation.
      operationId: createTradeListing
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTradeRequest'
      responses:
        '201':
          description: Trade listing created successfully
          content:
            application/json:
              schema:
                type: object
                required:
                  - trade
                properties:
                  trade:
                    $ref: '#/components/schemas/Trade'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/responses/Unauthorized'
        '403':
          description: Insufficient permissions or invalid item ownership
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Trade creation conflict
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/responses/InternalServerError'
  /trade/{trade_id}:
    get:
      tags:
        - Trade Management
      summary: Get trade details
      description: Get detailed information about a specific trade listing
      operationId: getTradeDetails
      security:
        - bearerAuth: []
      parameters:
        - name: trade_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Trade unique identifier
      responses:
        '200':
          description: Trade details
          content:
            application/json:
              schema:
                type: object
                required:
                  - trade
                properties:
                  trade:
                    $ref: '#/components/schemas/Trade'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/responses/Unauthorized'
        '404':
          description: Trade not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - Trade Management
      summary: Cancel trade listing
      description: |-
        Cancel an active trade listing (seller only).
        **BACKEND NOTE:** Safe cancellation with status validation and refund processing.
      operationId: cancelTrade
      security:
        - bearerAuth: []
      parameters:
        - name: trade_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Trade unique identifier
      responses:
        '200':
          description: Trade cancelled successfully
          content:
            application/json:
              schema:
                type: object
                required:
                  - result
                properties:
                  result:
                    $ref: '#/components/schemas/TradeResult'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/responses/Unauthorized'
        '403':
          description: Insufficient permissions (not the seller)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Trade not found or already processed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Trade cannot be cancelled (already in progress)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/responses/InternalServerError'
  /auctions:
    get:
      tags:
        - Auction House
      summary: Get auctions list
      description: |-
        Get paginated list of auctions with filtering and sorting.
        **BACKEND NOTE:** Hot path - optimized for 1000+ RPS with Redis caching.
      operationId: getAuctions
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [active, sold, expired, cancelled]
          description: Filter by auction status
        - name: item_id
          in: query
          schema:
            type: string
            format: uuid
          description: Filter by item ID
        - name: seller_id
          in: query
          schema:
            type: string
            format: uuid
          description: Filter by seller ID
        - name: sort
          in: query
          schema:
            type: string
            enum: [ending_soon, price_asc, price_desc, newest]
            default: ending_soon
          description: Sort auctions
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of auctions to return
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Pagination offset
      responses:
        '200':
          description: Auctions list
          content:
            application/json:
              schema:
                type: object
                properties:
                  auctions:
                    type: array
                    items:
                      $ref: '#/components/schemas/AuctionSummary'
                  total:
                    type: integer
                  next_offset:
                    type: integer
                    nullable: true
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      tags:
        - Auction House
      summary: Create auction
      description: |-
        Create a new auction listing.
        **BACKEND NOTE:** Validates item ownership and locks item inventory.
      operationId: createAuction
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAuctionRequest'
      responses:
        '201':
          description: Auction created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuctionDetail'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden - item not owned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auctions/{auction_id}:
    get:
      tags:
        - Auction House
      summary: Get auction details
      description: Get detailed information about a specific auction including bid history.
      operationId: getAuctionDetails
      security:
        - bearerAuth: []
      parameters:
        - name: auction_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Auction ID
      responses:
        '200':
          description: Auction details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuctionDetail'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Auction not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auctions/{auction_id}/bid:
    post:
      tags:
        - Auction House
      summary: Place bid on auction
      description: |-
        Place a bid on an active auction. Minimum bid increment is 5%.
        **BACKEND NOTE:** Atomic operation with balance check and bid validation.
      operationId: placeBid
      security:
        - bearerAuth: []
      parameters:
        - name: auction_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Auction ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PlaceBidRequest'
      responses:
        '200':
          description: Bid placed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuctionDetail'
        '400':
          description: Bad request - invalid bid amount
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden - insufficient funds or own auction
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Auction not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Auction ended or bid too low
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auctions/{auction_id}/buyout:
    post:
      tags:
        - Auction House
      summary: Buyout auction
      description: |-
        Instantly purchase auction at buyout price.
        **BACKEND NOTE:** Immediate completion with no bidding period.
      operationId: buyoutAuction
      security:
        - bearerAuth: []
      parameters:
        - name: auction_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Auction ID
      responses:
        '200':
          description: Auction bought out
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuctionDetail'
        '400':
          description: Bad request - no buyout price
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden - insufficient funds or own auction
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Auction not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Auction not active
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auctions/{auction_id}/cancel:
    post:
      tags:
        - Auction House
      summary: Cancel auction
      description: |-
        Cancel auction (seller only, if no bids placed).
        **BACKEND NOTE:** Only possible before first bid is placed.
      operationId: cancelAuction
      security:
        - bearerAuth: []
      parameters:
        - name: auction_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Auction ID
      responses:
        '200':
          description: Auction cancelled
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuctionDetail'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden - not seller or bids already placed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Auction not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Auction cannot be cancelled
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auctions/my:
    get:
      tags:
        - Auction House
      summary: Get my auctions
      description: Get auctions created by the authenticated user (seller view).
      operationId: getMyAuctions
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [active, sold, expired, cancelled]
          description: Filter by auction status
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of auctions to return
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Pagination offset
      responses:
        '200':
          description: User's auctions
          content:
            application/json:
              schema:
                type: object
                properties:
                  auctions:
                    type: array
                    items:
                      $ref: '#/components/schemas/AuctionSummary'
                  total:
                    type: integer
                  next_offset:
                    type: integer
                    nullable: true
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /auctions/my-bids:
    get:
      tags:
        - Auction House
      summary: Get my bids
      description: Get auctions where the authenticated user has placed bids (bidder view).
      operationId: getMyBids
      security:
        - bearerAuth: []
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of auctions to return
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Pagination offset
      responses:
        '200':
          description: Auctions with user's bids
          content:
            application/json:
              schema:
                type: object
                properties:
                  auctions:
                    type: array
                    items:
                      $ref: '#/components/schemas/AuctionWithBid'
                  total:
                    type: integer
                  next_offset:
                    type: integer
                    nullable: true
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /players/{player_id}/transactions:
    get:
      tags:
        - Transaction History
      summary: Get player transaction history
      description: |-
        Get paginated transaction history for a player.
        **BACKEND NOTE:** Optimized for player dashboard with indexing on player_id.
      operationId: getPlayerTransactionHistory
      security:
        - bearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Player unique identifier
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of transactions per page
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Number of transactions to skip
        - name: transaction_type
          in: query
          schema:
            type: string
            enum:
              - purchase
              - sale
              - refund
              - fee
          description: Filter by transaction type
      responses:
        '200':
          description: Transaction history
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionHistory'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/responses/Unauthorized'
        '404':
          description: Player not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/responses/InternalServerError'
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authentication
  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    Unauthorized:
      description: Authentication required
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
  schemas:
    HealthResponse:
      type: object
      required:
        - status
        - timestamp
        - service
      properties:
        service:
          type: string
          example: economy-service-go
          maxLength: 50
        status:
          type: string
          enum:
            - healthy
            - degraded
            - unhealthy
          example: healthy
          maxLength: 255
        timestamp:
          type: string
          format: date-time
          example: '2025-12-27T09:52:00Z'
        version:
          type: string
          example: 1.0.0
          maxLength: 50
        active_trades:
          type: integer
          example: 1250
        total_market_volume:
          type: number
          example: 50000
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Error:
      type: object
      required:
        - code
        - message
      properties:
        message:
          type: string
          maxLength: 256
          example: Internal server error
        service:
          type: string
          example: economy-service-go
          maxLength: 50
        details:
          type: object
          description: Additional error context
          example:
            field: trade_id
            reason: invalid_uuid_format
        code:
          type: integer
          format: int32
          minimum: 100
          maximum: 599
          example: 500
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Trade:
      type: object
      required:
        - trade_id
        - seller_id
        - item_id
        - quantity
        - price_per_unit
        - total_price
        - trade_type
        - status
        - created_at
      properties:
        trade_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        seller_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440001
        buyer_id:
          type: string
          format: uuid
          nullable: true
          example: 550e8400-e29b-41d4-a716-446655440002
        item_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440003
        quantity:
          type: integer
          minimum: 1
          example: 5
        price_per_unit:
          type: number
          minimum: 0
          example: 25.5
        total_price:
          type: number
          minimum: 0
          example: 127.5
        trade_type:
          type: string
          enum:
            - buy
            - sell
            - exchange
          example: sell
        status:
          type: string
          enum:
            - active
            - completed
            - cancelled
            - expired
          example: active
        created_at:
          type: string
          format: date-time
          example: '2025-12-27T09:52:00Z'
        expires_at:
          type: string
          format: date-time
          nullable: true
          example: '2025-12-28T09:52:00Z'
        item_name:
          type: string
          maxLength: 100
          example: Plasma Rifle MK-II
        item_category:
          type: string
          maxLength: 50
          example: weapons
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CreateTradeRequest:
      type: object
      required:
        - item_id
        - quantity
        - price_per_unit
        - trade_type
      properties:
        item_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440003
        quantity:
          type: integer
          minimum: 1
          example: 5
        price_per_unit:
          type: number
          minimum: 0
          example: 25.5
        trade_type:
          type: string
          enum:
            - buy
            - sell
            - exchange
          example: sell
        description:
          type: string
          maxLength: 500
          example: High-quality plasma rifle in excellent condition
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    TradeResult:
      type: object
      required:
        - trade_id
        - status
      properties:
        trade_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        status:
          type: string
          enum:
            - completed
            - cancelled
            - expired
          example: cancelled
        total_price:
          type: number
          minimum: 0
          example: 127.5
        executed_at:
          type: string
          format: date-time
          nullable: true
          example: '2025-12-27T09:52:00Z'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    MarketOverview:
      type: object
      required:
        - active_trades
        - total_volume
        - average_trade_price
      properties:
        active_trades:
          type: integer
          minimum: 0
          example: 1250
        total_volume:
          type: number
          minimum: 0
          example: 50000
        average_trade_price:
          type: number
          minimum: 0
          example: 40
        top_items:
          type: array
          items:
            type: object
            properties:
              item_name:
                type: string
                example: Plasma Rifle
              trade_count:
                type: integer
                example: 25
              average_price:
                type: number
                example: 150
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Transaction:
      type: object
      required:
        - transaction_id
        - transaction_type
        - amount
        - currency_type
        - created_at
      properties:
        transaction_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440010
        transaction_type:
          type: string
          enum:
            - purchase
            - sale
            - refund
            - fee
            - deposit
            - withdrawal
          example: purchase
        amount:
          type: number
          example: -25.5
        currency_type:
          type: string
          enum:
            - credits
            - premium_credits
            - tokens
          example: credits
        description:
          type: string
          maxLength: 255
          example: 'Purchase: Plasma Rifle MK-II'
        created_at:
          type: string
          format: date-time
          example: '2025-12-27T09:52:00Z'
        related_trade_id:
          type: string
          format: uuid
          nullable: true
          example: 550e8400-e29b-41d4-a716-446655440000
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    TransactionHistory:
      type: object
      required:
        - transactions
        - total
      properties:
        transactions:
          type: array
          items:
            $ref: '#/components/schemas/Transaction'
        total:
          type: integer
          minimum: 0
          example: 45
        limit:
          type: integer
          nullable: true
          example: 20
        offset:
          type: integer
          nullable: true
          example: 0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    AuctionStatus:
      type: string
      enum: [active, sold, expired, cancelled]
      description: Status of an auction
      example: active
    AuctionSummary:
      type: object
      required:
        - id
        - item_id
        - seller_id
        - quantity
        - start_price
        - current_bid
        - currency
        - expires_at
        - status
        - bid_count
      properties:
        id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        item_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440001
        seller_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440002
        current_bidder_id:
          type: string
          format: uuid
          nullable: true
          example: 550e8400-e29b-41d4-a716-446655440003
        expires_at:
          type: string
          format: date-time
          example: '2025-12-27T15:30:00Z'
        status:
          $ref: '#/components/schemas/AuctionStatus'
        currency:
          type: string
          enum: [credits]
          example: credits
        start_price:
          type: integer
          format: int64
          minimum: 100
          description: Starting price in minor units
          example: 10000
        current_bid:
          type: integer
          format: int64
          minimum: 0
          description: Current highest bid in minor units
          example: 15000
        buyout_price:
          type: integer
          format: int64
          nullable: true
          minimum: 0
          description: Buyout price in minor units
          example: 50000
        quantity:
          type: integer
          format: int32
          minimum: 1
          example: 1
        bid_count:
          type: integer
          format: int32
          minimum: 0
          example: 3
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    AuctionDetail:
      type: object
      required:
        - auction
      properties:
        auction:
          allOf:
            - $ref: '#/components/schemas/AuctionSummary'
            - type: object
              properties:
                sold_price:
                  type: integer
                  format: int64
                  nullable: true
                  description: Final sale price in minor units
                  example: 45000
                sold_at:
                  type: string
                  format: date-time
                  nullable: true
                  example: '2025-12-27T14:45:00Z'
                winning_bidder_id:
                  type: string
                  format: uuid
                  nullable: true
                  example: 550e8400-e29b-41d4-a716-446655440004
        bids:
          type: array
          items:
            $ref: '#/components/schemas/AuctionBid'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    AuctionBid:
      type: object
      required:
        - id
        - auction_id
        - bidder_id
        - amount
        - created_at
      properties:
        id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440005
        auction_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        bidder_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440006
        created_at:
          type: string
          format: date-time
          example: '2025-12-27T13:15:00Z'
        amount:
          type: integer
          format: int64
          minimum: 0
          description: Bid amount in minor units
          example: 15000
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    AuctionWithBid:
      type: object
      allOf:
        - $ref: '#/components/schemas/AuctionSummary'
        - type: object
          required:
            - my_bid_amount
            - my_bid_time
          properties:
            my_bid_amount:
              type: integer
              format: int64
              minimum: 0
              description: User's bid amount in minor units
              example: 15000
            my_bid_time:
              type: string
              format: date-time
              description: When user placed their bid
              example: '2025-12-27T13:15:00Z'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CreateAuctionRequest:
      type: object
      required:
        - item_id
        - quantity
        - start_price
        - duration_hours
        - currency
      properties:
        item_id:
          type: string
          format: uuid
          description: ID of the item to auction
          example: 550e8400-e29b-41d4-a716-446655440001
        currency:
          type: string
          enum: [credits]
          example: credits
        start_price:
          type: integer
          format: int64
          minimum: 100
          description: Starting price in minor units
          example: 10000
        buyout_price:
          type: integer
          format: int64
          nullable: true
          minimum: 0
          description: Optional buyout price in minor units
          example: 50000
        quantity:
          type: integer
          format: int32
          minimum: 1
          maximum: 1000
          example: 1
        duration_hours:
          type: integer
          format: int32
          minimum: 24
          maximum: 168
          description: Auction duration in hours
          example: 48
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    PlaceBidRequest:
      type: object
      required:
        - amount
      properties:
        amount:
          type: integer
          format: int64
          minimum: 0
          description: Bid amount in minor units
          example: 15000
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
