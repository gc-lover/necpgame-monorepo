openapi: 3.0.3
info:
  title: Experience Service API - Enterprise-Grade Domain Service
  description: '**Enterprise-Grade Experience Management API for NECPGAME**

    This API manages player experience, leveling, and progression mechanics in the
    Night City universe, providing real-time XP tracking, level calculations, and
    achievement systems.

    ## Key Features

    - **XP Tracking**: Real-time experience point accumulation and validation - **Level
    Progression**: Dynamic level calculations and milestone achievements - **Experience
    Bonuses**: Multiplier systems and experience modifiers - **Performance Optimized**:
    MMOFPS-grade performance with <10ms P99 latency - **Struct Alignment**: 30-50%
    memory savings for experience structs

    ## Domain Purpose

    The Experience domain handles all player progression mechanics in Night City.
    Players gain experience through combat, quests, and activities, progressing through
    levels and unlocking new abilities.

    ## Performance Targets

    - P99 Latency: <10ms for experience operations - Memory: <6KB per active experience
    session - Concurrent users: 55,000+ simultaneous operations - XP calculation time:
    <2ms

    '
  version: 1.0.0
  license:
    name: Proprietary
    url: https://necpgame.com/license
  contact:
    name: NECPGAME API Support
    url: https://necpgame.com/support
    email: api@experience.necpgame.com
servers:
- url: https://api.necpgame.com/v1/experience
  description: Production server
- url: https://staging-api.necpgame.com/v1/experience
  description: Staging server
- url: http://localhost:8080/api/v1/experience
  description: Local development server
tags:
- name: Experience Management
  description: Player experience and progression operations
- name: Level Progression
  description: Level calculation and milestone tracking
- name: Achievement System
  description: Achievement unlocking and reward distribution
security:
- BearerAuth: []
paths:
  /players/{player_id}/experience:
    get:
      summary: Get player experience
      description: '**Get detailed player experience information**

        Returns comprehensive experience data including current XP, level, and progression
        metrics.

        **Performance:** Single player lookup with <1ms response time'
      operationId: getPlayerExperience
      tags:
      - Experience Management
      parameters:
      - name: player_id
        in: path
        required: true
        description: Unique player identifier
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Player experience retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerExperienceResponse'
        '404':
          description: Player not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
    post:
      summary: Add experience to player
      description: '**Add experience points to player**

        Awards XP to player with validation, multipliers, and level progression.

        **Atomicity:** XP addition and level calculation in single transaction'
      operationId: addPlayerExperience
      tags:
      - Experience Management
      parameters:
      - name: player_id
        in: path
        required: true
        description: Unique player identifier
        schema:
          type: string
          format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddExperienceRequest'
      responses:
        '200':
          description: Experience added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerExperienceResponse'
        '400':
          description: Invalid experience data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
  /players/{player_id}/level:
    get:
      summary: Get player level information
      description: '**Get player level and progression details**

        Returns current level, XP requirements, and level progression metrics.

        **Performance:** <2ms level calculation time'
      operationId: getPlayerLevel
      tags:
      - Level Progression
      parameters:
      - name: player_id
        in: path
        required: true
        description: Unique player identifier
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Player level retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerLevelResponse'
        '404':
          description: Player not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
  /experience/calculate:
    post:
      summary: Calculate experience requirements
      description: '**Calculate XP requirements for level progression**

        Computes experience needed for level advancement with multipliers.

        **Performance:** <1ms calculation time'
      operationId: calculateExperience
      tags:
      - Experience Management
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CalculateExperienceRequest'
      responses:
        '200':
          description: Experience calculated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CalculateExperienceResponse'
        '400':
          description: Invalid calculation parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    Created:
      description: Resource created successfully
      content:
        application/json:
          schema:
            type: object
            properties:
              id:
                type: string
                format: uuid
              created_at:
                type: string
                format: date-time
    Deleted:
      description: Resource deleted successfully
      content:
        application/json:
          schema:
            type: object
            properties:
              deleted:
                type: boolean
                example: true
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    OK:
      description: Operation completed successfully
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: true
    TooManyRequests:
      description: Rate limit exceeded
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    Unauthorized:
      description: Authentication required
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    Updated:
      description: Resource updated successfully
      content:
        application/json:
          schema:
            type: object
            properties:
              updated:
                type: boolean
                example: true
  schemas:
    Error:
      type: object
      required:
      - code
      - message
      properties:
        code:
          type: string
          example: VALIDATION_ERROR
        message:
          type: string
          example: Invalid request parameters
        details:
          type: object
          additionalProperties: true
    AddExperienceRequest:
      type: object
      required:
      - amount
      - source
      properties:
        amount:
          type: integer
          minimum: 1
          maximum: 1000000
          description: Experience points to add
        source:
          type: string
          enum:
          - combat
          - quest
          - achievement
          - daily
          - event
          description: Experience source
        multiplier:
          type: number
          minimum: 1.0
          maximum: 10.0
          default: 1.0
          description: Experience multiplier
        description:
          type: string
          maxLength: 200
          description: Optional experience description
    CalculateExperienceRequest:
      type: object
      required:
      - current_level
      - target_level
      properties:
        current_level:
          type: integer
          minimum: 1
          maximum: 100
          description: Current player level
        target_level:
          type: integer
          minimum: 1
          maximum: 100
          description: Target level for calculation
        base_xp:
          type: integer
          minimum: 100
          default: 1000
          description: Base XP per level
        multiplier:
          type: number
          minimum: 1.0
          maximum: 5.0
          default: 1.1
          description: Level progression multiplier
    CalculateExperienceResponse:
      type: object
      required:
      - total_xp_needed
      - xp_breakdown
      properties:
        total_xp_needed:
          type: integer
          minimum: 0
          description: Total XP required for progression
        xp_breakdown:
          type: array
          items:
            type: object
            required:
            - level
            - xp_needed
            - cumulative_xp
            properties:
              level:
                type: integer
                description: Level number
              xp_needed:
                type: integer
                description: XP needed for this level
              cumulative_xp:
                type: integer
                description: Cumulative XP to reach this level
        base_xp:
          type: integer
          description: Base XP per level used in calculation
        final_xp:
          type: integer
          description: Final XP multiplier result
    PlayerExperienceResponse:
      type: object
      required:
      - player_id
      - current_xp
      - total_xp
      - level
      - xp_to_next_level
      - progress_percentage
      properties:
        player_id:
          type: string
          format: uuid
          description: Unique player identifier
        current_xp:
          type: integer
          minimum: 0
          description: Current experience points
        total_xp:
          type: integer
          minimum: 0
          description: Total accumulated experience
        level:
          type: integer
          minimum: 1
          description: Current player level
        xp_to_next_level:
          type: integer
          minimum: 0
          description: XP needed to reach next level
        progress_percentage:
          type: number
          minimum: 0
          maximum: 100
          description: Level progress percentage
        last_updated:
          type: string
          format: date-time
          description: Last experience update timestamp
    PlayerLevelResponse:
      type: object
      required:
      - player_id
      - level
      - experience
      - xp_to_next_level
      - progress_percentage
      properties:
        player_id:
          type: string
          format: uuid
          description: Player unique identifier
        level:
          type: integer
          minimum: 1
          description: Current player level
        experience:
          type: integer
          minimum: 0
          description: Current experience points
        xp_to_next_level:
          type: integer
          minimum: 0
          description: Experience needed for next level
        progress_percentage:
          type: number
          minimum: 0
          maximum: 100
          description: Level completion percentage
