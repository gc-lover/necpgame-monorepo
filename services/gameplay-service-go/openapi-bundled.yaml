openapi: 3.0.3
info:
  title: Gameplay Service API
  description: |
    API для игровых механик: боевые системы, способности, импланты, стелс, паркур, экстракт-зоны, арены.

    **Основные модули:**
    - Combat Sessions - боевые сессии
    - Combat Abilities - способности и активация
    - Combat Combos - комбо и синергии
    - Combat Implants - импланты и киберпсихоз
    - Stealth System - стелс механики
    - Freerun System - паркур и акробатика
    - Extract Zones - зоны экстракции
    - Arena System - арены

    **Performance:**
    - Hot endpoints: POST /combat/sessions, POST /combat/abilities/activate
    - Expected load: 2k RPS, P99 <50ms
    - Tick rate: 60-128 Hz для боевых действий
  version: 2.0.0
  contact:
    name: NECPGAME API Support
    email: api@necp.game
servers:
  - url: http://localhost:8083/api/v1
    description: Локальный сервер разработки
  - url: https://api.necp.game/api/v1
    description: Продакшен сервер
security:
  - BearerAuth: []
tags:
  - name: Combat Sessions
    description: Боевые сессии
  - name: Combat Abilities
    description: Способности
  - name: Combat Combos
    description: Комбо и синергии
  - name: Combat Implants
    description: Импланты
  - name: Stealth
    description: Стелс система
  - name: Freerun
    description: Паркур
  - name: Extract Zones
    description: Зоны экстракции
  - name: Arena
    description: Арены
  - name: Loadouts
    description: Лоадауты
paths:
  /gameplay/combat/sessions:
    post:
      summary: Создать боевую сессию
      operationId: createCombatSession
      tags:
        - Combat Sessions
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateSessionRequest'
      responses:
        '201':
          description: Сессия создана
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatSessionResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
    get:
      summary: Список сессий
      operationId: listCombatSessions
      tags:
        - Combat Sessions
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - name: status
          in: query
          schema:
            $ref: '#/components/schemas/SessionStatus'
        - name: session_type
          in: query
          schema:
            $ref: '#/components/schemas/SessionType'
      responses:
        '200':
          description: Список сессий
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SessionListResponse'
  /gameplay/combat/sessions/{sessionId}:
    parameters:
      - $ref: '#/components/parameters/SessionId'
    get:
      summary: Получить сессию
      operationId: getCombatSession
      tags:
        - Combat Sessions
      responses:
        '200':
          description: Состояние сессии
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CombatSessionResponse'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      summary: Завершить сессию
      operationId: endCombatSession
      tags:
        - Combat Sessions
      responses:
        '200':
          description: Сессия завершена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SessionEndResponse'
        '403':
          $ref: '#/components/responses/Forbidden'
  /gameplay/combat/abilities/catalog:
    get:
      tags:
        - Ability Catalog
      summary: Получить каталог способностей
      description: |
        Возвращает каталог способностей с возможностью фильтрации по типу, слоту и источнику.
        Поддерживает пагинацию.
      operationId: getAbilityCatalog
      security:
        - BearerAuth: []
      parameters:
        - name: ability_type
          in: query
          schema:
            $ref: '#/components/schemas/AbilityType'
          description: Фильтр по типу способности
        - name: slot
          in: query
          schema:
            $ref: '#/components/schemas/AbilitySlot'
          description: Фильтр по слоту
        - name: source
          in: query
          schema:
            $ref: '#/components/schemas/AbilitySource'
          description: Фильтр по источнику
        - name: min_rank
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 10
          description: Минимальный ранг
        - name: max_rank
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 10
          description: Максимальный ранг
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: Успешный ответ
          content:
            application/json:
              schema:
                type: object
                required:
                  - abilities
                  - total
                properties:
                  abilities:
                    type: array
                    items:
                      $ref: '#/components/schemas/Ability'
                  total:
                    type: integer
                    minimum: 0
                    description: Общее количество способностей
                    example: 50
                  limit:
                    type: integer
                    minimum: 1
                    example: 20
                  offset:
                    type: integer
                    minimum: 0
                    example: 0
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /gameplay/combat/abilities/activate:
    post:
      tags:
        - Ability Activation
      summary: Активировать способность
      description: |
        Активирует способность для текущего персонажа.
        Проверяет доступность, кулдауны, ресурсы (энергия, здоровье) и киберпсихоз.
        При успешной активации запускает кулдаун и обновляет киберпсихоз.
      operationId: activateAbility
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AbilityActivationRequest'
      responses:
        '200':
          description: Способность успешно активирована
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AbilityActivationResponse'
        '400':
          description: Ошибка валидации или способность недоступна
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: ValidationError
                message: Ability is on cooldown
                code: ABILITY_ON_COOLDOWN
                details:
                  ability_id: 550e8400-e29b-41d4-a716-446655440000
                  cooldown_expires_at: '2025-11-23T10:00:15Z'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          description: Способность недоступна из-за ограничений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: ForbiddenError
                message: Ability requirements not met
                code: ABILITY_REQUIREMENTS_NOT_MET
        '404':
          description: Способность не найдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: NotFoundError
                message: Ability not found
                code: ABILITY_NOT_FOUND
        '409':
          description: Конфликт при активации (например, недостаточно ресурсов)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: ConflictError
                message: Insufficient energy
                code: INSUFFICIENT_ENERGY
        '500':
          $ref: '#/components/responses/InternalServerError'
  /gameplay/combat/abilities/synergies:
    get:
      tags:
        - Synergies
      summary: Получить доступные синергии
      description: |
        Возвращает список доступных синергий для текущего персонажа.
        Фильтрует синергии на основе активных способностей, имплантов и экипировки.
        Поддерживает фильтрацию по типу синергии и пагинацию.
      operationId: getAvailableSynergies
      security:
        - BearerAuth: []
      parameters:
        - name: synergy_type
          in: query
          schema:
            $ref: '#/components/schemas/SynergyType'
          description: Фильтр по типу синергии
        - name: complexity
          in: query
          schema:
            type: string
            enum:
              - Bronze
              - Silver
              - Gold
              - Platinum
              - Legendary
          description: Фильтр по сложности
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: Успешный ответ
          content:
            application/json:
              schema:
                type: object
                required:
                  - synergies
                  - total
                properties:
                  synergies:
                    type: array
                    items:
                      $ref: '#/components/schemas/Synergy'
                  total:
                    type: integer
                    minimum: 0
                    description: Общее количество доступных синергий
                    example: 10
                  limit:
                    type: integer
                    minimum: 1
                    example: 20
                  offset:
                    type: integer
                    minimum: 0
                    example: 0
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /gameplay/combat/combos/catalog:
    get:
      tags:
        - Combo Catalog
      summary: Получить каталог комбо
      operationId: getComboCatalog
      security:
        - BearerAuth: []
      parameters:
        - name: combo_type
          in: query
          schema:
            $ref: '#/components/schemas/ComboType'
        - name: complexity
          in: query
          schema:
            $ref: '#/components/schemas/ComboComplexity'
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: Каталог комбо
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComboCatalogResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /gameplay/combat/combos/activate:
    post:
      tags:
        - Combo Activation
      summary: Активировать комбо
      operationId: activateCombo
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ActivateComboRequest'
      responses:
        '200':
          description: Комбо активировано
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComboActivationResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /gameplay/combat/combos/loadout:
    get:
      tags:
        - Combo Loadouts
      summary: Получить лоадаут комбо
      operationId: getComboLoadout
      security:
        - BearerAuth: []
      parameters:
        - name: character_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Лоадаут комбо
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComboLoadout'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - Combo Loadouts
      summary: Обновить лоадаут комбо
      operationId: updateComboLoadout
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateLoadoutRequest'
      responses:
        '200':
          description: Лоадаут обновлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComboLoadout'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /gameplay/combat/combos/score:
    post:
      tags:
        - Combo Scoring
      summary: Отправить результаты scoring
      operationId: submitComboScore
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubmitScoreRequest'
      responses:
        '200':
          description: Score отправлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScoreSubmissionResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /gameplay/combat/combos/analytics:
    get:
      tags:
        - Combo Analytics
      summary: Получить аналитику комбо
      operationId: getComboAnalytics
      security:
        - BearerAuth: []
      parameters:
        - name: combo_id
          in: query
          schema:
            type: string
            format: uuid
        - name: character_id
          in: query
          schema:
            type: string
            format: uuid
        - name: period_start
          in: query
          schema:
            type: string
            format: date-time
        - name: period_end
          in: query
          schema:
            type: string
            format: date-time
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: Аналитика комбо
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalyticsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /gameplay/combat/implants:
    get:
      tags:
        - Combat Implants
      summary: Получить установленные импланты
      operationId: getInstalledImplants
      security:
        - BearerAuth: []
      parameters:
        - name: character_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Список имплантов
          content:
            application/json:
              schema:
                type: object
                properties:
                  implants:
                    type: array
                    items:
                      $ref: '#/components/schemas/Implant'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /gameplay/combat/stealth/status:
    get:
      tags:
        - Stealth
      summary: Получить статус стелса
      operationId: getStealthStatus
      security:
        - BearerAuth: []
      parameters:
        - name: character_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Статус стелса
          content:
            application/json:
              schema:
                type: object
                properties:
                  is_stealthed:
                    type: boolean
                  detection_level:
                    type: number
                    format: float
        '401':
          $ref: '#/components/responses/Unauthorized'
  /gameplay/combat/freerun/routes:
    get:
      tags:
        - Freerun
      summary: Получить доступные маршруты паркура
      operationId: getFreerunRoutes
      security:
        - BearerAuth: []
      parameters:
        - name: position
          in: query
          required: true
          schema:
            type: string
          description: x,y,z
        - name: radius
          in: query
          schema:
            type: number
            format: float
            default: 100
      responses:
        '200':
          description: Список маршрутов
          content:
            application/json:
              schema:
                type: object
                properties:
                  routes:
                    type: array
        '401':
          $ref: '#/components/responses/Unauthorized'
  /gameplay/extract/zones:
    get:
      tags:
        - Extract Zones
      summary: Получить зоны экстракции
      operationId: getExtractZones
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Список зон
          content:
            application/json:
              schema:
                type: object
                properties:
                  zones:
                    type: array
        '401':
          $ref: '#/components/responses/Unauthorized'
  /gameplay/arena/sessions:
    get:
      tags:
        - Arena
      summary: Получить ареновые сессии
      operationId: getArenaSessions
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Список сессий
          content:
            application/json:
              schema:
                type: object
                properties:
                  sessions:
                    type: array
        '401':
          $ref: '#/components/responses/Unauthorized'
  /gameplay/loadouts:
    get:
      tags:
        - Loadouts
      summary: Получить лоадауты персонажа
      operationId: getLoadouts
      security:
        - BearerAuth: []
      parameters:
        - name: character_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Список лоадаутов
          content:
            application/json:
              schema:
                type: object
                properties:
                  loadouts:
                    type: array
        '401':
          $ref: '#/components/responses/Unauthorized'
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT токен для аутентификации
  responses:
    BadRequest:
      description: Неверный запрос
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: BadRequest
            message: Неверные параметры запроса
            code: INVALID_PARAMETERS
    Unauthorized:
      description: Требуется аутентификация
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: Unauthorized
            message: Требуется аутентификация
            code: AUTH_REQUIRED
    InternalServerError:
      description: Внутренняя ошибка сервера
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: InternalServerError
            message: Внутренняя ошибка сервера
            code: INTERNAL_ERROR
    NotFound:
      description: Ресурс не найден
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: NotFound
            message: Ресурс не найден
            code: RESOURCE_NOT_FOUND
    Forbidden:
      description: Доступ запрещен
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: Forbidden
            message: Доступ запрещен
            code: ACCESS_DENIED
  parameters:
    Limit:
      name: limit
      in: query
      required: false
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 50
      description: Количество элементов на странице
    Offset:
      name: offset
      in: query
      required: false
      schema:
        type: integer
        minimum: 0
        default: 0
      description: Смещение для пагинации
    SessionId:
      name: sessionId
      in: path
      required: true
      schema:
        type: string
        format: uuid
  schemas:
    SessionStatus:
      type: string
      enum:
        - pending
        - active
        - ended
        - aborted
    SessionType:
      type: string
      enum:
        - pvp_arena
        - pve_raid
        - extract_zone
        - guild_war
    PaginationResponse:
      type: object
      required:
        - items
        - total
      properties:
        items:
          type: array
          description: Список элементов
        total:
          type: integer
          minimum: 0
          description: Общее количество элементов
        limit:
          type: integer
          minimum: 1
          description: Количество элементов на странице
        offset:
          type: integer
          minimum: 0
          description: Смещение для пагинации
        has_more:
          type: boolean
          description: Есть ли еще элементы
    SessionSummary:
      type: object
      required:
        - id
        - session_type
        - status
        - created_at
      properties:
        id:
          type: string
          format: uuid
        created_at:
          type: string
          format: date-time
        status:
          $ref: '#/components/schemas/SessionStatus'
        session_type:
          $ref: '#/components/schemas/SessionType'
        participant_count:
          type: integer
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    SessionListResponse:
      type: object
      required:
        - items
        - pagination
      properties:
        pagination:
          $ref: '#/components/schemas/PaginationResponse'
        items:
          type: array
          items:
            $ref: '#/components/schemas/SessionSummary'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Difficulty:
      type: string
      enum:
        - normal
        - hard
        - elite
    CreateSessionRequest:
      type: object
      required:
        - session_type
        - participants
      properties:
        zone_id:
          type: string
        settings:
          type: object
        difficulty:
          $ref: '#/components/schemas/Difficulty'
        session_type:
          $ref: '#/components/schemas/SessionType'
        participants:
          type: array
          items:
            type: string
            format: uuid
          minItems: 1
          maxItems: 200
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    BaseEntity:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Уникальный идентификатор
    TimestampFields:
      type: object
      properties:
        created_at:
          type: string
          format: date-time
          description: Дата создания
        updated_at:
          type: string
          format: date-time
          description: Дата обновления
          nullable: true
        expires_at:
          type: string
          format: date-time
          description: Дата истечения
          nullable: true
    BaseEntityWithTimestamps:
      allOf:
        - $ref: '#/components/schemas/BaseEntity'
        - $ref: '#/components/schemas/TimestampFields'
    Participant:
      type: object
      required:
        - player_id
        - character_id
        - team
        - role
        - health
        - max_health
        - status
      properties:
        player_id:
          type: string
          format: uuid
        character_id:
          type: string
          format: uuid
        team:
          type: string
          enum:
            - team_a
            - team_b
            - solo
        role:
          type: string
          enum:
            - assault
            - support
            - tech
            - stealth
        status:
          type: string
          enum:
            - alive
            - dead
            - extracted
            - disconnected
        damage_dealt:
          type: integer
          format: int64
        damage_taken:
          type: integer
          format: int64
        healing_done:
          type: integer
          format: int64
        kills:
          type: integer
        deaths:
          type: integer
        assists:
          type: integer
        health:
          type: integer
        max_health:
          type: integer
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    CombatSessionResponse:
      allOf:
        - $ref: '#/components/schemas/BaseEntityWithTimestamps'
        - type: object
          required:
            - session_type
            - status
            - participants
          properties:
            session_type:
              $ref: '#/components/schemas/SessionType'
            status:
              $ref: '#/components/schemas/SessionStatus'
            zone_id:
              type: string
            difficulty:
              $ref: '#/components/schemas/Difficulty'
            participants:
              type: array
              items:
                $ref: '#/components/schemas/Participant'
            winner_team:
              type: string
              nullable: true
    Error:
      type: object
      required:
        - error
        - message
      properties:
        error:
          type: string
          description: Тип ошибки
        message:
          type: string
          description: Сообщение об ошибке
        code:
          type: string
          description: Код ошибки
          nullable: true
        details:
          type: object
          additionalProperties: true
          description: Дополнительные детали ошибки
          nullable: true
    Reward:
      type: object
      required:
        - player_id
        - experience
        - currency
      properties:
        player_id:
          type: string
          format: uuid
        currency:
          type: object
          properties:
            eurodollars:
              type: integer
            cryptos:
              type: integer
        items:
          type: array
          items:
            type: object
            required:
              - item_id
              - quantity
            properties:
              item_id:
                type: string
                format: uuid
              quantity:
                type: integer
                minimum: 1
        experience:
          type: integer
          minimum: 0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    SessionEndResponse:
      type: object
      required:
        - session_id
        - status
      properties:
        session_id:
          type: string
          format: uuid
        winner_team:
          type: string
          nullable: true
        status:
          $ref: '#/components/schemas/SessionStatus'
        rewards:
          type: array
          items:
            $ref: '#/components/schemas/Reward'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    AbilityType:
      type: string
      enum:
        - tactical
        - signature
        - ultimate
        - passive
        - hacking
      description: Тип способности
      example: tactical
    AbilitySlot:
      type: string
      enum:
        - Q
        - E
        - R
        - passive
        - hacking
      description: Слот способности
      example: Q
    AbilitySource:
      type: string
      enum:
        - equipment
        - implant
        - progression
        - cyberdeck
      description: Источник способности
      example: progression
    Ability:
      type: object
      required:
        - id
        - name
        - ability_type
        - slot
        - source
        - rank
      properties:
        id:
          type: string
          format: uuid
          description: Уникальный идентификатор способности
          example: 550e8400-e29b-41d4-a716-446655440000
        name:
          type: string
          description: Название способности
          example: Thermal Grenade
        description:
          type: string
          description: Описание способности
          example: Бросает термическую гранату, наносящую урон по области
        created_at:
          type: string
          format: date-time
          description: Дата создания
          example: '2025-11-23T10:00:00Z'
        requirements:
          type: object
          description: Требования для использования способности
          properties:
            min_level:
              type: integer
              minimum: 1
              example: 10
            required_attributes:
              type: object
              additionalProperties:
                type: integer
              example:
                strength: 15
                intelligence: 10
            required_skills:
              type: array
              items:
                type: string
              example:
                - combat
                - tactics
            required_abilities:
              type: array
              items:
                type: string
                format: uuid
              example: []
        modifiers:
          type: object
          description: Модификаторы способности
          properties:
            damage_multiplier:
              type: number
              format: float
              minimum: 0
              example: 1.2
            range_bonus:
              type: number
              format: float
              minimum: 0
              example: 1.5
            duration_bonus:
              type: number
              format: float
              minimum: 0
              example: 1.3
        slot:
          $ref: '#/components/schemas/AbilitySlot'
        source:
          $ref: '#/components/schemas/AbilitySource'
        ability_type:
          $ref: '#/components/schemas/AbilityType'
        rank:
          type: integer
          minimum: 1
          maximum: 10
          description: Ранг способности
          example: 5
        energy_cost:
          type: integer
          minimum: 0
          description: Стоимость энергии
          example: 25
        health_cost:
          type: integer
          minimum: 0
          description: Стоимость здоровья
          example: 0
        cooldown_base:
          type: integer
          minimum: 0
          description: Базовое время кулдауна в секундах
          example: 15
        cyberpsychosis_impact:
          type: number
          format: float
          minimum: 0
          maximum: 1
          description: Влияние на киберпсихоз (0-1)
          example: 0.05
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    AbilityActivationRequest:
      type: object
      required:
        - ability_id
      properties:
        ability_id:
          type: string
          format: uuid
          description: Идентификатор способности для активации
          example: 550e8400-e29b-41d4-a716-446655440000
        target_id:
          type: string
          format: uuid
          nullable: true
          description: Идентификатор цели (если требуется)
          example: 550e8400-e29b-41d4-a716-446655440007
        position:
          type: object
          nullable: true
          description: Позиция для активации (если требуется)
          properties:
            x:
              type: number
              format: float
            'y':
              type: number
              format: float
            z:
              type: number
              format: float
    AbilityActivationResponse:
      type: object
      required:
        - success
        - ability_id
      properties:
        ability_id:
          type: string
          format: uuid
          description: Идентификатор активированной способности
          example: 550e8400-e29b-41d4-a716-446655440000
        message:
          type: string
          nullable: true
          description: Сообщение о результате
          example: Ability activated successfully
        cooldown_expires_at:
          type: string
          format: date-time
          nullable: true
          description: Время окончания кулдауна
          example: '2025-11-23T10:00:15Z'
        cyberpsychosis_level:
          type: number
          format: float
          minimum: 0
          maximum: 1
          description: Текущий уровень киберпсихоза
          example: 0.15
        success:
          type: boolean
          description: Успешность активации
          example: true
        cooldown_started:
          type: boolean
          description: Запущен ли кулдаун
          example: true
        synergy_triggered:
          type: boolean
          description: Сработала ли синергия
          example: false
        cyberpsychosis_updated:
          type: boolean
          description: Обновлен ли киберпсихоз
          example: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    SynergyType:
      type: string
      enum:
        - ability
        - team
        - equipment
        - implant
        - timing
      description: Тип синергии
      example: ability
    Synergy:
      type: object
      required:
        - id
        - synergy_type
        - bonuses
      properties:
        id:
          type: string
          format: uuid
          description: Уникальный идентификатор синергии
          example: 550e8400-e29b-41d4-a716-446655440008
        complexity:
          type: string
          enum:
            - Bronze
            - Silver
            - Gold
            - Platinum
            - Legendary
          description: Сложность синергии
          example: Gold
        created_at:
          type: string
          format: date-time
          description: Дата создания
          example: '2025-11-23T10:00:00Z'
        requirements:
          type: object
          description: Требования для активации синергии
          properties:
            min_level:
              type: integer
              minimum: 1
              example: 10
            required_attributes:
              type: object
              additionalProperties:
                type: integer
              example:
                strength: 15
        bonuses:
          type: object
          description: Бонусы от синергии
          properties:
            damage_multiplier:
              type: number
              format: float
              minimum: 1
              example: 1.2
            cooldown_reduction:
              type: integer
              minimum: 0
              example: 5
            energy_cost_reduction:
              type: integer
              minimum: 0
              example: 10
            special_effects:
              type: array
              items:
                type: string
              example:
                - burn
                - stun
        synergy_type:
          $ref: '#/components/schemas/SynergyType'
        ability_ids:
          type: array
          items:
            type: string
            format: uuid
          description: Список идентификаторов способностей
          example:
            - 550e8400-e29b-41d4-a716-446655440000
            - 550e8400-e29b-41d4-a716-446655440003
        implant_ids:
          type: array
          items:
            type: string
            format: uuid
          nullable: true
          description: Список идентификаторов имплантов
          example:
            - 550e8400-e29b-41d4-a716-446655440009
        equipment_ids:
          type: array
          items:
            type: string
            format: uuid
          nullable: true
          description: Список идентификаторов экипировки
          example:
            - 550e8400-e29b-41d4-a716-446655440010
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ComboType:
      type: string
      enum:
        - solo
        - team
        - legendary
      description: Тип комбо
      example: solo
    ComboComplexity:
      type: string
      enum:
        - Bronze
        - Silver
        - Gold
        - Platinum
        - Legendary
      description: Сложность комбо
      example: Gold
    Combo:
      type: object
      description: |
        BACKEND NOTE: Fields ordered for optimal struct alignment (large → small).
        Expected memory: ~120 bytes/instance.
      required:
        - id
        - name
        - combo_type
        - complexity
      properties:
        id:
          type: string
          format: uuid
          description: Уникальный идентификатор комбо
          example: 550e8400-e29b-41d4-a716-446655440000
        name:
          type: string
          description: Название комбо
          example: Aerial Devastation
        description:
          type: string
          description: Описание комбо
          example: Комбо из воздушных атак с максимальным уроном
        created_at:
          type: string
          format: date-time
          description: Дата создания
        requirements:
          type: object
          description: Требования для активации комбо
          properties:
            min_level:
              type: integer
              minimum: 1
              example: 10
            required_skills:
              type: array
              items:
                type: string
              example:
                - acrobatics
                - combat
            required_abilities:
              type: array
              items:
                type: string
                format: uuid
              example:
                - 550e8400-e29b-41d4-a716-446655440001
            min_participants:
              type: integer
              minimum: 1
              example: 1
            max_participants:
              type: integer
              minimum: 1
              example: 5
        bonuses:
          type: object
          description: Бонусы от комбо
          properties:
            damage_multiplier:
              type: number
              format: float
              minimum: 1
              example: 1.5
            cooldown_reduction:
              type: integer
              minimum: 0
              example: 10
            special_effects:
              type: array
              items:
                type: string
              example:
                - stun
                - knockback
        complexity:
          $ref: '#/components/schemas/ComboComplexity'
        combo_type:
          $ref: '#/components/schemas/ComboType'
        sequence:
          type: array
          description: Последовательность действий для активации
          items:
            type: string
          example:
            - wall_run
            - air_dash
            - attack
        cooldown:
          type: integer
          description: Кулдаун комбо в секундах
          minimum: 0
          example: 30
        chain_compatible:
          type: boolean
          description: Совместимость с chain-комбо
          example: true
    ComboCatalogResponse:
      type: object
      properties:
        combos:
          type: array
          items:
            $ref: '#/components/schemas/Combo'
        total:
          type: integer
          description: Общее количество комбо
          example: 50
    ActivateComboRequest:
      type: object
      required:
        - character_id
        - combo_id
      properties:
        character_id:
          type: string
          format: uuid
          description: ID персонажа, активирующего комбо
          example: 550e8400-e29b-41d4-a716-446655440003
        combo_id:
          type: string
          format: uuid
          description: ID комбо для активации
          example: 550e8400-e29b-41d4-a716-446655440000
        context:
          type: object
          description: Контекст активации (позиция, состояние, окружение)
          additionalProperties: true
        participants:
          type: array
          items:
            type: string
            format: uuid
          description: ID участников команды (для team/legendary комбо)
          example:
            - 550e8400-e29b-41d4-a716-446655440003
            - 550e8400-e29b-41d4-a716-446655440004
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    schemas-Synergy:
      type: object
      description: |
        BACKEND NOTE: Fields ordered for struct alignment (large → small).
        Expected memory: ~80 bytes/instance.
      required:
        - id
        - synergy_type
        - combo_id
      properties:
        id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440002
        combo_id:
          type: string
          format: uuid
          description: ID комбо, к которому применяется синергия
        bonuses:
          type: object
          description: Бонусы от синергии
          properties:
            damage_multiplier:
              type: number
              format: float
              minimum: 1
            cooldown_reduction:
              type: integer
              minimum: 0
            special_effects:
              type: array
              items:
                type: string
        requirements:
          type: object
          description: Требования для активации синергии
        synergy_type:
          $ref: '#/components/schemas/SynergyType'
        ability_ids:
          type: array
          items:
            type: string
            format: uuid
          nullable: true
          description: ID способностей для ability синергии
        equipment_ids:
          type: array
          items:
            type: string
            format: uuid
          nullable: true
          description: ID экипировки для equipment синергии
        implant_ids:
          type: array
          items:
            type: string
            format: uuid
          nullable: true
          description: ID имплантов для implant синергии
        team_size:
          type: integer
          minimum: 2
          nullable: true
          description: Размер команды для team синергии
        timing_window:
          type: integer
          minimum: 0
          nullable: true
          description: Временное окно в миллисекундах для timing синергии
    ComboActivationResponse:
      type: object
      required:
        - success
        - activation_id
      properties:
        activation_id:
          type: string
          format: uuid
          description: ID активации комбо
          example: 550e8400-e29b-41d4-a716-446655440005
        message:
          type: string
          description: Сообщение о результате
          example: Combo activated successfully
        bonuses_applied:
          type: object
          description: Примененные бонусы
          properties:
            damage_multiplier:
              type: number
              format: float
            cooldown_reduction:
              type: integer
            special_effects:
              type: array
              items:
                type: string
        combo:
          $ref: '#/components/schemas/Combo'
        applied_synergies:
          type: array
          items:
            $ref: '#/components/schemas/schemas-Synergy'
        success:
          type: boolean
          description: Успешность активации
          example: true
        chain_combo_available:
          type: boolean
          description: Доступность chain-комбо
          example: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ComboLoadout:
      type: object
      required:
        - id
        - character_id
      properties:
        id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440006
        character_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440003
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        preferences:
          type: object
          description: Настройки лоадаута
          properties:
            auto_activate:
              type: boolean
              description: Автоматическая активация комбо
              example: false
            priority_order:
              type: array
              items:
                type: string
                format: uuid
              description: Порядок приоритета комбо
        active_combos:
          type: array
          items:
            type: string
            format: uuid
          description: ID активных комбо в лоадауте
          example:
            - 550e8400-e29b-41d4-a716-446655440000
            - 550e8400-e29b-41d4-a716-446655440007
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    UpdateLoadoutRequest:
      type: object
      required:
        - character_id
      properties:
        character_id:
          type: string
          format: uuid
        preferences:
          type: object
          properties:
            auto_activate:
              type: boolean
            priority_order:
              type: array
              items:
                type: string
                format: uuid
        active_combos:
          type: array
          items:
            type: string
            format: uuid
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    SubmitScoreRequest:
      type: object
      required:
        - activation_id
        - execution_difficulty
        - damage_output
        - visual_impact
      properties:
        activation_id:
          type: string
          format: uuid
        execution_difficulty:
          type: integer
          minimum: 0
          maximum: 100
        damage_output:
          type: integer
          minimum: 0
        visual_impact:
          type: integer
          minimum: 0
          maximum: 100
        team_coordination:
          type: integer
          minimum: 0
          maximum: 100
          nullable: true
    ComboScore:
      type: object
      description: |
        BACKEND NOTE: Fields ordered for struct alignment (large → small).
        Expected memory: ~56 bytes/instance. Hot endpoint for scoring.
      required:
        - activation_id
        - total_score
        - category
      properties:
        activation_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440005
        timestamp:
          type: string
          format: date-time
        category:
          $ref: '#/components/schemas/ComboComplexity'
        execution_difficulty:
          type: integer
          minimum: 0
          maximum: 100
          description: Сложность исполнения (0-100)
          example: 85
        damage_output:
          type: integer
          minimum: 0
          description: Выданный урон
          example: 5000
        visual_impact:
          type: integer
          minimum: 0
          maximum: 100
          description: Визуальный эффект (0-100)
          example: 90
        team_coordination:
          type: integer
          minimum: 0
          maximum: 100
          nullable: true
          description: Координация команды (0-100, только для team комбо)
          example: 75
        total_score:
          type: integer
          minimum: 0
          description: Общий score
          example: 7500
    ScoreSubmissionResponse:
      type: object
      required:
        - success
        - score
      properties:
        rewards:
          type: object
          nullable: true
          description: Награды за score (если применимо)
          properties:
            experience:
              type: integer
            currency:
              type: integer
            items:
              type: array
              items:
                type: string
                format: uuid
        score:
          $ref: '#/components/schemas/ComboScore'
        success:
          type: boolean
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ComboAnalytics:
      type: object
      properties:
        combo_id:
          type: string
          format: uuid
        average_category:
          $ref: '#/components/schemas/ComboComplexity'
        most_used_synergies:
          type: array
          items:
            type: object
            properties:
              synergy_id:
                type: string
                format: uuid
              synergy_type:
                $ref: '#/components/schemas/SynergyType'
              usage_count:
                type: integer
          description: Наиболее используемые синергии
        total_activations:
          type: integer
          minimum: 0
          description: Общее количество активаций
          example: 1250
        chain_combo_count:
          type: integer
          minimum: 0
          description: Количество chain-комбо
          example: 150
        success_rate:
          type: number
          format: float
          minimum: 0
          maximum: 1
          description: Процент успешных активаций
          example: 0.85
        average_score:
          type: number
          format: float
          minimum: 0
          description: Средний score
          example: 6500
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    AnalyticsResponse:
      type: object
      properties:
        period_start:
          type: string
          format: date-time
        period_end:
          type: string
          format: date-time
        analytics:
          type: array
          items:
            $ref: '#/components/schemas/ComboAnalytics'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Implant:
      type: object
      required:
        - id
        - name
        - implant_type
        - brand
        - rarity
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        implant_type:
          type: string
          enum:
            - combat
            - movement
            - os
            - visual
        brand:
          type: string
          enum:
            - arasaka
            - militech
            - kang_tao
            - zetatech
            - biotechnica
            - custom
        rarity:
          type: string
          enum:
            - common
            - uncommon
            - rare
            - epic
            - legendary
            - artifact
        slot_type:
          type: string
          enum:
            - combat
            - tactical
            - defensive
            - movement
            - os
        effects:
          type: object
          description: Эффекты импланта
        energy_cost:
          type: integer
          minimum: 0
        humanity_cost:
          type: integer
          minimum: 0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
