// Package api provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.5.1 DO NOT EDIT.
package api

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"

	"github.com/getkin/kin-openapi/openapi3"
)

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
	"AP//EpPq88IdAAA=",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
