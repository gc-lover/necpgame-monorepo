# Combat Cyberpsychosis API - Endpoints
# Источник: .BRAIN/02-gameplay/combat/combat-cyberpsychosis.md (v1.1.0)
# Раздел: Endpoints для системы киберпсихоза

openapi: 3.0.3
info:
  title: Combat Cyberpsychosis - Endpoints
  version: 1.0.0
  description: |
    Endpoints для системы киберпсихоза.
    Источник: .BRAIN/02-gameplay/combat/combat-cyberpsychosis.md (v1.1.0)

  x-microservice:
    name: gameplay-service
    port: 8083
    domain: gameplay
    base-path: /api/v1/gameplay/combat
    package: com.necpgame.gameplayservice
paths:
  # Управление человечностью
  /gameplay/combat/cyberpsychosis/{player_id}/humanity:
    get:
      summary: Получить текущий уровень человечности
      description: Возвращает текущий уровень человечности игрока
      operationId: getHumanity
      tags:
        - Combat
        - Cyberpsychosis
        - Humanity
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      responses:
        '200':
          description: Информация о человечности
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/HumanityInfo'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  /gameplay/combat/cyberpsychosis/{player_id}/humanity/calculate-loss:
    post:
      summary: Рассчитать потерю человечности при установке импланта
      description: Рассчитывает потерю человечности при установке импланта
      operationId: calculateHumanityLoss
      tags:
        - Combat
        - Cyberpsychosis
        - Humanity
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './cyberpsychosis-requests.yaml#/components/schemas/CalculateLossRequest'
      responses:
        '200':
          description: Расчет потери человечности
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/HumanityLossCalculation'
        '400':
          $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  /gameplay/combat/cyberpsychosis/{player_id}/humanity/apply-loss:
    post:
      summary: Применить потерю человечности
      description: Применяет потерю человечности при установке импланта
      operationId: applyHumanityLoss
      tags:
        - Combat
        - Cyberpsychosis
        - Humanity
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './cyberpsychosis-requests.yaml#/components/schemas/ApplyLossRequest'
      responses:
        '200':
          description: Потеря человечности применена
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/HumanityUpdateResult'
        '400':
          $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '422':
          $ref: '../../../shared/common/responses.yaml#/components/responses/UnprocessableEntity'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  # Стадии и симптомы
  /gameplay/combat/cyberpsychosis/{player_id}/stage:
    get:
      summary: Получить текущую стадию киберпсихоза
      description: Возвращает текущую стадию киберпсихоза игрока
      operationId: getCyberpsychosisStage
      tags:
        - Combat
        - Cyberpsychosis
        - Stages
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      responses:
        '200':
          description: Информация о стадии киберпсихоза
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/CyberpsychosisStage'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  /gameplay/combat/cyberpsychosis/{player_id}/symptoms:
    get:
      summary: Получить список активных симптомов
      description: Возвращает список активных симптомов игрока с их эффектами.
      operationId: getSymptoms
      tags:
        - Combat
        - Cyberpsychosis
        - Symptoms
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      responses:
        '200':
          description: Список активных симптомов
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: './cyberpsychosis-models.yaml#/components/schemas/Symptom'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  /gameplay/combat/cyberpsychosis/stages/{stage_name}:
    get:
      summary: Получить информацию о стадии
      description: Возвращает информацию о стадии киберпсихоза (ранняя, средняя, поздняя, киберпсихоз).
      operationId: getStageInfo
      tags:
        - Combat
        - Cyberpsychosis
        - Stages
      security:
        - BearerAuth: []
      parameters:
        - name: stage_name
          in: path
          required: true
          schema:
            type: string
            enum: [early, middle, late, cyberpsychosis]
          description: Название стадии
      responses:
        '200':
          description: Информация о стадии
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/StageInfo'
        '400':
          $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  # Прогрессия
  /gameplay/combat/cyberpsychosis/{player_id}/progression:
    get:
      summary: Получить информацию о прогрессии
      description: Возвращает информацию о прогрессии киберпсихоза
      operationId: getProgression
      tags:
        - Combat
        - Cyberpsychosis
        - Progression
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      responses:
        '200':
          description: Информация о прогрессии
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/ProgressionInfo'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  /gameplay/combat/cyberpsychosis/{player_id}/progression/calculate:
    post:
      summary: Рассчитать прогрессию с учетом всех факторов
      description: Рассчитывает прогрессию киберпсихоза с учетом всех факторов
      operationId: calculateProgression
      tags:
        - Combat
        - Cyberpsychosis
        - Progression
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './cyberpsychosis-requests.yaml#/components/schemas/CalculateProgressionRequest'
      responses:
        '200':
          description: Расчет прогрессии
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/ProgressionCalculation'
        '400':
          $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  /gameplay/combat/cyberpsychosis/{player_id}/progression/trigger:
    post:
      summary: Сработать триггер прогрессии
      description: Срабатывает триггер прогрессии
      operationId: triggerProgression
      tags:
        - Combat
        - Cyberpsychosis
        - Progression
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './cyberpsychosis-requests.yaml#/components/schemas/TriggerProgressionRequest'
      responses:
        '200':
          description: Триггер прогрессии сработан
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/ProgressionTriggerResult'
        '400':
          $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  # Последствия
  /gameplay/combat/cyberpsychosis/{player_id}/consequences:
    get:
      summary: Получить список последствий киберпсихоза
      description: Возвращает список последствий киберпсихоза
      operationId: getConsequences
      tags:
        - Combat
        - Cyberpsychosis
        - Consequences
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      responses:
        '200':
          description: Информация о последствиях
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/ConsequencesInfo'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  /gameplay/combat/cyberpsychosis/{player_id}/stat-penalties:
    get:
      summary: Получить штрафы к характеристикам
      description: Возвращает штрафы к характеристикам от киберпсихоза.
      operationId: getStatPenalties
      tags:
        - Combat
        - Cyberpsychosis
        - Consequences
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      responses:
        '200':
          description: Штрафы к характеристикам
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/StatPenalties'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  /gameplay/combat/cyberpsychosis/{player_id}/social-effects:
    get:
      summary: Получить влияние на социальные взаимодействия
      description: Возвращает влияние киберпсихоза на социальные взаимодействия
      operationId: getSocialEffects
      tags:
        - Combat
        - Cyberpsychosis
        - Consequences
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      responses:
        '200':
          description: Социальные эффекты
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/SocialEffects'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  # Управление
  /gameplay/combat/cyberpsychosis/{player_id}/prevention/apply:
    post:
      summary: Применить профилактическую меру
      description: Применяет профилактическую меру для замедления прогрессии
      operationId: applyPrevention
      tags:
        - Combat
        - Cyberpsychosis
        - Management
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './cyberpsychosis-requests.yaml#/components/schemas/ApplyPreventionRequest'
      responses:
        '200':
          description: Профилактическая мера применена
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/PreventionResult'
        '400':
          $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '422':
          $ref: '../../../shared/common/responses.yaml#/components/responses/UnprocessableEntity'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  /gameplay/combat/cyberpsychosis/{player_id}/treatment/apply:
    post:
      summary: Применить лечение
      description: Применяет лечение для восстановления человечности
      operationId: applyTreatment
      tags:
        - Combat
        - Cyberpsychosis
        - Management
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './cyberpsychosis-requests.yaml#/components/schemas/ApplyTreatmentRequest'
      responses:
        '200':
          description: Лечение применено
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/TreatmentResult'
        '400':
          $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '422':
          $ref: '../../../shared/common/responses.yaml#/components/responses/UnprocessableEntity'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  /gameplay/combat/cyberpsychosis/treatments:
    get:
      summary: Получить список доступных методов лечения
      description: Возвращает список доступных методов лечения с описанием, стоимостью и эффективностью.
      operationId: getTreatments
      tags:
        - Combat
        - Cyberpsychosis
        - Management
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: query
          schema:
            type: string
            format: uuid
          description: ID игрока (для проверки доступности)
        - $ref: '../../../shared/common/pagination.yaml#/components/parameters/Page'
        - $ref: '../../../shared/common/pagination.yaml#/components/parameters/PageSize'
      responses:
        '200':
          description: Список методов лечения
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: './cyberpsychosis-models.yaml#/components/schemas/TreatmentOption'
                  meta:
                    $ref: '../../../shared/common/pagination.yaml#/components/schemas/PaginationMeta'
        '400':
          $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  /gameplay/combat/cyberpsychosis/{player_id}/symptom-management/apply:
    post:
      summary: Применить управление симптомами
      description: Применяет управление симптомами для контроля их влияния
      operationId: applySymptomManagement
      tags:
        - Combat
        - Cyberpsychosis
        - Management
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './cyberpsychosis-requests.yaml#/components/schemas/ApplySymptomManagementRequest'
      responses:
        '200':
          description: Управление симптомами применено
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/SymptomManagementResult'
        '400':
          $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '422':
          $ref: '../../../shared/common/responses.yaml#/components/responses/UnprocessableEntity'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  /gameplay/combat/cyberpsychosis/{player_id}/adaptation:
    get:
      summary: Получить информацию об адаптации к симптомам
      description: Возвращает информацию об адаптации игрока к симптомам
      operationId: getAdaptation
      tags:
        - Combat
        - Cyberpsychosis
        - Management
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      responses:
        '200':
          description: Информация об адаптации
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/AdaptationInfo'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  /gameplay/combat/cyberpsychosis/{player_id}/implant-removal:
    post:
      summary: Удалить имплант для восстановления человечности
      description: Удаляет имплант для частичного восстановления человечности
      operationId: removeImplant
      tags:
        - Combat
        - Cyberpsychosis
        - Management
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './cyberpsychosis-requests.yaml#/components/schemas/RemoveImplantRequest'
      responses:
        '200':
          description: Имплант удален
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/ImplantRemovalResult'
        '400':
          $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '422':
          $ref: '../../../shared/common/responses.yaml#/components/responses/UnprocessableEntity'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  /gameplay/combat/cyberpsychosis/{player_id}/detoxification:
    post:
      summary: Выполнить детоксикацию
      description: Выполняет детоксикацию для восстановления человечности
      operationId: performDetoxification
      tags:
        - Combat
        - Cyberpsychosis
        - Management
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './cyberpsychosis-requests.yaml#/components/schemas/DetoxificationRequest'
      responses:
        '200':
          description: Детоксикация выполнена
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/DetoxificationResult'
        '400':
          $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '422':
          $ref: '../../../shared/common/responses.yaml#/components/responses/UnprocessableEntity'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  # Экономика и социальные механики
  /gameplay/combat/cyberpsychosis/{player_id}/treatment-costs:
    get:
      summary: Получить стоимость лечения
      description: Возвращает стоимость лечения с учетом всех факторов
      operationId: getTreatmentCosts
      tags:
        - Combat
        - Cyberpsychosis
        - Economy
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
        - name: treatment_type
          in: query
          schema:
            type: string
            enum: [therapy, medication, implant_removal, detoxification]
          description: Тип лечения
      responses:
        '200':
          description: Стоимость лечения
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/TreatmentCosts'
        '400':
          $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'

  /gameplay/combat/cyberpsychosis/{player_id}/social-support/apply:
    post:
      summary: Применить социальную поддержку
      description: Применяет социальную поддержку для снижения стресса
      operationId: applySocialSupport
      tags:
        - Combat
        - Cyberpsychosis
        - Social
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID игрока
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './cyberpsychosis-requests.yaml#/components/schemas/ApplySocialSupportRequest'
      responses:
        '200':
          description: Социальная поддержка применена
          content:
            application/json:
              schema:
                $ref: './cyberpsychosis-models.yaml#/components/schemas/SocialSupportResult'
        '400':
          $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest'
        '401':
          $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized'
        '404':
          $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound'
        '422':
          $ref: '../../../shared/common/responses.yaml#/components/responses/UnprocessableEntity'
        '500':
          $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError'
servers:
  - url: https://api.necp.game/v1
    description: Production API Gateway
  - url: http://localhost:8080/api/v1
    description: Local API Gateway
