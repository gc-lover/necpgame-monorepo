openapi: 3.0.3
info:
  title: Combat Implants Limits - Endpoints
  version: 1.0.0

  x-microservice:
    name: gameplay-service
    port: 8083
    domain: gameplay
    base-path: /api/v1/gameplay/combat
    package: com.necpgame.gameplayservice
paths:
  /gameplay/combat/implants/{player_id}/slots:
    get:
      summary: Получить текущее состояние слотов имплантов
      tags: [Implants Limits]
      operationId: getImplantSlots
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PlayerId'
      responses:
        '200':
          description: Текущее состояние слотов
          content:
            application/json:
              schema:
                $ref: './implants-limits-models.yaml#/components/schemas/ImplantSlots'
        '400': { $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest' }
        '401': { $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized' }
        '404': { $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound' }
        '500': { $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError' }

  /gameplay/combat/implants/{player_id}/compatibility:
    post:
      summary: Проверить совместимость импланта со слотами
      tags: [Implants Limits]
      operationId: checkImplantCompatibility
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PlayerId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './implants-limits-requests.yaml#/components/schemas/CompatibilityCheckRequest'
      responses:
        '200':
          description: Результат проверки совместимости
          content:
            application/json:
              schema:
                $ref: './implants-limits-models.yaml#/components/schemas/CompatibilityResult'
        '400': { $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest' }
        '401': { $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized' }
        '404': { $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound' }
        '422': { $ref: '../../../shared/common/responses.yaml#/components/responses/UnprocessableEntity' }
        '500': { $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError' }

  /gameplay/combat/implants/{player_id}/limits:
    get:
      summary: Получить текущие лимиты имплантов игрока
      tags: [Implants Limits]
      operationId: getImplantLimits
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PlayerId'
      responses:
        '200':
          description: Текущие лимиты имплантов
          content:
            application/json:
              schema:
                $ref: './implants-limits-models.yaml#/components/schemas/ImplantLimits'
        '400': { $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest' }
        '401': { $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized' }
        '404': { $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound' }
        '500': { $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError' }

  /gameplay/combat/implants/{player_id}/limit:
    get:
      summary: Получить сводную информацию о лимите имплантов
      tags: [Implants Limits]
      operationId: getImplantLimitSummary
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PlayerId'
      responses:
        '200':
          description: Сводная информация о лимитах имплантов
          content:
            application/json:
              schema:
                $ref: './implants-limits-models.yaml#/components/schemas/ImplantLimitInfo'
        '400': { $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest' }
        '401': { $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized' }
        '404': { $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound' }
        '500': { $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError' }

  /gameplay/combat/implants/{player_id}/limit/calculate:
    post:
      summary: Рассчитать новый лимит имплантов
      tags: [Implants Limits]
      operationId: calculateImplantLimit
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PlayerId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './implants-limits-requests.yaml#/components/schemas/CalculateLimitRequest'
      responses:
        '200':
          description: Результат расчета лимита
          content:
            application/json:
              schema:
                $ref: './implants-limits-models.yaml#/components/schemas/ImplantLimitCalculation'
        '400': { $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest' }
        '401': { $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized' }
        '404': { $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound' }
        '422': { $ref: '../../../shared/common/responses.yaml#/components/responses/UnprocessableEntity' }
        '500': { $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError' }

  /gameplay/combat/implants/{player_id}/energy:
    get:
      summary: Получить текущее состояние энергетического пула
      tags: [Implants Limits]
      operationId: getImplantEnergy
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PlayerId'
      responses:
        '200':
          description: Текущее состояние энергии
          content:
            application/json:
              schema:
                $ref: './implants-limits-models.yaml#/components/schemas/EnergyPoolInfo'
        '400': { $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest' }
        '401': { $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized' }
        '404': { $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound' }
        '500': { $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError' }

  /gameplay/combat/implants/{player_id}/energy/calculate:
    post:
      summary: Рассчитать энергетическое потребление имплантов
      tags: [Implants Limits]
      operationId: calculateImplantEnergy
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PlayerId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './implants-limits-requests.yaml#/components/schemas/CalculateEnergyRequest'
      responses:
        '200':
          description: Результат расчета энергии
          content:
            application/json:
              schema:
                $ref: './implants-limits-models.yaml#/components/schemas/EnergyCalculation'
        '400': { $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest' }
        '401': { $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized' }
        '404': { $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound' }
        '422': { $ref: '../../../shared/common/responses.yaml#/components/responses/UnprocessableEntity' }
        '500': { $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError' }

  /gameplay/combat/implants/{player_id}/energy/restore:
    post:
      summary: Восстановить энергию имплантов
      tags: [Implants Limits]
      operationId: restoreImplantEnergy
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PlayerId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './implants-limits-requests.yaml#/components/schemas/RestoreEnergyRequest'
      responses:
        '200':
          description: Результат восстановления энергии
          content:
            application/json:
              schema:
                $ref: './implants-limits-models.yaml#/components/schemas/EnergyRestoreResult'
        '400': { $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest' }
        '401': { $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized' }
        '404': { $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound' }
        '422': { $ref: '../../../shared/common/responses.yaml#/components/responses/UnprocessableEntity' }
        '500': { $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError' }

  /gameplay/combat/implants/{player_id}/energy/limits:
    get:
      summary: Получить индивидуальные энергетические лимиты
      tags: [Implants Limits]
      operationId: getImplantEnergyLimits
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PlayerId'
      responses:
        '200':
          description: Индивидуальные энергетические лимиты
          content:
            application/json:
              schema:
                $ref: './implants-limits-models.yaml#/components/schemas/IndividualEnergyLimits'
        '400': { $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest' }
        '401': { $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized' }
        '404': { $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound' }
        '500': { $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError' }

  /gameplay/combat/implants/{player_id}/validate-install:
    post:
      summary: Провести финальную валидацию установки импланта
      tags: [Implants Limits]
      operationId: validateImplantInstall
      security:
        - BearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PlayerId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './implants-limits-requests.yaml#/components/schemas/ValidateInstallRequest'
      responses:
        '200':
          description: Результат валидации установки
          content:
            application/json:
              schema:
                $ref: './implants-limits-models.yaml#/components/schemas/ValidationResult'
        '400': { $ref: '../../../shared/common/responses.yaml#/components/responses/BadRequest' }
        '401': { $ref: '../../../shared/common/responses.yaml#/components/responses/Unauthorized' }
        '404': { $ref: '../../../shared/common/responses.yaml#/components/responses/NotFound' }
        '409': { $ref: '../../../shared/common/responses.yaml#/components/responses/Conflict' }
        '422': { $ref: '../../../shared/common/responses.yaml#/components/responses/UnprocessableEntity' }
        '500': { $ref: '../../../shared/common/responses.yaml#/components/responses/InternalServerError' }

components:
  parameters:
    PlayerId:
      name: player_id
      in: path
      required: true
      description: Идентификатор игрока
      schema:
        type: string

  securitySchemes:
    BearerAuth:
      $ref: '../../../shared/common/security.yaml#/components/securitySchemes/BearerAuth'



servers:
  - url: https://api.necp.game/v1
    description: Production API Gateway
  - url: http://localhost:8080/api/v1
    description: Local API Gateway

