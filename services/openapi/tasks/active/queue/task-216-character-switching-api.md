# Task ID: API-TASK-216
**–¢–∏–ø:** API Generation
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –≤—ã—Å–æ–∫–∏–π
**–°—Ç–∞—Ç—É—Å:** queued
**–°–æ–∑–¥–∞–Ω–æ:** 2025-11-08 02:08
**–°–æ–∑–¥–∞—Ç–µ–ª—å:** GPT-5 Codex (API Task Creator)
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** API-TASK-127, API-TASK-198, API-TASK-199

---

## üìã –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π, –±—ã—Å—Ç—Ä–æ–π —Å–º–µ–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ —Å–µ—Å—Å–∏–∏, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞.

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:** –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å `api/v1/players/character-switching.yaml`, –æ–ø–∏—Å–∞–≤ REST/WS —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã, –º–æ–¥–µ–ª–∏ –∏ –ø—Ä–∞–≤–∏–ª–∞ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞ Part 2.

---

## üéØ –¶–µ–ª—å –∑–∞–¥–∞–Ω–∏—è

–û–±–µ—Å–ø–µ—á–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏ —É–¥–æ–±–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –±–µ–∑ —Ä–∞–∑—Ä—ã–≤–∞ —Å–µ—Å—Å–∏–∏ –∏ –ø–æ—Ç–µ—Ä–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.

**–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ:**
- –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –∏–≥—Ä–æ–≤–æ–π UX ¬´–±—ã—Å—Ç—Ä–æ–π —Å–º–µ–Ω—ã –ø–µ—Ä—Å–æ–Ω–∞–∂–∞¬ª –±–µ–∑ —Ä–µ–ª–æ–≥–∞
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –∏ –∑–∞–≥—Ä—É–∑–∫—É –Ω–æ–≤–æ–≥–æ
- –ü—Ä–∏–º–µ–Ω–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (cooldown, combat lock, queue)
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å session-management, progression, inventory, party —Å–∏—Å—Ç–µ–º–∞–º–∏

---

## üìö –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç

**–ü—É—Ç—å:** `.BRAIN/05-technical/backend/player-character-mgmt/part2-switching-management.md`
**–í–µ—Ä—Å–∏—è:** v1.0.1 (2025-11-07 02:23)
**–°—Ç–∞—Ç—É—Å:** approved, api-readiness: ready

**–ö–ª—é—á–µ–≤—ã–µ —Ä–∞–∑–¥–µ–ª—ã:**
- Switch character flow (save state, load new, update session)
- Server-side –ø—Ä–æ–≤–µ—Ä–∫–∏: combat lock, instance lock, party restrictions
- Cooldowns, queue –¥–ª—è –ø–ª–∞—Ç–Ω—ã—Ö –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π, RP-—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- Character state snapshot (inventory, progression, location)
- API summary: switch, queue, cancel, status, presets

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

- `.BRAIN/05-technical/backend/player-character-mgmt/part1-creation-deletion.md`
- `.BRAIN/05-technical/backend/session-management/part1-lifecycle-heartbeat.md`
- `.BRAIN/05-technical/backend/session-management/part2-reconnection-monitoring.md`
- `.BRAIN/05-technical/backend/inventory-system/part2-advanced-features.md`
- `.BRAIN/05-technical/backend/progression-backend.md`

### –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- `API-SWAGGER/tasks/active/queue/task-127-player-character-management-api.md`
- `API-SWAGGER/tasks/active/queue/task-198-session-lifecycle-api.md`
- `API-SWAGGER/tasks/active/queue/task-199-session-reconnect-monitoring-api.md`

---

## üìÅ –¶–µ–ª–µ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ API

- **–§–∞–π–ª:** `api/v1/players/character-switching.yaml`
- **–í–µ—Ä—Å–∏—è API:** v1
- **–§–æ—Ä–º–∞—Ç:** OpenAPI 3.0.3 (REST + Events)

```
API-SWAGGER/api/v1/players/
 ‚îú‚îÄ‚îÄ players.yaml                  (–±–∞–∑–æ–≤—ã–π API –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π)
 ‚îî‚îÄ‚îÄ character-switching.yaml      ‚Üê —Å–æ–∑–¥–∞—Ç—å/–∑–∞–ø–æ–ª–Ω–∏—Ç—å
```

---

## üèóÔ∏è –¶–µ–ª–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (‚ö†Ô∏è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)

### Backend
- **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å:** character-service
- **–ü–æ—Ä—Ç:** 8082
- **API Base Path:** `/api/v1/players`
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
  - auth-service ‚Äì –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞, —Ä–æ–ª–µ–π
  - session-service ‚Äì –∞–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–µ—Å—Å–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
  - inventory-service ‚Äì —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
  - progression-service ‚Äì —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ XP, –Ω–∞–≤—ã–∫–æ–≤
  - party-service ‚Äì –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–∞ –≥—Ä—É–ø–ø—ã
  - world-service ‚Äì –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –º–µ–∂–¥—É –∑–æ–Ω–∞–º–∏/–∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏
  - notification-service ‚Äì —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏

### Frontend
- **–ú–æ–¥—É–ª—å:** `modules/players/character-switching`
- **State Store:** `useCharacterStore`
- **State:** `activeCharacter`, `availableSlots`, `switchQueue`, `cooldowns`, `presets`
- **UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:** `CharacterSwitchPanel`, `CharacterCardList`, `SwitchCooldownTimer`, `SwitchQueueList`, `SwitchConfirmationModal`
- **–§–æ—Ä–º—ã:** `SwitchRequestForm`, `SwitchPresetForm`
- **Layouts:** `GameLayout`
- **–•—É–∫–∏:** `useCharacterSwitch`, `useSwitchCooldown`, `useSwitchQueue`

### –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è YAML

```yaml
# Target Architecture:
# - Microservice: character-service (port 8082)
# - API Base: /api/v1/players
# - Dependencies: auth, session, inventory, progression, party, world, notification
# - Frontend Module: modules/players/character-switching (useCharacterStore)
# - UI: CharacterSwitchPanel, CharacterCardList, SwitchCooldownTimer, SwitchQueueList, SwitchConfirmationModal
# - Forms: SwitchRequestForm, SwitchPresetForm
# - Hooks: useCharacterSwitch, useSwitchCooldown, useSwitchQueue
```

---

## ‚úÖ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å (–¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω)

1. –û–ø–∏—Å–∞—Ç—å switch flow: –≤–∞–ª–∏–¥–∞—Ü–∏—è, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ state snapshot, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ session, –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞.
2. –î–æ–±–∞–≤–∏—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è, –æ—Ç–º–µ–Ω—ã, —Å—Ç–∞—Ç—É—Å–∞, –æ—á–µ—Ä–µ–¥–∏.
3. –£–∫–∞–∑–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: combat lock, instance lock, cooldown, premium fast switch.
4. –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–µ—Å–µ—Ç—ã (favorite characters, quick slots) –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.
5. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å event bus —Å–æ–±—ã—Ç–∏—è (`character:switch-started`, `character:switch-completed`, `character:switch-failed`).
6. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å session heartbeat/reconnect API (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤, reconnection window).
7. –û–±–µ—Å–ø–µ—á–∏—Ç—å –∞—É–¥–∏—Ç (auditId) –∏ –ª–æ–≥–∏ –¥–ª—è –∞–Ω—Ç–∏-–∞–±—É–∑–∞.
8. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã JSON, —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –ø—Ä–æ–π—Ç–∏ —á–µ–∫–ª–∏—Å—Ç.

---

## üîÄ Endpoints

1. **GET `/api/v1/players/characters`** ‚Äì —Å–ø–∏—Å–æ–∫ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∞–∫–∫–∞—É–Ω—Ç–∞ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ (cooldowns, presets).
2. **POST `/api/v1/players/characters/switch`** ‚Äì –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ (targetCharacterId, reason, presetId).
3. **GET `/api/v1/players/characters/switch/status`** ‚Äì —Å—Ç–∞—Ç—É—Å —Ç–µ–∫—É—â–µ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è (step, eta, locks).
4. **POST `/api/v1/players/characters/switch/cancel`** ‚Äì –æ—Ç–º–µ–Ω–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è.
5. **POST `/api/v1/players/characters/switch/confirm`** ‚Äì –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (–¥–ª—è premium fast switch, –ø–ª–∞—Ç–Ω—ã—Ö –æ–ø—Ü–∏–π).
6. **GET `/api/v1/players/characters/switch/cooldowns`** ‚Äì –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞—Ö.
7. **GET `/api/v1/players/characters/switch/queue`** ‚Äì –æ—á–µ—Ä–µ–¥—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è batch).
8. **POST `/api/v1/players/characters/switch/preset`** ‚Äì —Å–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ—Å–µ—Ç (–∏–∑–±—Ä–∞–Ω–Ω—ã–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏, loadout).
9. **GET `/api/v1/players/characters/switch/preset`** ‚Äì –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–µ—Å–µ—Ç—ã.
10. **POST `/api/v1/players/characters/switch/session-sync`** ‚Äì —Ä—É—á–Ω–æ–π sync –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è (inventory, progression, buffs).
11. **POST `/api/v1/players/characters/switch/relocate`** ‚Äì –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ –±–µ–∑–æ–ø–∞—Å–Ω—É—é –∑–æ–Ω—É –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ –ª–æ–∫–∞—Ü–∏–π.
12. **POST `/api/v1/players/characters/switch/admin/force`** ‚Äì –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ (audit).
13. **GET `/api/v1/players/characters/switch/logs`** ‚Äì –∏—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π.
14. **GET `/api/v1/players/characters/switch/locks`** ‚Äì —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (combat, event, raid).
15. **WS `/api/v1/players/characters/switch/stream`** ‚Äì —Å–æ–±—ã—Ç–∏—è: `switch-started`, `switch-progress`, `switch-completed`, `switch-failed`, `switch-cooldown-updated`.

---

## üß± –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

- **CharacterSwitchRequest** ‚Äì `characterId`, `presetId`, `reason`, `fastSwitch`, `auditId`.
- **CharacterSwitchStatus** ‚Äì `state` (`IDLE|SAVING|LOADING|COMPLETED|FAILED`), `step`, `eta`, `locks[]`, `warnings[]`.
- **CharacterSnapshot** ‚Äì `inventoryChecksum`, `progression`, `location`, `party`, `buffs`.
- **SwitchCooldownInfo** ‚Äì `characterId`, `cooldownEndsAt`, `fastSwitchAvailable`, `charges`.
- **SwitchQueueItem** ‚Äì `queueId`, `requestedAt`, `priority`, `status`.
- **SwitchPreset** ‚Äì `presetId`, `name`, `characterIds[]`, `default`, `createdAt`.
- **SwitchLogEntry** ‚Äì `timestamp`, `source`, `oldCharacterId`, `newCharacterId`, `result`, `duration`, `auditId`.
- **SwitchLockInfo** ‚Äì `type` (`COMBAT|INSTANCE|QUEST|EVENT|PARTY`), `active`, `expiresAt`, `details`.
- **RealtimeEventPayload** ‚Äì union (`switchStarted`, `switchProgress`, `switchCompleted`, `switchFailed`, `switchCooldownUpdated`).
- **Error Schema (`CharacterSwitchError`)** ‚Äì codes (`LOCK_ACTIVE`, `COOLDOWN_ACTIVE`, `SESSION_NOT_FOUND`, `QUEUE_FULL`, `SNAPSHOT_FAILED`, `FAST_SWITCH_DENIED`).

---

## üß≠ –ü—Ä–∏–Ω—Ü–∏–ø—ã –∏ –ø—Ä–∞–≤–∏–ª–∞

- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: `BearerAuth` (–∞–∫–∫–∞—É–Ω—Ç), `ServiceToken` –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (admin/GM).
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –Ω–µ–ª—å–∑—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –≤ –±–æ—é/—Ä–µ–π–¥–µ; cooldown 5 –º–∏–Ω—É—Ç (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ).
- –°–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å snapshot —Ç–µ–∫—É—â–µ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º.
- –°–µ—Å—Å–∏–∏: –æ–±–Ω–æ–≤–ª—è—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã, heartbeat –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –±–µ–∑ –æ–±—Ä—ã–≤–∞.
- –ê—É–¥–∏—Ç: –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è, `auditId` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è fast switch/premium/GM.
- –ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã: –æ—à–∏–±–∫–∏ `SNAPSHOT_FAILED` ‚Üí incident-service —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º.
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ: `GET characters` –¥–æ–ø—É—Å–∫–∞–µ—Ç `Cache-Control: max-age=5`; –æ—Å—Ç–∞–ª—å–Ω—ã–µ POST/WS invalidate.
- DRY: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ `api/v1/shared/common/`.

---

## üß™ –ü—Ä–∏–º–µ—Ä—ã

- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –æ—Å–Ω–æ–≤–Ω—ã–º –∏ –∞–ª—å—Ç-–ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º.
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è (—ç—Ç–∞–ø SAVING) —Å –∞–∫—Ç–∏–≤–Ω—ã–º combat lock.
- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ—Å–µ—Ç–∞ ¬´Raid Team¬ª –∏ –±—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π.
- –°–æ–±—ã—Ç–∏–µ `switch-completed` –≤ WebSocket –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏.
- –ê–¥–º–∏–Ω—Å–∫–æ–µ —Ñ–æ—Ä—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞.

---

## üîó –°–≤—è–∑–Ω–æ—Å—Ç–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å session lifecycle/reconnect API (`API-TASK-198/199`).
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç inventory/progression –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞.
- Party-service –æ–±–Ω–æ–≤–ª—è–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ –≥—Ä—É–ø–ø–µ.
- Notification-service –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç push/ingame —É–≤–µ–¥—ã –∏–≥—Ä–æ–∫—É/–ø–∞—Ç–∏.

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏

1. –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `character-switching.yaml` —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º –∏ –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤/WS.
2. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –æ–ø–∏—Å—ã–≤–∞—é—Ç –∑–∞–ø—Ä–æ—Å—ã, —Å—Ç–∞—Ç—É—Å, –æ—á–µ—Ä–µ–¥–∏, –ª–æ–≥–∏, —Å–æ–±—ã—Ç–∏—è.
3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, lock –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, auditing, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.
4. –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è; —á–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–π–¥–µ–Ω.

---

## üìé Checklist

- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —à–∞–±–ª–æ–Ω `api-generation-task-template.md`
- [ ] –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å, —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –º–æ–¥—É–ª—å, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- [ ] –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –∏ —Å–æ–±—ã—Ç–∏—è –ø–æ–∫—Ä—ã–≤–∞—é—Ç —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã –º–æ–¥–µ–ª–∏, –æ—à–∏–±–∫–∏, –ø—Ä–∏–º–µ—Ä—ã, –∫—Ä–∏—Ç–µ—Ä–∏–∏
- [ ] –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±–Ω–æ–≤–∏—Ç—å `tasks/config/brain-mapping.yaml`

---

## ‚ùìFAQ

**Q:** –ù—É–∂–Ω–æ –ª–∏ –æ—Ç–∫–ª—é—á–∞—Ç—å heartbeat –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏?
**A:** –ù–µ—Ç, heartbeat –æ—Å—Ç–∞—ë—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º, Session-service –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —Å–µ—Å—Å–∏—é –≤ `SWITCHING` –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.

**Q:** –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ snapshot –Ω–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω?
**A:** –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ `SNAPSHOT_FAILED`, –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç—Å—è incident –∏ –∏–≥—Ä–æ–∫ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ –ø—Ä–µ–∂–Ω–µ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–µ.

**Q:** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ª–∏ fast switch –±–µ–∑ cooldown?
**A:** –î–∞, –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ premium charge –∏–ª–∏ GM –ø—Ä–∞–≤ –∏ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫; —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ –∞—É–¥–∏—Ç.



### OpenAPI (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

- –ó–∞–ø–æ–ª–Ω–∏ `info.x-microservice` (name, port, domain, base-path, package) –ø–æ –¥–∞–Ω–Ω—ã–º —Ü–µ–ª–µ–≤–æ–≥–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞.
- –í —Å–µ–∫—Ü–∏–∏ `servers` –æ—Å—Ç–∞–≤—å Production gateway `https://api.necp.game/v1` –∏ –ø—Ä–∏–º–µ—Ä –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ `http://localhost:8080/api/v1`.
- WebSocket –º–∞—Ä—à—Ä—É—Ç—ã –ø—É–±–ª–∏–∫—É–π —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ `wss://api.necp.game/v1/...`.

