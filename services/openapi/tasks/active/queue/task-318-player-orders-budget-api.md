# Task ID: API-TASK-318
**–¢–∏–ø:** API Generation  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –≤—ã—Å–æ–∫–∏–π  
**–°—Ç–∞—Ç—É—Å:** completed  
**–°–æ–∑–¥–∞–Ω–æ:** 2025-11-08 16:10  
**–°–æ–∑–¥–∞—Ç–µ–ª—å:** GPT-5 Codex  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** API-TASK-317 (social-service –º–∞—Å—Ç–µ—Ä –∑–∞–∫–∞–∑–æ–≤), API-TASK-319 (world-service –≤–∞–ª–∏–¥–∞—Ç–æ—Ä)

---

## üìã –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é `api/v1/economy/player-orders/budget.yaml`, –æ–ø–∏—Å—ã–≤–∞—é—â—É—é —Ä–∞—Å—á—ë—Ç –±—é–¥–∂–µ—Ç–∞, escrow –∏ —Å—Ç—Ä–∞—Ö–æ–≤—ã—Ö –≥–∞—Ä–∞–Ω—Ç–∏–π –∑–∞–∫–∞–∑–æ–≤ –∏–≥—Ä–æ–∫–æ–≤.

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:** –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ economy-service —Å REST endpoints, –º–æ–¥–µ–ª—è–º–∏ –¥–∞–Ω–Ω—ã—Ö, Kafka —Å–æ–±—ã—Ç–∏—è–º–∏ –∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö `.BRAIN/02-gameplay/social/player-orders-creation-–¥–µ—Ç–∞–ª—å–Ω–æ.md`.

---

## üéØ –¶–µ–ª—å –∑–∞–¥–∞–Ω–∏—è

–û–±–µ—Å–ø–µ—á–∏—Ç—å social-service –∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–∫–∞–∑–æ–≤ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º API –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏ –±—é–¥–∂–µ—Ç–∞, –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º–∏ –≥–∞—Ä–∞–Ω—Ç–∏—è–º–∏.

**–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ:**
- –°–æ—Ü–∏–∞–ª–∫–∞ –ø–æ–ª—É—á–∞–µ—Ç —Ä–∞—Å—á—ë—Ç `BaseReward`, `Escrow`, `Commission` –∏ —Å—Ç—Ä–∞—Ö–æ–≤—ã–µ —Ç–∞—Ä–∏—Ñ—ã –∏–∑ –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.
- –≠–∫–æ–Ω–æ–º–∏–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Å–æ–±–ª—é–¥–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª –∏ –ø–æ—Ä–æ–≥–æ–≤, —Å–Ω–∏–∂–∞—è —Ä–∏—Å–∫ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞.
- –§—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç breakdown –±—é–¥–∂–µ—Ç–∞ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏–≥—Ä–æ–∫—É –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –º–∞—Å—Ç–µ—Ä–∞.

---

## üìö –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫
**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** `.BRAIN`  
**–î–æ–∫—É–º–µ–Ω—Ç:** `.BRAIN/02-gameplay/social/player-orders-creation-–¥–µ—Ç–∞–ª—å–Ω–æ.md`  
**–í–µ—Ä—Å–∏—è:** v1.0.0 (approved)  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-11-08 09:53  

**–í–∞–∂–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã:**
- –§–æ—Ä–º—É–ª–∞ `BaseReward = ComplexityScore * RiskModifier * MarketIndex * TimeModifier`.
- –î–∏–∞–ø–∞–∑–æ–Ω—ã –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤: `riskModifier 0.8‚Äì1.5`, `timeModifier 1.0‚Äì1.3`, `escrowRate 10‚Äì30%`, `commissionRate 5‚Äì12%`.
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –º–µ–¥–∏–∞–Ω–æ–π —à–∞–±–ª–æ–Ω–∞ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—Ç—å –æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è—Ö.
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ (basic/extended/premium) –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∑–∞–≤—ã—à–µ–Ω–∏–∏/–∑–∞–Ω–∏–∂–µ–Ω–∏–∏ –±—é–¥–∂–µ—Ç–∞.

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- `.BRAIN/02-gameplay/social/player-orders-system-–¥–µ—Ç–∞–ª—å–Ω–æ.md`
- `.BRAIN/02-gameplay/social/player-orders-economy.md`
- `.BRAIN/02-gameplay/social/player-orders-reputation-–¥–µ—Ç–∞–ª—å–Ω–æ.md`
- `.BRAIN/02-gameplay/social/relationships-system-–¥–µ—Ç–∞–ª—å–Ω–æ.md`
- JSON —Å—Ö–µ–º—ã –±—é–¥–∂–µ—Ç–∞ –≤ `schemas/social/`
- –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è `api/v1/social/player-orders.yaml`

### –°–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏/API
- API-TASK-317 (`api/v1/social/player-orders.yaml`)
- API-TASK-319 (`api/v1/world/player-orders/validation.yaml`)

---

## üìÅ –¶–µ–ª–µ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ API

- **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** `API-SWAGGER`
- **–¶–µ–ª–µ–≤–æ–π —Ñ–∞–π–ª:** `api/v1/economy/player-orders/budget.yaml`
- **–í–µ—Ä—Å–∏—è API:** v1
- **–¢–∏–ø:** OpenAPI 3.0.3 YAML

```
api/
‚îî‚îÄ‚îÄ v1/
    ‚îî‚îÄ‚îÄ economy/
        ‚îî‚îÄ‚îÄ player-orders/
            ‚îú‚îÄ‚îÄ budget.yaml
            ‚îî‚îÄ‚îÄ player-orders-budget-components.yaml
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã: `api/v1/shared/common/responses.yaml`, `pagination.yaml`, `security.yaml`.

---

## üèóÔ∏è –¶–µ–ª–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Backend
- **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å:** economy-service (8085)
- **API Base Path:** `/api/v1/economy/player-orders/*`
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:** world-service, social-service, factions-service, telemetry-service
- **Kafka:** `economy.player-orders.budget.estimated`, `economy.player-orders.escrow.locked`, `economy.player-orders.insurance.applied`

### Frontend
- **–ú–æ–¥—É–ª—å:** `modules/social/player-orders/budget`
- **State Store:** `useSocialStore`
- **UI:** `BudgetSimulator`, `EscrowSummary`, `RiskIndicator`, `InsuranceTierCard`
- **Forms:** `BudgetAdjustForm`, `GuaranteeSelectionForm`

**–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:** –í –Ω–∞—á–∞–ª–µ `budget.yaml` –¥–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫ `Target Architecture` —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞, UI –∏ Kafka —Å–æ–±—ã—Ç–∏–π.

---

## ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

1. –ê–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤: –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, —Å—Ü–µ–Ω–∞—Ä–∏–∏.
2. –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ endpoints: —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π/–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ä–∞—Å—á—ë—Ç, —Ä—ã–Ω–æ—á–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã, —Å—Ç—Ä–∞—Ö–æ–≤—ã–µ –ø–ª–∞–Ω—ã, escrow.
3. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö: –∑–∞–ø—Ä–æ—Å—ã/–æ—Ç–≤–µ—Ç—ã —Ä–∞—Å—á—ë—Ç–∞, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è, escrow, —Å—Ç—Ä–∞—Ö–æ–≤—ã–µ –ø–ª–∞–Ω—ã.
4. –û–ø–∏—Å–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª: –¥–∏–∞–ø–∞–∑–æ–Ω—ã –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤, –º–µ–¥–∏–∞–Ω–∞, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è, manual override.
5. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –æ—à–∏–±–∫–∏: BearerAuth, –æ–±—â–∏–µ –æ—Ç–≤–µ—Ç—ã.
6. Kafka: –æ–ø–∏—Å–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –∏ payload.
7. –ü—Ä–∏–º–µ—Ä—ã: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∑–∞–∫–∞–∑, –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ.
8. –í–∞–ª–∏–¥–∞—Ü–∏—è: `npx swagger-cli validate`, —á–µ–∫–ª–∏—Å—Ç `tasks/config/checklist.md`.

---

## üß© Endpoints (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä)

1. `POST /economy/player-orders/budget/estimate`
2. `POST /economy/player-orders/budget/estimate/jobs`
3. `GET /economy/player-orders/budget/estimate/jobs/{jobId}`
4. `GET /economy/player-orders/market-index`
5. `GET /economy/player-orders/insurance-tiers`
6. `POST /economy/player-orders/{orderId}/budget/compare`
7. `POST /economy/player-orders/{orderId}/escrow/lock`
8. `DELETE /economy/player-orders/{orderId}/escrow/lock`

---

## üß± –ö–ª—é—á–µ–≤—ã–µ –º–æ–¥–µ–ª–∏

- `PlayerOrderBudgetEstimateRequest/Response`
- `BudgetModifier`, `BudgetWarning`, `CalculationBreakdown`
- `BudgetEstimateJob`
- `BudgetComparisonRequest/Result`
- `InsuranceTier`
- `MarketIndexHistory`
- `EscrowLockRequest/Response`

---

## üìå –ü—Ä–∏–Ω—Ü–∏–ø—ã –∏ –ø—Ä–∞–≤–∏–ª–∞

- SOLID, DRY, KISS, API First
- ‚â§400 —Å—Ç—Ä–æ–∫ –Ω–∞ —Ñ–∞–π–ª
- –ù–µ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- –£–∫–∞–∑–∞—Ç—å Kafka —Å–æ–±—ã—Ç–∏—è –∏ audit-trace –ø–æ–ª—è

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏

1. –°–æ–∑–¥–∞–Ω `budget.yaml` —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º.
2. –û–ø–∏—Å–∞–Ω—ã –≤—Å–µ endpoints —Å –∑–∞–ø—Ä–æ—Å–∞–º–∏/–æ—Ç–≤–µ—Ç–∞–º–∏.
3. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (required, min/max, enums).
4. –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞—é—Ç—Å—è –∫–æ–¥–∞–º–∏ (`BUDGET_OVERESTIMATED`, `MARKET_SPIKE`, ...).
5. –ü–æ–¥–∫–ª—é—á–µ–Ω—ã —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã.
6. Kafka —Å–æ–±—ã—Ç–∏—è –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã.
7. –ü—Ä–∏–º–µ—Ä—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –∫–ª—é—á–µ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏.
8. –£–∫–∞–∑–∞–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
9. `swagger-cli validate` –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ.
10. –ß–µ–∫–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω.

---

## ‚ùì FAQ

- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ä–∞—Å—á—ë—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º `complexityScore`.
- Manual override —Ç—Ä–µ–±—É–µ—Ç `adjustmentReason` –∏ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è.
- –ü—Ä–∏ –≤—Å–ø–ª–µ—Å–∫–µ `MarketIndex` –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ `MARKET_SPIKE`.
- Escrow/lock –≤—ã–∑—ã–≤–∞—é—Ç —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã social-service/arbitration.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∞–ª—é—Ç —á–µ—Ä–µ–∑ `preferredCurrency`.

---

## üß≠ –ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

- 2025-11-08 16:10 ‚Äî –∑–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞, —Å—Ç–∞—Ç—É—Å `queued`.
- 2025-11-08 16:18 ‚Äî –≤–∑—è—Ç–æ –≤ —Ä–∞–±–æ—Ç—É, —Å—Ç–∞—Ç—É—Å—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã.
- 2025-11-08 16:24 ‚Äî —Å–æ–∑–¥–∞–Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è `budget.yaml` –∏ `player-orders-budget-components.yaml`.
- 2025-11-08 16:26 ‚Äî `npx swagger-cli validate api/v1/economy/player-orders/budget.yaml` ‚Äî **OK**.
- 2025-11-08 17:05 ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏.

---

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:** —É–≤–µ–¥–æ–º–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Ä–∞—Å—á—ë—Ç–Ω–æ–≥–æ API, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å codegen –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –≤ economy-service/social-service.


### OpenAPI (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

- –ó–∞–ø–æ–ª–Ω–∏ `info.x-microservice` (name, port, domain, base-path, package) –ø–æ –¥–∞–Ω–Ω—ã–º —Ü–µ–ª–µ–≤–æ–≥–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞.
- –í —Å–µ–∫—Ü–∏–∏ `servers` –æ—Å—Ç–∞–≤—å Production gateway `https://api.necp.game/v1` –∏ –ø—Ä–∏–º–µ—Ä –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ `http://localhost:8080/api/v1`.
- WebSocket –º–∞—Ä—à—Ä—É—Ç—ã –ø—É–±–ª–∏–∫—É–π —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ `wss://api.necp.game/v1/...`.

