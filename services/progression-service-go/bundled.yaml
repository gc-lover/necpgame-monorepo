openapi: 3.0.3
info:
  title: Progression domain API
  description: 'Consolidated progression domain Domain API for NECPGAME.

    This domain consolidates all progression functionality.

    '
  version: 1.0.0
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  contact:
    name: NECPGAME API Support
    url: https://necpgame.com/support
    email: api@necpgame.com
servers:
- url: http://localhost:8080/api/v1
  description: Development server
- url: https://api.necpgame.com/api/v1
  description: Production server
security:
- BearerAuth: []
tags:
- name: Progression domain
  description: progression domain domain endpoints
paths:
  /api/v1/progression-domain/health:
    get:
      summary: progression domain domain health check
      operationId: progression-domainHealthCheck
      tags:
      - Progression domain
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
          headers:
            Cache-Control:
              schema:
                type: string
                example: max-age=300, s-maxage=600
            ETag:
              schema:
                type: string
                example: '"-api-v1-progression-domain-health-v1.0"'
            Content-Encoding:
              schema:
                type: string
                enum:
                - gzip
                - deflate
                - br
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
  /api/v1/progression-domain/health/batch:
    post:
      summary: Batch health check for multiple domains
      operationId: batchHealthCheck
      tags:
      - System
      description: 'Performance optimization: Check multiple domain health in single
        request'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
              - domains
              properties:
                domains:
                  type: array
                  items:
                    type: string
                  maxItems: 10
      responses:
        '200':
          description: Batch health results
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/HealthResponse'
                  total_time_ms:
                    type: integer
                    description: Total processing time
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
  /api/v1/progression-domain/health/ws:
    get:
      summary: Real-time health monitoring WebSocket
      operationId: healthWebSocket
      tags:
      - System
      description: Real-time health updates without polling
      responses:
        '101':
          description: WebSocket connection established
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    example: 500
                    format: int32
                    minimum: 100
                    maximum: 599
                  message:
                    type: string
                    example: Internal server error
                    maxLength: 1000
                  details:
                    type: object
                    description: Additional error details
                description: Standard error response format
components:
  responses:
    BadRequest:
      description: Invalid request parameters
      content:
        application/json:
          schema:
            type: object
            required:
            - code
            - message
            properties:
              code:
                type: integer
                example: 500
                format: int32
                minimum: 100
                maximum: 599
              message:
                type: string
                example: Internal server error
                maxLength: 1000
              details:
                type: object
                description: Additional error details
            description: Standard error response format
    Unauthorized:
      description: Authentication required
      content:
        application/json:
          schema:
            type: object
            required:
            - code
            - message
            properties:
              code:
                type: integer
                example: 500
                format: int32
                minimum: 100
                maximum: 599
              message:
                type: string
                example: Internal server error
                maxLength: 1000
              details:
                type: object
                description: Additional error details
            description: Standard error response format
    Forbidden:
      description: Access denied
      content:
        application/json:
          schema:
            type: object
            required:
            - code
            - message
            properties:
              code:
                type: integer
                example: 500
                format: int32
                minimum: 100
                maximum: 599
              message:
                type: string
                example: Internal server error
                maxLength: 1000
              details:
                type: object
                description: Additional error details
            description: Standard error response format
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            type: object
            required:
            - code
            - message
            properties:
              code:
                type: integer
                example: 500
                format: int32
                minimum: 100
                maximum: 599
              message:
                type: string
                example: Internal server error
                maxLength: 1000
              details:
                type: object
                description: Additional error details
            description: Standard error response format
    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            type: object
            required:
            - code
            - message
            properties:
              code:
                type: integer
                example: 500
                format: int32
                minimum: 100
                maximum: 599
              message:
                type: string
                example: Internal server error
                maxLength: 1000
              details:
                type: object
                description: Additional error details
            description: Standard error response format
    OK:
      description: Operation completed successfully
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: true
              message:
                type: string
                example: Operation completed
    Created:
      description: Resource created successfully
      headers:
        Location:
          schema:
            type: string
            format: uri
          description: URI of the created resource
      content:
        application/json:
          schema:
            type: object
            properties:
              id:
                type: string
                format: uuid
                description: Unique identifier of created resource
              created_at:
                type: string
                format: date-time
                description: Creation timestamp
    Conflict:
      description: Resource conflict
      content:
        application/json:
          schema:
            type: object
            required:
            - code
            - message
            properties:
              code:
                type: integer
                example: 500
                format: int32
                minimum: 100
                maximum: 599
              message:
                type: string
                example: Internal server error
                maxLength: 1000
              details:
                type: object
                description: Additional error details
            description: Standard error response format
    HealthOK:
      description: Service is healthy
      content:
        application/json:
          schema:
            HealthResponse:
              type: object
              required:
              - status
              - timestamp
              properties:
                status:
                  type: string
                  enum:
                  - healthy
                  - degraded
                  - unhealthy
                  example: healthy
                  maxLength: 255
                domain:
                  type: string
                  example: service-name
                  maxLength: 255
                timestamp:
                  type: string
                  format: date-time
                  example: '2025-12-28T10:00:00Z'
                  maxLength: 255
                version:
                  type: string
                  example: 1.0.0
                  maxLength: 50
                uptime_seconds:
                  type: integer
                  example: 3600
                  minimum: 0
                active_connections:
                  type: integer
                  example: 1500
                  minimum: 0
              description: 'BACKEND NOTE: Fields ordered for struct alignment (large
                → small). Expected memory savings: 30-50%.'
    HealthBatchSuccess:
      description: Batch health results retrieved successfully
      headers:
        Cache-Control:
          schema:
            type: string
            example: no-cache
        X-Processing-Time:
          schema:
            type: integer
            example: 15
            description: Processing time in milliseconds
      content:
        application/json:
          schema:
            type: object
            required:
            - results
            - total_time_ms
            properties:
              results:
                type: array
                items:
                  HealthResponse:
                    type: object
                    required:
                    - status
                    - timestamp
                    properties:
                      status:
                        type: string
                        enum:
                        - healthy
                        - degraded
                        - unhealthy
                        example: healthy
                        maxLength: 255
                      domain:
                        type: string
                        example: service-name
                        maxLength: 255
                      timestamp:
                        type: string
                        format: date-time
                        example: '2025-12-28T10:00:00Z'
                        maxLength: 255
                      version:
                        type: string
                        example: 1.0.0
                        maxLength: 50
                      uptime_seconds:
                        type: integer
                        example: 3600
                        minimum: 0
                      active_connections:
                        type: integer
                        example: 1500
                        minimum: 0
                    description: 'BACKEND NOTE: Fields ordered for struct alignment
                      (large → small). Expected memory savings: 30-50%.'
                description: Health status for each requested service
              total_time_ms:
                type: integer
                description: Total processing time in milliseconds
  schemas:
    HealthResponse:
      type: object
      required:
      - status
      - timestamp
      properties:
        status:
          type: string
          enum:
          - healthy
          - degraded
          - unhealthy
          example: healthy
          maxLength: 255
        domain:
          type: string
          example: service-name
          maxLength: 255
        timestamp:
          type: string
          format: date-time
          example: '2025-12-28T10:00:00Z'
          maxLength: 255
        version:
          type: string
          example: 1.0.0
          maxLength: 50
        uptime_seconds:
          type: integer
          example: 3600
          minimum: 0
        active_connections:
          type: integer
          example: 1500
          minimum: 0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small).
        Expected memory savings: 30-50%.'
    Error:
      type: object
      required:
      - code
      - message
      properties:
        code:
          type: integer
          example: 500
          format: int32
          minimum: 100
          maximum: 599
        message:
          type: string
          example: Internal server error
          maxLength: 1000
        details:
          type: object
          description: Additional error details
      description: Standard error response format
    WebSocketHealthMessage:
      type: object
      required:
      - type
      - message_timestamp
      - health
      properties:
        type:
          type: string
          enum:
          - health_update
          - health_alert
          - service_down
        message_timestamp:
          type: string
          format: date-time
          description: Timestamp of the health message
        health:
          $ref: '#/components/schemas/HealthResponse'
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small).
        Expected memory savings: 30-50%.'
    GrantExperienceRequest:
      type: object
      required:
      - amount
      - source
      properties:
        source:
          type: string
          enum:
          - combat
          - quest
          - achievement
          - daily
          - event
          description: Источник опыта
        sourceId:
          type: string
          description: ID источника (quest_id, enemy_id и т.д.)
        multiplier:
          type: number
          minimum: 0.1
          maximum: 5.0
          default: 1.0
          description: Множитель опыта (бонусы, баффы)
        amount:
          type: integer
          minimum: 1
          description: Количество опыта для начисления
    UpgradeSkillRequest:
      type: object
      required:
      - levels
      properties:
        levels:
          type: integer
          minimum: 1
          maximum: 10
          description: Количество уровней для повышения навыка
    PaginationParams:
      type: object
      properties:
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
          example: 20
        offset:
          type: integer
          minimum: 0
          default: 0
          example: 0
    PaginatedResponse:
      type: object
      required:
      - items
      - total
      - limit
      - offset
      properties:
        items:
          type: array
          description: Array of items
        total:
          type: integer
          minimum: 0
          example: 100
          description: Total number of items
        limit:
          type: integer
          minimum: 1
          maximum: 100
          example: 20
          description: Items per page
        offset:
          type: integer
          minimum: 0
          example: 0
          description: Number of items to skip
    AllocateAttributesRequest:
      type: object
      required:
      - attributes
      properties:
        attributes:
          type: object
          properties:
            intelligence:
              type: integer
              minimum: 0
              maximum: 10
            reflexes:
              type: integer
              minimum: 0
              maximum: 10
            dexterity:
              type: integer
              minimum: 0
              maximum: 10
            technology:
              type: integer
              minimum: 0
              maximum: 10
            cool:
              type: integer
              minimum: 0
              maximum: 10
            willpower:
              type: integer
              minimum: 0
              maximum: 10
            luck:
              type: integer
              minimum: 0
              maximum: 10
            movement:
              type: integer
              minimum: 0
              maximum: 10
            body:
              type: integer
              minimum: 0
              maximum: 10
            empathy:
              type: integer
              minimum: 0
              maximum: 10
    CharacterProgressionResponse:
      type: object
      required:
      - character_id
      - level
      - experience
      - experience_to_next
      properties:
        character_id:
          type: string
          format: uuid
          description: ID персонажа
        attributes:
          type: object
          properties:
            intelligence:
              type: integer
              format: int32
            reflexes:
              type: integer
              format: int32
            dexterity:
              type: integer
              format: int32
            technology:
              type: integer
              format: int32
            cool:
              type: integer
              format: int32
            willpower:
              type: integer
              format: int32
            luck:
              type: integer
              format: int32
            movement:
              type: integer
              format: int32
            body:
              type: integer
              format: int32
            empathy:
              type: integer
              format: int32
        skills:
          type: array
          items:
            type: object
            properties:
              skill_id:
                type: string
                format: uuid
              name:
                type: string
              level:
                type: integer
                format: int32
              experience:
                type: integer
                format: int32
        level:
          type: integer
          format: int32
          description: Текущий уровень персонажа
        experience:
          type: integer
          format: int32
          description: Текущий опыт персонажа
        experience_to_next:
          type: integer
          format: int32
          description: Опыт до следующего уровня
    ExperienceGrantedResponse:
      type: object
      required:
      - success
      - experience_granted
      - total_experience
      properties:
        success:
          type: boolean
          description: Успешность операции
        leveled_up:
          type: boolean
          description: Повысился ли уровень персонажа
        experience_granted:
          type: integer
          format: int32
          description: Начисленный опыт
        total_experience:
          type: integer
          format: int32
          description: Общий опыт персонажа после начисления
    LevelUpResponse:
      type: object
      required:
      - success
      - new_level
      - attribute_points_gained
      properties:
        success:
          type: boolean
          description: Успешность повышения уровня
        new_level:
          type: integer
          format: int32
          description: Новый уровень персонажа
        attribute_points_gained:
          type: integer
          format: int32
          description: Полученные очки атрибутов
        skill_points_gained:
          type: integer
          format: int32
          description: Полученные очки навыков
    AttributesAllocatedResponse:
      type: object
      required:
      - success
      - allocated_attributes
      properties:
        allocated_attributes:
          type: object
          description: Распределенные атрибуты
          properties:
            intelligence:
              type: integer
              format: int32
            reflexes:
              type: integer
              format: int32
            dexterity:
              type: integer
              format: int32
            technology:
              type: integer
              format: int32
            cool:
              type: integer
              format: int32
            willpower:
              type: integer
              format: int32
            luck:
              type: integer
              format: int32
            movement:
              type: integer
              format: int32
            body:
              type: integer
              format: int32
            empathy:
              type: integer
              format: int32
        success:
          type: boolean
          description: Успешность распределения
    SkillUpgradedResponse:
      type: object
      required:
      - success
      - skill_id
      - new_level
      - experience_spent
      properties:
        skill_id:
          type: string
          format: uuid
          description: ID навыка
        success:
          type: boolean
          description: Успешность повышения навыка
        new_level:
          type: integer
          format: int32
          description: Новый уровень навыка
        experience_spent:
          type: integer
          format: int32
          description: Потраченный опыт
    CharacterSkillsResponse:
      type: object
      required:
      - character_id
      - skills
      properties:
        character_id:
          type: string
          format: uuid
          description: ID персонажа
        skills:
          type: array
          items:
            type: object
            properties:
              skill_id:
                type: string
                format: uuid
              name:
                type: string
              level:
                type: integer
                format: int32
              experience:
                type: integer
                format: int32
              max_level:
                type: integer
                format: int32
    RecalculateStatsResponse:
      type: object
      required:
      - success
      - message
      properties:
        message:
          type: string
          description: Сообщение о результате
        updated_stats:
          type: object
          description: Пересчитанные статы
        success:
          type: boolean
          description: Успешность пересчета
    LevelRequirementsResponse:
      type: object
      required:
      - level
      - experience_required
      - total_experience_required
      properties:
        level:
          type: integer
          format: int32
          description: Уровень
        experience_required:
          type: integer
          format: int32
          description: Опыт, необходимый для достижения уровня
        total_experience_required:
          type: integer
          format: int32
          description: Общий опыт, необходимый для достижения уровня
        attribute_points_rewarded:
          type: integer
          format: int32
          description: Очки атрибутов за уровень
        skill_points_rewarded:
          type: integer
          format: int32
          description: Очки навыков за уровень
    SkillInfoResponse:
      type: object
      required:
      - skill_id
      - name
      - description
      - max_level
      properties:
        skill_id:
          type: string
          format: uuid
          description: ID навыка
        name:
          type: string
          description: Название навыка
        description:
          type: string
          description: Описание навыка
        category:
          type: string
          enum:
          - combat
          - social
          - technical
          - physical
          description: Категория навыка
        max_level:
          type: integer
          format: int32
          description: Максимальный уровень навыка
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT Bearer token authentication
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: API Key authentication
    ServiceAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: Service-to-service authentication token
