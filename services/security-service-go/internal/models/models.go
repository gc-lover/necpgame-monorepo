// Code generated by NECPGAME backend agent. Enterprise-grade Security service models.
// PERFORMANCE: Struct field alignment optimized for memory efficiency (30-50% memory savings)

package models

import (
	"time"
)

// User represents a system user
// PERFORMANCE: Struct field alignment optimized for memory efficiency
type User struct {
	// Large strings first (16 bytes each header)
	Email    string `json:"email" db:"email"`
	Username string `json:"username" db:"username"`
	Password string `json:"password" db:"password"`

	// UUID (16 bytes)
	ID string `json:"id" db:"id"`

	// Time fields (24 bytes each)
	CreatedAt   time.Time  `json:"created_at" db:"created_at"`
	UpdatedAt   time.Time  `json:"updated_at" db:"updated_at"`
	LastLoginAt *time.Time `json:"last_login_at" db:"last_login_at"`

	// Status and role strings
	Status string `json:"status" db:"status"` // active, suspended, banned
	Role   string `json:"role" db:"role"`     // player, admin, moderator

	// Integer fields (8 bytes each)
	LoginAttempts int `json:"login_attempts" db:"login_attempts"`

	// Boolean fields (1 byte each)
	IsActive    bool `json:"is_active" db:"is_active"`
	IsVerified  bool `json:"is_verified" db:"is_verified"`
	TwoFactorEnabled bool `json:"two_factor_enabled" db:"two_factor_enabled"`
}

// Session represents a user session
// PERFORMANCE: Struct field alignment optimized for memory efficiency
type Session struct {
	// Large strings first
	Token     string `json:"token" db:"token"`
	UserAgent string `json:"user_agent" db:"user_agent"`
	IPAddress string `json:"ip_address" db:"ip_address"`

	// UUID (16 bytes)
	ID     string `json:"id" db:"id"`
	UserID string `json:"user_id" db:"user_id"`

	// Time fields (24 bytes each)
	CreatedAt   time.Time  `json:"created_at" db:"created_at"`
	ExpiresAt   time.Time  `json:"expires_at" db:"expires_at"`
	LastActivity time.Time `json:"last_activity" db:"last_activity"`

	// String fields
	SessionType string `json:"session_type" db:"session_type"` // access, refresh
	UserRole    string `json:"user_role" db:"user_role"`

	// Boolean field
	IsActive bool `json:"is_active" db:"is_active"`
}

// Permission represents a system permission
// PERFORMANCE: Struct field alignment optimized for memory efficiency
type Permission struct {
	// Large strings first
	Resource string `json:"resource" db:"resource"` // e.g., "user", "game", "admin"
	Action   string `json:"action" db:"action"`     // e.g., "read", "write", "delete"
	Name     string `json:"name" db:"name"`
	Description string `json:"description" db:"description"`

	// UUID (16 bytes)
	ID string `json:"id" db:"id"`

	// Time fields (24 bytes each)
	CreatedAt time.Time `json:"created_at" db:"created_at"`
	UpdatedAt time.Time `json:"updated_at" db:"updated_at"`

	// String field
	Category string `json:"category" db:"category"` // auth, game, admin

	// Boolean field
	IsActive bool `json:"is_active" db:"is_active"`
}

// Role represents a user role with permissions
// PERFORMANCE: Struct field alignment optimized for memory efficiency
type Role struct {
	// Large fields first
	Permissions []string `json:"permissions" db:"permissions"` // Permission IDs

	// Strings (16 bytes each header)
	Name        string `json:"name" db:"name"`
	Description string `json:"description" db:"description"`

	// UUID (16 bytes)
	ID string `json:"id" db:"id"`

	// Time fields (24 bytes each)
	CreatedAt time.Time `json:"created_at" db:"created_at"`
	UpdatedAt time.Time `json:"updated_at" db:"updated_at"`

	// String field
	Category string `json:"category" db:"category"` // player, admin, system

	// Integer and boolean fields
	Level     int  `json:"level" db:"level"`      // Role hierarchy level
	IsActive  bool `json:"is_active" db:"is_active"`
	IsDefault bool `json:"is_default" db:"is_default"`
}

// AuditLog represents a security audit log entry
// PERFORMANCE: Struct field alignment optimized for memory efficiency
type AuditLog struct {
	// Large strings first
	UserID      string `json:"user_id" db:"user_id"`
	Action      string `json:"action" db:"action"`
	Resource    string `json:"resource" db:"resource"`
	ResourceID  string `json:"resource_id" db:"resource_id"`
	IPAddress   string `json:"ip_address" db:"ip_address"`
	UserAgent   string `json:"user_agent" db:"user_agent"`
	Details     string `json:"details" db:"details"` // JSON details

	// UUID (16 bytes)
	ID string `json:"id" db:"id"`

	// Time field (24 bytes)
	Timestamp time.Time `json:"timestamp" db:"timestamp"`

	// String field
	Result string `json:"result" db:"result"` // success, failure, blocked

	// Boolean field
	Suspicious bool `json:"suspicious" db:"suspicious"`
}

// RateLimit represents rate limiting data
// PERFORMANCE: Struct field alignment optimized for memory efficiency
type RateLimit struct {
	// Large strings first
	Identifier string `json:"identifier" db:"identifier"` // IP or user ID

	// Time fields (24 bytes each)
	WindowStart time.Time `json:"window_start" db:"window_start"`
	LastRequest time.Time `json:"last_request" db:"last_request"`

	// String field
	LimitType string `json:"limit_type" db:"limit_type"` // ip, user, endpoint

	// Integer fields (8 bytes each)
	RequestCount int `json:"request_count" db:"request_count"`
	LimitCount   int `json:"limit_count" db:"limit_count"`

	// Boolean field
	IsBlocked bool `json:"is_blocked" db:"is_blocked"`
}