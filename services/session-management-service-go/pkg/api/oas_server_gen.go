// Code generated by ogen, DO NOT EDIT.

package api

import (
	"context"
)

// Handler handles operations described by OpenAPI v3 specification.
type Handler interface {
	// BlockSession implements blockSession operation.
	//
	// Blocks a session due to suspicious activity.
	//
	// POST /security/sessions/{sessionId}/block
	BlockSession(ctx context.Context, req *BlockSessionRequest, params BlockSessionParams) (BlockSessionRes, error)
	// CleanupSessions implements cleanupSessions operation.
	//
	// Forces cleanup of expired sessions (admin operation).
	//
	// POST /sessions/cleanup
	CleanupSessions(ctx context.Context) (CleanupSessionsRes, error)
	// CreateSession implements createSession operation.
	//
	// Creates a new user session with automatic device fingerprinting.
	// **BACKEND NOTE:** Hot path - optimized for 5000+ RPS, zero allocations.
	//
	// POST /sessions
	CreateSession(ctx context.Context, req *CreateSessionRequest) (CreateSessionRes, error)
	// ExtendSession implements extendSession operation.
	//
	// Extends session lifetime without full recreation.
	//
	// POST /sessions/{sessionId}/extend
	ExtendSession(ctx context.Context, req OptExtendSessionRequest, params ExtendSessionParams) (ExtendSessionRes, error)
	// GetActiveSessions implements getActiveSessions operation.
	//
	// Retrieves all active sessions for the authenticated user.
	// **BACKEND NOTE:** Hot path - optimized for 5000+ RPS, zero allocations.
	//
	// GET /sessions/active
	GetActiveSessions(ctx context.Context, params GetActiveSessionsParams) (GetActiveSessionsRes, error)
	// GetSession implements getSession operation.
	//
	// Retrieves detailed information about a specific session.
	//
	// GET /sessions/{sessionId}
	GetSession(ctx context.Context, params GetSessionParams) (GetSessionRes, error)
	// GetSessionAnalytics implements getSessionAnalytics operation.
	//
	// Retrieves session usage analytics (admin operation).
	//
	// GET /analytics/sessions
	GetSessionAnalytics(ctx context.Context, params GetSessionAnalyticsParams) (GetSessionAnalyticsRes, error)
	// HealthCheck implements healthCheck operation.
	//
	// Service health check.
	//
	// GET /health
	HealthCheck(ctx context.Context) (*HealthResponse, error)
	// TerminateSession implements terminateSession operation.
	//
	// Terminates a session immediately.
	//
	// DELETE /sessions/{sessionId}
	TerminateSession(ctx context.Context, params TerminateSessionParams) (TerminateSessionRes, error)
	// UpdateSession implements updateSession operation.
	//
	// Updates session metadata or extends session lifetime.
	//
	// PUT /sessions/{sessionId}
	UpdateSession(ctx context.Context, req *UpdateSessionRequest, params UpdateSessionParams) (UpdateSessionRes, error)
	// ValidateSession implements validateSession operation.
	//
	// Validates session authenticity and freshness.
	// **BACKEND NOTE:** Hot path - optimized for 5000+ RPS, zero allocations.
	//
	// POST /sessions/{sessionId}/validate
	ValidateSession(ctx context.Context, params ValidateSessionParams) (ValidateSessionRes, error)
}

// Server implements http server based on OpenAPI v3 specification and
// calls Handler to handle requests.
type Server struct {
	h   Handler
	sec SecurityHandler
	baseServer
}

// NewServer creates new Server.
func NewServer(h Handler, sec SecurityHandler, opts ...ServerOption) (*Server, error) {
	s, err := newServerConfig(opts...).baseServer()
	if err != nil {
		return nil, err
	}
	return &Server{
		h:          h,
		sec:        sec,
		baseServer: s,
	}, nil
}
