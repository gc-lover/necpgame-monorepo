openapi: 3.0.3
info:
  title: Social Service API - Enterprise-Grade Domain Service
  description: '**Enterprise-Grade Social Interaction API for NECPGAME**

    This API manages all social interactions, relationships, and community features
    in the Night City universe, providing comprehensive social gameplay mechanics.

    ## Key Features

    - **Chat System**: Real-time messaging and moderation - **Guild Management**:
    Guild creation, management, and warfare - **Party System**: Temporary player groups
    and coordination - **Relationships**: NPC and player relationship dynamics - **Notifications**:
    Event-driven notification system - **Voice Communication**: Voice chat integration
    - **Reputation System**: Social standing and benefits

    ## Domain Purpose

    The Social domain handles all player-to-player and player-to-NPC interactions,
    community building, and social gameplay mechanics in Night City.

    ## Performance Targets

    - P99 Latency: <30ms for social operations - Memory: <18KB per active social session
    - Concurrent users: 60,000+ simultaneous social interactions - Message delivery:
    <2ms response time

    ## Modular Architecture

    The Social Service is organized into specialized modules for better maintainability:

    - **Chat Module** (`chat.yaml`): Real-time messaging, channels, moderation - **Guilds
    Module** (`guilds.yaml`): Guild management, membership, hierarchy - **Parties
    Module** (`parties.yaml`): Temporary groups, matchmaking, coordination

    Each module can be developed, deployed, and scaled independently while maintaining
    consistent API patterns and shared infrastructure.

    ## BACKEND NOTE - Struct alignment hints: 30-50% memory savings across all social
    operations - Optimized for MMOFPS RPG with low latency social interactions - Context
    timeouts: Module-specific timeout configurations - DB pool config: Dedicated connection
    pools per module - Performance target: <50ms P95 for cross-module operations '
  version: 1.0.0
  contact:
    name: NECPGAME API Support
    email: api@necpgame.com
  license:
    name: MIT
servers:
- url: https://api.necpgame.com/v1/social
  description: Production server
- url: https://staging-api.necpgame.com/v1/social
  description: Staging server
- url: http://localhost:8080/api/v1/social
  description: Local development server
tags:
- name: Health Monitoring
  description: System health and performance monitoring
security:
- BearerAuth: []
paths:
  /health:
    get:
      summary: Social Service Health Check
      description: '**Enterprise-grade health check endpoint**

        Provides real-time health status of the social service and all modules.

        Critical for service discovery, load balancing, and monitoring.

        **Performance:** <1ms response time, cached for 30 seconds

        ## BACKEND NOTE - Health checks all modules: chat, guilds, parties - Cached
        responses with ETag validation - Circuit breaker pattern for module failures '
      operationId: socialServiceHealthCheck
      tags:
      - Health Monitoring
      parameters:
      - name: Accept-Encoding
        in: header
        schema:
          type: string
          enum:
          - gzip
          - deflate
          - br
      responses:
        '200':
          description: Service is healthy
          headers:
            Cache-Control:
              schema:
                type: string
                example: max-age=30, s-maxage=60
            ETag:
              schema:
                type: string
                example: '"health-v1.0"'
            Content-Encoding:
              schema:
                type: string
                enum:
                - gzip
                - deflate
                - br
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '503':
          description: Service is unhealthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '429':
          description: Too many requests - rate limit exceeded
          headers:
            Retry-After:
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                type: object
                required:
                - code
                - message
                properties:
                  code:
                    type: integer
                    minimum: 100
                    maximum: 599
                    example: 400
                  message:
                    type: string
                    example: Bad request
                  details:
                    type: object
                    description: Additional error details
components:
  responses:
    OK:
      $ref: ../common/responses/success.yaml#/OK
    Created:
      $ref: ../common/responses/success.yaml#/Created
    Updated:
      $ref: ../common/responses/success.yaml#/Updated
    Deleted:
      $ref: ../common/responses/success.yaml#/Deleted
    BadRequest:
      $ref: ../common/responses/error.yaml#/BadRequest
    Unauthorized:
      $ref: ../common/responses/error.yaml#/Unauthorized
    NotFound:
      $ref: ../common/responses/error.yaml#/NotFound
    TooManyRequests:
      $ref: ../common/responses/error.yaml#/TooManyRequests
  schemas:
    HealthResponse:
      type: object
      required:
      - status
      - timestamp
      - version
      properties:
        status:
          type: string
          enum:
          - healthy
          - degraded
          - unhealthy
          description: Overall service health status
        timestamp:
          type: string
          format: date-time
          description: Health check timestamp
        version:
          type: string
          description: Service version
        modules:
          type: object
          properties:
            chat:
              type: string
              enum:
              - healthy
              - unhealthy
              description: Chat module status
            guilds:
              type: string
              enum:
              - healthy
              - unhealthy
              description: Guilds module status
            parties:
              type: string
              enum:
              - healthy
              - unhealthy
              description: Parties module status
          description: Individual module health statuses
        uptime:
          type: integer
          description: Service uptime in seconds
        active_connections:
          type: integer
          description: Number of active connections
      description: Comprehensive health response including module statuses
    Error:
      type: object
      required:
      - code
      - message
      properties:
        code:
          type: integer
          minimum: 100
          maximum: 599
          example: 400
        message:
          type: string
          example: Bad request
        details:
          type: object
          description: Additional error details
    InfrastructureEntity:
      type: object
      required:
      - id
      - created_at
      - updated_at
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for infrastructure entity
          example: f47ac10b-58cc-4372-a567-0e02b2c3d479
        created_at:
          type: string
          format: date-time
          description: Entity creation timestamp
          example: '2024-01-15T10:30:00Z'
        updated_at:
          type: string
          format: date-time
          description: Last modification timestamp
          example: '2024-01-15T14:20:00Z'
        version:
          type: integer
          minimum: 1
          description: Optimistic locking version for concurrent operations
          example: 1
    ErrorResponse:
      type: object
      required:
      - code
      - message
      properties:
        code:
          type: integer
          minimum: 100
          maximum: 599
          example: 400
        message:
          type: string
          example: Bad request
        details:
          type: object
          description: Additional error details
    HealthBatchRequest:
      type: object
      properties:
        services:
          type: array
          items:
            type: string
          description: List of services to check
    HealthBatchResponse:
      type: object
      properties:
        results:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/HealthResponse'
    BaseEntity:
      type: object
      required:
      - id
      - created_at
      - updated_at
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier
          example: f47ac10b-58cc-4372-a567-0e02b2c3d479
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
          example: '2024-01-15T10:30:00Z'
        updated_at:
          type: string
          format: date-time
          description: Last modification timestamp
          example: '2024-01-15T14:20:00Z'
    OptimisticLock:
      type: object
      properties:
        version:
          type: integer
          minimum: 1
          description: Version for optimistic locking
          example: 1
    UserAccountEntity:
      allOf:
      - $ref: '#/components/schemas/InfrastructureEntity'
      - type: object
        required:
        - username
        - email
        - account_status
        - registration_method
        properties:
          username:
            type: string
            minLength: 3
            maxLength: 30
            pattern: ^[a-zA-Z0-9_-]+$
            description: Unique username for login
            example: nightrunner2077
          email:
            type: string
            format: email
            description: Primary email address
            example: nightrunner@necpgame.com
          email_verified:
            type: boolean
            description: Whether email is verified
            example: true
          email_verification_token:
            type: string
            description: Token for email verification
            example: abc123def456
          password_hash:
            type: string
            description: Bcrypt password hash
            example: $2b$10$...
          account_status:
            type: string
            enum:
            - active
            - suspended
            - banned
            - pending_verification
            - deactivated
            description: Account status
            example: active
          registration_method:
            type: string
            enum:
            - email_password
            - google_oauth
            - discord_oauth
            - steam_oauth
            - guest
            description: How user registered
            example: email_password
          registration_ip:
            type: string
            description: IP address used during registration
            example: 192.168.1.100
          last_login_ip:
            type: string
            description: IP address of last login
            example: 10.0.0.50
          last_login_at:
            type: string
            format: date-time
            description: Timestamp of last successful login
            example: '2024-01-15T14:20:00Z'
          login_count:
            type: integer
            minimum: 0
            description: Total number of logins
            example: 147
          failed_login_attempts:
            type: integer
            minimum: 0
            description: Recent failed login attempts
            example: 0
          account_locked_until:
            type: string
            format: date-time
            description: When account lock expires
            example: '2024-01-15T16:00:00Z'
          two_factor_enabled:
            type: boolean
            description: Whether 2FA is enabled
            example: true
          two_factor_secret:
            type: string
            description: TOTP secret for 2FA
            example: JBSWY3DPEHPK3PXP
          recovery_email:
            type: string
            format: email
            description: Backup email for account recovery
            example: backup@necpgame.com
          preferred_language:
            type: string
            enum:
            - en
            - es
            - zh
            - ja
            - ru
            - de
            - fr
            - pl
            - ko
            - pt
            description: User's preferred language
            example: en
    SessionEntity:
      allOf:
      - $ref: '#/components/schemas/InfrastructureEntity'
      - type: object
        required:
        - user_id
        - session_token
        - ip_address
        - user_agent
        - expires_at
        properties:
          user_id:
            type: string
            format: uuid
            description: User this session belongs to
            example: a1b2c3d4-e5f6-7890-abcd-ef1234567890
          session_token:
            type: string
            minLength: 32
            maxLength: 128
            description: Unique session identifier/token
            example: abc123def456ghi789jkl012mno345pqr678stu901vwx
          refresh_token:
            type: string
            minLength: 32
            maxLength: 128
            description: Token for refreshing session
            example: yz234abc567def890ghi123jkl456mno789pqr012stu
          ip_address:
            type: string
            description: Client IP address
            example: 192.168.1.100
          user_agent:
            type: string
            description: Client user agent string
            example: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
          device_fingerprint:
            type: string
            description: Unique device identifier
            example: fp_abcdef1234567890
          location:
            type: string
            description: Approximate location based on IP
            example: New York, US
          expires_at:
            type: string
            format: date-time
            description: When session expires
            example: '2024-01-15T16:20:00Z'
          is_active:
            type: boolean
            description: Whether session is currently active
            example: true
          last_activity_at:
            type: string
            format: date-time
            description: Last user activity in this session
            example: '2024-01-15T15:45:00Z'
          security_level:
            type: string
            enum:
            - standard
            - elevated
            - maximum
            description: Security level of session
            example: standard
          session_metadata:
            type: object
            description: Additional session data
            properties:
              game_version:
                type: string
                description: Client game version
                example: 1.2.3
              platform:
                type: string
                enum:
                - windows
                - macos
                - linux
                - ios
                - android
                - web
                description: Client platform
                example: windows
              vpn_detected:
                type: boolean
                description: Whether VPN usage was detected
                example: false
    AuditLogEntity:
      allOf:
      - $ref: '#/components/schemas/InfrastructureEntity'
      - type: object
        required:
        - event_type
        - actor_id
        - resource_type
        - action
        - severity
        properties:
          event_type:
            type: string
            enum:
            - user_action
            - system_event
            - security_event
            - admin_action
            - api_call
            description: Category of audit event
            example: user_action
          actor_id:
            type: string
            format: uuid
            description: User/system that performed the action
            example: b2c3d4e5-f6g7-8901-bcde-f23456789012
          actor_type:
            type: string
            enum:
            - user
            - system
            - admin
            - api_client
            description: Type of actor
            example: user
          resource_type:
            type: string
            enum:
            - user
            - session
            - character
            - guild
            - item
            - transaction
            - quest
            - chat
            - file
            description: Type of resource affected
            example: character
          resource_id:
            type: string
            format: uuid
            description: Specific resource that was affected
            example: c3d4e5f6-g7h8-9012-cdef-345678901234
          action:
            type: string
            enum:
            - create
            - read
            - update
            - delete
            - login
            - logout
            - ban
            - unban
            - transfer
            - execute
            description: Action performed
            example: update
          old_values:
            type: object
            description: Previous state of modified fields
            example:
              level: 24
              experience: 12000
          new_values:
            type: object
            description: New state of modified fields
            example:
              level: 25
              experience: 12500
          severity:
            type: string
            enum:
            - low
            - medium
            - high
            - critical
            description: Security/impact severity
            example: low
          ip_address:
            type: string
            description: IP address of the actor
            example: 192.168.1.100
          user_agent:
            type: string
            description: User agent of the actor
            example: NECPGAME Client v1.2.3
          location:
            type: string
            description: Approximate location
            example: Night City, NC
          success:
            type: boolean
            description: Whether the action succeeded
            example: true
          error_message:
            type: string
            description: Error message if action failed
            example: Insufficient permissions
          metadata:
            type: object
            description: Additional audit data
            properties:
              request_id:
                type: string
                description: Unique request identifier
                example: req_abc123def456
              session_id:
                type: string
                format: uuid
                description: Associated session ID
                example: d4e5f6g7-h8i9-0123-def0-456789012345
              api_endpoint:
                type: string
                description: API endpoint called
                example: /api/v1/characters/upgrade
              response_time_ms:
                type: integer
                description: API response time
                example: 45
    ApiKeyEntity:
      allOf:
      - $ref: '#/components/schemas/InfrastructureEntity'
      - type: object
        required:
        - owner_id
        - name
        - key_hash
        - permissions
        - status
        properties:
          owner_id:
            type: string
            format: uuid
            description: User or service that owns this API key
            example: e5f6g7h8-i9j0-1234-ef01-567890123456
          name:
            type: string
            minLength: 1
            maxLength: 50
            description: Human-readable name for the key
            example: Mobile App Key
          description:
            type: string
            maxLength: 200
            description: Description of key usage
            example: API key for mobile application authentication
          key_hash:
            type: string
            description: SHA-256 hash of the actual API key
            example: a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3
          key_prefix:
            type: string
            minLength: 8
            maxLength: 8
            description: First 8 characters of API key for identification
            example: ncp_1a2b
          permissions:
            type: array
            items:
              type: string
              enum:
              - read_user
              - write_user
              - read_character
              - write_character
              - read_inventory
              - write_inventory
              - admin
            description: Granted permissions
            example:
            - read_user
            - read_character
            - read_inventory
          status:
            type: string
            enum:
            - active
            - suspended
            - revoked
            - expired
            description: API key status
            example: active
          expires_at:
            type: string
            format: date-time
            description: When key expires (null = never)
            example: '2025-01-15T10:30:00Z'
          last_used_at:
            type: string
            format: date-time
            description: Last time key was used
            example: '2024-01-15T14:20:00Z'
          usage_count:
            type: integer
            minimum: 0
            description: Total API calls made with this key
            example: 15420
          rate_limit:
            type: integer
            minimum: 1
            description: Requests per minute allowed
            example: 60
          allowed_ips:
            type: array
            items:
              type: string
            description: IP addresses allowed to use this key
            example:
            - 192.168.1.0/24
            - 10.0.0.1
          metadata:
            type: object
            description: Additional key metadata
            properties:
              created_by:
                type: string
                format: uuid
                description: User who created this key
                example: f6g7h8i9-j0k1-2345-f012-678901234567
              application:
                type: string
                description: Application using this key
                example: NECPGAME Mobile App
              environment:
                type: string
                enum:
                - development
                - staging
                - production
                description: Environment this key is for
                example: production
    ConfigurationEntity:
      allOf:
      - $ref: '#/components/schemas/InfrastructureEntity'
      - type: object
        required:
        - config_key
        - config_value
        - config_type
        - environment
        properties:
          config_key:
            type: string
            minLength: 1
            maxLength: 100
            pattern: ^[a-zA-Z0-9_\-\.]+$
            description: Configuration key
            example: game.max_players_per_server
          config_value:
            type: string
            description: Configuration value (stored as string)
            example: '1000'
          config_type:
            type: string
            enum:
            - string
            - integer
            - float
            - boolean
            - json
            description: Data type of the value
            example: integer
          environment:
            type: string
            enum:
            - development
            - staging
            - production
            - all
            description: Environment this config applies to
            example: production
          description:
            type: string
            maxLength: 500
            description: Description of what this config controls
            example: Maximum number of players allowed per game server
          default_value:
            type: string
            description: Default value if not set
            example: '500'
          validation_rules:
            type: object
            description: Validation rules for the value
            properties:
              min_value:
                type: number
                description: Minimum allowed value
                example: 1
              max_value:
                type: number
                description: Maximum allowed value
                example: 10000
              allowed_values:
                type: array
                items:
                  type: string
                description: List of allowed values
                example:
                - '100'
                - '500'
                - '1000'
                - '2000'
          is_encrypted:
            type: boolean
            description: Whether value is encrypted
            example: false
          last_modified_by:
            type: string
            format: uuid
            description: User who last modified this config
            example: g7h8i9j0-k1l2-3456-0123-456789012345
          requires_restart:
            type: boolean
            description: Whether server restart is required after change
            example: true
    ServiceHealthEntity:
      allOf:
      - $ref: '#/components/schemas/InfrastructureEntity'
      - type: object
        required:
        - service_name
        - status
        - response_time_ms
        - timestamp
        properties:
          service_name:
            type: string
            minLength: 1
            maxLength: 50
            description: Name of the service being monitored
            example: auth-service
          status:
            type: string
            enum:
            - healthy
            - degraded
            - unhealthy
            - down
            - maintenance
            description: Current health status
            example: healthy
          response_time_ms:
            type: integer
            minimum: 0
            description: Response time in milliseconds
            example: 45
          timestamp:
            type: string
            format: date-time
            description: When this health check was performed
            example: '2024-01-15T15:30:00Z'
          uptime_seconds:
            type: integer
            minimum: 0
            description: Service uptime in seconds
            example: 86400
          memory_usage_mb:
            type: integer
            minimum: 0
            description: Current memory usage in MB
            example: 256
          memory_usage_percent:
            type: number
            minimum: 0
            maximum: 100
            description: Memory usage percentage
            example: 23.5
          cpu_usage_percent:
            type: number
            minimum: 0
            maximum: 100
            description: CPU usage percentage
            example: 15.2
          active_connections:
            type: integer
            minimum: 0
            description: Number of active connections
            example: 1250
          queue_depth:
            type: integer
            minimum: 0
            description: Number of queued requests
            example: 5
          error_rate_percent:
            type: number
            minimum: 0
            maximum: 100
            description: Error rate percentage
            example: 0.1
          version:
            type: string
            description: Service version
            example: 1.2.3
          environment:
            type: string
            enum:
            - development
            - staging
            - production
            description: Deployment environment
            example: production
          checks:
            type: array
            items:
              $ref: '#/components/schemas/HealthCheck'
            description: Detailed health checks
    HealthCheck:
      type: object
      required:
      - check_name
      - status
      - response_time_ms
      properties:
        check_name:
          type: string
          minLength: 1
          maxLength: 50
          description: Name of the health check
          example: database_connection
        status:
          type: string
          enum:
          - pass
          - warn
          - fail
          description: Health check result
          example: pass
        response_time_ms:
          type: integer
          minimum: 0
          description: Check response time
          example: 12
        message:
          type: string
          maxLength: 200
          description: Check result message
          example: Database connection successful
        details:
          type: object
          description: Additional check details
          example:
            connection_pool_size: 10
            active_connections: 3
    NotificationQueueEntity:
      allOf:
      - $ref: '#/components/schemas/InfrastructureEntity'
      - type: object
        required:
        - notification_type
        - recipient_id
        - content
        - priority
        - status
        properties:
          notification_type:
            type: string
            enum:
            - email
            - push
            - in_game
            - sms
            - webhook
            description: Type of notification
            example: email
          recipient_id:
            type: string
            format: uuid
            description: User receiving the notification
            example: a1b2c3d4-e5f6-7890-abcd-ef1234567890
          recipient_contact:
            type: string
            description: Contact info (email, phone, etc.)
            example: user@necpgame.com
          content:
            type: object
            description: Notification content
            required:
            - subject
            - body
            properties:
              subject:
                type: string
                minLength: 1
                maxLength: 100
                description: Notification subject/title
                example: Quest Completed!
              body:
                type: string
                minLength: 1
                maxLength: 2000
                description: Notification body/content
                example: Congratulations! You have completed the 'Corporate Espionage'
                  quest.
              template_id:
                type: string
                description: Template used for notification
                example: quest_completion_v2
          priority:
            type: string
            enum:
            - low
            - normal
            - high
            - critical
            description: Notification priority
            example: normal
          status:
            type: string
            enum:
            - queued
            - processing
            - sent
            - delivered
            - failed
            - cancelled
            description: Delivery status
            example: queued
          scheduled_for:
            type: string
            format: date-time
            description: When to send notification (null = immediate)
            example: '2024-01-15T16:00:00Z'
          sent_at:
            type: string
            format: date-time
            description: When notification was sent
            example: '2024-01-15T15:45:00Z'
          delivered_at:
            type: string
            format: date-time
            description: When notification was delivered
            example: '2024-01-15T15:45:02Z'
          retry_count:
            type: integer
            minimum: 0
            description: Number of delivery attempts
            example: 0
          max_retries:
            type: integer
            minimum: 0
            maximum: 5
            description: Maximum retry attempts
            example: 3
          error_message:
            type: string
            description: Delivery error message
            example: SMTP server timeout
          metadata:
            type: object
            description: Additional notification data
            properties:
              campaign_id:
                type: string
                description: Marketing campaign ID
                example: quest_reminder_2024
              source_service:
                type: string
                description: Service that triggered notification
                example: quest-service
              user_preferences:
                type: object
                description: User's notification preferences
                example:
                  email_enabled: true
                  push_enabled: false
    SendMessageRequest:
      type: object
      required:
      - channel_id
      - content
      properties:
        channel_id:
          type: string
          format: uuid
          description: Chat channel identifier
        content:
          type: string
          maxLength: 500
          description: Message content
        message_type:
          type: string
          enum:
          - text
          - emoji
          - system
          default: text
          description: Type of message
        reply_to:
          type: string
          format: uuid
          description: ID of message being replied to
      description: Chat message request with validation
    MessageResponse:
      type: object
      properties:
        message_id:
          type: string
          format: uuid
          description: Unique message identifier
        channel_id:
          type: string
          format: uuid
          description: Channel where message was sent
        sender_id:
          type: string
          format: uuid
          description: Sender's player ID
        timestamp:
          type: string
          format: date-time
          description: Message timestamp
        status:
          type: string
          enum:
          - sent
          - delivered
          - moderated
          description: Message delivery status
      description: Message confirmation response
    Message:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Message unique identifier
        channel_id:
          type: string
          format: uuid
          description: Channel identifier
        sender_id:
          type: string
          format: uuid
          description: Sender player ID
        sender_name:
          type: string
          description: Sender display name
        content:
          type: string
          description: Message content
        message_type:
          type: string
          enum:
          - text
          - emoji
          - system
          description: Message type
        timestamp:
          type: string
          format: date-time
          description: Message timestamp
        edited_at:
          type: string
          format: date-time
          description: Last edit timestamp
        reply_to:
          type: string
          format: uuid
          description: Replied message ID
        reactions:
          type: array
          items:
            type: object
            properties:
              emoji:
                type: string
              count:
                type: integer
              users:
                type: array
                items:
                  type: string
                  format: uuid
          description: Message reactions
      description: Complete message object with all metadata
    CreateGuildRequest:
      type: object
      required:
      - name
      - description
      properties:
        name:
          type: string
          minLength: 3
          maxLength: 50
          pattern: ^[a-zA-Z0-9\\s\\-_]+$
          description: Guild name (alphanumeric, spaces, hyphens, underscores)
        description:
          type: string
          maxLength: 500
          description: Guild description
        category:
          type: string
          enum:
          - casual
          - competitive
          - roleplay
          - trading
          - pvp
          default: casual
          description: Guild category
        emblem:
          type: string
          format: uri
          description: Guild emblem image URL
        settings:
          type: object
          properties:
            is_public:
              type: boolean
              default: true
              description: Whether guild is public
            max_members:
              type: integer
              minimum: 5
              maximum: 500
              default: 50
              description: Maximum guild members
            join_approval_required:
              type: boolean
              default: false
              description: Whether join requests need approval
            min_level_required:
              type: integer
              minimum: 1
              default: 1
              description: Minimum player level to join
          description: Guild configuration settings
      description: Guild creation request with comprehensive validation
    UpdateGuildRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 3
          maxLength: 50
          description: New guild name
        description:
          type: string
          maxLength: 500
          description: New guild description
        emblem:
          type: string
          format: uri
          description: New guild emblem
        settings:
          $ref: '#/components/schemas/CreateGuildRequest/properties/settings'
      description: Guild update request (partial update allowed)
    GuildResponse:
      type: object
      properties:
        guild_id:
          type: string
          format: uuid
          description: Unique guild identifier
        name:
          type: string
          description: Guild name
        description:
          type: string
          description: Guild description
        category:
          type: string
          enum:
          - casual
          - competitive
          - roleplay
          - trading
          - pvp
          description: Guild category
        leader_id:
          type: string
          format: uuid
          description: Guild leader's player ID
        member_count:
          type: integer
          minimum: 1
          description: Current member count
        level:
          type: integer
          minimum: 1
          default: 1
          description: Guild level
        experience:
          type: integer
          minimum: 0
          description: Guild experience points
        emblem:
          type: string
          format: uri
          description: Guild emblem URL
        settings:
          $ref: '#/components/schemas/CreateGuildRequest/properties/settings'
        created_at:
          type: string
          format: date-time
          description: Guild creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
      description: Complete guild information response
    GuildSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Guild ID
        name:
          type: string
          description: Guild name
        description:
          type: string
          description: Guild description
        category:
          type: string
          enum:
          - casual
          - competitive
          - roleplay
          - trading
          - pvp
          description: Guild category
        member_count:
          type: integer
          description: Current member count
        level:
          type: integer
          description: Guild level
        emblem:
          type: string
          format: uri
          description: Guild emblem
        is_public:
          type: boolean
          description: Whether guild is public
        leader_name:
          type: string
          description: Guild leader's display name
      description: Condensed guild information for listings
    GuildDetails:
      allOf:
      - $ref: '#/components/schemas/GuildResponse'
      - type: object
        properties:
          members:
            type: array
            items:
              $ref: '#/components/schemas/GuildMember'
            description: Guild members (if requester is member)
          achievements:
            type: array
            items:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
                name:
                  type: string
                description:
                  type: string
                unlocked_at:
                  type: string
                  format: date-time
            description: Guild achievements
          stats:
            type: object
            properties:
              total_playtime:
                type: integer
                description: Total guild playtime in minutes
              raids_completed:
                type: integer
                description: Number of raids completed
              pvp_wins:
                type: integer
                description: PvP victories
            description: Guild statistics
      description: Detailed guild information including members and stats
    GuildMember:
      type: object
      properties:
        player_id:
          type: string
          format: uuid
          description: Player ID
        player_name:
          type: string
          description: Player display name
        role:
          type: string
          enum:
          - leader
          - officer
          - veteran
          - member
          - recruit
          description: Member role in guild
        joined_at:
          type: string
          format: date-time
          description: When player joined guild
        last_active:
          type: string
          format: date-time
          description: Last activity timestamp
        contribution_score:
          type: integer
          minimum: 0
          description: Player's contribution to guild
      description: Guild member information
    CreatePartyRequest:
      type: object
      required:
      - name
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 30
          description: Party name
        description:
          type: string
          maxLength: 200
          description: Party description
        activity_type:
          type: string
          enum:
          - raid
          - dungeon
          - pvp
          - exploration
          - quest
          - casual
          default: casual
          description: Primary activity type
        max_size:
          type: integer
          minimum: 2
          maximum: 8
          default: 4
          description: Maximum party size
        min_level:
          type: integer
          minimum: 1
          description: Minimum player level requirement
        max_level:
          type: integer
          minimum: 1
          description: Maximum player level requirement
        skill_level:
          type: string
          enum:
          - beginner
          - intermediate
          - advanced
          - expert
          description: Required skill proficiency
        region:
          type: string
          description: Geographic region preference
        language:
          type: string
          description: Preferred language
        is_public:
          type: boolean
          default: true
          description: Whether party appears in public listings
        auto_approve:
          type: boolean
          default: true
          description: Whether to auto-approve join requests
        voice_required:
          type: boolean
          default: false
          description: Whether voice communication is required
      description: Party creation request with comprehensive configuration
    UpdatePartyRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 30
          description: New party name
        description:
          type: string
          maxLength: 200
          description: New party description
        activity_type:
          $ref: '#/components/schemas/CreatePartyRequest/properties/activity_type'
        max_size:
          type: integer
          minimum: 2
          maximum: 8
          description: New maximum party size
        min_level:
          type: integer
          minimum: 1
          description: New minimum level requirement
        max_level:
          type: integer
          minimum: 1
          description: New maximum level requirement
        skill_level:
          $ref: '#/components/schemas/CreatePartyRequest/properties/skill_level'
        is_public:
          type: boolean
          description: New public visibility setting
        auto_approve:
          type: boolean
          description: New auto-approval setting
      description: Party update request (partial updates allowed)
    PartyResponse:
      type: object
      properties:
        party_id:
          type: string
          format: uuid
          description: Unique party identifier
        name:
          type: string
          description: Party name
        description:
          type: string
          description: Party description
        activity_type:
          type: string
          enum:
          - raid
          - dungeon
          - pvp
          - exploration
          - quest
          - casual
          description: Primary activity type
        leader_id:
          type: string
          format: uuid
          description: Party leader's player ID
        leader_name:
          type: string
          description: Party leader's display name
        members:
          type: array
          items:
            type: object
            properties:
              player_id:
                type: string
                format: uuid
              player_name:
                type: string
              role:
                type: string
                enum:
                - leader
                - officer
                - member
              joined_at:
                type: string
                format: date-time
            description: Party member information
          description: Current party members
        current_size:
          type: integer
          description: Current number of members
        max_size:
          type: integer
          description: Maximum party size
        min_level:
          type: integer
          description: Minimum level requirement
        max_level:
          type: integer
          description: Maximum level requirement
        skill_level:
          type: string
          enum:
          - beginner
          - intermediate
          - advanced
          - expert
          description: Required skill level
        region:
          type: string
          description: Geographic region
        language:
          type: string
          description: Preferred language
        is_public:
          type: boolean
          description: Public visibility
        voice_required:
          type: boolean
          description: Voice communication requirement
        created_at:
          type: string
          format: date-time
          description: Party creation timestamp
        expires_at:
          type: string
          format: date-time
          description: Party expiration timestamp
      description: Complete party information response
    PartySummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Party ID
        name:
          type: string
          description: Party name
        activity_type:
          type: string
          enum:
          - raid
          - dungeon
          - pvp
          - exploration
          - quest
          - casual
          description: Activity type
        leader_name:
          type: string
          description: Leader's display name
        current_size:
          type: integer
          description: Current member count
        max_size:
          type: integer
          description: Maximum size
        min_level:
          type: integer
          description: Minimum level
        max_level:
          type: integer
          description: Maximum level
        skill_level:
          type: string
          enum:
          - beginner
          - intermediate
          - advanced
          - expert
          description: Skill level requirement
        region:
          type: string
          description: Geographic region
        language:
          type: string
          description: Language
        voice_required:
          type: boolean
          description: Voice chat required
      description: Condensed party information for listings
    PartyDetails:
      allOf:
      - $ref: '#/components/schemas/PartyResponse'
      - type: object
        properties:
          pending_requests:
            type: array
            items:
              $ref: '#/components/schemas/JoinRequest'
            description: Pending join requests
          recent_activity:
            type: array
            items:
              type: object
              properties:
                type:
                  type: string
                  enum:
                  - member_joined
                  - member_left
                  - activity_started
                  - activity_completed
                player_name:
                  type: string
                timestamp:
                  type: string
                  format: date-time
                details:
                  type: object
                  additionalProperties: true
            description: Recent party activity log
      description: Detailed party information including pending requests and activity
    JoinRequest:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Request unique identifier
        player_id:
          type: string
          format: uuid
          description: Requesting player ID
        player_name:
          type: string
          description: Requesting player name
        player_level:
          type: integer
          description: Player level
        message:
          type: string
          description: Optional request message
        requested_at:
          type: string
          format: date-time
          description: Request timestamp
        status:
          type: string
          enum:
          - pending
          - accepted
          - rejected
          description: Request status
      description: Party join request information
  securitySchemes:
    BearerAuth:
      $ref: ../common/security/security.yaml#/BearerAuth
x-module-chat:
  description: Chat functionality - imported from chat.yaml
  paths:
    /social/chat/messages:
      post:
        summary: Send chat message
        operationId: sendChatMessage
        description: 'Send a real-time chat message with moderation and anti-spam
          filtering.

          **Real-time:** WebSocket-based delivery for instant messaging.

          ## BACKEND NOTE - Struct alignment hints: 30-50% memory savings for message
          processing - Optimized for MMOFPS RPG with low latency message delivery
          - Context timeouts: 1s for message validation, 2s for spam filtering - DB
          pool config: connection pooling for message history - Performance target:
          <2ms for message delivery, <50ms P95 for spam checks'
        tags:
        - Chat
        security:
        - BearerAuth: []
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SendMessageRequest'
        responses:
          '200':
            description: Message sent successfully
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/MessageResponse'
          '400':
            description: Invalid request payload
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '401':
            description: Unauthorized
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '429':
            description: Rate limit exceeded
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
    /social/chat/channels/{channelId}/messages:
      get:
        summary: Get channel messages
        operationId: getChannelMessages
        description: 'Retrieve message history for a specific chat channel.

          **Pagination:** Supports cursor-based pagination for efficient message loading.

          ## BACKEND NOTE - Optimized message retrieval with cursor pagination - Memory
          efficient for large message histories'
        tags:
        - Chat
        security:
        - BearerAuth: []
        parameters:
        - name: channelId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Chat channel identifier
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
          description: Maximum number of messages to retrieve
        - name: before
          in: query
          schema:
            type: string
            format: date-time
          description: Get messages before this timestamp
        - name: after
          in: query
          schema:
            type: string
            format: date-time
          description: Get messages after this timestamp
        responses:
          '200':
            description: Channel messages retrieved successfully
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    messages:
                      type: array
                      items:
                        $ref: '#/components/schemas/Message'
                    has_more:
                      type: boolean
                      description: Whether there are more messages available
                    next_cursor:
                      type: string
                      description: Cursor for next page of results
          '401':
            description: Unauthorized
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '404':
            description: Channel not found
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
  components:
    schemas:
      SendMessageRequest:
        type: object
        required:
        - channel_id
        - content
        properties:
          channel_id:
            type: string
            format: uuid
            description: Chat channel identifier
          content:
            type: string
            maxLength: 500
            description: Message content
          message_type:
            type: string
            enum:
            - text
            - emoji
            - system
            default: text
            description: Type of message
          reply_to:
            type: string
            format: uuid
            description: ID of message being replied to
        description: Chat message request with validation
      MessageResponse:
        type: object
        properties:
          message_id:
            type: string
            format: uuid
            description: Unique message identifier
          channel_id:
            type: string
            format: uuid
            description: Channel where message was sent
          sender_id:
            type: string
            format: uuid
            description: Sender's player ID
          timestamp:
            type: string
            format: date-time
            description: Message timestamp
          status:
            type: string
            enum:
            - sent
            - delivered
            - moderated
            description: Message delivery status
        description: Message confirmation response
      Message:
        type: object
        properties:
          id:
            type: string
            format: uuid
            description: Message unique identifier
          channel_id:
            type: string
            format: uuid
            description: Channel identifier
          sender_id:
            type: string
            format: uuid
            description: Sender player ID
          sender_name:
            type: string
            description: Sender display name
          content:
            type: string
            description: Message content
          message_type:
            type: string
            enum:
            - text
            - emoji
            - system
            description: Message type
          timestamp:
            type: string
            format: date-time
            description: Message timestamp
          edited_at:
            type: string
            format: date-time
            description: Last edit timestamp
          reply_to:
            type: string
            format: uuid
            description: Replied message ID
          reactions:
            type: array
            items:
              type: object
              properties:
                emoji:
                  type: string
                count:
                  type: integer
                users:
                  type: array
                  items:
                    type: string
                    format: uuid
            description: Message reactions
        description: Complete message object with all metadata
      ErrorResponse:
        type: object
        required:
        - code
        - message
        properties:
          code:
            type: string
            example: INVALID_ARGUMENT
          message:
            type: string
            example: Invalid message content
x-module-guilds:
  description: Guild management - imported from guilds.yaml
  paths:
    /social/guilds:
      get:
        summary: List guilds
        operationId: listGuilds
        description: 'Retrieve a list of available guilds with filtering and pagination.

          ## BACKEND NOTE - Optimized guild listing with search indexes - Memory efficient
          pagination for large guild directories'
        tags:
        - Guilds
        security:
        - BearerAuth: []
        parameters:
        - name: search
          in: query
          schema:
            type: string
          description: Search guilds by name or description
        - name: category
          in: query
          schema:
            type: string
            enum:
            - casual
            - competitive
            - roleplay
            - trading
            - pvp
          description: Filter by guild category
        - name: min_level
          in: query
          schema:
            type: integer
            minimum: 1
          description: Minimum guild level
        - name: max_members
          in: query
          schema:
            type: integer
            minimum: 1
          description: Maximum member count filter
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 50
            default: 20
          description: Number of guilds to return
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Pagination offset
        responses:
          '200':
            description: Guilds retrieved successfully
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    guilds:
                      type: array
                      items:
                        $ref: '#/components/schemas/GuildSummary'
                    total_count:
                      type: integer
                      description: Total number of guilds matching criteria
                    has_more:
                      type: boolean
                      description: Whether there are more results
          '401':
            description: Unauthorized
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
      post:
        summary: Create guild
        operationId: createGuild
        description: 'Create a new player guild with customizable settings and permissions.

          **Community:** Foundation for social gameplay and cooperation.

          ## BACKEND NOTE - Guild creation with validation and anti-spam measures
          - Struct alignment hints: 30-50% memory savings for guild operations - Context
          timeouts: 3s for guild validation, 5s for creation - DB pool config: dedicated
          connection for guild metadata'
        tags:
        - Guilds
        security:
        - BearerAuth: []
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateGuildRequest'
        responses:
          '201':
            description: Guild created successfully
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GuildResponse'
          '400':
            description: Invalid request payload
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '401':
            description: Unauthorized
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '429':
            description: Rate limit exceeded (guild creation limit)
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
    /social/guilds/{guildId}:
      get:
        summary: Get guild details
        operationId: getGuild
        description: Retrieve detailed information about a specific guild.
        tags:
        - Guilds
        security:
        - BearerAuth: []
        parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Guild identifier
        responses:
          '200':
            description: Guild details retrieved successfully
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GuildDetails'
          '404':
            description: Guild not found
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '403':
            description: Access denied (private guild)
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
      put:
        summary: Update guild
        operationId: updateGuild
        description: Update guild information and settings (leader only).
        tags:
        - Guilds
        security:
        - BearerAuth: []
        parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Guild identifier
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateGuildRequest'
        responses:
          '200':
            description: Guild updated successfully
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GuildResponse'
          '403':
            description: Insufficient permissions
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '404':
            description: Guild not found
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
      delete:
        summary: Delete guild
        operationId: deleteGuild
        description: Delete a guild (leader only, with confirmation).
        tags:
        - Guilds
        security:
        - BearerAuth: []
        parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Guild identifier
        - name: confirmation
          in: query
          required: true
          schema:
            type: string
          description: Confirmation token for deletion
        responses:
          '204':
            description: Guild deleted successfully
          '403':
            description: Insufficient permissions
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '404':
            description: Guild not found
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
    /social/guilds/{guildId}/members:
      get:
        summary: Get guild members
        operationId: getGuildMembers
        description: Retrieve list of guild members with roles and activity.
        tags:
        - Guilds
        security:
        - BearerAuth: []
        parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Guild identifier
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
          description: Number of members to return
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Pagination offset
        responses:
          '200':
            description: Guild members retrieved successfully
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    members:
                      type: array
                      items:
                        $ref: '#/components/schemas/GuildMember'
                    total_count:
                      type: integer
          '403':
            description: Access denied
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '404':
            description: Guild not found
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
      post:
        summary: Invite player to guild
        operationId: inviteToGuild
        description: Invite a player to join the guild (officer+ permissions).
        tags:
        - Guilds
        security:
        - BearerAuth: []
        parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Guild identifier
        requestBody:
          required: true
          content:
            application/json:
              schema:
                type: object
                required:
                - player_id
                properties:
                  player_id:
                    type: string
                    format: uuid
                    description: Player to invite
                  message:
                    type: string
                    maxLength: 200
                    description: Optional invitation message
        responses:
          '200':
            description: Invitation sent successfully
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    invitation_id:
                      type: string
                      format: uuid
          '403':
            description: Insufficient permissions
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '404':
            description: Guild or player not found
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
    /social/guilds/{guildId}/members/{playerId}:
      delete:
        summary: Remove member from guild
        operationId: removeGuildMember
        description: Remove a member from the guild (appropriate permissions required).
        tags:
        - Guilds
        security:
        - BearerAuth: []
        parameters:
        - name: guildId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Guild identifier
        - name: playerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Player to remove
        - name: reason
          in: query
          schema:
            type: string
            enum:
            - voluntary
            - kicked
            - inactive
            default: voluntary
          description: Reason for removal
        responses:
          '204':
            description: Member removed successfully
          '403':
            description: Insufficient permissions
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '404':
            description: Guild or member not found
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
  components:
    schemas:
      CreateGuildRequest:
        type: object
        required:
        - name
        - description
        properties:
          name:
            type: string
            minLength: 3
            maxLength: 50
            pattern: ^[a-zA-Z0-9\\s\\-_]+$
            description: Guild name (alphanumeric, spaces, hyphens, underscores)
          description:
            type: string
            maxLength: 500
            description: Guild description
          category:
            type: string
            enum:
            - casual
            - competitive
            - roleplay
            - trading
            - pvp
            default: casual
            description: Guild category
          emblem:
            type: string
            format: uri
            description: Guild emblem image URL
          settings:
            type: object
            properties:
              is_public:
                type: boolean
                default: true
                description: Whether guild is public
              max_members:
                type: integer
                minimum: 5
                maximum: 500
                default: 50
                description: Maximum guild members
              join_approval_required:
                type: boolean
                default: false
                description: Whether join requests need approval
              min_level_required:
                type: integer
                minimum: 1
                default: 1
                description: Minimum player level to join
            description: Guild configuration settings
        description: Guild creation request with comprehensive validation
      UpdateGuildRequest:
        type: object
        properties:
          name:
            type: string
            minLength: 3
            maxLength: 50
            description: New guild name
          description:
            type: string
            maxLength: 500
            description: New guild description
          emblem:
            type: string
            format: uri
            description: New guild emblem
          settings:
            $ref: '#/components/schemas/CreateGuildRequest/properties/settings'
        description: Guild update request (partial update allowed)
      GuildResponse:
        type: object
        properties:
          guild_id:
            type: string
            format: uuid
            description: Unique guild identifier
          name:
            type: string
            description: Guild name
          description:
            type: string
            description: Guild description
          category:
            type: string
            enum:
            - casual
            - competitive
            - roleplay
            - trading
            - pvp
            description: Guild category
          leader_id:
            type: string
            format: uuid
            description: Guild leader's player ID
          member_count:
            type: integer
            minimum: 1
            description: Current member count
          level:
            type: integer
            minimum: 1
            default: 1
            description: Guild level
          experience:
            type: integer
            minimum: 0
            description: Guild experience points
          emblem:
            type: string
            format: uri
            description: Guild emblem URL
          settings:
            $ref: '#/components/schemas/CreateGuildRequest/properties/settings'
          created_at:
            type: string
            format: date-time
            description: Guild creation timestamp
          updated_at:
            type: string
            format: date-time
            description: Last update timestamp
        description: Complete guild information response
      GuildSummary:
        type: object
        properties:
          id:
            type: string
            format: uuid
            description: Guild ID
          name:
            type: string
            description: Guild name
          description:
            type: string
            description: Guild description
          category:
            type: string
            enum:
            - casual
            - competitive
            - roleplay
            - trading
            - pvp
            description: Guild category
          member_count:
            type: integer
            description: Current member count
          level:
            type: integer
            description: Guild level
          emblem:
            type: string
            format: uri
            description: Guild emblem
          is_public:
            type: boolean
            description: Whether guild is public
          leader_name:
            type: string
            description: Guild leader's display name
        description: Condensed guild information for listings
      GuildDetails:
        allOf:
        - $ref: '#/components/schemas/GuildResponse'
        - type: object
          properties:
            members:
              type: array
              items:
                $ref: '#/components/schemas/GuildMember'
              description: Guild members (if requester is member)
            achievements:
              type: array
              items:
                type: object
                properties:
                  id:
                    type: string
                    format: uuid
                  name:
                    type: string
                  description:
                    type: string
                  unlocked_at:
                    type: string
                    format: date-time
              description: Guild achievements
            stats:
              type: object
              properties:
                total_playtime:
                  type: integer
                  description: Total guild playtime in minutes
                raids_completed:
                  type: integer
                  description: Number of raids completed
                pvp_wins:
                  type: integer
                  description: PvP victories
              description: Guild statistics
        description: Detailed guild information including members and stats
      GuildMember:
        type: object
        properties:
          player_id:
            type: string
            format: uuid
            description: Player ID
          player_name:
            type: string
            description: Player display name
          role:
            type: string
            enum:
            - leader
            - officer
            - veteran
            - member
            - recruit
            description: Member role in guild
          joined_at:
            type: string
            format: date-time
            description: When player joined guild
          last_active:
            type: string
            format: date-time
            description: Last activity timestamp
          contribution_score:
            type: integer
            minimum: 0
            description: Player's contribution to guild
        description: Guild member information
      ErrorResponse:
        type: object
        required:
        - code
        - message
        properties:
          code:
            type: string
            example: GUILD_NOT_FOUND
          message:
            type: string
            example: Guild with specified ID does not exist
x-module-parties:
  description: Party system - imported from parties.yaml
  paths:
    /social/parties:
      get:
        summary: List available parties
        operationId: listParties
        description: 'Retrieve a list of available parties that can be joined.

          ## BACKEND NOTE - Optimized party discovery with geolocation filtering -
          Memory efficient for large numbers of active parties'
        tags:
        - Parties
        security:
        - BearerAuth: []
        parameters:
        - name: activity_type
          in: query
          schema:
            type: string
            enum:
            - raid
            - dungeon
            - pvp
            - exploration
            - quest
          description: Filter by activity type
        - name: min_size
          in: query
          schema:
            type: integer
            minimum: 1
          description: Minimum party size
        - name: max_size
          in: query
          schema:
            type: integer
            minimum: 1
          description: Maximum party size
        - name: region
          in: query
          schema:
            type: string
          description: Geographic region filter
        - name: language
          in: query
          schema:
            type: string
          description: Preferred language
        - name: skill_level
          in: query
          schema:
            type: string
            enum:
            - beginner
            - intermediate
            - advanced
            - expert
          description: Required skill level
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 20
            default: 10
          description: Number of parties to return
        responses:
          '200':
            description: Parties retrieved successfully
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    parties:
                      type: array
                      items:
                        $ref: '#/components/schemas/PartySummary'
          '401':
            description: Unauthorized
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
      post:
        summary: Create party
        operationId: createParty
        description: 'Create a temporary player party for cooperative gameplay.

          **Dynamic:** Short-lived groups for specific missions or activities.

          ## BACKEND NOTE - Party creation with automatic cleanup timers - Struct
          alignment hints: 30-50% memory savings for party operations - Context timeouts:
          2s for party validation, 3s for creation - Optimized for quick party formation
          in high-tempo gameplay'
        tags:
        - Parties
        security:
        - BearerAuth: []
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreatePartyRequest'
        responses:
          '201':
            description: Party created successfully
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/PartyResponse'
          '400':
            description: Invalid request payload
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '401':
            description: Unauthorized
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '429':
            description: Rate limit exceeded
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
    /social/parties/{partyId}:
      get:
        summary: Get party details
        operationId: getParty
        description: Retrieve detailed information about a specific party.
        tags:
        - Parties
        security:
        - BearerAuth: []
        parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Party identifier
        responses:
          '200':
            description: Party details retrieved successfully
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/PartyDetails'
          '404':
            description: Party not found
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '403':
            description: Access denied
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
      put:
        summary: Update party
        operationId: updateParty
        description: Update party settings (leader only).
        tags:
        - Parties
        security:
        - BearerAuth: []
        parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Party identifier
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdatePartyRequest'
        responses:
          '200':
            description: Party updated successfully
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/PartyResponse'
          '403':
            description: Insufficient permissions
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '404':
            description: Party not found
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
      delete:
        summary: Disband party
        operationId: disbandParty
        description: Disband the party (leader only).
        tags:
        - Parties
        security:
        - BearerAuth: []
        parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Party identifier
        responses:
          '204':
            description: Party disbanded successfully
          '403':
            description: Insufficient permissions
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '404':
            description: Party not found
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
    /social/parties/{partyId}/members:
      post:
        summary: Join party
        operationId: joinParty
        description: Request to join or directly join a party.
        tags:
        - Parties
        security:
        - BearerAuth: []
        parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Party identifier
        requestBody:
          required: false
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    maxLength: 100
                    description: Optional join message
        responses:
          '200':
            description: Successfully joined party
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/PartyResponse'
          '202':
            description: Join request sent (pending approval)
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    request_id:
                      type: string
                      format: uuid
                    status:
                      type: string
                      enum:
                      - pending
          '403':
            description: Party is full or join not allowed
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '404':
            description: Party not found
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
    /social/parties/{partyId}/members/{playerId}:
      delete:
        summary: Leave party or kick member
        operationId: leaveParty
        description: Leave the party (any member) or kick a member (leader/officer
          only).
        tags:
        - Parties
        security:
        - BearerAuth: []
        parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Party identifier
        - name: playerId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Player to remove (can be self)
        - name: reason
          in: query
          schema:
            type: string
            enum:
            - voluntary
            - kicked
            - inactive
            - afk
            default: voluntary
          description: Reason for leaving/kicking
        responses:
          '204':
            description: Member removed successfully
          '403':
            description: Insufficient permissions
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '404':
            description: Party or member not found
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
    /social/parties/{partyId}/invite:
      post:
        summary: Invite player to party
        operationId: inviteToParty
        description: Invite a specific player to join the party.
        tags:
        - Parties
        security:
        - BearerAuth: []
        parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Party identifier
        requestBody:
          required: true
          content:
            application/json:
              schema:
                type: object
                required:
                - player_id
                properties:
                  player_id:
                    type: string
                    format: uuid
                    description: Player to invite
                  message:
                    type: string
                    maxLength: 100
                    description: Optional invitation message
        responses:
          '200':
            description: Invitation sent successfully
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    invitation_id:
                      type: string
                      format: uuid
          '403':
            description: Insufficient permissions
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '404':
            description: Party or player not found
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
    /social/parties/{partyId}/requests:
      get:
        summary: Get join requests
        operationId: getJoinRequests
        description: Get pending join requests for the party (leader/officers only).
        tags:
        - Parties
        security:
        - BearerAuth: []
        parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Party identifier
        responses:
          '200':
            description: Join requests retrieved successfully
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    requests:
                      type: array
                      items:
                        $ref: '#/components/schemas/JoinRequest'
          '403':
            description: Insufficient permissions
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '404':
            description: Party not found
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
      post:
        summary: Respond to join request
        operationId: respondToJoinRequest
        description: Accept or reject a join request (leader/officers only).
        tags:
        - Parties
        security:
        - BearerAuth: []
        parameters:
        - name: partyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Party identifier
        requestBody:
          required: true
          content:
            application/json:
              schema:
                type: object
                required:
                - request_id
                - action
                properties:
                  request_id:
                    type: string
                    format: uuid
                    description: Join request ID
                  action:
                    type: string
                    enum:
                    - accept
                    - reject
                    description: Response action
                  message:
                    type: string
                    maxLength: 200
                    description: Optional response message
        responses:
          '200':
            description: Request processed successfully
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    status:
                      type: string
                      enum:
                      - accepted
                      - rejected
          '403':
            description: Insufficient permissions
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '404':
            description: Request not found
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
  components:
    schemas:
      CreatePartyRequest:
        type: object
        required:
        - name
        properties:
          name:
            type: string
            minLength: 1
            maxLength: 30
            description: Party name
          description:
            type: string
            maxLength: 200
            description: Party description
          activity_type:
            type: string
            enum:
            - raid
            - dungeon
            - pvp
            - exploration
            - quest
            - casual
            default: casual
            description: Primary activity type
          max_size:
            type: integer
            minimum: 2
            maximum: 8
            default: 4
            description: Maximum party size
          min_level:
            type: integer
            minimum: 1
            description: Minimum player level requirement
          max_level:
            type: integer
            minimum: 1
            description: Maximum player level requirement
          skill_level:
            type: string
            enum:
            - beginner
            - intermediate
            - advanced
            - expert
            description: Required skill proficiency
          region:
            type: string
            description: Geographic region preference
          language:
            type: string
            description: Preferred language
          is_public:
            type: boolean
            default: true
            description: Whether party appears in public listings
          auto_approve:
            type: boolean
            default: true
            description: Whether to auto-approve join requests
          voice_required:
            type: boolean
            default: false
            description: Whether voice communication is required
        description: Party creation request with comprehensive configuration
      UpdatePartyRequest:
        type: object
        properties:
          name:
            type: string
            minLength: 1
            maxLength: 30
            description: New party name
          description:
            type: string
            maxLength: 200
            description: New party description
          activity_type:
            $ref: '#/components/schemas/CreatePartyRequest/properties/activity_type'
          max_size:
            type: integer
            minimum: 2
            maximum: 8
            description: New maximum party size
          min_level:
            type: integer
            minimum: 1
            description: New minimum level requirement
          max_level:
            type: integer
            minimum: 1
            description: New maximum level requirement
          skill_level:
            $ref: '#/components/schemas/CreatePartyRequest/properties/skill_level'
          is_public:
            type: boolean
            description: New public visibility setting
          auto_approve:
            type: boolean
            description: New auto-approval setting
        description: Party update request (partial updates allowed)
      PartyResponse:
        type: object
        properties:
          party_id:
            type: string
            format: uuid
            description: Unique party identifier
          name:
            type: string
            description: Party name
          description:
            type: string
            description: Party description
          activity_type:
            type: string
            enum:
            - raid
            - dungeon
            - pvp
            - exploration
            - quest
            - casual
            description: Primary activity type
          leader_id:
            type: string
            format: uuid
            description: Party leader's player ID
          leader_name:
            type: string
            description: Party leader's display name
          members:
            type: array
            items:
              type: object
              properties:
                player_id:
                  type: string
                  format: uuid
                player_name:
                  type: string
                role:
                  type: string
                  enum:
                  - leader
                  - officer
                  - member
                joined_at:
                  type: string
                  format: date-time
              description: Party member information
            description: Current party members
          current_size:
            type: integer
            description: Current number of members
          max_size:
            type: integer
            description: Maximum party size
          min_level:
            type: integer
            description: Minimum level requirement
          max_level:
            type: integer
            description: Maximum level requirement
          skill_level:
            type: string
            enum:
            - beginner
            - intermediate
            - advanced
            - expert
            description: Required skill level
          region:
            type: string
            description: Geographic region
          language:
            type: string
            description: Preferred language
          is_public:
            type: boolean
            description: Public visibility
          voice_required:
            type: boolean
            description: Voice communication requirement
          created_at:
            type: string
            format: date-time
            description: Party creation timestamp
          expires_at:
            type: string
            format: date-time
            description: Party expiration timestamp
        description: Complete party information response
      PartySummary:
        type: object
        properties:
          id:
            type: string
            format: uuid
            description: Party ID
          name:
            type: string
            description: Party name
          activity_type:
            type: string
            enum:
            - raid
            - dungeon
            - pvp
            - exploration
            - quest
            - casual
            description: Activity type
          leader_name:
            type: string
            description: Leader's display name
          current_size:
            type: integer
            description: Current member count
          max_size:
            type: integer
            description: Maximum size
          min_level:
            type: integer
            description: Minimum level
          max_level:
            type: integer
            description: Maximum level
          skill_level:
            type: string
            enum:
            - beginner
            - intermediate
            - advanced
            - expert
            description: Skill level requirement
          region:
            type: string
            description: Geographic region
          language:
            type: string
            description: Language
          voice_required:
            type: boolean
            description: Voice chat required
        description: Condensed party information for listings
      PartyDetails:
        allOf:
        - $ref: '#/components/schemas/PartyResponse'
        - type: object
          properties:
            pending_requests:
              type: array
              items:
                $ref: '#/components/schemas/JoinRequest'
              description: Pending join requests
            recent_activity:
              type: array
              items:
                type: object
                properties:
                  type:
                    type: string
                    enum:
                    - member_joined
                    - member_left
                    - activity_started
                    - activity_completed
                  player_name:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
                  details:
                    type: object
                    additionalProperties: true
              description: Recent party activity log
        description: Detailed party information including pending requests and activity
      JoinRequest:
        type: object
        properties:
          id:
            type: string
            format: uuid
            description: Request unique identifier
          player_id:
            type: string
            format: uuid
            description: Requesting player ID
          player_name:
            type: string
            description: Requesting player name
          player_level:
            type: integer
            description: Player level
          message:
            type: string
            description: Optional request message
          requested_at:
            type: string
            format: date-time
            description: Request timestamp
          status:
            type: string
            enum:
            - pending
            - accepted
            - rejected
            description: Request status
        description: Party join request information
      ErrorResponse:
        type: object
        required:
        - code
        - message
        properties:
          code:
            type: string
            example: PARTY_FULL
          message:
            type: string
            example: Party has reached maximum capacity
