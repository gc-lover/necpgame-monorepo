openapi: 3.0.3
info:
  title: Quest System API
  description: |
    **Enterprise-Grade Quest Management API for NECPGAME MMOFPS**

    Полная система управления квестами с enterprise-grade оптимизациями.
    Поддерживает динамические квесты, NPC взаимодействия, награды и прогрессию.

    ## Key Features
    - **Enterprise-grade quest management** с оптимизацией производительности
    - **Backend optimization hints** для struct alignment и memory savings
    - **Complete validation** с redocly и ogen code generation
    - **Security-first approach** с JWT authentication
    - **Performance-optimized** response structures
    - **Comprehensive error handling** с proper HTTP status codes

    ## Domain Purpose
    Quest System управляет всеми аспектами квестовой системы:
    создание квестов, отслеживание прогресса, награды, NPC диалоги, ветвление сюжета.

    ## Performance Targets
    - Hot paths: 1000+ RPS, P99 <15ms (quest status, progress updates)
    - Quest queries: <5ms average response time
    - Memory: <35MB per service instance
    - Cache hit rate: >95%
  version: 1.0.0
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  contact:
    name: NECPGAME Quests API Support
    url: https://necpgame.com/support
    email: api@quests.necpgame.com
servers:
  - url: http://localhost:8080/api/v1
    description: Development server
  - url: https://api.necpgame.com/api/v1
    description: Production server
security:
  - BearerAuth: []
tags:
  - name: Quests
    description: Quest management operations
  - name: Quest Progress
    description: Quest progress tracking
paths:
  /api/v1/quests/health:
    get:
      summary: Quest service health check
      operationId: questHealthCheck
      tags:
        - Quests
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
  /api/v1/quests/content/reload:
    post:
      summary: Импортировать контентный квест из YAML в БД
      operationId: reloadQuestContent
      tags:
        - Quests
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReloadQuestContentRequest'
      responses:
        '200':
          description: Квест успешно импортирован
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReloadQuestContentResponse'
        '400':
          description: Invalid quest data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/quests:
    get:
      summary: Get available quests
      operationId: getQuests
      tags:
        - Quests
      security:
        - BearerAuth: []
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum:
              - available
              - active
              - completed
              - failed
            default: available
          description: Filter by quest status
        - name: type
          in: query
          schema:
            type: string
            enum:
              - main_story
              - side_quest
              - daily
              - event
              - faction
          description: Filter by quest type
        - name: location_id
          in: query
          schema:
            type: string
            format: uuid
          description: Filter by location
        - name: level_min
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
          description: Minimum character level
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 50
            default: 20
          description: Maximum number of results
      responses:
        '200':
          description: Quests retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuestListResponse'
        '400':
          description: Invalid query parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/quests/{quest_id}:
    get:
      summary: Get quest details
      operationId: getQuest
      tags:
        - Quests
      security:
        - BearerAuth: []
      parameters:
        - name: quest_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Quest unique identifier
      responses:
        '200':
          description: Quest details retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuestDetailResponse'
        '404':
          description: Quest not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/quests/{quest_id}/accept:
    post:
      summary: Accept a quest
      operationId: acceptQuest
      tags:
        - Quests
      security:
        - BearerAuth: []
      parameters:
        - name: quest_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Quest to accept
      responses:
        '200':
          description: Quest accepted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuestProgressResponse'
        '400':
          description: Cannot accept quest
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Quest already active or completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/quests/{quest_id}/progress:
    get:
      summary: Get quest progress
      operationId: getQuestProgress
      tags:
        - Quest Progress
      security:
        - BearerAuth: []
      parameters:
        - name: quest_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Quest identifier
      responses:
        '200':
          description: Quest progress retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuestProgressResponse'
        '404':
          description: Quest not found or not active
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      summary: Update quest progress
      operationId: updateQuestProgress
      tags:
        - Quest Progress
      security:
        - BearerAuth: []
      parameters:
        - name: quest_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Quest identifier
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProgressRequest'
      responses:
        '200':
          description: Progress updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuestProgressResponse'
        '400':
          description: Invalid progress update
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Quest not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/quests/{quest_id}/complete:
    post:
      summary: Complete a quest
      operationId: completeQuest
      tags:
        - Quests
      security:
        - BearerAuth: []
      parameters:
        - name: quest_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Quest to complete
      responses:
        '200':
          description: Quest completed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuestCompletionResponse'
        '400':
          description: Cannot complete quest
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Quest not ready for completion
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/v1/seattle/quests:
    get:
      summary: Получить все квесты Сиэтла 2020-2029
      operationId: getSeattleQuests
      tags:
        - seattle-quests
      security:
        - BearerAuth: []
      parameters:
        - name: player_id
          in: query
          schema:
            type: string
            format: uuid
          description: ID игрока для фильтрации доступных квестов
        - name: status
          in: query
          schema:
            type: string
            enum:
              - available
              - in_progress
              - completed
              - failed
          description: Статус квеста
        - name: theme
          in: query
          schema:
            type: string
            enum:
              - landmarks
              - culture
              - technology
              - nature
              - food
          description: Тематика квеста
      responses:
        '200':
          description: Список квестов Сиэтла
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SeattleQuestsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/seattle/quests/{quest_id}:
    get:
      summary: Получить детали квеста Сиэтла
      operationId: getSeattleQuest
      tags:
        - seattle-quests
      security:
        - BearerAuth: []
      parameters:
        - name: quest_id
          in: path
          required: true
          schema:
            type: string
            enum:
              - space-needle
              - pike-place-market
              - starbucks-origin
              - grunge-music
              - amazon-hq
              - mount-rainier
              - rain-rain-rain
              - boeing-factory
              - seafood-salmon
              - tech-boom-gentrification
          description: ID квеста Сиэтла
        - name: include_lore
          in: query
          schema:
            type: boolean
            default: false
          description: Включить исторический лор
      responses:
        '200':
          description: Детали квеста
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SeattleQuestDetailResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/seattle/quests/{quest_id}/progress:
    get:
      summary: Получить прогресс игрока по квесту
      operationId: getSeattleQuestProgress
      tags:
        - quest-progress
      security:
        - BearerAuth: []
      parameters:
        - name: quest_id
          in: path
          required: true
          schema:
            type: string
            enum:
              - space-needle
              - pike-place-market
              - starbucks-origin
              - grunge-music
              - amazon-hq
              - mount-rainier
              - rain-rain-rain
              - boeing-factory
              - seafood-salmon
              - tech-boom-gentrification
        - name: player_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Прогресс по квесту
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/schemas-QuestProgressResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      summary: Обновить прогресс по квесту
      operationId: updateSeattleQuestProgress
      tags:
        - quest-progress
      security:
        - BearerAuth: []
      parameters:
        - name: quest_id
          in: path
          required: true
          schema:
            type: string
            enum:
              - space-needle
              - pike-place-market
              - starbucks-origin
              - grunge-music
              - amazon-hq
              - mount-rainier
              - rain-rain-rain
              - boeing-factory
              - seafood-salmon
              - tech-boom-gentrification
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateQuestProgressRequest'
      responses:
        '200':
          description: Прогресс обновлен
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateQuestProgressResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/seattle/quests/landmarks:
    get:
      summary: Получить достопримечательности Сиэтла
      operationId: getSeattleLandmarks
      tags:
        - landmarks
      security:
        - BearerAuth: []
      parameters:
        - name: category
          in: query
          schema:
            type: string
            enum:
              - architecture
              - nature
              - culture
              - technology
              - food
          description: Категория достопримечательности
        - name: quest_related
          in: query
          schema:
            type: boolean
            default: true
          description: Только связанные с квестами
      responses:
        '200':
          description: Достопримечательности Сиэтла
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SeattleLandmarksResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/seattle/quests/history/{year}:
    get:
      summary: Получить исторический контекст Сиэтла за год
      operationId: getSeattleHistory
      tags:
        - history
      security:
        - BearerAuth: []
      parameters:
        - name: year
          in: path
          required: true
          schema:
            type: integer
            minimum: 2020
            maximum: 2029
          description: Год (2020-2029)
        - name: focus
          in: query
          schema:
            type: string
            enum:
              - technology
              - culture
              - economy
              - environment
          description: Фокус исторического контекста
      responses:
        '200':
          description: Исторический контекст
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SeattleHistoryResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /api/v1/seattle/quests/routes:
    get:
      summary: Получить туристические маршруты по Сиэтлу
      operationId: getSeattleRoutes
      tags:
        - landmarks
      security:
        - BearerAuth: []
      parameters:
        - name: quest_id
          in: query
          schema:
            type: string
            enum:
              - space-needle
              - pike-place-market
              - starbucks-origin
              - grunge-music
              - amazon-hq
              - mount-rainier
              - rain-rain-rain
              - boeing-factory
              - seafood-salmon
              - tech-boom-gentrification
          description: Маршрут для конкретного квеста
        - name: difficulty
          in: query
          schema:
            type: string
            enum:
              - easy
              - medium
              - hard
            default: medium
          description: Сложность маршрута
      responses:
        '200':
          description: Туристические маршруты
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SeattleRoutesResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    Quest:
      type: object
      required:
        - id
        - title
        - type
        - status
        - created_at
      properties:
        id:
          type: string
          format: uuid
          description: Unique quest identifier
          example: 550e8400-e29b-41d4-a716-446655440000
        location_id:
          type: string
          format: uuid
          description: Associated location
        giver_npc_id:
          type: string
          format: uuid
          description: NPC who gives the quest
        title:
          type: string
          maxLength: 200
          description: Quest title
          example: Shadows of the Past
        description:
          type: string
          maxLength: 2000
          description: Detailed quest description
        type:
          type: string
          enum:
            - main_story
            - side_quest
            - daily
            - event
            - faction
          description: Quest type
          example: main_story
        status:
          type: string
          enum:
            - draft
            - available
            - active
            - completed
            - failed
            - expired
          description: Quest status
          example: available
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        prerequisites:
          type: array
          items:
            type: object
            required:
              - type
              - value
            properties:
              type:
                type: string
                enum:
                  - quest_completed
                  - level_minimum
                  - faction_reputation
                  - item_owned
              value:
                type: string
                description: Prerequisite value
        is_repeatable:
          type: boolean
          default: false
          description: Whether quest can be repeated
        level_requirement:
          type: integer
          minimum: 1
          maximum: 100
          description: Required character level
          example: 15
        time_limit_hours:
          type: integer
          minimum: 1
          description: Time limit in hours
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    QuestObjective:
      type: object
      required:
        - id
        - description
        - type
        - current_progress
        - target_progress
      properties:
        id:
          type: string
          format: uuid
          description: Objective identifier
        location_id:
          type: string
          format: uuid
          description: Associated location
        npc_id:
          type: string
          format: uuid
          description: Associated NPC
        item_id:
          type: string
          format: uuid
          description: Required item
        description:
          type: string
          maxLength: 500
          description: Objective description
        type:
          type: string
          enum:
            - kill
            - collect
            - explore
            - interact
            - deliver
            - escort
            - defend
          description: Objective type
        current_progress:
          type: integer
          minimum: 0
          description: Current progress value
        target_progress:
          type: integer
          minimum: 1
          description: Target progress value
    QuestReward:
      type: object
      properties:
        currency:
          type: object
          properties:
            amount:
              type: integer
              minimum: 0
            type:
              type: string
              enum:
                - eddies
                - tokens
                - reputation
              default: eddies
        faction_reputation:
          type: object
          description: Faction reputation changes
          additionalProperties:
            type: integer
            description: Reputation points (positive or negative)
        items:
          type: array
          items:
            type: object
            required:
              - item_id
              - quantity
            properties:
              item_id:
                type: string
                format: uuid
              quantity:
                type: integer
                minimum: 1
        experience_points:
          type: integer
          minimum: 0
          description: XP reward
    QuestDetailResponse:
      type: object
      required:
        - quest
        - objectives
        - rewards
      properties:
        quest:
          $ref: '#/components/schemas/Quest'
        rewards:
          $ref: '#/components/schemas/QuestReward'
        objectives:
          type: array
          items:
            $ref: '#/components/schemas/QuestObjective'
        dialogue_options:
          type: array
          items:
            type: object
            required:
              - text
              - action
            properties:
              text:
                type: string
                maxLength: 200
              action:
                type: string
                enum:
                  - accept
                  - decline
                  - ask_more_info
    QuestListResponse:
      type: object
      required:
        - quests
        - total_count
      properties:
        quests:
          type: array
          items:
            $ref: '#/components/schemas/Quest'
        has_more:
          type: boolean
          default: false
        total_count:
          type: integer
          minimum: 0
    QuestProgressResponse:
      type: object
      required:
        - quest_id
        - status
        - objectives
        - started_at
      properties:
        quest_id:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - active
            - completed
            - failed
        started_at:
          type: string
          format: date-time
        objectives:
          type: array
          items:
            $ref: '#/components/schemas/QuestObjective'
        time_remaining_seconds:
          type: integer
          minimum: 0
          description: Seconds until quest expires
    UpdateProgressRequest:
      type: object
      required:
        - objective_id
        - progress_increment
      properties:
        objective_id:
          type: string
          format: uuid
          description: Objective to update
        progress_increment:
          type: integer
          minimum: 1
          description: Amount to add to progress
    QuestCompletionResponse:
      type: object
      required:
        - quest_id
        - rewards_granted
        - completed_at
      properties:
        quest_id:
          type: string
          format: uuid
        next_quest_available:
          type: string
          format: uuid
          description: ID of next quest in chain
        completed_at:
          type: string
          format: date-time
        rewards_granted:
          $ref: '#/components/schemas/QuestReward'
    HealthResponse:
      type: object
      required:
        - status
        - service
        - timestamp
      properties:
        status:
          type: string
          enum:
            - healthy
            - degraded
            - unhealthy
          example: healthy
        service:
          type: string
          example: quests
        timestamp:
          type: string
          format: date-time
        version:
          type: string
          example: 1.0.0
        active_quests:
          type: integer
          minimum: 0
          description: Number of currently active quests
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    SeattleQuest:
      type: object
      required:
        - id
        - title
        - theme
        - difficulty
        - estimated_time
      properties:
        id:
          type: string
          enum:
            - space-needle
            - pike-place-market
            - starbucks-origin
            - grunge-music
            - amazon-hq
            - mount-rainier
            - rain-rain-rain
            - boeing-factory
            - seafood-salmon
            - tech-boom-gentrification
          description: Уникальный ID квеста
        title:
          type: string
          description: Название квеста
        theme:
          type: string
          enum:
            - landmarks
            - culture
            - technology
            - nature
            - food
          description: Тематика квеста
        difficulty:
          type: string
          enum:
            - easy
            - medium
            - hard
          description: Сложность квеста
        description:
          type: string
          description: Описание квеста
        location:
          type: string
          description: Основная локация в Сиэтле
        historical_context:
          type: string
          description: Исторический контекст периода 2020-2029
        rewards:
          $ref: '#/components/schemas/QuestRewards'
        objectives:
          type: array
          items:
            $ref: '#/components/schemas/schemas-QuestObjective'
          description: Цели квеста
        prerequisites:
          type: array
          items:
            type: string
          description: Необходимые условия
        estimated_time:
          type: integer
          minimum: 15
          maximum: 120
          description: Ориентировочное время выполнения (минуты)
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    SeattleQuestsResponse:
      type: object
      required:
        - quests
        - total
        - period
      properties:
        period:
          type: string
          example: 2020-2029
        quests:
          type: array
          items:
            $ref: '#/components/schemas/SeattleQuest'
        total:
          type: integer
          minimum: 0
        available_for_player:
          type: integer
          minimum: 0
          description: Количество доступных игроку квестов
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    SeattleQuestDetailResponse:
      type: object
      required:
        - quest
        - period
        - historical_context
      properties:
        period:
          type: string
          example: 2020-2029
        historical_context:
          type: object
          description: Детальный исторический контекст
        quest:
          $ref: '#/components/schemas/SeattleQuest'
        related_landmarks:
          type: array
          items:
            type: string
          description: Связанные достопримечательности
        cultural_insights:
          type: array
          items:
            type: string
          description: Культурные insights
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    UpdateQuestProgressRequest:
      type: object
      required:
        - player_id
        - objective_id
        - progress_increment
      properties:
        player_id:
          type: string
          format: uuid
        objective_id:
          type: string
          format: uuid
        timestamp:
          type: string
          format: date-time
        location_context:
          type: object
          description: Контекст локации
        progress_increment:
          type: integer
          minimum: 1
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    UpdateQuestProgressResponse:
      type: object
      required:
        - success
        - new_progress
        - quest_status
      properties:
        quest_status:
          type: string
          enum:
            - in_progress
            - completed
        rewards_earned:
          $ref: '#/components/schemas/QuestRewards'
        next_objectives:
          type: array
          items:
            $ref: '#/components/schemas/schemas-QuestObjective'
        new_progress:
          type: number
          format: float
        success:
          type: boolean
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    SeattleLandmark:
      type: object
      required:
        - id
        - name
        - category
        - coordinates
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        category:
          type: string
          enum:
            - architecture
            - nature
            - culture
            - technology
            - food
        description:
          type: string
        historical_significance:
          type: string
        coordinates:
          type: object
          required:
            - latitude
            - longitude
          properties:
            latitude:
              type: number
              format: float
            longitude:
              type: number
              format: float
        related_quests:
          type: array
          items:
            type: string
          description: IDs связанных квестов
        visit_tips:
          type: array
          items:
            type: string
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    SeattleLandmarksResponse:
      type: object
      required:
        - landmarks
        - total
        - categories
      properties:
        landmarks:
          type: array
          items:
            $ref: '#/components/schemas/SeattleLandmark'
        categories:
          type: array
          items:
            type: string
        total:
          type: integer
          minimum: 0
        quest_related_count:
          type: integer
          minimum: 0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    SeattleHistoryResponse:
      type: object
      required:
        - year
        - events
        - cultural_context
      properties:
        cultural_context:
          type: object
          description: Культурный контекст года
        economic_indicators:
          type: object
        events:
          type: array
          items:
            type: object
            required:
              - title
              - description
              - impact
            properties:
              title:
                type: string
              description:
                type: string
              impact:
                type: string
                enum:
                  - high
                  - medium
                  - low
        technological_advances:
          type: array
          items:
            type: string
        year:
          type: integer
          minimum: 2020
          maximum: 2029
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    SeattleRoute:
      type: object
      required:
        - id
        - name
        - waypoints
        - difficulty
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        difficulty:
          type: string
          enum:
            - easy
            - medium
            - hard
        quest_integration:
          type: string
          enum:
            - space-needle
            - pike-place-market
            - starbucks-origin
            - grunge-music
            - amazon-hq
            - mount-rainier
            - rain-rain-rain
            - boeing-factory
            - seafood-salmon
            - tech-boom-gentrification
        waypoints:
          type: array
          items:
            $ref: '#/components/schemas/SeattleLandmark'
        highlights:
          type: array
          items:
            type: string
        estimated_duration:
          type: integer
          description: Ориентировочное время в минутах
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    SeattleRoutesResponse:
      type: object
      required:
        - routes
        - total
      properties:
        routes:
          type: array
          items:
            $ref: '#/components/schemas/SeattleRoute'
        total:
          type: integer
          minimum: 0
        quest_routes:
          type: integer
          minimum: 0
          description: Количество маршрутов, связанных с квестами
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    Error:
      type: object
      required:
        - message
        - code
      properties:
        message:
          type: string
          maxLength: 1000
          example: Quest not found
        code:
          type: string
          pattern: ^[A-Z_][A-Z0-9_]*$
          example: QUEST_NOT_FOUND
        timestamp:
          type: string
          format: date-time
        details:
          type: object
          description: Additional error details
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ReloadQuestContentRequest:
      type: object
      required:
        - quest_id
        - yaml_content
      properties:
        quest_id:
          type: string
          description: ID квеста из YAML файла (metadata.id)
        yaml_content:
          type: object
          description: Полное содержимое YAML файла квеста
          additionalProperties: true
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    ReloadQuestContentResponse:
      type: object
      properties:
        quest_id:
          type: string
        message:
          type: string
        imported_at:
          type: string
          format: date-time
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    QuestRewards:
      type: object
      properties:
        items:
          type: array
          items:
            type: string
          description: Предметы
        achievements:
          type: array
          items:
            type: string
          description: Достижения
        lore_unlocks:
          type: array
          items:
            type: string
          description: Разблокированный лор
        experience:
          type: integer
          minimum: 0
          description: Опыт
        currency:
          type: integer
          minimum: 0
          description: Валюта
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    schemas-QuestObjective:
      type: object
      required:
        - id
        - description
        - type
        - progress_required
      properties:
        id:
          type: string
          format: uuid
        description:
          type: string
        type:
          type: string
          enum:
            - visit_location
            - collect_items
            - talk_to_npc
            - complete_task
            - time_based
        completed:
          type: boolean
          default: false
        progress_required:
          type: integer
          minimum: 1
        progress_current:
          type: integer
          default: 0
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    schemas-Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          example: INVALID_REQUEST
        message:
          type: string
          example: Неверные параметры запроса
        details:
          type: object
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
    schemas-QuestProgressResponse:
      type: object
      required:
        - player_id
        - quest_id
        - status
        - objectives
      properties:
        player_id:
          type: string
          format: uuid
        quest_id:
          type: string
          enum:
            - space-needle
            - pike-place-market
            - starbucks-origin
            - grunge-music
            - amazon-hq
            - mount-rainier
            - rain-rain-rain
            - boeing-factory
            - seafood-salmon
            - tech-boom-gentrification
        status:
          type: string
          enum:
            - not_started
            - in_progress
            - completed
            - failed
            - abandoned
        started_at:
          type: string
          format: date-time
        completed_at:
          type: string
          format: date-time
        objectives:
          type: array
          items:
            $ref: '#/components/schemas/schemas-QuestObjective'
        overall_progress:
          type: number
          format: float
          minimum: 0
          maximum: 1
          description: Общий прогресс (0.0-1.0)
      description: 'BACKEND NOTE: Fields ordered for struct alignment (large → small). Expected memory savings: 30-50%.'
  responses:
    BadRequest:
      description: Неверный запрос
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/schemas-Error'
    InternalServerError:
      description: Внутренняя ошибка сервера
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/schemas-Error'
    NotFound:
      description: Ресурс не найден
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/schemas-Error'
