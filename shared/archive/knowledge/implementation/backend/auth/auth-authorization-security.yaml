metadata:
  id: backend-auth-part3-authorization
  title: "Authentication System — Part 3: Authorization & Security"
  document_type: implementation
  category: backend
  status: approved
  version: '1.0.0'
  last_updated: 2025-11-07T01:46:00Z
  concept_approved: true
  concept_reviewed_at: 2025-11-07T01:46:00Z
  owners:
    - role: auth_lead
      contact: auth@necp.game
  tags:
    - authorization
    - security
    - permissions
  topics:
    - auth-service
    - access-control
  related_systems:
    - auth-service
    - notification-service
    - session-service
  related_documents:
    - id: backend-auth-part1-registration
      relation: references
    - id: backend-auth-part2-login
      relation: references
  source: shared/docs/knowledge/implementation/backend/auth/auth-authorization-security.md
  visibility: internal
  audience:
    - backend
    - platform
  risk_level: high
review:
  chain:
    - role: auth_lead
      reviewer: ''
      reviewed_at: 2025-11-07T01:46:00Z
      status: approved
  next_actions: []
summary:
  problem: "Нужно зафиксировать модель авторизации, эндпоинты и практики безопасности Auth System."
  goal: "Документировать роли, проверки разрешений, защитные меры и связанные API."
  essence: "Часть 3 описывает роли/permissions, аспект `@RequiresPermission`, набор REST эндпоинтов и best practices безопасности."
  key_points:
    - "Перечневы роли PLAYER/MODERATOR/ADMIN/SUPER_ADMIN и их дефолтные разрешения."
    - "PermissionService и аспект проверяют права при вызове методов."
    - "Описан набор эндпоинтов auth, password, 2FA, OAuth и account management."
    - "Best practices: пароль, токены, rate limiting, IP tracking, session management."
content:
  sections:
    - id: authorization
      title: Авторизация и роли
      body: |
        Определены enum Role с дефолтными разрешениями, сервис проверки прав и аспект `@RequiresPermission` для валидации
        доступа.
      mechanics_links: []
    - id: endpoints
      title: API эндпоинты
      body: |
        Перечислены ключевые REST маршруты для аутентификации, управления паролями, 2FA, OAuth и управления аккаунтом.
      mechanics_links: []
    - id: security
      title: Security best practices
      body: |
        Охватывает требования к паролям, хранению и TTL токенов, rate limiting, обязательную верификацию email, 2FA, IP
        tracking и интеграцию с Session Manager.
      mechanics_links: []
    - id: architecture
      title: Микросервисная архитектура
      body: |
        Auth Service зависит от Session Manager, Email Service, Redis и PostgreSQL, обеспечивая проверку прав и безопасность
        аккаунтов.
      mechanics_links: []
appendix:
  glossary: []
  references: []
  decisions: []
implementation:
  needs_task: false
  queue_reference:
    - shared/trackers/queues/concept/queued.yaml
  blockers: []
history:
  - version: '1.0.0'
    date: 2025-11-07
    author: auth_lead
    changes: Собраны роли, разрешения, API и рекомендации по безопасности.
validation:
  checksum: ''
  schema_version: '1.0'

