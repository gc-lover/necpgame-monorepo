metadata:
  id: family-relationships-system
  title: Система семейных отношений с NPC
  document_type: mechanics
  category: social
  status: in-review
  version: '1.1.0'
  last_updated: 2025-11-07T02:30:00Z
  concept_approved: false
  concept_reviewed_at: ''
  owners:
    - role: concept_director
      contact: concept@necp.game
  tags:
    - social
    - relationships
    - npc
  topics:
    - family-system
    - relationship-impact
  related_systems:
    - social-service
    - relationship-service
  related_documents:
    - id: family-relationships-system-detailed
      relation: elaborates
  source: shared/docs/knowledge/mechanics/social/family-relationships-system.md
  visibility: internal
  audience:
    - concept
    - vision
    - narrative
  risk_level: medium
review:
  chain:
    - role: concept_director
      reviewer: ''
      reviewed_at: ''
      status: pending
  next_actions: []
summary:
  problem: Семейные связи NPC были описаны в Markdown и не имели структурированной модели для передачи в дизайн и API команды.
  goal: Зафиксировать типы родственников, влияние действий игрока и механики семейных квестов в форме единого знания.
  essence: Система семейных отношений определяет состав семей, реакции на действия игрока и их последствия для мира.
  key_points:
    - Семьи NPC включают базовых и расширенных родственников, а также приёмные связи.
    - Поступки игрока по отношению к родственникам усиливают или ослабляют привязанность NPC.
    - Обнаружение связей и семейные квесты формируют цепочки событий и доступ к контенту.
    - Семейные конфликты и усыновление добавляют глубокие социальные сценарии.
content:
  sections:
    - id: concept_overview
      title: Концепция семейной системы
      body: |
        Семейные связи усиливают эмоциональную вовлечённость и расширяют социальную структуру. Вдохновением служат Baldur's Gate 3, The Witcher 3, Cyberpunk 2077 и Skyrim, где отношения семьи влияют на повествование и доступ к событиям.
      mechanics_links:
        - mechanics/social/npc-relationships-system.yaml
      assets: []
    - id: relationship_types
      title: Типы членов семьи и связей
      body: |
        Определены категории членов семьи: родители, дети, братья и сестры, супруги, расширенная и приёмная семья. Связи делятся на родственные, брачные и особые (опекун, подопечный). Для каждого NPC хранится набор связанных персонажей с указанием статуса.
      mechanics_links:
        - mechanics/social/relationships-system.yaml
      assets: []
    - id: impact_rules
      title: Влияние семьи на отношения
      body: |
        Положительные действия по отношению к родственникам повышают привязанность NPC, отрицательные — снижают, вплоть до конфликта. Система поддерживает каскадные эффекты: одна семья может воздействовать на кланы, фракции и события.
      mechanics_links:
        - mechanics/social/reputation-tiers-detailed.yaml
      assets: []
    - id: discovery_interactions
      title: Обнаружение и взаимодействие
      body: |
        Информация о семье открывается через диалоги, исследование, задания и высокий уровень доверия. Игрок может назначать встречи, выполнять просьбы, помогать или вредить семье, что влияет на дальнейшее поведение NPC.
      mechanics_links:
        - mechanics/social/player-orders-system.yaml
      assets: []
    - id: family_quests
      title: Семейные квесты
      body: |
        Поддерживаются сценарии помощи, защиты, разрешения конфликтов, воссоединения и раскрытия тайн. Выполнение задач усиливает доступ к уникальному контенту, а игнорирование приводит к ухудшению отношений.
      mechanics_links:
        - mechanics/quests/quest-system.yaml
      assets: []
    - id: special_mechanics
      title: Особые механики
      body: |
        Игрок может усыновлять NPC или вступать в приёмную семью, получая бонусы и ответственность. Семейные конфликты предполагают выбор стороны, последствия для репутации и долгосрочные развилки. Детализация условий усыновления и автоматизации конфликтов планируется в будущих итерациях.
      mechanics_links:
        - mechanics/social/mentorship-system.yaml
      assets: []
    - id: world_influence
      title: Влияние на игровой мир
      body: |
        Семейные связи формируют социальные сети, влияют на экономику, торговлю и доступ к ресурсам. Модель учитывает влияние на фракции и глобальные события; параметры баланса требуют дальнейшей калибровки.
      mechanics_links:
        - mechanics/social/social-mechanics-overview.yaml
      assets: []
    - id: decisions
      title: Принятые решения
      body: |
        Зафиксирована полная система семейных отношений: состав семьи, связей, правила влияния, механики обнаружения, взаимодействия и квестов. Подтверждена поддержка сложных последствий и влияния на мир.
      mechanics_links:
        - mechanics/social/social-mechanics-overview.yaml
      assets: []
    - id: open_questions
      title: Вопросы для дальнейшей проработки
      body: |
        Необходимо перечислить условия усыновления, описать управление семейными конфликтами и определить влияние семей на контент и экономику.
      mechanics_links:
        - mechanics/social/social-mechanics-overview.yaml
      assets: []
appendix:
  glossary: []
  references:
    - id: family-relationships-system-detailed
      description: Расширенное описание семейной системы.
  decisions: []
implementation:
  needs_task: true
  queue_reference:
    - shared/trackers/queues/concept/queued.yaml
  blockers: []
history:
  - version: '1.0.0'
    date: 2025-11-03
    author: Concept Director Team
    changes: Создан документ системы семейных отношений с NPC.
  - version: '1.1.0'
    date: 2025-11-03
    author: Concept Director Team
    changes: Дополнены типы членов семьи, механики влияния и особые сценарии.
validation:
  checksum: ''
  schema_version: '1.0'

