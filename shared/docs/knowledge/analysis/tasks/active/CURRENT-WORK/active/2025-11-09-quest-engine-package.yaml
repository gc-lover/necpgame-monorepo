metadata:
  id: analysis-quest-engine-package
  title: Подготовка пакета для quest engine backend
  document_type: analysis
  category: operations
  status: draft
  version: '1.0.0'
  last_updated: 2025-11-09T14:05:00Z
  concept_approved: false
  concept_reviewed_at: ''
  owners:
    - role: brain_manager
      contact: brain@necp.game
  tags:
    - quests
    - gameplay-service
    - backend
  topics:
    - gameplay
    - quest-engine
  related_systems:
    - gameplay-service
    - character-service
    - economy-service
    - social-service
    - analytics-service
  related_documents:
    - id: quest-engine-backend
      relation: references
    - id: quest-system
      relation: references
  source: shared/docs/knowledge/analysis/tasks/active/CURRENT-WORK/active/2025-11-09-quest-engine-package.md
  visibility: internal
  audience:
    - brain-team
    - quest-design
  risk_level: medium
review:
  chain:
    - role: brain_manager
      reviewer: ''
      reviewed_at: ''
      status: pending
  next_actions: []
summary:
  problem: Необходимо подготовить пакет задач для backend квестового движка без запуска постановки в API-SWAGGER.
  goal: Зафиксировать готовность документации, REST/WS/Event контрактов и зависимостей, чтобы сформировать бриф ДУАПИТАСК.
  essence: Концентрированное описание прогресса и чернового брифа для запуска quest engine в shooter-модели.
  key_points:
    - Документ `.BRAIN/quest-engine-backend.md` подтверждён, каталоги и фронтенд синхронизированы.
    - Перечислены REST, WebSocket, Event Bus и storage требования.
    - Определены зависимости с другими сервисами и дальнейшие шаги.
content:
  sections:
    - id: progress
      title: Прогресс
      body: |
        Подтверждён статус `ready` базового документа, уточнены зависимости между character, economy, social, combat и
        analytics сервисами. Определены ключевые события Event Bus и REST точки для размещения в будущих заданиях.
      mechanics_links: []
      assets: []
    - id: handoff_overview
      title: Резюме для передачи
      body: |
        Каталог OpenAPI `api/v1/gameplay/quests/quest-engine.yaml` и фронтенд `modules/quests` готовы. Блокирующих задач нет,
        очереди readiness обновлены. Следующий шаг — передача брифа после открытия окна задач.
      mechanics_links: []
      assets: []
    - id: brief_rest
      title: REST и WebSocket (черновой бриф)
      body: |
        REST эндпоинты включают старт/завершение квестов, обработку целей, диалоговых выборов, управление флагами и skill
        tests. Для realtime предусмотрены WebSocket каналы на quest instance и на персонажа.
      mechanics_links: []
      assets: []
    - id: events_storage
      title: Event Bus и хранение
      body: |
        Исходящие события `quest:*` покрывают старт, прогресс, завершение, диалог и проверки навыков; входящие события приходят
        из combat, inventory, economy, social и world сервисов. Хранилище описывает `quest_instances`, `quest_objectives_state`,
        `dialogue_state`, `skill_test_results`, `quest_rewards_history` и `quest_dependencies_cache`.
      mechanics_links: []
      assets: []
    - id: dependencies
      title: Зависимости и ограничения
      body: |
        Документ синхронизирует требования с character-service, economy-service, social-service, combat-service, analytics-service
        и схемой quest branching. Зафиксированы требования к shooter-проверкам, таймерам, версионности сценариев и аудиту.
      mechanics_links: []
      assets: []
    - id: next_steps
      title: Следующие действия
      body: |
        Нужно подготовить итоговый бриф ДУАПИТАСК, собрать зависимости в приложении, отметить прогресс в трекерах после
        разрешения на постановку задач и синхронизировать документ с другими готовыми материалами.
      mechanics_links: []
      assets: []
appendix:
  glossary: []
  references: []
  decisions: []
implementation:
  needs_task: false
  queue_reference:
    - shared/trackers/queues/concept/queued.yaml#analysis-quest-engine-package
  blockers: []
history:
  - version: '1.0.0'
    date: 2025-11-11
    author: Brain Manager
    changes: Конвертация пакета quest engine backend в YAML.
validation:
  checksum: ''
  schema_version: '1.0'

