metadata:
  id: backend-leaderboard-system
  title: Leaderboard System
  document_type: implementation
  category: backend
  status: approved
  version: '1.0.0'
  last_updated: 2025-11-08T18:10:00Z
  concept_approved: true
  concept_reviewed_at: 2025-11-07T05:20:00Z
  owners:
    - role: world_lead
      contact: world@necp.game
  tags:
    - leaderboards
    - rankings
  topics:
    - engagement
    - gameplay-infra
  related_systems:
    - world-service
    - social-service
    - character-service
  related_documents:
    - id: backend-achievement-system
      relation: references
  source: shared/docs/knowledge/implementation/backend/leaderboard-system.md
  visibility: internal
  audience:
    - backend
    - world
  risk_level: medium
review:
  chain:
    - role: world_lead
      reviewer: ''
      reviewed_at: 2025-11-08T18:10:00Z
      status: approved
  next_actions: []
summary:
  problem: "Не хватало стандартизированной документации по глобальной системе рейтингов и обновлений."
  goal: "Задокументировать архитектуру, типы лидербордов, метрики, БД и API."
  essence: "Документ описывает глобальные/сезонные рейтинги, обновления, структурирование данных и endpoints."
  key_points:
    - Перечислены типы лидербордов (global, class, seasonal, friend, guild).
    - Описаны метрики, частота обновлений и хранилища (Redis, мат. представления).
    - Приведены SQL примеры таблиц `leaderboards`, `seasonal_leaderboards`.
    - Перечислены ключевые API маршруты.
content:
  sections:
    - id: overview
      title: Краткое описание
      body: |
        Leaderboard System управляет глобальными, сезонными, дружественными и гильдийными рейтингами, используя события и
        Redis sorted sets.
      mechanics_links: []
    - id: types
      title: Типы Leaderboards
      body: |
        Перечислены примеры глобальных, классовых, сезонных, friend и guild рейтингов с примерами отображения.
      mechanics_links: []
    - id: metrics
      title: Ranking Metrics и обновления
      body: |
        Описаны метрики для игроков и гильдий, а также частота обновлений (real-time/hours/daily/weekly).
      mechanics_links: []
    - id: database
      title: База данных и материалы
      body: |
        Представлены таблицы `leaderboards`, materialized view `leaderboard_global_level` и `seasonal_leaderboards`.
      mechanics_links: []
    - id: api
      title: API
      body: |
        Основные endpoints: global, seasonal, guild, friends leaderboards, rank lookup и соседние позиции.
      mechanics_links: []
appendix:
  glossary: []
  references: []
  decisions: []
implementation:
  needs_task: false
  queue_reference:
    - shared/trackers/queues/concept/queued.yaml
  blockers: []
history:
  - version: '1.0.0'
    date: 2025-11-06
    author: world_lead
    changes: Создана документация leaderboard system.
validation:
  checksum: ''
  schema_version: '1.0'

