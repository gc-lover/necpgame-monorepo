metadata:
  id: implementation-global-state-operations
  title: 'Global State Operations — Операции и мониторинг'
  document_type: implementation
  category: global-state
  status: approved
  version: '1.0.0'
  last_updated: 2025-11-07T06:00:00Z
  concept_approved: true
  concept_reviewed_at: 2025-11-07T06:00:00Z
  owners:
    - role: concept_director
      contact: concept@necp.game
  tags:
    - global-state
    - operations
    - observability
  topics:
    - monitoring
    - performance
    - security
  related_systems:
    - global-state-service
    - projection-service
    - monitoring-stack
  related_documents:
    - id: implementation-global-state-management
      relation: references
    - id: implementation-global-state-sync
      relation: complements
  source: shared/docs/knowledge/implementation/global-state/global-state-operations.md
  visibility: internal
  audience:
    - concept
    - backend
    - devops
  risk_level: high
review:
  chain:
    - role: concept_director
      reviewer: ''
      reviewed_at: ''
      status: pending
  next_actions: []
summary:
  problem: 'Операционные практики глобального состояния были в Markdown и не участвовали в автоматических проверках.'
  goal: 'Структурировать сервис запросов, проекции, мониторинг, DR, тестирование и масштабирование в YAML.'
  essence: 'Документ описывает типы запросов, read-модели, метрики, восстановление, оптимизации, тесты, безопасность и масштабирование.'
  key_points:
    - 'Query Service поддерживает point, range, aggregate, time travel и projection запросы.'
    - 'Проекции формируют read модели через event listeners и материализованные представления.'
    - 'Мониторинг, DR, performance tuning и security формализованы для production эксплуатации.'
content:
  sections:
    - id: query_service
      title: 'Сервис запросов состояния'
      body: |
        Описаны пять типов запросов с примерами Java-кода: точечные, диапазонные, агрегированные, time travel и projection.
        Сервис обеспечивает доступ к состоянию, агрегации и историческим значениям.
      mechanics_links:
        - implementation/global-state/global-state-management.yaml
      assets: []
    - id: projections
      title: 'Проекции и read-модели'
      body: |
        SQL-схема player_profile_projection и пример PlayerProfileProjector демонстрируют, как события обновляют статистику игрока
        и формируют агрегаты для аналитики и API.
      mechanics_links: []
      assets: []
    - id: monitoring
      title: 'Мониторинг и health checks'
      body: |
        Перечислены метрики Event Store, State Store и синхронизации, описан health check, который отмечает состояние сервисов и задержки.
      mechanics_links:
        - implementation-global-state/global-state-sync.yaml
      assets: []
    - id: disaster_recovery
      title: 'Disaster Recovery и оптимизации'
      body: |
        Рассмотрены сценарии восстановления, batch/async запись, многоуровневый кэш, materialized views, индексы и партиционирование,
        а также стратегий тестирования replay и time travel отладки.
      mechanics_links: []
      assets: []
    - id: security_scaling
      title: 'Безопасность и масштабирование'
      body: |
        EventValidator обеспечивает структуру, авторизацию, rate limiting и anti-cheat. Описаны горизонтальное и вертикальное
        масштабирование, шардинг и репликация Event/State Store.
      mechanics_links:
        - implementation-global-state/global-state-events.yaml
      assets: []
appendix:
  glossary: []
  references: []
  decisions: []
implementation:
  needs_task: true
  queue_reference:
    - shared/trackers/queues/concept/queued.yaml
  blockers: []
history:
  - version: '1.0.0'
    date: 2025-11-07
    author: ai_brain_manager
    changes: 'Задокументированы операционные практики, мониторинг и масштабирование Global State.'
validation:
  checksum: ''
  schema_version: '1.0'

