---

---
**api-readiness:** ready  
**api-readiness-check-date:** 2025-11-09 01:22
**api-readiness-notes:** Перепроверено 2025-11-09 01:22: режимы арен, рейтинги, награды, интеграции с лидербордами и voice-lobby готовы к постановке API задач.
---

# Arena System - Неоновые арены Найт-Сити

**Статус:** approved  
**Версия:** 1.0.0  
**Дата создания:** 2025-11-07 20:28  
**Приоритет:** HIGH  
**Автор:** AI Brain Manager

**Микрофича:** Competitive arena gameplay loop  
**Размер:** ~340 строк ✅  
**target-domain:** gameplay-combat  
**target-microservice:** gameplay-service (8083)  
**target-frontend-module:** modules/combat/arenas

---

## Краткое описание

Арены — это киберспортивное ядро NECPGAME. Они дают:

- Быстрые 5–15 минутные матчи для PvP и гибридных PvPvE режимов
- Подгрузку готовых тим-композиций через Voice Lobby & Party Finder
- Прогресс в рейтингах, боевом пропуске, фракционных войнах
- Шанс заработать эксклюзивные неоновые косметические предметы

Арены работают круглосуточно, синхронизируются с сезонным расписанием и тесно связаны с экономикой (ставки, спонсоры, инфопотоки).

---

## Дизайн цели

1. **Киберспортивная глубина:** высокая читаемость, честность матчмейкинга, анти-чит
2. **Лор:** каждая арена — медийная площадка корпораций, кланов или подполья
3. **Гибкие режимы:** рейтинговый, тренировочный, эвенты с модификаторами
4. **Интеграция:** лидерборды, клановые войны, контрактная система спонсоров

---

## Каталог арен

### Neon Circuit (5v5 Objective Control)

- Локация: поверхностные мосты над районом Heywood
- Цель: удержание трёх точек, вращающиеся энергетические щиты
- Особенность: динамические дроны-камеры, публикующие хайлайты для ставок
- Лор: спонсор — корпорация Kiroshi Media, транслирует матчи на голографических билбордах

### Orbital Pit (3v3 Elimination)

- Локация: орбитальная станция корпорации Arasaka, невесомость в центральном отсеке
- Цель: три раунда до двух побед, ограниченный объём кислорода
- Особенность: смена гравитации, вращающиеся укрытия, импульсные барьеры
- Лор: закрытые матчи для элиты, победители получают доступ к чёрному рынку имплантов

### Underbelly Gauntlet (4v4 PvPvE Theft)

- Локация: канализация Pacifica с гнёздами мутировавших дронов Maelstrom
- Цель: украсть из хранилища ядро данных и экстрактиться
- Особенность: спавны AI, шум созывает больше врагов, гибрид PvP
- Лор: организаторы — партизанская сеть Voodoo Boys, передают данные фиксам

### HoloGrid Rumble (8в8 Control + Hack)

- Локация: AR-симуляция в киберпространстве, арену проектирует NetWatch
- Цель: захват узлов и их взлом, боёвка + нетранин
- Особенность: изменение ландшафта в реальном времени, «глюки» дают баффы
- Лор: битва за доступ к фрагментам Blackwall, трансляция блокируется в Night News

---

## Структура матчей

1. **Pre-Match Lobby**
   - Подбор по MMR, роли, голосовым преференциям
   - Проверка готовности экипировки, AR-хаков, имплантов
   - Встроенный ready-check, голосовое брифинг-окно

2. **Draft & Loadout**
   - Ограничения по уникальным имплантам в команде
   - Баны/пики тактических гаджетов
   - Перегрев имплантов учитывается, чтобы сохранять баланс

3. **Match Core Loop**
   - Фазы раунда: захват → контроль → перебалансировка
   - События «Neon Burst»: случайные баффы/дебаффы в зоне
   - Динамические зрительские задания: бонусные очки за стильные киллы

4. **Post-Match**
   - Распределение наград (арена-валюта, имплант-полиш)
   - Обновление рейтинга, сезонных заданий
   - Сохранение телеметрии для анти-чита и повтора

---

## Рейтинги и прогресс

- **MMR-диапазоны:** Bronze → Neon → Chrome → Blackwall (скрыто)
- **Seasons:** 8 недель, с мидсезонными патчами
- **Placement:** первые 10 матчей с повышенными изменениями MMR
- **Decay:** отсутствующие >7 дней — постепенное снижение до минимума диапазона
- **Streak Buff:** 3+ побед подряд дают бонус к арена-валюте, но повышают сложность оппонентов
- **Cross-Progression:** опыт для боевого пропуска, фракционные рейтинги (Arasaka vs Militech)

---

## Награды и экономика

- **Арена-валюта:** `ARENA_CHIPS` — покупка косметики, контрактов спонсоров
- **Loot Drops:** кейсы «Neon Showcase» с визуальными эффектами оружия, голограммами
- **Contracts:** ежедневные задания от корпораций (награда — скидки, reputation)
- **Betting Integration:** социальный сервис ставок (см. economy/betting) синхронизирует выписки
- **Salvage System:** проигравшие получают «данные матча» для крафта имплантов при анализе

---

## Интеграции и зависимости

- **Voice Lobby & Party Finder:** авто-создание лобби для команд, управление подканалами
- **Leaderboard System:** глобальные/региональные рейтинги, сезонные таблицы
- **Achievement System:** достижения за streak, clutch, без поражений
- **Daily Reset:** ежедневные арена-квесты, бонусы за первую победу дня
- **Guild/Clan Wars:** очки влияния, разыгрываемые в турнирных сезонах
- **Anti-Cheat:** real-time мониторинг кривых прицеливания, проверка неткода
- **Replay Service (план):** хранение хайлайтов, API для стримеров

---

## Технический стек

- **Match Orchestrator:** gRPC сервис в gameplay-service, управляет сессиями
- **State Sync:** Redis pub/sub + Kafka topics `arena.match.state`
- **Telemetry:** ClickHouse таблицы `arena_events`
- **Config Storage:** Postgres JSONB для модификаторов арен
- **Server Footprint:** отдельные pod-ы Kubernetes, автоскейл по очереди матчей

---

## API контуры (высокоуровневый)

- `POST /api/v1/arena/matchmaking/search`
- `POST /api/v1/arena/matchmaking/cancel`
- `GET /api/v1/arena/maps`
- `POST /api/v1/arena/match/{matchId}/ready`
- `POST /api/v1/arena/match/{matchId}/loadout`
- `POST /api/v1/arena/match/{matchId}/telemetry`
- `GET /api/v1/arena/rewards/{seasonId}`
- `GET /api/v1/arena/profile/{playerId}`

---

## Данные и схемы

`arena_matches`
- `id UUID`
- `map_code VARCHAR(40)`
- `mode VARCHAR(20)`
- `team_a_id UUID`
- `team_b_id UUID`
- `winner_team UUID`
- `duration_seconds INT`
- `mmr_delta JSONB`
- `start_time TIMESTAMP`
- `end_time TIMESTAMP`

`arena_rewards`
- `id UUID`
- `match_id UUID`
- `player_id UUID`
- `chips_awarded INT`
- `loot_case VARCHAR(40)`
- `battlepass_xp INT`
- `season_points INT`

`arena_leaderboard`
- пересчитывается каждые 5 минут
- агрегирует MMR, winrate, streak, стильные моменты

---

## Пользовательский опыт (UX)

- Быстрый доступ из главного меню, подсветка актуальных ивентов
- Интеграция с UI модулем `CyberpunkArenaPanel`
- Спектаторский режим: обзорные камеры, выбор POV, instant replay
- Нарративные вставки: кинотрейлер перед матчем, аннонсер

---

## Лор взаимосвязи

- Арены — наследие проекта «Neon Circuit» корпорации Kiroshi
- Каждая карта связана с текущими конфликтами (Arasaka vs Militech, подполье Maelstrom)
- NPC комментаторы влияют на репутацию игрока

---

## Риски и контроль

- Баланс имплантов, токсичность, экономика ставок, техриски

---

## Дорожная карта

| Этап | Содержание | Статус |
|------|------------|--------|
| Phase 1 | Базовые арены | готово |
| Phase 2 | PvPvE режим | в разработке |
| Phase 3 | HoloGrid + spectator API | планируется |
| Phase 4 | Трансляции и ставки | планируется |

---

## Требуемые документы

- `03-lore/activities/activities-lore-compendium.md`
- `03-lore/characters/activity-npc-roster.md`
- `05-technical/backend/leaderboard/leaderboard-core.md`
- `05-technical/backend/voice-lobby/voice-lobby-system.md`

---

## Готовность

- Структура арен, интеграции и лор выверены
- Документ соответствует требованиям микрофичи и готов к API задачам


