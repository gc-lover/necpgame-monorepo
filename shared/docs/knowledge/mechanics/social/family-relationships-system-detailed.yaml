metadata:
  id: family-relationships-system-detailed
  title: Система семейных отношений с NPC — Детальная версия
  document_type: mechanics
  category: social
  status: approved
  version: '1.0.0'
  last_updated: 2025-11-08T20:10:00Z
  concept_approved: true
  concept_reviewed_at: 2025-11-09
  owners:
    - role: concept_director
      contact: concept@necp.game
  tags:
    - family
    - relationships
    - inheritance
  topics:
    - social_narrative
    - world_events
  related_systems:
    - social-service
    - world-service
    - economy-service
    - character-service
  related_documents:
    - id: relationships-system-detailed
      relation: references
    - id: npc-relationships-system-detailed
      relation: complements
    - id: mentorship-system-detailed
      relation: complements
  source: shared/docs/knowledge/mechanics/social/family-relationships-system-детально.md
  visibility: internal
  audience:
    - concept
    - narrative
    - economy
  risk_level: medium
review:
  chain:
    - role: concept_director
      reviewer: ''
      reviewed_at: 2025-11-09
      status: approved
  next_actions: []
summary:
  problem: Семейные связи, события и наследование NPC требовали единого описания для социальных, мировых и экономических сервисов.
  goal: Детализировать структуру семей, эмоции, события и их влияние на фракции, экономику и UX.
  essence: Семейные отношения формируют квесты, кризисы и экономику наследования, интегрируя социальные показатели и мировые события.
  key_points:
    - Семейные структуры охватывают ядро, расширенные связи и кланы с атрибутами членов.
    - События жизни и наследование запускают world-events, квесты и экономические расчёты.
    - UX дерево семьи, календарь и журнал обеспечивают визуализацию динамики отношений.
content:
  sections:
    - id: methodology
      title: Методика детализации
      body: |
        Система описывает роли членов семьи, взаимодействие сервисов и требуемые интерфейсы. Социальные уровни, события и наследование координируются между `social-service`, `world-service`, `economy-service`, `character-service` и `gameplay-service`.
      mechanics_links:
        - mechanics/social/relationships-system-detailed.yaml
      assets: []
    - id: family_structures
      title: Семейные структуры и атрибуты
      body: |
        Определены ядро семьи, расширенная родня, кланы и опека. Для каждого члена фиксируются статус, профессия, фракция, отношение к игроку и скрытые секреты, раскрываемые через сюжет.
      mechanics_links:
        - mechanics/social/npc-relationships-system-detailed.yaml
      assets: []
    - id: emotions_trust
      title: Эмоциональные уровни и доверие
      body: |
        Эмоции и доверие усиливают базовую систему отношений и определяют готовность NPC к сотрудничеству. Комбинации эмоций влияют на поведение и запускают цепочки заданий.
      mechanics_links:
        - mechanics/social/relationships-system-detailed.yaml
      assets: []
    - id: life_events
      title: События семейной жизни
      body: |
        Свадьбы, рождение, болезни, конфликты, трагедии и праздники меняют отношения, запускают квесты и требуют ресурсов. Каждое событие описывает триггеры, последствия и UX-сигналы.
      mechanics_links:
        - mechanics/social/player-orders-system-detailed.yaml
      assets: []
    - id: player_interactions
      title: Взаимодействие игрока с семьёй NPC
      body: |
        Игрок участвует в диалогах, помогает, дарит подарки, выступает медиатором и выполняет семейные квесты. Сценарии помогают воссоединять семьи, раскрывать тайны и строить династии.
      mechanics_links:
        - mechanics/social/mentorship-system-detailed.yaml
      assets: []
    - id: adoption
      title: Усыновление и вступление в семью
      body: |
        Высокая репутация и выполненные квесты позволяют игроку усыновлять NPC или стать членом чужой семьи. Это открывает доступ к ресурсам, событиям и новым обязанностям.
      mechanics_links:
        - mechanics/social/npc-hiring-system.yaml
      assets: []
    - id: inheritance
      title: Наследование и ресурсы
      body: |
        Завещания, споры и распределение собственности интегрированы с economy-service. Требуются правила расчёта налогов, условий наследования и возможных конфликтов.
      mechanics_links:
        - mechanics/economy/stock-exchange/stock-analytics.yaml
      assets: []
    - id: factions_influence
      title: Влияние на фракции и мир
      body: |
        Семейные союзы влияют на дипломатию, политику и события городов. Фракции реагируют на решения семей, меняя контроль территорий и доступ к ресурсам.
      mechanics_links:
        - mechanics/social/relationships-system-detailed.yaml
      assets: []
    - id: ux_visuals
      title: UX и визуализация
      body: |
        Интерактивное дерево, календарь важный дат, журнал событий и VR-архив обеспечивают игроку полную картину семейной динамики. Уведомления предупреждают о кризисах и запросах семьи.
      mechanics_links:
        - mechanics/social/relationships-system-detailed.yaml
      assets: []
    - id: integrations
      title: Интеграции, API и аналитика
      body: |
        REST API поддерживают дерево семьи, события, наследство и историю взаимодействий. Kafka события информируют подписчиков о кризисах, наследовании и изменениях статусов. Метрики FamilyStabilityIndex, HeritageDisputeRate и AdoptionSuccessRate отслеживают устойчивость семейных систем.
      mechanics_links:
        - mechanics/social/player-orders-reputation.yaml
      assets: []
appendix:
  glossary: []
  references: []
  decisions: []
implementation:
  needs_task: false
  queue_reference:
    - shared/trackers/queues/concept/queued.yaml
  blockers: []
history:
  - version: '1.0.0'
    date: 2025-11-07
    author: concept_director
    changes: Сформированы структуры, события и аналитика семейных отношений.
validation:
  checksum: ''
  schema_version: '1.0'

