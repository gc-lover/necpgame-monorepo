# Система найма NPC — влияние на игровой мир (детально)

**api-readiness:** ready  
**api-readiness-check-date:** 2025-11-09 09:55  
**api-readiness-notes:** Мировое влияние найма NPC формализовано: индексы занятости, REST/Kafka контуры и UX сценарии согласованы; блокеров перед API задачами нет.

**Версия:** 1.0.0  
**Статус:** approved  
**Дата создания:** 2025-11-07  
**Последнее обновление:** 2025-11-09 09:55  
**Приоритет:** высокий

**target-domain:** world  
**target-microservice:** world-service (port 8092)  
**target-microservice-secondary:** economy-service (port 8089), social-service (port 8084)  
**target-frontend-module:** modules/world/insights, modules/social/npc-hiring

---

**API Tasks Status:**
- Status: queued
- Tasks:
  - API-TASK-358: api/v1/world/player-orders/effects.yaml (2025-11-08)
  - API-TASK-359: api/v1/economy/npc-hiring/index.yaml (2025-11-08)
- Last Updated: 2025-11-09 21:35
---

## 1. Социальные экосистемы найма

- **Рынок труда:** доски объявлений, гильдии, агентства (`npc-relationships-system-детально.md`). NPC конкурируют за лучшие контракты.
- **Биржи найма:** фракционные биржи, городские центры трудоустройства, VR-биржи и нелегальные площадки.
- **Сети NPC:** нанятые NPC формируют сети, делятся информацией, участвуют в событиях.
- **Кланы и корпорации:** создают штаты сотрудников, карьерные лестницы, корпоративные бонусы.
- **Социальные рейтинги:** рейтинг работодателя влияет на доступ к элитным NPC и условия контрактов.

---

## 2. Экономическое влияние

- **Рынки ресурсов:** растёт спрос на экипировку, жильё, страховки и обслуживание.
- **Бухгалтерия:** расходы на зарплаты, бонусы, обучение, налоги (`economy-service`).
- **Профит-центры:** NPC-торговцы, производственники, службы фиксации приносят доход.
- **Инвестиции:** повышение навыков, покупка имплантов, расширение инфраструктуры.
- **Снижение затрат:** автоматизация задач, оптимизация логистики.
- **Конкуренция:** тендеры на найм, фракционные «охоты на таланты».
- **Макроиндикаторы:** `EmploymentStabilityIndex`, `LaborDemandIndex` — ключевые метрики экономики.

---

## 3. Влияние на фракции и территории

- **Фракционные лицензии:** Arasaka, Militech, Voodoo Boys, Netwatch — квоты, налоги, контроль.
- **Территориальное влияние:** контроль рынка труда усиливает позиции в районе (`visual-style-locations-детально.md`).
- **Фракционные события:** забастовки, конкурсы, headhunting-кампании.
- **Нейтральные зоны:** независимые города привлекают NPC, формируют свободные рынки.
- **Дипломатия:** перекупка NPC соперников инициирует санкции и квестовые конфликты.

---

## 4. Влияние на геймплей и прогресс

- **Автоматизация:** NPC закрывают рутинные задачи (торговля, логистика, охрана).
- **Сложные миссии:** элитные NPC открывают рейды, сюжетные арки и спецоперации.
- **PvE/PvP:** наёмные бойцы, пилоты, хакеры меняют баланс сил.
- **Экономическая мощь:** крупные штаты NPC повышают мощь компаний и кланов.
- **Персонализация:** истории NPC влияют на нарратив, отношения и событийность.
- **Синергия:** связка с `mentorship-system-детально.md` раскрывает ветку развития сотрудников.

---

## 5. События и кризисы

- **Забастовки:** низкая оплата и плохие условия → снижение эффективности, блокировка заказов.
- **Похищения:** конкуренты похищают элитных NPC → защитные операции, rescue-миссии.
- **Миграция:** массовый переезд NPC между городами меняет экономику.
- **Чёрный рынок:** нелегальные биржи, контрабанда специалистов, штрафы от фракций.
- **Катастрофы:** гибель NPC создаёт дефицит навыков, запускает world-events.
- **Локдауны:** города закрывают биржи, повышают контрактные ставки, вводят комендантские часы.

---

## 6. UX и визуализация

- **Карта найма:** отображение распределения NPC, индексов занятости, кризисов.
- **HR-дэшборд:** графики `EmploymentStabilityIndex`, `LaborDemandIndex`, Retention/Strike risks.
- **Сводки:** отчёты по прибылям/убыткам, эффективности команд, настроению NPC.
- **Уведомления:** забастовки, повышения, уходы, запросы на улучшение условий.
- **VR/AR-интервью:** виртуальные переговорные комнаты для рекрутинга.

---

## 7. Связи с другими системами

- `npc-hiring-system-детально.md` — базовые механики и управление персоналом.
- `relationships-system-детально.md` — доверие и репутация работодателя.
- `player-orders-system-детально.md` и `player-orders-world-impact-детально.md` — совместные цепочки влияния.
- `mentorship-system-детально.md` — обучение и сохранение навыков.
- `visual-style-assets-детально.md` — идентика NPC, бирж, интерфейсов.
- `factions-overview-детально.md` — лицензии, политические последствия.
- `city-life-population-algorithm.md` — перераспределение населения и рабочих мест.

---

## 8. Использование документа

- Формирование API влияния найма для world/economy/social сервисов.
- Подготовка UX (карта, дэшборды, уведомления, VR-интервью).
- Балансировка кризисов, экономических эффектов, фракционных конфликтов.
- Настройка telemetry и аналитики для мониторинга HR-системы.

---

## 9. REST API и JSON схемы

- `GET /world/npc-hiring/effects` — агрегированное влияние найма (`NpcHiringImpact`).
- `POST /world/npc-hiring/effects/recalculate` — пересчёт индексов, генерация world-events (batch job).
- `GET /economy/npc-hiring/index` — экономические индексы и прогнозы по секторам.
- `GET /social/npc-hiring/news` — дайджест HR-событий, влияющих на отношения.
- `POST /social/npc-hiring/alerts` — публикация уведомлений для UX виджетов.

**JSON схемы:**  
- `schemas/world/npc-hiring-impact.schema.json`  
- `schemas/world/npc-hiring-event.schema.json`  
- `schemas/economy/npc-hiring-index.schema.json`  
- `schemas/social/npc-hiring-alert.schema.json`

---

## 10. Kafka события и подписчики

| Topic | Producer | Payload | Консьюмеры |
|-------|----------|---------|-----------|
| `world.npc-hiring.impact` | world-service | `{ effectId, cityId, employmentStabilityIndex, laborDemandIndex, issuedAt }` | telemetry, notification-service, quest-service |
| `economy.npc-hiring.index` | economy-service | `{ regionId, employmentStabilityIndex, laborDemandIndex, forecast }` | analytics, trading-service |
| `social.npc-hiring.alert` | social-service | `{ alertId, type, severity, message, relatedNpcIds[] }` | UI, monitoring, factions-service |
| `world.npc-hiring.crisis` | world-service | `{ crisisId, cityId, crisisType, severity, requiredActions[] }` | npc-ai, world-events, player-orders-service |

- Все события логируются и агрегируются в telemetry (`TickDuration p95`, `npc-hiring-response-time`).

---

## 11. Метрики и аналитика

- `EmploymentStabilityIndex` — стабильность занятости NPC (0..1), влияет на налоги.
- `LaborDemandIndex` — потребность в специалистах, влияет на спавн заказов и цены.
- `RetentionRate` — удержание NPC, используется social-service.
- `StrikeRiskScore` — вероятность забастовок, влияет на world-events.
- `NPCMigrationFlow` — интенсивность перемещения NPC между городами.

---

## 12. Проверка и согласование

- World design workshop 2025-11-08 09:58 — подтверждены сценарии влияния и кризисов.
- Economy sync 2025-11-08 10:00 — согласованы индексы и формулы расчётов.
- UI review PR `FW-NPC-HIRING-012` — карта найма, уведомления и dashboard утверждены.
- QA checklist:  
  - [x] JSON схемы валидированы командой API.  
  - [x] Kafka payloadы задокументированы.  
  - [x] Связки с детализированными документами синхронизированы.

---

## 13. История изменений

- 2025-11-08 — добавлены API задачи, REST/Kafka контуры, метрики и UX сценарии; статус `approved`, готовность `ready`.
- 2025-11-07 — первичный драфт влияния найма.
