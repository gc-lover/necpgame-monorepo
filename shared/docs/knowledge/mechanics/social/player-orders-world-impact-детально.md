# Система заказов — влияние на мир (детально)

**Статус:** approved  \\n**Версия:** 1.0.0  \\n**Дата создания:** 2025-11-07  \\n**Последнее обновление:** 2025-11-08 09:57  \\n**Приоритет:** высокий

**api-readiness:** ready  \\n**api-readiness-check-date:** 2025-11-08 09:57  \\n**api-readiness-notes:** Влияние заказов на мир формализовано: описаны REST/JSON схемы, Kafka события и связки с world/social/economy сервисами; документ готов к API задачам.

---

- **Status:** queued
- **Last Updated:** 2025-11-08 18:10

---

## 1. Социальные эффекты

- **Сообщества и гильдии:** заказчики и исполнители объединяются в платформы, получают рейтинги, делятся опытом (`social-service`).
- **Сетевые связи:** успешное выполнение заказов укрепляет доверие, создаёт долгосрочные партнёрства.
- **Медиа и репутация:** известные заказы освещаются в VR/AR, влияют на имидж игроков и фракций.
- **Конфликты:** споры, мошенничество, саботаж → запускают арбитраж, квесты, санкции.
- **Социальные кризисы:** surge заказов в одной области вызывает протесты, забастовки, события EMU.

---

## 2. Экономика заказов

- **Денежные потоки:** крупные контракты перераспределяют капитал, создают новую экономическую активность.
- **Рынок услуг:** растёт спрос на логистику, охрану, хакерские услуги, PR-кампании.
- **Ценообразование:** стоимость заказов зависит от сложности, дистанции, риска (`economy-service`).
- **Налоги и комиссии:** фракции удерживают сборы; часть средств идёт в бюджеты.
- **Рабочие места:** появляются агенты, брокеры, модераторы, аудиторы.
- **Макроиндикаторы:** `OrderEconomicIndex`, `ServiceDemandIndex` — используются для событий рынка.

---

## 3. Политика и фракции

- **Скрытые операции:** фракции используют заказы для саботажа, шпионажа, пропаганды.
- **Дипломатия:** выполнение заказов улучшает/ухудшает отношения между фракциями (`factions-overview-детально.md`).
- **Войны:** PvP-заказы могут ускорить конфликты, заказы-перемирия — ослабить.
- **Лоббизм:** богатые заказчики влияют на политиков, меняют законы.
- **Локальные правки:** city councils меняют налоги/законы в ответ на волну заказов.

---

## 4. Влияние на города и локации

- **Доски заказов:** Night City, Neo Tokyo, Badlands — центры размещения заказов.
- **Региональное развитие:** заказы стимулируют торговлю, построение баз, туризм.
- **Кризисы:** волны преступности, кибератак, эпидемии — следствие заказов.
- **События:** фестивали исполнителей, марафоны благотворительных заказов.
- **Visual link:** asset ID из `visual-style-locations-детально.md` для отображения активности.

---

## 5. Геймплей

- **Прогресс:** заказы дают опыт, предметы, уникальный контент (`player-orders-system-детально.md`).
- **Команда:** заказы можно выполнять группами, синергия с `npc-hiring-system-детально.md`.
- **PvP/PvE:** охота за целями, защита караванов, хакерские рейды.
- **Контент:** пользователи создают сценарии, задания, VR-мероприятия.

---

## 6. UX и визуализация

- **Карта влияния:** отображает активность заказов, горячие точки, кризисы.
- **Журнал новостей:** обновления о крупных заказах, рейтингах, скандалах.
- **Оповещения:** уведомления о предложениях, кризисах, санкциях.
- **VR-комнаты:** переговоры заказчиков и исполнителей, презентации.
- **Analytics Dashboard:** графики `OrderEconomicIndex`, `ServiceDemandIndex`, `ConflictHeatMap`.

---

## 7. Интеграции

- `player-orders-system-детально.md` — механики и процесс.
- `player-orders-reputation-детально.md` — рейтинги, влияющие на доступ к заказам.
- `npc-hiring-system-детально.md` — использование NPC-исполнителей.
- `relationships-system-детально.md` — доверие между сторонами.
- `visual-style-locations-детально.md` — оформление досок и хабов.
- `factions-overview-детально.md` — политические эффекты.
- `city-life-population-algorithm.md` — пересчёт живости городов.
- `economy-service`, `world-service` — отслеживание влияния.

---

## 8. REST API и JSON схемы

- `GET /world/player-orders/effects` — список эффектов (`PlayerOrderImpact`).
- `POST /world/player-orders/effects/recalculate` — пересчёт влияния (batch).
- `GET /economy/player-orders/index` — индексы `OrderEconomicIndex`, `ServiceDemandIndex`.
- `GET /social/player-orders/news` — новости и события.
- `POST /world/player-orders/events` — генерация world-events.

**JSON схемы:**  
- `schemas/world/player-order-impact.schema.json`  
- `schemas/world/player-order-event.schema.json`  
- `schemas/economy/player-order-index.schema.json`  
- `schemas/social/player-order-news.schema.json`

---

## 9. Kafka события

| Topic | Producer | Payload |
|-------|----------|---------|
| `world.player-orders.impact` | world-service | `{ effectId, orderId, cityId, effectType, magnitude, expiresAt }` |
| `economy.player-orders.index` | economy-service | `{ orderEconomicIndex, serviceDemandIndex, updatedAt }` |
| `social.player-orders.news` | social-service | `{ orderId, headline, tags, publishedAt }` |
| `world.player-orders.crisis` | world-service | `{ crisisId, cityId, severity, triggers[] }` |

Подписчики: telemetry-service, monitoring-service, notification-service, factions-service, quest-service.

---

## 10. Использование

- API влияния применяются world/economy сервисами для обновления состояния мира.
- UX команды используют карту влияния и новостные ленты.
- Баланс: отслеживать общий эффект заказов, корректировать коэффициенты.
- Нарратив: связывать эффекты с сюжетными событиями и сезонными кампаниями.

---

## 11. Проверка и согласование

- World design: workshop 2025-11-08 09:50 — подтверждены индексы и эффекты.
- Economy: формулы индексов согласованы (meeting 2025-11-08 09:45).
- UI: PR `FW-PO-WORLD-008` — карта влияния и новостные ленты утверждены.
- QA чеклист:  
  - [x] JSON схемы валидированы.  
  - [x] Kafka payloadы задокументированы.  
  - [x] Документ < 400 строк, readiness-tracker обновлён.

---

## 12. История изменений

- 2025-11-08 — добавлены REST/JSON схемы, Kafka события, UX интеграции; статус `approved`, готовность `ready`.
- 2025-11-07 — первичный драфт влияния.
