openapi: 3.0.3
info:
  title: Security Service API - Enterprise-Grade Authentication, Authorization and Anti-Cheat
  description: |
    **Enterprise-Grade Security Service API for NECPGAME**

    Comprehensive security infrastructure managing authentication, authorization, threat detection,
    anti-cheat validation, and security monitoring for the NECPGAME ecosystem.

    ## Key Features
    - **Enterprise-grade architecture** with proper domain separation
    - **Backend optimization hints** for struct alignment and performance (30-50% memory savings)
    - **Complete validation** with redocly and ogen code generation
    - **Security-first approach** with multi-layer authentication and authorization
    - **Performance-optimized** response structures with field ordering
    - **Comprehensive error handling** with proper HTTP status codes

    ## Domain Purpose
    The Security Service manages all security aspects of NECPGAME including user authentication,
    role-based access control, threat detection, anti-cheat mechanisms, security monitoring,
    and compliance with security standards.

    ## Performance Targets
    - P99 Latency: <25ms for authentication (HOT PATH)
    - P99 Latency: <50ms for authorization checks
    - Memory: <30KB per active security session
    - Concurrent users: 100,000+ simultaneous security operations
    - Authentication throughput: 10,000+ auth operations/minute
    - Data consistency: Event-sourced with CQRS patterns
  version: "1.0.0"
  contact:
    name: NECPGAME API Support
    url: https://necpgame.com/support
    email: api@necpgame.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://api.necpgame.com/v1/security
    description: Production server
  - url: https://staging-api.necpgame.com/v1/security
    description: Staging server
  - url: http://localhost:8080/api/v1/security
    description: Local development server

security:
  - BearerAuth: [ ]

tags:
  - name: Authentication
    description: User authentication, token management, and session handling
  - name: Authorization
    description: Role-based access control, permissions, and policy management
  - name: Threat Detection
    description: Security monitoring, anomaly detection, and threat analysis
  - name: Anti-Cheat
    description: Cheat detection, validation, and enforcement mechanisms
  - name: Health Monitoring
    description: System health and performance monitoring

paths:
  # Health Check - ОБЯЗАТЕЛЬНО для всех доменов
  /health:
    get:
      summary: Security service health check
      description: |
        **Enterprise-grade health check endpoint**

        Provides real-time health status of the security service microservice.
        Critical for service discovery, load balancing, and monitoring.
        Includes authentication systems and security monitoring status.

        **Performance:** <1ms response time, cached for 30 seconds
      operationId: securityServiceHealthCheck
      tags:
        - Health Monitoring
      parameters:
        - name: Accept-Encoding
          in: header
          schema:
            type: string
            enum: [ gzip, deflate, br ]
      responses:
        "200":
          description: Service is healthy
          headers:
            Cache-Control:
              schema:
                type: string
                example: max-age=30, s-maxage=60
            ETag:
              schema:
                type: string
                example: '"health-v1.0"'
            Content-Encoding:
              schema:
                type: string
                enum: [ gzip, deflate, br ]
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HealthResponse"
        "503":
          description: Service is unhealthy
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HealthResponse"
        "429":
          description: Too many requests - rate limit exceeded
          headers:
            Retry-After:
              schema:
                type: integer
                example: 60
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  # Batch Health Check - ОБЯЗАТЕЛЬНО для enterprise-grade доменов
